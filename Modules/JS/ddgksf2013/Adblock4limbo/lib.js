!function(){var e={192:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".icon {\n  height: 17px;\n  width: 17px;\n}",""]),t.A=i},338:function(e,t,r){"use strict";r.d(t,{P:function(){return i},T:function(){return o}});var n=r(5950),i=(0,n.A)("Impression ready"),o=(0,n.A)("Tracking parameters loaded")},479:function(e,t,r){"use strict";r.d(t,{N5:function(){return o},g3:function(){return a},jv:function(){return n},ky:function(){return i}});var n=["s","s","e","n","i","s","u","b","m","a","c","e","h","t"].reverse().join(""),i=["h","s","a","c","p","i","r","t","s"].reverse().join(""),o=["t","a","h","c","p","i","r","t","s"].reverse().join(""),s=function(e){return e.Alpha="alpha",e.Beta="beta",e.Gamma="gamma",e.Zeta="zeta",e}(s||{}),a=Object.values(s)},541:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".root--FFUYt {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  width: 100%;\n  -webkit-box-pack: justify;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n}\n\n.left--Fhes9 {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  min-width: 0;\n}\n\n.left--Fhes9:only-child {\n  -webkit-box-flex: 1;\n      -ms-flex-positive: 1;\n          flex-grow: 1;\n}\n\n.right--0aRek {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  margin-left: auto;\n}",""]),i.locals={root:"root--FFUYt",left:"left--Fhes9",right:"right--0aRek"},t.A=i},681:function(e,t,r){"use strict";r.d(t,{A:function(){return l}});var n=r(479),i=r(8062),o=r(5419),s=e=>{var{hostname:t}=e;return t.replace(/^(creative|vr|gate)\./,"")},a=/(\..*){2,}/,l=e=>{var{hostname:t,protocol:r="https:",search:l=""}=e,u=(0,i.qy)(l.replace("?",""));if(u.goDomain&&a.test(u.goDomain))return"".concat(r,"//").concat(u.goDomain);var c=null;return n.g3.forEach(e=>{t.includes("-".concat(e,"."))&&(c="-".concat(e,"."))}),c?"".concat(r,"//go").concat(c).concat(n.ky,".com"):t.includes("creative.",0)||t==="".concat(n.N5,".com")||(0,o.A)({hostname:t})?"".concat(r,"//go.").concat(s({hostname:t})):"".concat(r,"//g").concat(t.slice(1))}},709:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".layoutWrapper--zyz7H {\n  height: 100%;\n  color: #fff;\n  overflow: hidden;\n  position: relative;\n  font-size: 22px;\n}\n",""]),i.locals={layoutWrapper:"layoutWrapper--zyz7H"},t.A=i},846:function(e,t,r){"use strict";r.d(t,{GN:function(){return N},ih:function(){return I},Io:function(){return w},L9:function(){return D},g8:function(){return M}});var n=r(2712),i=r(3911),o=(e,t)=>function(){return e(...arguments)&&t(...arguments)},s=r(9773),a=r(8062),l=r(9418),u=e=>{var{prevailingGender:t}=e;return t},c=r(1761),d=r(6579);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){p(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=e=>{var{modelsMeta:t}=e;return t||{}},g=(0,c.A)(v,d.zj,(0,l.IV)("isNewModelApi"),(e,t,r)=>{var{player:n}=t,{enabled:o}=r;return(0,i.A)(e)?null:"".concat(n,"-").concat(o?"newAPI":"oldAPI")}),_=(0,c.A)(v,e=>{var{modelsList:t=[]}=e;return t.length},g,(e,t,r)=>f(f({},e),{},{modelsCount:t,segment:r})),m=r(6628),y=r(3208),b=["queryParams","landing","path","referrer","modelPromotion"],E=["queryParams","landing","referrer"];function S(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function T(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?S(Object(r),!0).forEach(function(t){C(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function C(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var P,R=e=>(t,r)=>e.includes(r),O={referrer:!0},L=(0,s.A)((e,t)=>O[t],(P=i.A,function(){return!P(...arguments)})),M=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{isIncognito:i,trackingParameters:s,referrer:a,mlHash:l,mlHashTime:u}=e,c=(0,d.zj)(e),{queryParams:h={},landing:f,path:p,referrer:v,modelPromotion:g}=c,y=A(c,b),E=v||a;return(0,m.A)((0,n.A)(o(L,R([...s,"mlHash","mlHashTime","notifyAfterAV","modelPromotionId","modelId"])),T(T(T(T(T(T(T(T({},h),y),r),_(e)),{},{path:t||h.path||p||"/",i:i,landing:f,referrer:E},l?{mlHash:l}:{}),u?{mlHashTime:u}:{}),null!=h&&h.notifyAfterAV?{notifyAfterAV:h.notifyAfterAV}:{}),{},{modelPromotion:g})))},w=(e,t)=>{var{hash:r=""}=t,{isIncognito:i,impressionParameters:s,referrer:l,modelsList:u}=e,c=(0,d.zj)(e),{queryParams:h,landing:f,referrer:p}=c,v=A(c,E),g=p||l,b=r.substring(1),S=T(T(T({},h),b?(0,a.qy)(b):{}),v),C=T({landing:f,referrer:g,i:i},(0,y.xp)(e));return(0,m.A)((0,n.A)(o(L,R(s)),T(T(T(T({},S),_(e)),C),{},{filtersMatch:u&&u.some(e=>{var{strict:t}=e;return t})})))},I=function(e,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"click",n=M(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),i=u(e),o=T(T(T({},n),"/"===n.path&&"male"===i?{path:"men"}:{}),(0,y.xp)(e));return(0,a.dF)((0,l.FB)(e,r),(0,d.zj)(e).encrypted?{e:btoa((0,a.x7)(o))}:o)},D=function(e,t){return{href:I(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},arguments.length>3&&void 0!==arguments[3]?arguments[3]:"click"),target:"_blank",rel:"noopener"}},N=function(e,t,r){var n=I(t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}),[i,o]=n.split("?");return"".concat(i).concat("/"===i[i.length-1]?"":"/","api/").concat(e,"?").concat(o)}},889:function(e,t){"use strict";t.A="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjMzgzODM4IiB2aWV3Qm94PSIwIDAgMjE3IDQyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik02MS4zNTggMjMuNzU5aC00LjM1M2MtLjAxOSAxLjI2LjIxIDIuMzQ4LjY4OCAzLjI2NGE2LjQzNiA2LjQzNiAwIDAwMS45MzMgMi4yNjJjLjgxMS41OTIgMS43NDYgMS4wMjcgMi44MDYgMS4zMDMgMS4wNi4yNzcgMi4xNTMuNDE2IDMuMjc5LjQxNiAxLjM5NCAwIDIuNjItLjE2MyAzLjY4LS40ODcgMS4wNi0uMzI1IDEuOTQ3LS43NzggMi42NjMtMS4zNmE1LjY2MSA1LjY2MSAwIDAwMS42MTgtMi4wNzdjLjM2My0uODAxLjU0NC0xLjY3LjU0NC0yLjYwNSAwLTEuMTQ2LS4yNDMtMi4wODYtLjczLTIuODIxLS40ODctLjczNS0xLjA2NS0xLjMyMi0xLjczMy0xLjc2MWE3LjYxNiA3LjYxNiAwIDAwLTIuMDE5LS45NmMtLjY3Ny0uMi0xLjIwNy0uMzM4LTEuNTg5LS40MTUtMS4yOC0uMzI0LTIuMzE1LS41OTItMy4xMDctLjgwMi0uNzkyLS4yMS0xLjQxMy0uNDItMS44NjEtLjYzLS40NDktLjIxLS43NS0uNDM5LS45MDItLjY4Ny0uMTUzLS4yNDgtLjIzLS41NzMtLjIzLS45NzQgMC0uNDM5LjA5Ni0uODAxLjI4Ny0xLjA4OGEyLjQ4IDIuNDggMCAwMS43My0uNzE2IDIuOTEgMi45MSAwIDAxLjk4OC0uNCA1LjI3IDUuMjcgMCAwMTEuMDg4LS4xMTVjLjU1NCAwIDEuMDY0LjA0OCAxLjUzMi4xNDMuNDY4LjA5Ni44ODMuMjU4IDEuMjQ2LjQ4Ny4zNjMuMjI5LjY1NC41NDQuODczLjk0NS4yMi40LjM0OS45MDcuMzg3IDEuNTE4aDQuMzUzYzAtMS4xODQtLjIyNS0yLjE5MS0uNjczLTMuMDIyYTUuODY3IDUuODY3IDAgMDAtMS44MTktMi4wNDcgNy42NzggNy42NzggMCAwMC0yLjYyLTEuMTYgMTMuMDA4IDEzLjAwOCAwIDAwLTMuMDc4LS4zNThjLS45MTcgMC0xLjgzMy4xMjQtMi43NS4zNzNhNy42NzUgNy42NzUgMCAwMC0yLjQ2MiAxLjE0NSA2LjA5OCA2LjA5OCAwIDAwLTEuNzYxIDEuOTMzYy0uNDQ5Ljc3My0uNjczIDEuNjg1LS42NzMgMi43MzUgMCAuOTM1LjE3NiAxLjczMi41MyAyLjM5YTUuMDU3IDUuMDU3IDAgMDAxLjM4OCAxLjY0N2MuNTczLjQ0IDEuMjIyLjc5NyAxLjk0OCAxLjA3NC43MjUuMjc3IDEuNDcuNTExIDIuMjMzLjcwMi43NDUuMjEgMS40OC40IDIuMjA1LjU3My43MjYuMTcxIDEuMzc1LjM3MiAxLjk0OC42MDEuNTcyLjIzIDEuMDM1LjUxNSAxLjM4OC44Ni4zNTQuMzQzLjUzLjc5MS41MyAxLjM0NSAwIC41MTUtLjEzMy45NC0uNCAxLjI3NGEyLjgxMSAyLjgxMSAwIDAxLTEuMDAzLjc4OGMtLjQuMTktLjgzLjMyLTEuMjg5LjM4Ni0uNDU4LjA2Ny0uODg3LjEtMS4yODguMWE2LjgzNCA2LjgzNCAwIDAxLTEuNzE4LS4yMTQgNC4yNzcgNC4yNzcgMCAwMS0xLjQ0Ny0uNjU5IDMuMjUzIDMuMjUzIDAgMDEtLjk4OC0xLjE2Yy0uMjQ4LS40NzctLjM3Mi0xLjA2LS4zNzItMS43NDZ6bTIwLjA0Ni05Ljg4djE2LjY2Nkg4NS45VjEzLjg4aDYuMTI4VjEwLjFINzUuMjc1djMuNzhoNi4xMjl6bTE3LjQ2OCA1LjQ3di01Ljc1Nmg0LjkyNWMxLjAzMSAwIDEuODA0LjIyNCAyLjMyLjY3My41MTUuNDQ4Ljc3MyAxLjE2OS43NzMgMi4xNjIgMCAxLjAzLS4yNTggMS43NzUtLjc3MyAyLjIzMy0uNTE2LjQ1OS0xLjI4OS42ODgtMi4zMi42ODhoLTQuOTI1em0tNC40OTYtOS4yNXYyMC40NDZoNC40OTZ2LTcuOTloNC40OTZjMS4xMjYgMCAxLjkzNy4yNSAyLjQzNC43NDUuNDk2LjQ5Ny44MiAxLjI4Ljk3MyAyLjM0OS4xMTUuODIuMiAxLjY4LjI1OCAyLjU3Ny4wNTcuODk3LjIxIDEuNjcuNDU4IDIuMzJoNC40OTZhMy4wMSAzLjAxIDAgMDEtLjQ3Mi0xLjA0NiA5LjAyOSA5LjAyOSAwIDAxLS4yMy0xLjMwMyAyMi4zNzQgMjIuMzc0IDAgMDEtLjEtMS4zNDZjLS4wMTktLjQzOS0uMDM4LS44Mi0uMDU3LTEuMTQ1YTEyLjIyNSAxMi4yMjUgMCAwMC0uMjE1LTEuNTQ2IDUuMiA1LjIgMCAwMC0uNS0xLjQxOCAzLjg5IDMuODkgMCAwMC0uODg4LTEuMTE3Yy0uMzYzLS4zMTUtLjgyMS0uNTQ5LTEuMzc1LS43MDF2LS4wNThjMS4xNDUtLjQ1OCAxLjk3MS0xLjEyNiAyLjQ3Ny0yLjAwNC41MDYtLjg3OC43NTktMS45MTkuNzU5LTMuMTIyIDAtLjc4Mi0uMTM4LTEuNTEyLS40MTUtMi4xOWE1LjI4MyA1LjI4MyAwIDAwLTEuMjAzLTEuNzkgNS43MDEgNS43MDEgMCAwMC0xLjg5LTEuMjE3Yy0uNzM1LS4yOTYtMS41Ni0uNDQ0LTIuNDc3LS40NDRIOTQuMzc2em0yMC42NzUgMHYyMC40NDZoNC40OTZWMTAuMWgtNC40OTZ6bTEyLjk0NCA5LjYyMnYtNi4xMjhoMy40OTRhOS40NyA5LjQ3IDAgMDExLjQ4OS4xMTQgMy40OSAzLjQ5IDAgMDExLjI2LjQ0NGMuMzYyLjIyLjY1NC41My44NzMuOTMuMjIuNDAyLjMzLjkyNy4zMyAxLjU3NnMtLjExIDEuMTc0LS4zMyAxLjU3NWMtLjIyLjQtLjUxLjcxMS0uODczLjkzLS4zNjMuMjItLjc4My4zNjgtMS4yNi40NDRhOS40MTYgOS40MTYgMCAwMS0xLjQ5LjExNWgtMy40OTN6bS00LjQ5Ni05LjYyMnYyMC40NDZoNC40OTZ2LTcuMzNoNC43MjVjMS4yOCAwIDIuMzY3LS4xODcgMy4yNjUtLjU1OS44OTctLjM3MiAxLjYyNy0uODY0IDIuMTktMS40NzVhNS42NDYgNS42NDYgMCAwMDEuMjMyLTIuMTA0IDcuNzc2IDcuNzc2IDAgMDAuMzg2LTIuNDIgNy43NSA3Ljc1IDAgMDAtLjM4Ni0yLjQzNCA1LjY2NSA1LjY2NSAwIDAwLTEuMjMyLTIuMDljLS41NjMtLjYxMi0xLjI5My0xLjEwMy0yLjE5LTEuNDc1LS44OTgtLjM3My0xLjk4Ni0uNTU5LTMuMjY1LS41NTloLTkuMjJ6bTMzLjczNCA2LjE1N2gyLjcyYy0uMTUzLTEuMDg4LS40NzctMi4wNDgtLjk3My0yLjg3OGE3LjA4MSA3LjA4MSAwIDAwLTEuODYyLTIuMDc2IDguMTYgOC4xNiAwIDAwLTIuNTQ4LTEuMjYgMTAuNTEgMTAuNTEgMCAwMC0zLjAzNi0uNDNjLTEuNTY1IDAtMi45NTQuMjgyLTQuMTY2Ljg0NS0xLjIxMy41NjMtMi4yMjUgMS4zMzItMy4wMzYgMi4zMDUtLjgxMS45NzQtMS40MjcgMi4xMTUtMS44NDcgMy40MjItLjQyIDEuMzA4LS42MyAyLjcwNi0uNjMgNC4xOTYgMCAxLjQ4OS4xOTYgMi44ODIuNTg3IDQuMTguMzkxIDEuMjk5Ljk3OCAyLjQyNSAxLjc2MSAzLjM4Ljc4My45NTQgMS43NjYgMS43MDMgMi45NSAyLjI0NyAxLjE4My41NDUgMi41NjcuODE3IDQuMTUyLjgxNyAyLjYxNSAwIDQuNjc3LS43MTYgNi4xODUtMi4xNDggMS41MDktMS40MzIgMi4zOTYtMy40MzYgMi42NjQtNi4wMTRoLTIuNzJhNy44MDIgNy44MDIgMCAwMS0uNTE2IDIuMzQ4IDUuNjY3IDUuNjY3IDAgMDEtMS4xODkgMS44NzYgNS40MTMgNS40MTMgMCAwMS0xLjgwNCAxLjIzMmMtLjY5Ny4yOTUtMS40OTQuNDQzLTIuMzkuNDQzLTEuMjIzIDAtMi4yNzMtLjIyOS0zLjE1LS42ODdhNi4xNTIgNi4xNTIgMCAwMS0yLjE2My0xLjg0N2MtLjU2My0uNzczLS45NzgtMS42OC0xLjI0Ni0yLjcyYTEzLjI1IDEzLjI1IDAgMDEtLjQtMy4zMDhjMC0xLjA2OS4xMzMtMi4xLjQtMy4wOTNhNy45NzIgNy45NzIgMCAwMTEuMjQ2LTIuNjQ4IDYuMTg5IDYuMTg5IDAgMDEyLjE0OC0xLjg0OGMuODY4LS40NTggMS45MTQtLjY4NyAzLjEzNS0uNjg3IDEuNDMyIDAgMi42NjguMzYzIDMuNzA5IDEuMDg4IDEuMDQuNzI2IDEuNzEzIDEuODE0IDIuMDE5IDMuMjY1em02LjMtNi4xNTd2MjAuNDQ2aDIuNzJ2LTkuMzY0aDEwLjc2N3Y5LjM2NGgyLjcyVjEwLjFoLTIuNzJ2OC43OTFoLTEwLjc2N1YxMC4xaC0yLjcyem0yNC4xOTcgMTEuOTk5bDMuNDY1LTkuNTM2aC4wNThsMy40MDcgOS41MzZoLTYuOTN6bTIuMDM0LTExLjk5OWwtNy45NjEgMjAuNDQ2aDIuNzc3bDIuMjkxLTYuMTU2aDguNjQ5bDIuMjMzIDYuMTU2aDMuMDA3TDE5Mi43NyAxMC4xaC0zLjAwNnptMTcuNjQgMi4yOTF2MTguMTU1aDIuNzJWMTIuMzloNi44MTZWMTAuMWgtMTYuMzUydjIuMjloNi44MTZ6TTE3LjcgMzcuNzZzLS4yNzItLjA1LS4zMjEtLjA2NGMtLjc5NS0uMjEyLTEuNjE4LS4wMDMtMi4yMDguMjg1LS41NzQuMjgtLjMzLjE2My0uMzMuMTYzLS45NTguNDc1LTEuOTczLjkxMy0zLjAzOCAxLjMxNS0yLjg5NSAxLjA5MS02LjAyOCAxLjg3LTkuMTgyIDIuMzguMjgtLjQxNy41MzctLjgxNi43NzEtMS4xOTguNjMyLTEuMDMgMS40NDEtMi40OTkgMi4zODYtNC4yOTYgMCAwIC43OC0xLjM2IDEuMDktMi4wNzIuMzA4LS43MDYtLjA0OC0xLjM3Mi0uNDktMS44MDMtLjQ0NC0uNDMtMS4zNDQtMS4zOTgtMS4zNDQtMS4zOThDMS43NzcgMjcuNjgxIDAgMjMuNTA4IDAgMTkuMTMgMCA4LjczIDEwLjExNyAwIDIyLjkxIDAgMzUuNyAwIDQ1LjgxNyA4LjczIDQ1LjgxNyAxOS4xMjljMCA5LjgyOS05LjA0IDE4LjE2OC0yMC44MzUgMTkuMDUxLS4yNi4wMi0uNzgzLS4xODEtLjc4OS0uODE2LS4wMzUtMy44MTUtLjA3LTExLjQzMS0uMDctMTEuNDMxIDAtLjM1OC4yNDktLjc5NS41NTYtLjk3NWw4Ljc1OC05LjI0NmMuMjMtLjI0NC40MS0uNzEzLjQtMS4wNGwuMDE4LjU5YS44MTguODE4IDAgMDAtLjgxNy0uNzkybC0yMC43MDkuMDFjLS40MzggMC0uOC4zNTctLjgwOS43ODdsLjAxMi0uNjA0Yy0uMDA3LjMzMy4xOC44MDYuNDA1IDEuMDQ1bDguNzMyIDkuMjM3Yy4zMDMuMTg4LjU1LjYzLjU1Ljk4OCAwIDAtLjAxIDcuNjM4LjAxNCAxMS40NTguMDA0LjU4NC0uNTg0LjgwOC0uODcyLjc3OWEyOS4yMiAyOS4yMiAwIDAxLTIuNjYxLS40MXoiLz48L3N2Zz4="},946:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".root--1yzKo {\n  background-color: rgba(0, 0, 0, 0.32);\n  border-radius: 2px;\n  color: #fff;\n  font-size: 10px;\n  padding: 1px 5px;\n  display: inline-block;\n  position: relative;\n  z-index: 2;\n}\n\n.root--1yzKo + .root--1yzKo {\n  margin-left: 3px;\n}\n\n.big--hCEpr {\n  font-weight: 600;\n  padding: 5px 12px;\n  font-size: 15px;\n  border-radius: 3px;\n}\n\n@media (max-height: 160px) {\n  .root--1yzKo,\n  .root--1yzKo.big--hCEpr {\n    font-size: 8px;\n    line-height: normal;\n    padding: 1px 3px;\n  }\n}",""]),i.locals={root:"root--1yzKo",big:"big--hCEpr"},t.A=i},1512:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".root--HUO8u {\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  font-size: 12px;\n  padding: 0 8px;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  position: absolute;\n  width: 100%;\n  z-index: 1;\n}\n\n.big--pNpF8 {\n  padding: 0 25px 10px;\n}\n\n.model-name--WbalK {\n  max-width: calc(100% - 17px);\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  margin-right: 5px;\n}\n\n.model-name-responsive--Xfg0V {\n  font-size: calc(12px + 2vh);\n  margin-right: calc(5px + 0.3vh);\n}\n\n.root--HUO8u .icon-responsive--DzB-T {\n  height: 100%;\n  width: auto;\n}\n\n@media screen and (max-height: 89px) {\n  .hide-on-small-spots--xvt3p {\n    display: none;\n  }\n}",""]),i.locals={root:"root--HUO8u",big:"big--pNpF8","model-name":"model-name--WbalK",modelName:"model-name--WbalK","model-name-responsive":"model-name-responsive--Xfg0V",modelNameResponsive:"model-name-responsive--Xfg0V","icon-responsive":"icon-responsive--DzB-T",iconResponsive:"icon-responsive--DzB-T","hide-on-small-spots":"hide-on-small-spots--xvt3p",hideOnSmallSpots:"hide-on-small-spots--xvt3p"},t.A=i},1761:function(e,t){"use strict";t.A=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var{length:n}=t;if(n<2)throw new Error("Selector should receive more than one argument!");var i=t[n-1],o=t.slice(0,n-1);return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i(...o.map(e=>e(...t)))}}},1967:function(e){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var r=e(t);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r}).join("")},t.i=function(e,r,n){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(n)for(var o=0;o<this.length;o++){var s=this[o][0];null!=s&&(i[s]=!0)}for(var a=0;a<e.length;a++){var l=[].concat(e[a]);n&&i[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},1981:function(e,t){"use strict";t.A={INT:"int",UNSIGNED_INT:"unsigned_int",INT_LIST:"int_list",BOOL:"bool",STRING:"string",ENUM:"enum",STRING_LIST:"string_list",HEX_COLOR:"hex_color",HEX_LIST:"hex_list",LP_EXPERIENCE_HEX_LIST:"lp_experience_hex_list",LP_AKIRA_HEX_LIST:"lp_akira_hex_list"}},2698:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".root--oPpnf {\n  opacity: 0;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  width: 100%;\n  height: 100%;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  font-family: Arimo, sans-serif;\n  text-align: center;\n  position: absolute;\n  top: 0;\n  text-shadow: 0 0 9px black;\n  -webkit-animation: fade-in--AMyWk 0.5s 0.8s forwards;\n          animation: fade-in--AMyWk 0.5s 0.8s forwards;\n}\n\n.head--1H5Od {\n  font-size: 1.8em;\n  margin-bottom: 1.8em;\n}\n\n@-webkit-keyframes fade-in--AMyWk {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes fade-in--AMyWk {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}",""]),i.locals={root:"root--oPpnf","fade-in":"fade-in--AMyWk",fadeIn:"fade-in--AMyWk",head:"head--1H5Od"},t.A=i},2712:function(e,t){"use strict";t.A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).reduce((r,n)=>(e(t[n],n)&&(r[n]=t[n]),r),{})}},2929:function(e,t){"use strict";t.A=function(e){return 0===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"").indexOf(e)}},3208:function(e,t,r){"use strict";r.d(t,{FB:function(){return a},IV:function(){return l},JO:function(){return u},xp:function(){return d}});var n=r(1761),i=r(6579);r(7727);function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=(e,t)=>{var{urls:r}=e;return r[t]},l=e=>t=>{var{features:r={}}=t;return r[e]||{}},u=e=>{var{whiteLabelData:t}=e;return t||{}},c=e=>{var{abTest:t}=e;return t},d=((0,n.A)(i.zj,c,(e,t)=>{var{landing:r}=e;if(!t||String(t.landing).toLowerCase()!==String(r).toLowerCase())return{};var{selectedVariant:n,variants:i}=t,{params:o={}}=i.find(e=>e.name===n)||{};return o}),(0,n.A)(i.zj,c,(e,t)=>{var{landing:r}=e;return t&&String(t.landing).toLowerCase()===String(r).toLowerCase()?function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach(function(t){s(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({abTest:t.name,abTestVariant:t.selectedVariant},t.uniquenessParams):{}}))},3246:function(e,t){"use strict";var r=e=>Array.isArray(e)?e:[e];t.A=e=>{var t=[],n=function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=(e=>t.find(t=>t.event===e))(e);i?i.handlers.push([r,n]):t.push({event:e,handlers:[[r,n]]})};return{initialState:e,on(e,t){return r(e).forEach(e=>{n(e,t)}),this},once(e,t){return r(e).forEach(e=>{n(e,t,{once:!0})}),this},bind(e,r){t.forEach(t=>{var{event:n,handlers:i}=t;i.forEach(t=>{var[i,{once:o}]=t,s=e=>r(i(e));o?e.once(n,s):e.on(n,s)})})}}}},3292:function(e,t){"use strict";t.A=e=>{var t=[],r=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.map(e=>{if(e in r)return r[e];throw new Error('Dependency "'.concat(e,'" is empty!'))});return e(...n)};return r.requires=function(){return t.push(...arguments),r},r}},3554:function(e,t,r){"use strict";r.d(t,{A:function(){return n}});var n=function(){var e,t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return r[(e=0,t=r.length-1,Math.floor(Math.random()*(t-e+1)+e))]}},3614:function(e,t){"use strict";t.A=e=>{for(var t=0,r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t&=t;return t}},3698:function(e,t,r){"use strict";r.r(t),r.d(t,{modelThumbRenderedEvent:function(){return u},modelsApiCacheResponseSuccess:function(){return f},modelsApiLoaded:function(){return v},modelsApiParametersLoaded:function(){return d},modelsLoadedEvent:function(){return s},modelsLoadingStarted:function(){return o},modelsMlDataReceived:function(){return g},modelsNotLoadedEvent:function(){return a},modelsReadyEvent:function(){return l},replaceModelByModel:function(){return c},replaceModelWithRandomModel:function(){return p},startLoadingModels:function(){return i},updateModelsApiCache:function(){return h}});var n=r(5950),i=(0,n.A)("Call to starts models loading"),o=(0,n.A)("Models started loading"),s=(0,n.A)("Models loaded"),a=(0,n.A)("Models not loaded"),l=(0,n.A)("Models ready"),u=(0,n.A)("Model thumb rendered"),c=(0,n.A)("replace model"),d=(0,n.A)("Models api parameters loaded"),h=(0,n.A)("models, loading data from api"),f=(0,n.A)("models, api response cached"),p=(0,n.A)("models, replace by random models"),v=(0,n.A)("models, api data loaded"),g=(0,n.A)("models, set ml-event hash")},3711:function(e,t){"use strict";t.byteLength=function(e){var t=a(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,o=a(e),s=o[0],l=o[1],u=new i(function(e,t,r){return 3*(t+r)/4-r}(0,s,l)),c=0,d=l>0?s-4:s;for(r=0;r<d;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;2===l&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,u[c++]=255&t);1===l&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=16383,a=0,l=n-i;a<l;a+=s)o.push(u(e,a,a+s>l?l:a+s));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)r[s]=o[s],n[o.charCodeAt(s)]=s;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function u(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(l(n));return i.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},3847:function(e,t,r){var n;!function(){"use strict";var i={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(e){return function(e,t){var r,n,s,a,l,u,c,d,h,f=1,p=e.length,v="";for(n=0;n<p;n++)if("string"==typeof e[n])v+=e[n];else if("object"==typeof e[n]){if((a=e[n]).keys)for(r=t[f],s=0;s<a.keys.length;s++){if(null==r)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',a.keys[s],a.keys[s-1]));r=r[a.keys[s]]}else r=a.param_no?t[a.param_no]:t[f++];if(i.not_type.test(a.type)&&i.not_primitive.test(a.type)&&r instanceof Function&&(r=r()),i.numeric_arg.test(a.type)&&"number"!=typeof r&&isNaN(r))throw new TypeError(o("[sprintf] expecting number but found %T",r));switch(i.number.test(a.type)&&(d=r>=0),a.type){case"b":r=parseInt(r,10).toString(2);break;case"c":r=String.fromCharCode(parseInt(r,10));break;case"d":case"i":r=parseInt(r,10);break;case"j":r=JSON.stringify(r,null,a.width?parseInt(a.width):0);break;case"e":r=a.precision?parseFloat(r).toExponential(a.precision):parseFloat(r).toExponential();break;case"f":r=a.precision?parseFloat(r).toFixed(a.precision):parseFloat(r);break;case"g":r=a.precision?String(Number(r.toPrecision(a.precision))):parseFloat(r);break;case"o":r=(parseInt(r,10)>>>0).toString(8);break;case"s":r=String(r),r=a.precision?r.substring(0,a.precision):r;break;case"t":r=String(!!r),r=a.precision?r.substring(0,a.precision):r;break;case"T":r=Object.prototype.toString.call(r).slice(8,-1).toLowerCase(),r=a.precision?r.substring(0,a.precision):r;break;case"u":r=parseInt(r,10)>>>0;break;case"v":r=r.valueOf(),r=a.precision?r.substring(0,a.precision):r;break;case"x":r=(parseInt(r,10)>>>0).toString(16);break;case"X":r=(parseInt(r,10)>>>0).toString(16).toUpperCase()}i.json.test(a.type)?v+=r:(!i.number.test(a.type)||d&&!a.sign?h="":(h=d?"+":"-",r=r.toString().replace(i.sign,"")),u=a.pad_char?"0"===a.pad_char?"0":a.pad_char.charAt(1):" ",c=a.width-(h+r).length,l=a.width&&c>0?u.repeat(c):"",v+=a.align?h+r+l:"0"===u?h+l+r:l+h+r)}return v}(function(e){if(a[e])return a[e];var t,r=e,n=[],o=0;for(;r;){if(null!==(t=i.text.exec(r)))n.push(t[0]);else if(null!==(t=i.modulo.exec(r)))n.push("%");else{if(null===(t=i.placeholder.exec(r)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var s=[],l=t[2],u=[];if(null===(u=i.key.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(s.push(u[1]);""!==(l=l.substring(u[0].length));)if(null!==(u=i.key_access.exec(l)))s.push(u[1]);else{if(null===(u=i.index_access.exec(l)))throw new SyntaxError("[sprintf] failed to parse named argument key");s.push(u[1])}t[2]=s}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");n.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}r=r.substring(t[0].length)}return a[e]=n}(e),arguments)}function s(e,t){return o.apply(null,[e].concat(t||[]))}var a=Object.create(null);t.sprintf=o,t.vsprintf=s,"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=s,void 0===(n=function(){return{sprintf:o,vsprintf:s}}.call(t,r,t,e))||(e.exports=n))}()},3911:function(e,t,r){"use strict";var n=r(6773);t.A=e=>(0,n.A)(e)||""===e||Array.isArray(e)&&0===e.length||"object"==typeof e&&0===Object.keys(e).length||"number"==typeof e&&e!=e},4080:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function s(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var s=e.apply(t,r);function a(e){o(s,n,i,a,l,"next",e)}function l(e){o(s,n,i,a,l,"throw",e)}a(void 0)})}}function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{xG:function(){return f},yD:function(){return p},zQ:function(){return h}}),e=r.hmd(e);var l={3:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddStereoModifier=void 0,t.AddStereoModifier=class{constructor(){a(this,"_opusCodecRegexp",/^a=rtpmap:(\d+)\sopus\/48000/gm)}modify(e){var t=e.match(this._opusCodecRegexp);return t?[...t].reduce((e,t)=>{var r,n=null===(r=this._opusCodecRegexp.exec(t))||void 0===r?void 0:r[1];return this._opusCodecRegexp.exec(""),n?e.replace(new RegExp("a=fmtp:".concat(n," .*")),e=>"".concat(e,";stereo=1;sprop-stereo=1")):e},e):e}}},28:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackSpeedWatcher=void 0;var o=r(355),s=r(1421),l=r(8548),u=r(6791),c=r(8169),d=r(8474),h=r(6701),f=r(180),p=r(9088),v=i(r(6073));class g extends c.ConfigConsumer{constructor(e){super("playbackSpeedWatcher",e),a(this,"state",f.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["PlaybackSpeed"]),a(this,"_originalTargetBuffer",2),a(this,"_currentTargetBufferMultiplier",1),a(this,"_currentPlaybackRateMode",l.EPlaybackRateMode.NORMAL),a(this,"_isPaused",!1),a(this,"_isDecriseable",!0),a(this,"_currentOriginalTargetBufferMultiplier",0),a(this,"_onBufferMetricsReadyListener",void 0),a(this,"_onTargetBufferIncreaseRequestedListener",void 0),a(this,"_onTargetBufferDecreaseRequestedListener",void 0),a(this,"_onPlaylistInfoAvailableListener",void 0),a(this,"_onPlaybackSpeedControllerMetricsRequestedListener",void 0),a(this,"_onOriginalTargetBufferDecreaseRequestedListener",void 0),a(this,"_onOriginalTargetBufferDecreaseDisableListener",void 0),a(this,"_logger",void 0),this._logger=(0,d.Logger)(this._eventBus,"Doppio - PlaybackSpeedWatcher"),this._onBufferMetricsReadyListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable),this._onTargetBufferDecreaseRequestedListener=this._eventBus.subscribe(u.TargetBufferEvents.targetBufferDecreaseRequested,this._targetBufferDecreaseRequested),this._onTargetBufferIncreaseRequestedListener=this._eventBus.subscribe(u.TargetBufferEvents.targetBufferIncreaseRequested,this._targetBufferIncreaseRequested),this._onPlaylistInfoAvailableListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.playlistRotator.playlists.playlistInfo,this._onPlaylistInfoAvailable),this._onPlaybackSpeedControllerMetricsRequestedListener=this._eventBus.subscribe(s.GetSideMetricsAsyncEvents.getPlaybackSpeedControllerMetrics,this._onPlaybackSpeedControllerMetricsRequested),this._onOriginalTargetBufferDecreaseRequestedListener=this._eventBus.subscribe(u.TargetBufferEvents.originalTargetBufferDecreaseRequested,this._originalTargetBufferDecreaseRequested),this._onOriginalTargetBufferDecreaseDisableListener=this._eventBus.subscribe(u.TargetBufferEvents.originalTargetBufferDisable,this._onOriginalTargetBufferDecreaseDisable),this.config.targetBufferInitialMultiplier&&this.config.targetBufferInitialMultiplier<1&&this._logger.warn("Target buffer multiplier set to value lower than 1. It is unsafe to load less than target-duration, forcing no multiplier instead")}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onBufferMetricsReadyListener),this._eventBus.unsubscribe(this._onTargetBufferDecreaseRequestedListener),this._eventBus.unsubscribe(this._onTargetBufferIncreaseRequestedListener),this._eventBus.unsubscribe(this._onPlaylistInfoAvailableListener),this._eventBus.unsubscribe(this._onPlaybackSpeedControllerMetricsRequestedListener),this._eventBus.unsubscribe(this._onOriginalTargetBufferDecreaseRequestedListener),this._eventBus.unsubscribe(this._onOriginalTargetBufferDecreaseDisableListener)}pause(){this._isPaused=!0,this._setNewPlaybackRateMode(l.EPlaybackRateMode.NORMAL)}resume(){this._isPaused=!1}_handleConfigUpdated(){}_setNewPlaybackRateMode(e){this._currentPlaybackRateMode!==e&&(this._currentPlaybackRateMode=e,this._eventBus.publish(u.PlaybackSpeedEvents.setPlaybackSpeed,e))}_onBufferMetricsAvailable(e){if(!this._isPaused){var t=this._getTargetBuffer(),r=e.bufferAmountWithoutGaps-t;0!==e.currentPlaybackPosition&&(r>this.config.maxLiveSyncThreshold*t?this._setNewPlaybackRateMode(l.EPlaybackRateMode.FAST):-1*r>this.config.minLiveSyncThreshold*t?this._setNewPlaybackRateMode(l.EPlaybackRateMode.SLOW):(this._currentPlaybackRateMode===l.EPlaybackRateMode.SLOW&&r>0||this._currentPlaybackRateMode===l.EPlaybackRateMode.FAST&&r<0)&&this._setNewPlaybackRateMode(l.EPlaybackRateMode.NORMAL))}}_targetBufferIncreaseRequested(){this._currentTargetBufferMultiplier<this.config.maxTargetBufferMultiplier&&(this._currentTargetBufferMultiplier+=1,this._eventBus.publish(u.TargetBufferEvents.targetBufferIncreased,{}))}_targetBufferDecreaseRequested(){this._currentTargetBufferMultiplier>1&&(this._currentTargetBufferMultiplier-=1,this._eventBus.publish(u.TargetBufferEvents.targetBufferIncreased,{}))}_onPlaylistInfoAvailable(e){this._originalTargetBuffer=(0,p.getPartHoldback)(e,3*e.targetDuration)}_onPlaybackSpeedControllerMetricsRequested(){this._eventBus.publish(s.GetSideMetricsAsyncEvents.playbackSpeedControllerMetricsAvailable,this._getTargetBuffer())}_getTargetBuffer(){return this._isDecriseable?this._originalTargetBuffer-this._currentOriginalTargetBufferMultiplier*this.config.targetBufferDecreaseCoefficient:this._originalTargetBuffer*this._currentTargetBufferMultiplier*this.config.targetBufferInitialMultiplier}get additionalInfo(){return{currentTargetBufferMultiplier:this._currentTargetBufferMultiplier,currentTargetBuffer:this._getTargetBuffer()}}_originalTargetBufferDecreaseRequested(){this._currentOriginalTargetBufferMultiplier+=1}_onOriginalTargetBufferDecreaseDisable(){this._isDecriseable=!1}}t.PlaybackSpeedWatcher=g,n([v.default],g.prototype,"destroy",null),n([v.default],g.prototype,"_onBufferMetricsAvailable",null),n([v.default],g.prototype,"_targetBufferIncreaseRequested",null),n([v.default],g.prototype,"_targetBufferDecreaseRequested",null),n([v.default],g.prototype,"_onPlaylistInfoAvailable",null),n([v.default],g.prototype,"_onPlaybackSpeedControllerMetricsRequested",null),n([v.default],g.prototype,"_originalTargetBufferDecreaseRequested",null),n([v.default],g.prototype,"_onOriginalTargetBufferDecreaseDisable",null)},57:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbrControllerFacade=void 0;var o=r(6805),s=r(3518),l=r(9476),u=i(r(5354)),c=r(5088),d=r(5803);class h extends s.ConfigConsumer{constructor(e){super("abrControllerConfig",e),a(this,"_logger",void 0),a(this,"_abrController",void 0),a(this,"_onStreamInfoAvailableListener",void 0),a(this,"_availablePresets",null),this._logger=(0,o.Logger)(this._eventBus,"Ristretto - AbrControllerFacade"),this._logger.info("Created"),this._onStreamInfoAvailableListener=this._eventBus.subscribe(l.EMetadataTransportEvents.STREAM_INFO_AVAILABLE,this._onStreamInfoAvailable),this._recreateAbrController()}destroy(){this._eventBus.unsubscribe(this._onStreamInfoAvailableListener)}toggleAbrStatus(e){this._abrController.toggleAbrStatus(e)}updateCurrentPreset(e){this._abrController.updateCurrentPreset(e)}updateQualityPresets(e){var{presets:t}=e;this._abrController.updateQualityPresets({presets:t})}_handleConfigUpdated(e){void 0!==e.isNewAbr&&this._recreateAbrController()}_recreateAbrController(){this.config.isNewAbr?this._abrController=new c.AbrControllerNew(this._eventBus):this._abrController=new d.AbrController(this._eventBus)}_onStreamInfoAvailable(e){e.presets&&(this._availablePresets=e.presets.filter(e=>!1!==e.abr),this._abrController&&this._abrController.updateQualityPresets({presets:this._availablePresets}))}}t.AbrControllerFacade=h,n([u.default],h.prototype,"updateQualityPresets",null),n([u.default],h.prototype,"_onStreamInfoAvailable",null)},83:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventBus=void 0;class r{constructor(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a(this,"appId",null),a(this,"_lastUid",-1),a(this,"_messages",{}),a(this,"_immediateExceptions",!1),a(this,"_allSubscribingMsg","*"),this._immediateExceptions=e}setAppId(e){this.appId=e}getAppId(){return this.appId}publish(e,t){return this._publish(e,t,!1,this._immediateExceptions)}publishSync(e,t){return this._publish(e,t,!0,this._immediateExceptions)}subscribe(e,t){if("function"!=typeof t)return"";var r="uid_"+String(++this._lastUid);return this._messages[e]||(this._messages[e]={}),(this._messages[e]||{})[r]=t,r}toggleSubscriptionBulk(e){"subscribe"===e.action?Object.entries(e.callbacks).forEach(e=>{var[t,r]=e;this.subscribe.call(this,t,r)}):Object.entries(e.callbacks).forEach(e=>{var[t,r]=e;this.unsubscribe.call(this,r)})}subscribeAll(e){return this.subscribe(this._allSubscribingMsg,e)}subscribeOnce(e,t){var r=this,n=this.subscribe(e,function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];r.unsubscribe(n),t.apply(r,i)});return this}clearAllSubscriptions(){this._messages={}}clearSubscriptions(e){for(var t in this._messages)Object.prototype.hasOwnProperty.call(this._messages,t)&&0===t.indexOf(e)&&delete this._messages[t]}unsubscribe(e){var t="string"==typeof e&&(Object.prototype.hasOwnProperty.call(this._messages,e)||this._descendantTopicExists(e)),r=!t&&"string"==typeof e,n="function"==typeof e,i=!1;if(!t){for(var o in this._messages)if(Object.prototype.hasOwnProperty.call(this._messages,o)){var s=this._messages[o]||{};if(r&&s[e]){delete s[e],i=e;break}if(n)for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&s[a]===e&&(delete s[a],i=!0)}return i}this.clearSubscriptions(e)}_hasKeys(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!0;return!1}_throwException(e){return()=>{throw e}}_callSubscriberWithDelayedExceptions(e,t){try{e(t)}catch(e){setTimeout(this._throwException(e),0)}}_callSubscriberWithImmediateExceptions(e,t){e(t)}_deliverMessage(e,t,r,n){var i=this._messages[t]||{},o=n?this._callSubscriberWithImmediateExceptions:this._callSubscriberWithDelayedExceptions;if(Object.prototype.hasOwnProperty.call(this._messages,t))for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&o(i[s],r)}_createDeliveryFunction(e,t,r){return()=>{var n=String(e),i=n.lastIndexOf(".");for(this._deliverMessage(e,e,t,r);i>-1;)i=(n=n.substr(0,i)).lastIndexOf("."),this._deliverMessage(e,n,t,r);this._deliverMessage(e,this._allSubscribingMsg,t,r)}}_hasDirectSubscribersFor(e){var t=String(e);return Boolean(Object.prototype.hasOwnProperty.call(this._messages,t)&&this._hasKeys(this._messages[t]||{}))}_messageHasSubscribers(e){for(var t=String(e),r=this._hasDirectSubscribersFor(t)||this._hasDirectSubscribersFor(this._allSubscribingMsg),n=t.lastIndexOf(".");!r&&-1!==n;)n=(t=t.substr(0,n)).lastIndexOf("."),r=this._hasDirectSubscribersFor(t);return r}_publish(e,t,r,n){var i="symbol"==typeof e?e.toString():e,o=this._createDeliveryFunction(i,t,n);return!!this._messageHasSubscribers(i)&&(r?o():setTimeout(o,0),!0)}_descendantTopicExists(e){for(var t in this._messages)if(Object.prototype.hasOwnProperty.call(this._messages,t)&&0===t.indexOf(e))return!0;return!1}}t.EventBus=r;var n=new r;t.default=n},99:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.PlayerEventEmitter=void 0;var i=r(3362),o=r(6805),s=r(4354);class l extends o.CustomEventTarget{constructor(e){super(),a(this,"_onPlaybackStateChangedListener",void 0),a(this,"_onVideoPlaybackStateChangedListener",void 0),a(this,"_onDebuggerConnectedListener",void 0),a(this,"_onErrorListener",void 0),a(this,"_onResolutionsAvailableListener",void 0),a(this,"_onResolutionSwitchedAutoListener",void 0),a(this,"_onResolutionSwitchedListener",void 0),a(this,"_onResolutionNotFoundListener",void 0),a(this,"_onBroadcastSupportedChangeListener",void 0),a(this,"_onStreamLoadErrorListener",void 0),a(this,"_onFragLoadedListener",void 0),a(this,"_eventBusInstance",void 0),this._eventBusInstance=e,this._onPlaybackStateChangedListener=this._eventBusInstance.subscribe(i.EPlayersEvents.PLAYBACK_STATE_CHANGED,this._onPlaybackStateChanged),this._onResolutionSwitchedAutoListener=this._eventBusInstance.subscribe(i.EPlayersEvents.AUTO_RESOLUTION_SWITCHED,this._onResolutionSwitchedAuto),this._onVideoPlaybackStateChangedListener=this._eventBusInstance.subscribe(i.EPlayersEvents.VIDEO_PLAYBACK_STATE_CHANGED,this._onVideoPlaybackStateChanged),this._onDebuggerConnectedListener=this._eventBusInstance.subscribe(i.EPlayersEvents.DEBUGGER_CONNECTED,this._onDebuggerConnected),this._onErrorListener=this._eventBusInstance.subscribe(i.EPlayersEvents.ERROR,this._onError),this._onResolutionsAvailableListener=this._eventBusInstance.subscribe(i.EPlayersEvents.RESOLUTIONS_AVAILABLE,this._onResolutionsAvailable),this._onResolutionSwitchedListener=this._eventBusInstance.subscribe(i.EPlayersEvents.RESOLUTION_SWITCHED,this._onResolutionSwitched),this._onResolutionNotFoundListener=this._eventBusInstance.subscribe(i.EPlayersEvents.RESOLUTION_NOT_FOUND,this._onResolutionNotFound),this._onBroadcastSupportedChangeListener=this._eventBusInstance.subscribe(i.EPlayersEvents.BROADCAST_SUPPORTED_CHANGE,this._onBroadcastSupportedChange),this._onStreamLoadErrorListener=this._eventBusInstance.subscribe(i.EPlayersEvents.STREAM_LOAD_ERROR,this._onStreamLoadError),this._onFragLoadedListener=this._eventBusInstance.subscribe(i.EPlayersEvents.FRAG_LOADED,this._onFragLoaded)}destroy(){this._eventBusInstance.unsubscribe(this._onPlaybackStateChangedListener),this._eventBusInstance.unsubscribe(this._onDebuggerConnectedListener),this._eventBusInstance.unsubscribe(this._onErrorListener),this._eventBusInstance.unsubscribe(this._onResolutionsAvailableListener),this._eventBusInstance.unsubscribe(this._onVideoPlaybackStateChangedListener),this._eventBusInstance.unsubscribe(this._onResolutionSwitchedAutoListener),this._eventBusInstance.unsubscribe(this._onResolutionSwitchedListener),this._eventBusInstance.unsubscribe(this._onResolutionNotFoundListener),this._eventBusInstance.unsubscribe(this._onBroadcastSupportedChangeListener),this._eventBusInstance.unsubscribe(this._onStreamLoadErrorListener),this._eventBusInstance.unsubscribe(this._onFragLoadedListener)}reemitEvent(e,t){this.emitEvent(e,t)}_onPlaybackStateChanged(e){var{prevState:t,nextState:r}=e;this.emitEvent(s.EMouflonPlayerEvent.PLAYBACK_STATE_CHANGED,{prevState:t,nextState:r})}_onDebuggerConnected(e){var{debuggerUrl:t}=e;this.emitEvent(s.EMouflonPlayerEvent.DEBUGGER_CONNECTED,{debuggerUrl:t})}_onError(e){var{error:t,playerType:r,isFatal:n,errorType:i}=e;this.emitEvent(s.EMouflonPlayerEvent.ERROR,{error:t,playerType:r,isFatal:n,errorType:i})}_onResolutionsAvailable(e){var{resolutions:t}=e;this.emitEvent(s.EMouflonPlayerEvent.RESOLUTIONS_AVAILABLE,{resolutions:t})}_onResolutionSwitchedAuto(e){var{name:t}=e;this.emitEvent(s.EMouflonPlayerEvent.AUTO_RESOLUTION_SWITCHED,{name:t})}_onResolutionSwitched(e){var{name:t}=e;this.emitEvent(s.EMouflonPlayerEvent.RESOLUTION_SWITCHED,{resolutionName:t})}_onVideoPlaybackStateChanged(e){this.emitEvent(s.EMouflonPlayerEvent.VIDEO_PLAYBACK_STATE_CHANGED,e)}_onResolutionNotFound(){this.emitEvent(s.EMouflonPlayerEvent.RESOLUTION_NOT_FOUND,{})}_onBroadcastSupportedChange(e){var{isSupported:t}=e;this.emitEvent(s.EMouflonPlayerEvent.BROADCAST_SUPPORTED_CHANGE,{isSupported:t})}_onStreamLoadError(e){var{reason:t,httpStatusCode:r,wsStatusCode:n,signallingMessage:i,resourceType:o}=e;this.emitEvent(s.EMouflonPlayerEvent.STREAM_LOAD_ERROR,{reason:t,httpStatusCode:r,wsStatusCode:n,signallingMessage:i,resourceType:o})}_onFragLoaded(e){var{netStats:t,duration:r}=e;this.emitEvent(s.EMouflonPlayerEvent.FRAG_LOADED,{netStats:t,duration:r})}}t.PlayerEventEmitter=l,n([o.bind],l.prototype,"_onPlaybackStateChanged",null),n([o.bind],l.prototype,"_onDebuggerConnected",null),n([o.bind],l.prototype,"_onError",null),n([o.bind],l.prototype,"_onResolutionsAvailable",null),n([o.bind],l.prototype,"_onResolutionSwitchedAuto",null),n([o.bind],l.prototype,"_onResolutionSwitched",null),n([o.bind],l.prototype,"_onVideoPlaybackStateChanged",null),n([o.bind],l.prototype,"_onResolutionNotFound",null),n([o.bind],l.prototype,"_onBroadcastSupportedChange",null),n([o.bind],l.prototype,"_onStreamLoadError",null),n([o.bind],l.prototype,"_onFragLoaded",null)},124:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(7949),i=function(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return(0,n.A)(r)?r:void 0}},131:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Player=t.EPlayerEvent=void 0;var o,l=r(1192),u=r(57),c=r(9476),d=r(3566),h=r(942),f=r(3559),p=r(2712),v=r(5851),g=r(2302),_=i(r(5354)),m=r(7813),y=r(1222);!function(e){e.PLAY_STATE_CHANGED="playStateChanged"}(o||(t.EPlayerEvent=o={}));class b extends m.CommonEntrypoint{constructor(){var e;super(),a(this,"_videoElement",null),a(this,"_mediaStream",null),a(this,"_isAbrEnabled",!1),a(this,"_streamIdCached",null),a(this,"_abrController",null),a(this,"_streamDispatcher",void 0),a(this,"_onMediaStreamAvailableListener",void 0),a(this,"_onPlayingStatusChangedListener",void 0),a(this,"_onPeerConnectionStateChangeListener",void 0),this._streamDispatcher=new f.StreamDispatcher(this._eventBus),this._onMediaStreamAvailableListener=this._eventBus.subscribe(p.EStreamDispatcherEvent.MEDIA_STREAM_AVAILABLE,this._onMediaStreamAvailable),this._onPlayingStatusChangedListener=this._eventBus.subscribe(y.ECommonEvent.PLAYING_STATE_CHANGED,this._onPlayingStatusChanged),this._onPeerConnectionStateChangeListener=this._eventBus.subscribe(h.EPeerConnectionEvents.CONNECTION_STATE_CHANGED,this._onPeerConnectionStateChanged),this._debugger.registerDebuggableModules({streamDispatcher:this._streamDispatcher}),null===(e=this._loggerOOTransport)||void 0===e||e.setMode("Receive")}static checkSupport(){return s(function*(){var e=[v.KNOWN_CODECS.H264,v.KNOWN_CODECS.VP8],t=yield(0,g.checkCodecsSupported)("play",e);return e.some(e=>t.includes(e))})()}destroy(){super.destroy(),this.detachVideoElement(),this._eventBus.unsubscribe(this._onMediaStreamAvailableListener),this._eventBus.unsubscribe(this._onPlayingStatusChangedListener),this._eventBus.unsubscribe(this._onPeerConnectionStateChangeListener),this._streamDispatcher.destroy()}setAppKey(e){this._streamDispatcher.setAppKey(e)}detachVideoElement(){var e;this._logger.info("Video element requested to detach"),this._videoElement&&(null!==(e=this._videoElement)&&void 0!==e&&e.removeAttribute("src"),this._videoElement.srcObject=null)}toggleTURNServersUsage(e){this._streamDispatcher.toggleTURNServersUsage(e)}enableABR(){var e;this._isAbrEnabled=!0,null===(e=this._abrController)||void 0===e||e.toggleAbrStatus(!0)}disableABR(){var e;this._isAbrEnabled=!1,null===(e=this._abrController)||void 0===e||e.toggleAbrStatus(!1)}setVideoElement(e){this._logger.info("New video element attached to the player instance"),this._videoElement=e,this._streamDispatcher.setVideoElement(e),this._mediaStream&&(this._videoElement.srcObject=this._mediaStream)}detachStream(){this._logger.info("Requested to detach stream from video element"),this._videoElement&&this._mediaStream&&(this._videoElement.srcObject=null)}setWSServerUrl(e){this._streamDispatcher.setMetadataConnectionUrl(e)}setStreamId(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._streamDispatcher.setStreamId(e,r),null!==(t=this._loggerOOTransport)&&void 0!==t&&t.setStreamId(e),this._streamIdCached=e}setAclToken(e){this._streamDispatcher.setAclToken(e||null)}setStreamConfig(e,t){var r;this._streamDispatcher.setStreamConfig(e,t),e.streamId&&(null!==(r=this._loggerOOTransport)&&void 0!==r&&r.setStreamId(e.streamId),this._streamIdCached=e.streamId)}setAbrResolutionsVariants(e){this._createABR(),this._eventBus.publish(l.EAbrControllerEvents.PRESETS_VARIANTS_AVAILABLE,{presets:e})}getMediaStream(){return this._mediaStream}start(){this._logger.info("Starting playing loop"),this._videoElement||this._logger.warn("Video element is not defined. Feel free to define it later"),this._isStarted=this._streamDispatcher.start(),this._createABR()}setQualityByName(e){var t;this._logger.info("Forced to change quality. New quality is ".concat(e,". This action will disable ABR (if enabled)")),this.disableABR(),null!==(t=this._abrController)&&void 0!==t&&t.updateCurrentPreset(e),this._eventBus.publish(c.EMetadataTransportEvents.SET_QUALITY,{quality:e})}setQualityByBitrate(e){var t,r=this._streamDispatcher.getClosestResolutionByBitrate(e);r&&(null!==(t=this._abrController)&&void 0!==t&&t.updateCurrentPreset(r.name),this._eventBus.publish(c.EMetadataTransportEvents.SET_QUALITY,{quality:r.name}))}stop(){var e;this._logger.info("Stopping"),this._streamDispatcher.stop(),null!==(e=this._abrController)&&void 0!==e&&e.destroy(),this.detachVideoElement(),this._mediaStream=null}_retuneOOLogger(){var e,t;null!==(e=this._loggerOOTransport)&&void 0!==e&&e.setMode("Receive"),this._streamIdCached&&(null===(t=this._loggerOOTransport)||void 0===t||t.setStreamId(this._streamIdCached))}_onMediaStreamAvailable(e){var{mediaStream:t}=e;this._mediaStream=t,this._logger.info("Ready to play"),this._videoElement&&(this._videoElement.srcObject=t)}_createABR(){this._abrController||(this._abrController=new u.AbrControllerFacade(this._eventBus),this._abrController.toggleAbrStatus(this._isAbrEnabled))}_onPlayingStatusChanged(e){var{prevState:t,nextState:r}=e;this.emitEvent(o.PLAY_STATE_CHANGED,{prevState:t,nextState:r})}_onPeerConnectionStateChanged(e){var{nextState:t}=e;t===d.EPeerConnectionState.DESTROYED&&this.detachStream()}}t.Player=b,n([_.default],b.prototype,"_onMediaStreamAvailable",null),n([_.default],b.prototype,"_createABR",null),n([_.default],b.prototype,"_onPlayingStatusChanged",null),n([_.default],b.prototype,"_onPeerConnectionStateChanged",null)},164:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BasePlaylistRotationController=void 0;var o=r(355),s=r(8169),l=r(8474),u=r(9408),c=r(835),d=r(6304),h=r(6967),f=i(r(6073)),p=r(5720),v=r(2513),g=r(5206);class _ extends s.ConfigConsumer{constructor(e,t,r,n){super(t,n),a(this,"_lastPlaylistContent",""),a(this,"_samePlaylistsCount",0),a(this,"_isActive",!0),a(this,"_currentPlaylistLoader",null),a(this,"_url",null),a(this,"_logger",void 0),a(this,"_lifecycleEventReporter",void 0),a(this,"_playlistDecryptHandler",void 0),this._logger=(0,l.Logger)(n,"Doppio - ".concat(e)),this._lifecycleEventReporter=(0,g.LifecycleEventReporterFactory)("playlistRotator",this._eventBus),this._logger.info("Instance created"),this._playlistDecryptHandler=r}destroy(){super.destroy(),this._isActive=!1,this._logger.info("Destroyed")}_onPlaylistLoadingStateChanged(e,t){var r,n,i,s,a,l;if(this._isActive){if(!this._currentPlaylistLoader||[h.ELoadingState.ABORTED,h.ELoadingState.ERROR].includes(t))return this._lifecycleEventReporter("Loading error reported, ".concat(null===(r=this._currentPlaylistLoader)||void 0===r?void 0:r.error)),this._logger.warn("Playlist loader reported ".concat(t===h.ELoadingState.ERROR?"error":"as aborted"," (").concat((null===(n=this._currentPlaylistLoader)||void 0===n||null===(n=n.error)||void 0===n?void 0:n.statusText)||"no error"," with status ").concat((null===(i=this._currentPlaylistLoader)||void 0===i||null===(i=i.error)||void 0===i?void 0:i.statusText)||"no status","). Planning next load")),this._eventBus.publish(v.BasePlaylistRotationControllerEvents.playlists.playlistLoadingError,{error:null===(s=this._currentPlaylistLoader)||void 0===s?void 0:s.error}),t===h.ELoadingState.ERROR&&"4"===(null===(a=this._currentPlaylistLoader)||void 0===a||null===(a=a.error)||void 0===a?void 0:a.status.toString()[0])&&(this._logger.warn("Playlist loading reported 4xx status. Requesting start over"),this._eventBus.publish(c.ResolutionsManagerEvents.requestRestartFromMain,{})),this._currentPlaylistLoader=null,void this._planNextLoad();if(t===h.ELoadingState.LOADED){if(!this._isPlaylistValid(this._currentPlaylistLoader.data))return this._logger.warn("Playlist seems to be invalid. Plan next load"),this._currentPlaylistLoader=null,void this._planNextLoad();this._eventBus.publish(v.BasePlaylistRotationControllerEvents.playlists.playlistLoaded,{originalUrl:this._url,realUrl:this._currentPlaylistLoader.realUrl,stats:this._currentPlaylistLoader.stats});var u=this._currentPlaylistLoader.data,f=this._isPlaylistChanged(u),p=this._currentPlaylistLoader.queryParams.has(d.PlaylistDecryptHandler.SCHEME_QUERY_PARAMETER_NAME);if(this._currentPlaylistLoader=null,!f)return this._logger.warn("Loaded playlist is identical to previous one. Skipping it"),void this._planNextLoad();var g=this._parsePlaylist({data:u,isCorruptRequested:p});if(!g)return this._logger.warn("Empty playlist parse result! Should restart"),void this._eventBus.publish(c.ResolutionsManagerEvents.requestRestartFromMain,{});null!==(l=g.custom)&&void 0!==l&&l.encodeTimestampMap&&this._eventBus.publish(o.BufferControllerEvents.latencyExtraInformationAvailable,g.custom.encodeTimestampMap),this._eventBus.publish(v.BasePlaylistRotationControllerEvents.playlists.playlistInfo,g),this._lifecycleEventReporter("Playlist loaded"),this._handleParsedPlaylist(g)}}else this._logger.warn("Loader was destroyed, but we are trying to load handle playlist load state change!")}_isPlaylistValid(e){return Boolean(null==e?void 0:e.trim().length)&&(null==e?void 0:e.includes("#EXT-X-VERSION"))}_isPlaylistChanged(e){return this._lastPlaylistContent!==e}_isPlaylistUpToDate(e){if(void 0!==this.config.equalPlaylistsAmountToDecline&&this.config.equalPlaylistsAmountToDecline<1)return!0;if(e===this._lastPlaylistContent){this._samePlaylistsCount++;var{equalPlaylistsAmountToDecline:t=2}=this.config;if(this._samePlaylistsCount>=t)return!1}else this._samePlaylistsCount=0;return this._lastPlaylistContent=e,!0}_parsePlaylist(e){this._logger.verbose("Parsing manifest");try{var r=this._playlistDecryptHandler.handlePlaylist(e);this._logger.verbose("Manifest parsed");var n=Array.isArray(null==r?void 0:r.playlists)&&r.playlists.length>0,i=Array.isArray(null==r?void 0:r.segments)&&r.segments.length>0;return n||i||u.OpenObserveLogger.reportError("Playlist seems to be parsed invalid",{playlistContent:e.data,playlistUrl:this._url,parsedPlaylistResult:r}),(0,p.m3u8Hydrator)(r,{partHoldBack:void 0!==this.config.partHoldBack?this.config.partHoldBack/1e3:void 0})}catch(t){return u.OpenObserveLogger.reportError("Could not parse playlist",{playlistContent:e.data,playlistUrl:this._url}),null}}_isMultiVariantPlaylist(e){return e.playlists&&(!e.segments||Array.isArray(e.segments)&&0===e.segments.length)}_isVODPlaylist(e){return"VOD"===e.playlistType||e.endList}_isSimplePlaylist(e){return!this._isLowLatencyPlaylist(e)&&!this._isVODPlaylist(e)}_isLowLatencyPlaylist(e){return Boolean(e.partInf)}_handleFragmentsDetected(e){this._logger.verbose("Detected fragments",e.map(e=>e.getMsnPn())),this._logger.debug("Fragments was detected and extracted. Emitting it"),this._lifecycleEventReporter("Found fragments ".concat(e.map(e=>{var{url:t}=e;return t}).join(","))),this._eventBus.publish(v.BasePlaylistRotationControllerEvents.fragments.fragmentsDetected,e)}_handleLLManifestDetected(e){this._logger.debug("Low-latency playlist detected. Emitting it"),this._eventBus.publish(v.BasePlaylistRotationControllerEvents.playlistType.llDetected,e)}_handleVODPlaylist(e){this._logger.debug("VOD playlist detected. Emitting it"),this._eventBus.publish(v.BasePlaylistRotationControllerEvents.playlistType.vodDetected,e)}_handleMultivariantManifestDetected(e){var t=e.playlists.reduce((e,t)=>(e[t.attributes.NAME]={name:t.attributes.NAME,bitrate:t.attributes.BANDWIDTH,url:t.uri,width:t.attributes.RESOLUTION.width,height:t.attributes.RESOLUTION.height,fps:t.attributes["FRAME-RATE"]},e),{});this._logger.verbose("Variants detected",t),this._logger.debug("Multivariant playlist detected. Emitting it"),this._eventBus.publish(v.BasePlaylistRotationControllerEvents.playlistType.multivariantDetected,t)}_handleSimplePlaylistDetected(e){this._logger.debug("Simple playlist detected. Emitting it"),this._eventBus.publish(v.BasePlaylistRotationControllerEvents.playlistType.simpleDetected,e)}}t.BasePlaylistRotationController=_,n([f.default],_.prototype,"_onPlaylistLoadingStateChanged",null)},180:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EDebuggableModuleState=void 0,function(e){e.OK="ok",e.ERROR="error"}(r||(t.EDebuggableModuleState=r={}))},236:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.nativeStateToConnectionStateMapper=void 0;var n=r(3566);t.nativeStateToConnectionStateMapper=e=>{var t=n.EPeerConnectionState.UNKNOWN;return{[n.ENativePeerConnectionState.NEW]:n.EPeerConnectionState.UNKNOWN,[n.ENativePeerConnectionState.CONNECTING]:n.EPeerConnectionState.CONNECTING,[n.ENativePeerConnectionState.CONNECTED]:n.EPeerConnectionState.ONLINE,[n.ENativePeerConnectionState.DISCONNECTED]:n.EPeerConnectionState.DISCONNECTING,[n.ENativePeerConnectionState.CLOSED]:n.EPeerConnectionState.OFFLINE,[n.ENativePeerConnectionState.FAILED]:n.EPeerConnectionState.FAILED}[e]||t}},241:(e,t,r)=>{r.d(t,{A:()=>n});var n=r(1917).A.Symbol},355:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferControllerEvents=void 0,t.BufferControllerEvents={requestResetWithOverplay:"buffer.requestResetWithOverplay",bufferStalled:"buffer.stalled",bufferMetricsAvailable:"buffer.metricsAvaialable",playbackStallChanged:"buffer.playbackStallChanged",requestSourceBufferOperation:"buffer.requestSourceBufferOperation",playbackStateChanged:"buffer.playbackStateChanged",endOfStreamReached:"buffer.endOfStreamReached",onFragmentAppended:"buffer.onFragmentAppended",fragmentAdded:"buffer.fragmentAdded",changeCodec:"buffer.changeCodec",sourceBufferStuck:"buffer.sourceBufferStuck",latencyExtraInformationAvailable:"buffer.latencyExtraInformationAvailable"}},363:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EIndependenceType=void 0,function(e){e.UNKNOWN="unknown",e.INDEPENDENT="independent",e.PART="part"}(r||(t.EIndependenceType=r={}))},367:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e,t){return function(r){return e(t(r))}}},398:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AggregatedMetricsV2=void 0;var n=r(3998),o={Latency:[{scope:"report",aggregates:["max","min","avg","median"]},{scope:"session",aggregates:["max","min","avg"]}]},s={report:"",session:"Session"};t.AggregatedMetricsV2=class{constructor(){a(this,"_sessionAggregatedFields",{}),a(this,"_reportAggregatedFields",{}),Object.entries(o).forEach(e=>{var[t,r]=e;for(var i of r)"session"===i.scope?this._sessionAggregatedFields[t]=new n.AggregationsContainer(i.aggregates):this._reportAggregatedFields[t]=new n.AggregationsContainer(i.aggregates)})}addValue(e,t){var r,n;null!==(r=this._sessionAggregatedFields[e])&&void 0!==r&&r.addValue(t),null===(n=this._reportAggregatedFields[e])||void 0===n||n.addValue(t)}addValues(e,t){var r,n;null!==(r=this._sessionAggregatedFields[e])&&void 0!==r&&r.addValues(t),null===(n=this._reportAggregatedFields[e])||void 0===n||n.addValues(t)}clearValues(e){var t,r;null!==(t=this._sessionAggregatedFields[e])&&void 0!==t&&t.clear(),null===(r=this._reportAggregatedFields[e])||void 0===r||r.clear()}clearReportValues(){Object.values(this._reportAggregatedFields).forEach(e=>e.clear())}clearSessionValues(){Object.values(this._sessionAggregatedFields).forEach(e=>e.clear())}clearAllValues(){this.clearReportValues(),this.clearSessionValues()}getAllValues(){var e=i(i({},this._populateValuesByScope("session")),this._populateValuesByScope("report"));return this.clearReportValues(),e}_populateValuesByScope(e){var t={},r="session"===e?this._sessionAggregatedFields:this._reportAggregatedFields;return Object.keys(r).forEach(n=>{var i=o[n].find(t=>{var{scope:r}=t;return r===e});if(i){var a=i.aggregates;for(var l of a){var u,c;r[n]&&null!==(null===(u=r[n])||void 0===u?void 0:u[l])&&(t["".concat(l).concat(n).concat(s[e])]=null===(c=r[n])||void 0===c?void 0:c[l])}}}),t}}},414:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SimplePlaylistRotationController=void 0;var o=r(2086),s=r(363),l=r(164),u=r(2513),c=r(450),d=r(180),h=i(r(6073)),f=r(1743);class p extends l.BasePlaylistRotationController{constructor(e,t,r,n){super("SimplePlaylistRotationController","playlistLoader",r,e),a(this,"state",d.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["loader"]),a(this,"additionalInfo",{}),a(this,"_playlistLoaderTimeout",null),a(this,"_lastTargetDuration",2),this._lifecycleEventReporter("Created"),this._url=t,n?this._handleParsedPlaylist(n):this._loadNextPlaylist()}destroy(){var e;this._isActive=!1,super.destroy(),null!==(e=this._currentPlaylistLoader)&&void 0!==e&&e.destroy(),this._currentPlaylistLoader=null,this._logger.info("Destroy controller"),this._playlistLoaderTimeout&&clearTimeout(this._playlistLoaderTimeout),this._lifecycleEventReporter("Destroyed")}abortCurrentPlaylistLoading(){var e;this._logger.info("Aborting current loading playlist"),null===(e=this._currentPlaylistLoader)||void 0===e||e.destroy()}setURL(e,t){var r;t?this._url=e:(this._logger.info("Setting new url ".concat(e)),null!==(r=this._currentPlaylistLoader)&&void 0!==r&&r.destroy(),this._url=e,this._loadNextPlaylist())}_handleConfigUpdated(e){e.equalPlaylistsAmountToDecline&&(this._samePlaylistsCount=0)}_loadNextPlaylist(){var e;if(this._isActive){var{playlistLoadingTimeout:t}=this.config;this._logger.debug("Loading next playlist"),this._lifecycleEventReporter("Loading next playlist with url ".concat(this._url)),this.status="Loading playlist",this._currentPlaylistLoader&&this._currentPlaylistLoader.cancel("Another playlist with url ".concat(this._url," scheduled to load")),this._url&&(this._currentPlaylistLoader=new c.NetworkLoader({url:this._buildUrl(),loadingTimeout:t,autoLoad:!0,mode:"text",onStateChanged:this._onPlaylistLoadingStateChanged,workerMode:this.config.workerMode,requestCustomReferer:this.config.sendCustomRefererHeader?null===(e=(0,f.getGlobalThis)().location)||void 0===e?void 0:e.href:void 0},this._eventBus),this._eventBus.publish(u.BasePlaylistRotationControllerEvents.playlists.playlistRequested,{}))}else this._logger.warn("Loader was destroying, but we trying to load next playlist!")}_handleParsedPlaylist(e){var t;if(this._lifecycleEventReporter("Playlist parsed"),this._isMultiVariantPlaylist(e))this._handleMultivariantManifestDetected(e);else if(this._isLowLatencyPlaylist(e)&&this.config.lowLatencyMode)this._handleLLManifestDetected(e);else if(this._isVODPlaylist(e))this._handleVODPlaylist(e);else if(this._eventBus.publish(u.BasePlaylistRotationControllerEvents.playlists.lastPlaylistOfSegmentLoaded,{}),this._url){var r=this._url;this._lastTargetDuration=e.targetDuration||2;var n=e.segments.map(t=>{var n;return new o.Fragment({fragmentUrl:t.uri,playlistUrl:r,duration:t.duration,independent:s.EIndependenceType.INDEPENDENT,msn:t.msnNumber,pn:t.partNumber,isTransmuxingBypassRequested:!(null===(n=e.segments[0].map)||void 0===n||!n.uri)},this._eventBus,this.config.shouldLogFragmentsHistory)});null!==(t=e.segments[0])&&void 0!==t&&null!==(t=t.map)&&void 0!==t&&t.uri&&n.unshift(new o.Fragment({fragmentUrl:e.segments[0].map.uri,playlistUrl:r,independent:s.EIndependenceType.INDEPENDENT,msn:-1,pn:-1,isTransmuxingBypassRequested:!0,duration:0,isInitSection:!0},this._eventBus,this.config.shouldLogFragmentsHistory)),this._handleFragmentsDetected(n),this._planNextLoad()}}_planNextLoad(){var e=this._getNextPlaylistLoadTimeout();this._currentPlaylistLoader&&(this._currentPlaylistLoader.destroy(),this._currentPlaylistLoader=null),this._logger.info("Expecting next load in ".concat(e," ms")),this._lifecycleEventReporter("Awaiting next loading"),this.status="Awaiting next loading",this._playlistLoaderTimeout=globalThis.setTimeout(()=>{this._loadNextPlaylist()},e)}_getNextPlaylistLoadTimeout(){var{forceStaticPlaylistLoadingTimeout:e,staticPlaylistLoadingTimeoutInDurations:t}=this.config;if(e&&t)return this._logger.verbose("forceStaticPlaylistLoadingTimeout is set to true and staticPlaylistLoadingTimeoutInDurations is set to ".concat(t,". Using static timeout")),t*this._lastTargetDuration*1e3;var r=!this.config.disableRotateTimeoutIncrease&&this._samePlaylistsCount>1?1.5:1;return this._logger.verbose("There was ".concat(this._samePlaylistsCount," same playlists. Multiplier is ").concat(r,". Target duration is ").concat(this._lastTargetDuration)),r*this._lastTargetDuration*1e3}_buildUrl(){var e=new URL(this._url||"");return e.search=new URLSearchParams([...this._playlistDecryptHandler.corruptionQueryParams,...e.searchParams]).toString(),e}}t.SimplePlaylistRotationController=p,n([h.default],p.prototype,"_handleConfigUpdated",null)},423:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(9520),i=r(5175),o=r(2049),s=r(4616),a=r(5353),l=r(4749),u=Object.prototype.hasOwnProperty,c=function(e,t){var r=(0,o.A)(e),c=!r&&(0,i.A)(e),d=!r&&!c&&(0,s.A)(e),h=!r&&!c&&!d&&(0,l.A)(e),f=r||c||d||h,p=f?(0,n.A)(e.length,String):[],v=p.length;for(var g in e)!t&&!u.call(e,g)||f&&("length"==g||d&&("offset"==g||"parent"==g)||h&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||(0,a.A)(g,v))||p.push(g);return p}},426:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createInplaceWorker=void 0,t.createInplaceWorker=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i="".concat(e,"\ncreateBaseWorker(").concat(r.map(e=>JSON.stringify(e)),");\n");return new Worker(URL.createObjectURL(new Blob([i],{type:"application/javascript"})),{type:"module"})}},450:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkLoader=t.destroyWorker=t.getWorker=void 0;var l=r(8474),u=o(r(6073)),c=r(7141),d=r(6967),h=r(5395),f=r(2534),p=r(4947),v=o(r(9507)),g=[d.ELoadingState.ERROR,d.ELoadingState.LOADED,d.ELoadingState.ABORTED],_=new Map;t.getWorker=s(function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,n=_.get(e);if(!n&&t){if(!(n=yield(0,c.createWorker)(r(6987)(v.default),{type:"module"})))throw new Error;_.set(e,n)}return n||null}),t.destroyWorker=function(){var e=s(function*(e){var r=yield(0,t.getWorker)(e);r&&r.terminate(),_.delete(e)});return function(t){return e.apply(this,arguments)}}();class m{constructor(e,t){if(a(this,"_eventBus",void 0),a(this,"data",null),a(this,"error",null),a(this,"stats",null),a(this,"realUrl",""),a(this,"_state",d.ELoadingState.UNKNOWN),a(this,"_retriesAmount",0),a(this,"_timeoutAbortHandler",null),a(this,"_retryTimeoutHandler",null),a(this,"_config",void 0),a(this,"_logger",void 0),a(this,"_startTimestamp",performance.now()),a(this,"_fetcherWorker",null),a(this,"_fetcherSimple",null),a(this,"_workerMode",!1),this._eventBus=t,this._logger=(0,l.Logger)(this._eventBus,"Doppio - NetworkLoader"),!e.url||!e.onStateChanged)throw new Error("Invalid config");this._workerMode=!!e.workerMode,this._config=e,this._logger.debug("Created with config",e),this._recreateFetcherAndAutoload()}startLoad(){return this._state===d.ELoadingState.UNKNOWN&&(this._armTimeoutAbort(),this._logger.debug("Starting load ".concat(this._config.url)),this._startAsyncLoad(),!0)}cancel(e){var t,r;this._disarmTimeoutAbort(),this._disarmRetryTimeout(),this.error={status:-1,statusText:"Cancelled because of ".concat(null!=e?e:"unknown reason")},g.includes(this._state)||(this._logger.warn("".concat(this._config.url," loading was cancelled with reason ").concat(e,", current status is ").concat(this._state)),this._workerMode?null===(t=this._fetcherWorker)||void 0===t||t.postMessage({type:f.ENetworkLoadFetchNetworkEvent.ABORT,payload:{url:this._config.url.toString()}}):null===(r=this._fetcherSimple)||void 0===r||r.abort())}destroy(){g.includes(this._state)||(this.cancel("Destroyed"),this._state=d.ELoadingState.DESTROYED),this._disarmTimeoutAbort(),this._disarmRetryTimeout(),this.data=null,this.error=null,this._removeFetcherFromWorker()}_onAbortTimeoutFired(){this._logger.info("".concat(this._config.url," loading timeout")),this.cancel("Loading timeout")}_armRetryTimeout(){this._logger.info("Retry loading ".concat(this._retriesAmount," time")),this._disarmRetryTimeout(),this._setNewState(d.ELoadingState.UNKNOWN),this._retriesAmount++,this._retryTimeoutHandler=globalThis.setTimeout(()=>{this.startLoad()},2**this._retriesAmount)}_disarmRetryTimeout(){this._retryTimeoutHandler&&globalThis.clearTimeout(this._retryTimeoutHandler)}_armTimeoutAbort(){!this._config.loadingTimeout||this._config.loadingTimeout<=0?this._logger.debug("LoadingTimeout is not defined or below zero! Skipping abort timeout arming"):(this._logger.debug("Arming loading abort timeout"),this._timeoutAbortHandler&&(this._logger.debug("Another timeout already armed. Cancel it"),this._disarmTimeoutAbort()),this._timeoutAbortHandler=setTimeout(()=>{this._onAbortTimeoutFired()},this._config.loadingTimeout))}_disarmTimeoutAbort(){this._timeoutAbortHandler&&(this._logger.debug("Disarming abort timeout"),clearTimeout(this._timeoutAbortHandler))}_setNewState(e,t){this._state!==d.ELoadingState.DESTROYED?this._state!==e&&(e===d.ELoadingState.LOADED&&this._logger.verbose("".concat(this._config.url," loading finished")),g.includes(e)&&(this._eventBus.publish(h.NetworkLoaderEvent.events.networkRequestSettled,{stats:this.stats,startTimestamp:this._startTimestamp,endTimestamp:performance.now(),response:i({url:this.url,body:this.data,timestamp:performance.now()},t||{})}),this._removeFetcherFromWorker(),this._disarmTimeoutAbort()),this._logger.verbose("Loading ".concat(this._config.url,", state transition: ").concat(this._state," -> ").concat(e)),[d.ELoadingState.ABORTED,d.ELoadingState.ERROR].includes(e)&&this._config.maxRetries&&this._config.baseRetryTimeout&&this._retriesAmount<this._config.maxRetries?this._armRetryTimeout():(this._config.onStateChanged(this._state,e,this),this._state=e)):this._logger.warn("Tried to set new state=".concat(e," while loader is destroyed"))}_removeFetcherFromWorker(){var e,t;null!==(e=this._fetcherWorker)&&void 0!==e&&e.removeEventListener("message",this._handleWorkerMessage),null===(t=this._fetcherWorker)||void 0===t||t.postMessage({type:f.ENetworkLoadFetchNetworkEvent.DESTROY,payload:{url:this._config.url.toString()}})}_startAsyncLoad(){var e=this;return s(function*(){var t;if(e._workerMode){var r,n={type:f.ENetworkLoadFetchNetworkEvent.FETCH,payload:{url:e._config.url.toString(),mode:e._config.mode,requestCustomReferer:e._config.requestCustomReferer}};null===(r=e._fetcherWorker)||void 0===r||r.postMessage(n)}else null===(t=e._fetcherSimple)||void 0===t||t.fetch(e._config.url.toString(),e._config.mode)})()}_recreateFetcherAndAutoload(){var r=this;return s(function*(){var n,i;if(null!==(n=r._fetcherSimple)&&void 0!==n&&n.abort(),null!==(i=r._fetcherWorker)&&void 0!==i&&i.postMessage({type:f.ENetworkLoadFetchNetworkEvent.DESTROY,payload:{url:r._config.url}}),r._workerMode)try{var o;r._fetcherWorker=yield(0,t.getWorker)(r._eventBus.getAppId(),!0),null===(o=r._fetcherWorker)||void 0===o||o.addEventListener("message",r._handleWorkerMessage)}catch(e){return r._logger.warn("Could not use worker for network request. Fallback to simple mode",{error:e}),r._workerMode=!1,void r._recreateFetcherAndAutoload()}else r._fetcherSimple=new p.NetworkLoadFetch({requestCustomReferer:r._config.requestCustomReferer,onDataReady:r._handleDataReady,onChangeState:r._setNewState,onStatsReady:r._handleLoadStatsReady,onError:r._handleError,onRedirectDetected:r._handleRedirectDetected});r._config.autoLoad&&(r._logger.debug("AutoLoad config field set to true. Starting load"),globalThis.queueMicrotask(()=>{r.startLoad()}))})()}_handleDataReady(e){this.data=e}_handleLoadStatsReady(e){this.stats=e,this._eventBus.publish(h.NetworkLoaderEvent.stats.statsReady,e)}_handleError(e){this.error=e,this._logger.warn("Cannot load ".concat(this._config.url),e)}_handleRedirectDetected(e,t){this._eventBus.publish(h.NetworkLoaderEvent.events.browserRedirectDetected,{requestUrl:e,responseUrl:t})}_handleWorkerMessage(e){var{data:t}=e;if(t.payload.url===this._config.url.toString()&&t.type)switch(t.type){case f.ENetworkLoadFetchNetworkEvent.DATA_READY:this._handleDataReady(t.payload.binaryData);break;case f.ENetworkLoadFetchNetworkEvent.CHANGE_STATE:this._setNewState(t.payload.newState,t.payload.metadata);break;case f.ENetworkLoadFetchNetworkEvent.STATS_READY:this._handleLoadStatsReady(t.payload.stats);break;case f.ENetworkLoadFetchNetworkEvent.ERROR:this._handleError(t.payload.error);break;case f.ENetworkLoadFetchNetworkEvent.REDIRECT_DETECTED:this._handleRedirectDetected(t.payload.url,t.payload.responseUrl)}}get url(){return this._config.url.toString()}get queryParams(){return this._config.url.searchParams}}t.NetworkLoader=m,n([u.default],m.prototype,"_setNewState",null),n([u.default],m.prototype,"_handleDataReady",null),n([u.default],m.prototype,"_handleLoadStatsReady",null),n([u.default],m.prototype,"_handleError",null),n([u.default],m.prototype,"_handleRedirectDetected",null),n([u.default],m.prototype,"_handleWorkerMessage",null)},452:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableBufferControllerConfigValues=t.defaultBufferControllerConfig=void 0,t.defaultBufferControllerConfig={checkMetricsInterval:150,bufferStallThreshold:.2,maxBackBufferAmount:1e4,bufferEdgeThreshold:.3,endOfRangeThreshold:.4,nudgePlaybackAmount:.1,numberOfCandidatesToDetectGap:2,numberOfFragmentToKeep:2,recreateSourceBufferOnResolutionChange:!1,saveLastSegmentsCount:3,sourceBufferStuckTimeout:1e3,timeSyncResyncInterval:-1,enableG2GLatencyMeasurement:!1,timeSyncUrlTemplate:"//time.{{domain}}/time"},t.availableBufferControllerConfigValues={}},469:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addMediaAction=t.performAction=t.checkPlayAvailability=t.READY_STATES=t.NETWORK_STATES=void 0;var n=r(9661),i=new WeakMap;t.NETWORK_STATES={EMPTY:0,IDLE:1,LOADING:2,NO_SOURCE:3},t.READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},t.checkPlayAvailability=(e,r)=>{var i=e.readyState===t.READY_STATES.HAVE_NOTHING,o=e.networkState!==t.NETWORK_STATES.LOADING&&e.networkState!==t.NETWORK_STATES.IDLE;if(n.BROWSER_CAPABILITIES.firefox&&"play"===r&&i&&o)throw new Error("Can not play audio")},t.performAction=(e,r)=>e instanceof HTMLMediaElement?((0,t.checkPlayAvailability)(e,r),"function"==typeof r?r(e):e[r]()):null,t.addMediaAction=(e,r)=>{var n=(i.get(e)||Promise.resolve()).then(()=>{var n=(0,t.performAction)(e,r);return n&&"then"in n?Promise.resolve(n):new Promise(e=>{setTimeout(()=>{e(n)},150)})}).then(()=>{i.delete(e)}).catch(t=>{throw i.delete(e),t});return i.set(e,n),n}},480:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EBroadcastLogsEvents=void 0,function(e){e.REPORT_EVENT="broadcastLogs.reportEvent"}(r||(t.EBroadcastLogsEvents=r={}))},496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbrRulesController=void 0;var n=r(2945),i=r(745);t.AbrRulesController=class{constructor(e){a(this,"_rules",void 0),this._rules=[new n.FpsRule(e),new i.PliRule(e)]}reset(){this._rules.forEach(e=>e.reset())}handleStats(e){e&&this._rules.forEach(t=>t.handleStats(e))}destroy(){this._rules.forEach(e=>e.destroy())}getResult(){for(var e of this._rules){var t=e.getResult();if(0!==t.value)return t}return{name:"",value:0}}}},576:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebsocketTransport=void 0;var o=r(6805),s=r(3518),l=r(1675),u=i(r(5354)),c=r(3908),d=r(3273),h=r(917),f=r(480),p=r(1178),v=r(1222),g=r(5740);class _ extends s.ConfigConsumer{constructor(e){var t;super("websocketTransportConfig",e),a(this,"_wsConnection",null),a(this,"_wsUrl",null),a(this,"_messagesCache",[]),a(this,"_state",c.ESocketConnectionState.UNKNOWN),a(this,"_pendingStateTimeout",null),a(this,"_logger",void 0),this._logger=(0,o.Logger)(this._eventBus,"Ristretto - WebsocketTransport"),this._logger.info("Created"),this._eventBus.publish(f.EBroadcastLogsEvents.REPORT_EVENT,{event:p.EBroadcastLogsEvent.SOCKET_CONNECTION_OPEN_REQUESTED,description:"WebSocket transport connected"}),(null===(t=document)||void 0===t?void 0:t.addEventListener)&&document.addEventListener("visibilitychange",this._onWindowVisibilityChanged)}destroy(){super.destroy(),this._logger.info("Destroyed"),this._eventBus.publish(f.EBroadcastLogsEvents.REPORT_EVENT,{event:p.EBroadcastLogsEvent.SOCKET_CONNECTION_CLOSE_REQUESTED,description:"WebSocket transport destroyed"}),document.removeEventListener("visibilitychange",this._onWindowVisibilityChanged),this._closeConnection()}isReady(){return!!this._wsConnection&&this._wsConnection.readyState===WebSocket.OPEN}setWebsocketUrl(e){this._wsUrl!==e&&e&&(this._logger.debug("Websocket URL is defined now"),this._wsUrl=e,this._createConnection())}sendMessage(e){if(this._logger.verbose("Trying to send message: ".concat(JSON.stringify(e))),!this._wsConnection||this._wsConnection.readyState!==WebSocket.OPEN){if(this._logger.debug("Transport isnt ready to send message. Checking queue"),this.config.isQueueAllowed)return void this._messagesCache.push(e);throw new Error("Transport is not ready for messages")}this._eventBus.publish(h.EWebsocketTransportEvents.MESSAGE_SENT,e),this._eventBus.publish(f.EBroadcastLogsEvents.REPORT_EVENT,{event:p.EBroadcastLogsEvent.SOCKET_MESSAGE_SENT,description:e.message?"'".concat(e.message,"' message has been sent"):"Socket message has been sent",details:e}),this._wsConnection.send(JSON.stringify(e))}sendRawMessage(e){this._wsConnection&&this._wsConnection.readyState===WebSocket.OPEN&&this._wsConnection.send(e)}_handleConfigUpdated(){this._createConnection()}_setNewState(e){if(e!==this._state){var t;if(this._logger.debug("State changed: ".concat(this._state," -> ").concat(e)),this._eventBus.publish(h.EWebsocketTransportEvents.STATE_CHANGED,{prevState:this._state,nextState:e}),e===c.ESocketConnectionState.OFFLINE&&null!==(t=this._wsConnection)&&void 0!==t&&t.close(),e===c.ESocketConnectionState.CONNECTED){this._logger.info("Connected");var r=[...this._messagesCache];this._messagesCache=[],r.forEach(e=>{this.sendMessage(e)})}this._state=e}}_createConnection(){this._closeConnection(),this._wsUrl&&(this._wsConnection=new WebSocket(this._wsUrl),this._attachSocketEvents(),this._pendingStateTimeout=setTimeout(this._onConnectionStuck,this.config.pendingStateConnectionTimeout))}_attachSocketEvents(){this._wsConnection&&(this._wsConnection.addEventListener("open",this._onSocketOpened),this._wsConnection.addEventListener("close",this._onSocketClosed),this._wsConnection.addEventListener("error",this._onSocketError),this._wsConnection.addEventListener("message",this._onSocketMessage))}_detachSocketEvents(){this._wsConnection&&(this._wsConnection.removeEventListener("open",this._onSocketOpened),this._wsConnection.removeEventListener("close",this._onSocketClosed),this._wsConnection.removeEventListener("error",this._onSocketError),this._wsConnection.removeEventListener("message",this._onSocketMessage))}_closeConnection(){this._wsConnection&&(this._logger.debug("Stopping connection"),this._disarmPendingTimeout(),this._detachSocketEvents(),this._wsConnection.close())}_disarmPendingTimeout(){this._pendingStateTimeout&&(clearTimeout(this._pendingStateTimeout),this._pendingStateTimeout=null)}_onSocketOpened(){this._logger.debug("Socket is open now"),this._eventBus.publish(f.EBroadcastLogsEvents.REPORT_EVENT,{event:p.EBroadcastLogsEvent.SOCKET_CONNECTION_STATE_CHANGED,description:"Socket is open now"}),this._setNewState(c.ESocketConnectionState.CONNECTED),this._disarmPendingTimeout()}_onSocketClosed(e){var t;this._logger.debug("Socket is closed now"),this._eventBus.publish(f.EBroadcastLogsEvents.REPORT_EVENT,{event:p.EBroadcastLogsEvent.SOCKET_CONNECTION_STATE_CHANGED,description:"Socket is closed now",details:{readyState:null===(t=this._wsConnection)||void 0===t?void 0:t.readyState.toString(),code:e.code.toString()}}),this._eventBus.publish(l.ELifecycleEvent.LIFECYCLE_ERROR,{errorType:l.ELifecycleErrors.SIGNALLING_CONNECTION_ERROR,nativeError:new Error(e.code.toString())}),this._disarmPendingTimeout(),this._detachSocketEvents(),this._setNewState(c.ESocketConnectionState.OFFLINE)}_onSocketError(){var e,t,r;this._logger.debug("Socket reported an error"),this._eventBus.publish(f.EBroadcastLogsEvents.REPORT_EVENT,{event:p.EBroadcastLogsEvent.SOCKET_CONNECTION_STATE_CHANGED,description:"Socket reported an error",details:{readyState:null===(e=this._wsConnection)||void 0===e?void 0:e.readyState.toString()}}),this._disarmPendingTimeout(),this._eventBus.publish(l.ELifecycleEvent.LIFECYCLE_ERROR,{errorType:l.ELifecycleErrors.SIGNALLING_ESTABLISH_ERROR,nativeError:new Error(null===(t=this._wsConnection)||void 0===t?void 0:t.readyState.toString())}),this._eventBus.publish(v.ECommonEvent.COMMON_ERROR,{error:new g.RistrettoPlayerError(g.EErrorDomain.METADATA_UNDERLYING_CONNECTION,g.EErrorType.COULD_NOT_CONNECT_TO_METADATA_TRANSPORT,!1,null===(r=this._wsConnection)||void 0===r?void 0:r.readyState.toString())}),this._setNewState(c.ESocketConnectionState.OFFLINE)}_onSocketMessage(e){this._disarmPendingTimeout();var t=JSON.parse(e.data);this._eventBus.publish(f.EBroadcastLogsEvents.REPORT_EVENT,{event:p.EBroadcastLogsEvent.SOCKET_MESSAGE_RECEIVED,description:t.message?"'".concat(t.message,"' message has been received"):"Socket message has been received",details:t}),t.message===d.EIncomingMessage.NOTIFY_STREAM_STATUS_EVENT&&t.data[0].errorType&&this._eventBus.publish(l.ELifecycleEvent.LIFECYCLE_ERROR,{errorType:t.data[0].errorType===d.EStreamStatusErrorType.RECOVERABLE?l.ELifecycleErrors.SIGNALLING_ERROR_RECOVERABLE_MESSAGE:l.ELifecycleErrors.SIGNALLING_ERROR_UNRECOVERABLE_MESSAGE,nativeError:new Error(t.data[0].info)}),this._eventBus.publish(h.EWebsocketTransportEvents.MESSAGE_RECEIVED,JSON.parse(e.data))}_onConnectionStuck(){var e;this._logger.warn("Connection is stuck by timeout."),this._eventBus.publish(l.ELifecycleEvent.LIFECYCLE_ERROR,{errorType:l.ELifecycleErrors.SIGNALLING_CONNECTION_ERROR,nativeError:new Error("Connection is stuck in pending state")}),this._eventBus.publish(v.ECommonEvent.COMMON_ERROR,{error:new g.RistrettoPlayerError(g.EErrorDomain.METADATA_UNDERLYING_CONNECTION,g.EErrorType.COULD_NOT_CONNECT_TO_METADATA_TRANSPORT,!1,"Connection stuck in pending state, connection state = ".concat(null===(e=this._wsConnection)||void 0===e?void 0:e.readyState))}),this._setNewState(c.ESocketConnectionState.OFFLINE)}_onWindowVisibilityChanged(){if(this._wsConnection){this._logger.info("Checking WS state on visibility change, state is ".concat(this._wsConnection.readyState));var e=this._wsConnection.readyState===WebSocket.OPEN?c.ESocketConnectionState.CONNECTED:c.ESocketConnectionState.OFFLINE;this._setNewState(e)}}}t.WebsocketTransport=_,n([u.default],_.prototype,"_onSocketOpened",null),n([u.default],_.prototype,"_onSocketClosed",null),n([u.default],_.prototype,"_onSocketError",null),n([u.default],_.prototype,"_onSocketMessage",null),n([u.default],_.prototype,"_onConnectionStuck",null),n([u.default],_.prototype,"_onWindowVisibilityChanged",null)},619:(e,t,r)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigConsumer=t.setConfig=t.defaultMouflonPlayerConfig=void 0;var i=r(6805);t.defaultMouflonPlayerConfig={videoControllerConfig:{autoplay:!1,isRemote:!0},hlsConfig:{},webRTCConfig:{},nativeConfig:{},minUpscaleFactor:0,persistent:!1,establishWSOnStart:!1,reportModifiedMSE:!1,forbidModifiedMSE:!1,isShouldWatchDogStopStream:!1},n=(0,i.createConfig)(t.defaultMouflonPlayerConfig),t.setConfig=n.setConfig,t.ConfigConsumer=n.ConfigConsumer},641:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerSideTransport=void 0;var o=r(6805),s=i(r(5354));class l{constructor(e){a(this,"_currentSideLoggerCallback",null),a(this,"_onLogMessageReceivedToken",void 0),a(this,"_eventBus",void 0),this._eventBus=e,this._onLogMessageReceivedToken=this._eventBus.subscribe(o.ELoggerEvents.LOG,this._onMessageReceived)}registerSideLoggerCallback(e){this._currentSideLoggerCallback=e}destroy(){this._eventBus.unsubscribe(this._onLogMessageReceivedToken)}_onMessageReceived(e){this._currentSideLoggerCallback&&this._currentSideLoggerCallback(e)}}t.LoggerSideTransport=l,n([s.default],l.prototype,"_onMessageReceived",null)},666:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DoppioWrapper=void 0;var i=r(1783),o=r(9678),l=r(2502),u=r(3362),c=r(6805),d={[i.EPlaybackState.IDLE]:c.EPlaybackState.IDLE,[i.EPlaybackState.LOADING]:c.EPlaybackState.LOADING,[i.EPlaybackState.PAUSED]:c.EPlaybackState.PAUSED,[i.EPlaybackState.PLAYING]:c.EPlaybackState.PLAYING,[i.EPlaybackState.ERROR]:c.EPlaybackState.ERROR};class h extends l.AbstractWrapper{constructor(e){super(e),a(this,"_logLevels",[])}setStreamConfig(e){var t,r;return e&&e.HLSStreamUrl?(this._lastKnownStreamConfig={hlsStreamUrl:e.HLSStreamUrl},null!==(t=this._playerInstance)&&void 0!==t&&t.setUrl(e.HLSStreamUrl),this):(this._lastKnownStreamConfig=null,null!==(r=this._playerInstance)&&void 0!==r&&r.setUrl(""),this)}setAbrResolutions(){return this}enableAbr(){var e;return this._isAbrEnabled=!0,null!==(e=this._playerInstance)&&void 0!==e&&e.enableABR(),this}setResolutionByName(e){var t;return null!==(t=this._playerInstance)&&void 0!==t&&t.setResolutionByName(e),this}setResolutionByBitrate(e){var t;return null!==(t=this._playerInstance)&&void 0!==t&&t.setResolutionByBitrate(e),this}setLoggerLevel(e){var t;null!==(t=this._playerInstance)&&void 0!==t&&t.setLoggerLevel(e),this._logLevels=e}disableAbr(){var e;return this._isAbrEnabled=!1,null!==(e=this._playerInstance)&&void 0!==e&&e.disableABR(),this}setResolutionLimits(e){var t;return null!==(t=this._playerInstance)&&void 0!==t&&t.setMaxABRResolution(e),this}get version(){return"unknown"}_attachEventListeners(){this._playerInstance&&(this._playerInstance.addEventListener(i.EEvent.DEBUGGER_CONNECTED,this._wrapEventForDebuggerConnected),this._playerInstance.addEventListener(i.EEvent.PLAYBACK_STATE_CHANGED,this._wrapEventForPlaybackStateChanged),this._playerInstance.addEventListener(i.EEvent.ERROR,this._wrapEventForDoppioError),this._playerInstance.addEventListener(i.EEvent.VARIANTS_DETECTED,this._wrapEventForResolutionsAvailable),this._playerInstance.addEventListener(i.EEvent.METRICS_AVAILABLE,this._wrapEventForMetricsReported),this._playerInstance.addEventListener(i.EEvent.FRAG_LOADED,this._wrapEventForFragLoaded),this._playerInstance.addEventListener(i.EEvent.LEVEL_LOADED,this._wrapEventForPlaylistLoaded),this._playerInstance.addEventListener(i.EEvent.LIFECYCLE_EVENT,this._wrapEventForLifecycleEventReported),this._playerInstance.addEventListener(i.EEvent.LIFECYCLE_ERROR,this._wrapEventForLifecycleErrorReported),this._playerInstance.addEventListener(i.EEvent.LEVEL_SWITCHED_AUTO,this._wrapEventForRenditionSwitchAuto),this._playerInstance.addEventListener(i.EEvent.RESOLUTION_CHANGED,this._wrapEventForResolutionChanged),this._playerInstance.addEventListener(i.EEvent.RESOLUTION_NOT_FOUND,this._wrapEventForResolutionNotFound),this._playerInstance.addEventListener(i.EEvent.FRAGMENT_FILTERED_OUT,this._wrapEventForFragmentFilteredOut))}_detachEventListeners(){this._playerInstance&&(this._playerInstance.removeEventListener(i.EEvent.DEBUGGER_CONNECTED,this._wrapEventForDebuggerConnected),this._playerInstance.removeEventListener(i.EEvent.PLAYBACK_STATE_CHANGED,this._wrapEventForPlaybackStateChanged),this._playerInstance.removeEventListener(i.EEvent.ERROR,this._wrapEventForDoppioError),this._playerInstance.removeEventListener(i.EEvent.VARIANTS_DETECTED,this._wrapEventForResolutionsAvailable),this._playerInstance.removeEventListener(i.EEvent.METRICS_AVAILABLE,this._wrapEventForMetricsReported),this._playerInstance.removeEventListener(i.EEvent.FRAG_LOADED,this._wrapEventForFragLoaded),this._playerInstance.removeEventListener(i.EEvent.LEVEL_LOADED,this._wrapEventForPlaylistLoaded),this._playerInstance.removeEventListener(i.EEvent.LIFECYCLE_EVENT,this._wrapEventForLifecycleEventReported),this._playerInstance.removeEventListener(i.EEvent.LIFECYCLE_ERROR,this._wrapEventForLifecycleErrorReported),this._playerInstance.removeEventListener(i.EEvent.LEVEL_SWITCHED_AUTO,this._wrapEventForRenditionSwitchAuto),this._playerInstance.removeEventListener(i.EEvent.RESOLUTION_CHANGED,this._wrapEventForResolutionChanged),this._playerInstance.removeEventListener(i.EEvent.RESOLUTION_NOT_FOUND,this._wrapEventForResolutionNotFound),this._playerInstance.removeEventListener(i.EEvent.FRAGMENT_FILTERED_OUT,this._wrapEventForFragmentFilteredOut))}_createPlayerInstance(){var e=this;return s(function*(){var t;e._destroyPlayerInstance(),e._playerInstance=new i.DoppioPlayer,e._lastKnownConfig&&e._playerInstance.setConfig(e._lastKnownConfig),e._lastKnownStreamConfig&&e._playerInstance.setUrl(e._lastKnownStreamConfig.hlsStreamUrl),e._videoElement&&e._playerInstance.setVideoElement(e._videoElement),e._isAbrEnabled?e._playerInstance.enableABR():e._playerInstance.disableABR(),e._attachEventListeners(),null===(t=e._playerInstance)||void 0===t||t.setLoggerLevel(e._logLevels)})()}_onDebuggerConnected(e){var{detail:{panelUrl:t}}=e;this._eventBusInstance.publish(u.EPlayersEvents.DEBUGGER_CONNECTED,{debuggerUrl:t})}_onPlaybackStateChanged(e){var{detail:{prevState:t,nextState:r}}=e;this._eventBusInstance.publish(u.EPlayersEvents.PLAYBACK_STATE_CHANGED,{nextState:d[r],prevState:d[t]})}_onDoppioError(e){var{detail:{error:t}}=e;this._eventBusInstance.publish(u.EPlayersEvents.ERROR,{error:t,playerType:c.EPlayerType.HLS})}_onResolutionsAvailable(e){var{detail:t}=e;this._eventBusInstance.publish(u.EPlayersEvents.RESOLUTIONS_AVAILABLE,{resolutions:t})}_onMetricsReported(e){var t,{detail:r}=e;this._eventBusInstance.publish(o.EWatchDogEvent.ALIVE_PLAYER,{playerType:c.EPlayerType.HLS}),null!==(t=this._metricsCollector)&&void 0!==t&&t.registerMetrics({targetBuffer:r.targetBuffer}),r.latency&&this._eventBusInstance.publish(u.EPlayersEvents.LATENCY_ESTIMATION_AVAILABLE,{medianLatency:r.latency,EWMALatency:r.latency})}_onFragLoaded(e){var t;null!==(t=this._metricsCollector)&&void 0!==t&&t.registerMetrics({chunkLoadDuration:e.detail.netStats.downloadDuration,chunkLoadTTFB:e.detail.netStats.ttfb,chunkSize:e.detail.netStats.sizeInKb}),this._eventBusInstance.publish(u.EPlayersEvents.FRAG_LOADED,{netStats:e.detail.netStats,duration:e.detail.duration})}_onPlaylistLoaded(e){var t;null===(t=this._metricsCollector)||void 0===t||t.registerMetrics({playlistLoadTTFB:e.detail.netStats.ttfb,playlistLoadDuration:e.detail.netStats.downloadDuration,playlistSize:e.detail.netStats.sizeInKb})}_onLifecycleEventReported(e){var t,{detail:{eventType:r}}=e;null===(t=this._metricsCollector)||void 0===t||t.registerEvent(r,{})}_onRenditionSwitchAuto(e){var t,{detail:{nextResolution:r,prevResolution:n}}=e;null!==(t=this._metricsCollector)&&void 0!==t&&t.registerEvent("RenditionSwitchedAuto",{prevResolution:n,nextResolution:r}),this._eventBusInstance.publish(u.EPlayersEvents.AUTO_RESOLUTION_SWITCHED,{name:r})}_onResolutionChanged(e){var{detail:{name:t}}=e;this._eventBusInstance.publish(u.EPlayersEvents.RESOLUTION_SWITCHED,{name:t})}_onLifecycleErrorReported(e){var t,{detail:{errorType:r,nativeError:n}}=e;null===(t=this._metricsCollector)||void 0===t||t.registerEvent(r,{errorMessage:(null==n?void 0:n.message)||""});var i=String(r).toLowerCase(),o=["PlaylistLoadError","ManifestLoadError"].includes(r)||i.includes("manifest")||i.includes("playlist"),s=["FragmentLoadError"].includes(r)||i.includes("fragment"),a=o?"manifest":s?"content":void 0;this._eventBusInstance.publish(u.EPlayersEvents.STREAM_LOAD_ERROR,{reason:"HTTP_ERROR",httpStatusCode:null==n?void 0:n.statusCode,resourceType:a})}_onResolutionNotFound(){this._eventBusInstance.publish(u.EPlayersEvents.RESOLUTION_NOT_FOUND,{})}_onFragmentFilteredOut(e){var t,{detail:{reason:r,fragment:n}}=e;null===(t=this._metricsCollector)||void 0===t||t.registerEvent("FragmentFilteredOut",{reason:r,fragmentName:n})}_wrapEventForDebuggerConnected(e){this._onDebuggerConnected(e)}_wrapEventForPlaybackStateChanged(e){this._onPlaybackStateChanged(e)}_wrapEventForDoppioError(e){this._onDoppioError(e)}_wrapEventForResolutionsAvailable(e){this._onResolutionsAvailable(e)}_wrapEventForMetricsReported(e){this._onMetricsReported(e)}_wrapEventForFragLoaded(e){this._onFragLoaded(e)}_wrapEventForPlaylistLoaded(e){this._onPlaylistLoaded(e)}_wrapEventForLifecycleEventReported(e){this._onLifecycleEventReported(e)}_wrapEventForLifecycleErrorReported(e){this._onLifecycleErrorReported(e)}_wrapEventForRenditionSwitchAuto(e){this._onRenditionSwitchAuto(e)}_wrapEventForResolutionChanged(e){this._onResolutionChanged(e)}_wrapEventForResolutionNotFound(e){this._onResolutionNotFound()}_wrapEventForFragmentFilteredOut(e){this._onFragmentFilteredOut(e)}}t.DoppioWrapper=h,n([c.bind],h.prototype,"_onDebuggerConnected",null),n([c.bind],h.prototype,"_onPlaybackStateChanged",null),n([c.bind],h.prototype,"_onDoppioError",null),n([c.bind],h.prototype,"_onResolutionsAvailable",null),n([c.bind],h.prototype,"_onMetricsReported",null),n([c.bind],h.prototype,"_onFragLoaded",null),n([c.bind],h.prototype,"_onPlaylistLoaded",null),n([c.bind],h.prototype,"_onLifecycleEventReported",null),n([c.bind],h.prototype,"_onRenditionSwitchAuto",null),n([c.bind],h.prototype,"_onResolutionChanged",null),n([c.bind],h.prototype,"_onLifecycleErrorReported",null),n([c.bind],h.prototype,"_onResolutionNotFound",null),n([c.bind],h.prototype,"_onFragmentFilteredOut",null),n([c.bind],h.prototype,"_wrapEventForDebuggerConnected",null),n([c.bind],h.prototype,"_wrapEventForPlaybackStateChanged",null),n([c.bind],h.prototype,"_wrapEventForDoppioError",null),n([c.bind],h.prototype,"_wrapEventForResolutionsAvailable",null),n([c.bind],h.prototype,"_wrapEventForMetricsReported",null),n([c.bind],h.prototype,"_wrapEventForFragLoaded",null),n([c.bind],h.prototype,"_wrapEventForPlaylistLoaded",null),n([c.bind],h.prototype,"_wrapEventForLifecycleEventReported",null),n([c.bind],h.prototype,"_wrapEventForLifecycleErrorReported",null),n([c.bind],h.prototype,"_wrapEventForRenditionSwitchAuto",null),n([c.bind],h.prototype,"_wrapEventForResolutionChanged",null),n([c.bind],h.prototype,"_wrapEventForResolutionNotFound",null),n([c.bind],h.prototype,"_wrapEventForFragmentFilteredOut",null)},683:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.NativeWrapper=void 0;var i=r(9715),o=r(2502),l=r(6805);class u extends o.AbstractWrapper{constructor(e){super(e),a(this,"_reloadSrcTimeout",null)}setVideoElement(e){var t;return this._detachEventListeners(),super.setVideoElement(e),this._attachEventListeners(),this._videoElement&&null!==(t=this._lastKnownStreamConfig)&&void 0!==t&&t.NativeStreamURL&&(this._videoElement.src=this._lastKnownStreamConfig.NativeStreamURL),this}start(){var e=this;return s(function*(){var t;return null!==(t=e._videoElement)&&void 0!==t&&t.load(),e})()}setResolutionByName(){return this}setResolutionByBitrate(){return this}stop(){var e;return null!==(e=this._videoElement)&&void 0!==e&&e.pause(),this}destroy(){var e,t;return null!==(e=this._videoElement)&&void 0!==e&&e.pause(),null!==(t=this._videoElement)&&void 0!==t&&t.removeAttribute("src"),this._disarmReloadSrc(),this._detachEventListeners(),this}setPlayerConfig(e){var{addFallbackKey:t}=e;return this._lastKnownConfig.addFallbackKey=t,this}setAbrResolutions(){return this}setStreamConfig(e){var t;return this._disarmReloadSrc(),e?(this._lastKnownStreamConfig=e,this._lastKnownStreamConfig.NativeStreamURL=this._addQueryParam(this._lastKnownStreamConfig.NativeStreamURL,i.FALLBACK_KEY_QUERY_PARAMS),this._videoElement&&this._lastKnownStreamConfig&&(this._videoElement.src=this._lastKnownStreamConfig.NativeStreamURL,this._lastKnownStreamConfig.NativeStreamURL||this.stop()),this):(this._lastKnownStreamConfig=null,null!==(t=this._videoElement)&&void 0!==t&&t.removeAttribute("src"),this)}enableAbr(){return this}disableAbr(){return this}setLoggerLevel(){}setResolutionLimits(){return this}get version(){return""}_createPlayerInstance(){return s(function*(){})()}_attachEventListeners(){this._videoElement&&(this._detachEventListeners(),this._videoElement.addEventListener("error",this._onErrorReported))}_detachEventListeners(){this._videoElement&&this._videoElement.removeEventListener("error",this._onErrorReported)}_onErrorReported(){var e;4===(null===(e=this._videoElement)||void 0===e||null===(e=e.error)||void 0===e?void 0:e.code)&&this._armReloadSrc()}_reloadSrc(){var t=this;return s(function*(){var r;if(t._videoElement&&(t._videoElement.removeAttribute("src"),t._videoElement.load(),null!==(r=t._lastKnownStreamConfig)&&void 0!==r&&r.NativeStreamURL)){t._videoElement.src=t._lastKnownStreamConfig.NativeStreamURL,t._videoElement.load();try{t._videoElement.played.length&&(yield t._videoElement.play())}catch(e){}}})()}_addQueryParam(e,t){if(!e)return"";var r=new URL(this._isValidUrl(e)?e:this._buildUrl(e));return Object.entries(t).forEach(e=>{var[t,n]=e;return r.searchParams.set(t,n)}),r.toString()}_isValidUrl(e){try{var t=new URL(e);return Boolean(t.origin)}catch(e){return!1}}_buildUrl(e){var t=new URL(document.location.href);if(e.startsWith("/"))return"".concat(t.origin).concat(e);var r=t.pathname.split("/").filter(e=>e.trim().length>0);return r.pop()||r.pop(),"".concat(t.origin,"/").concat(r.concat(e).join("/"))}_armReloadSrc(){this._disarmReloadSrc(),this._reloadSrcTimeout=setTimeout(this._reloadSrc,500)}_disarmReloadSrc(){this._reloadSrcTimeout&&clearTimeout(this._reloadSrcTimeout)}}t.NativeWrapper=u,n([l.bind],u.prototype,"_onErrorReported",null),n([l.bind],u.prototype,"_reloadSrc",null)},745:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PliRule=void 0;var s=r(6805),l=o(r(5354)),u=r(2006);class c extends u.AbrRule{constructor(e){super({pliChangeThresholdPercentage:0,pliIgnoreReportsAmount:0,pliAverageUpFactor:0,pliAverageDownFactor:0,pliVectorDownFactor:0,pliVectorUpFactor:0,pliMeasurementPacketsLostMultiplier:0},e),a(this,"_lastLost",0),a(this,"_lastLostChange",0),a(this,"_lastLostChangePercentage",0),a(this,"_ignoreCount",0),a(this,"_averageFactorData",{items:[],value:0,vector:0}),a(this,"_logger",void 0),this._logger=(0,s.Logger)(e,"ABR/Rules/PLI"),this._logger.info("Created")}handleStats(e){this._logger.verbose("Stats received"),this._calculatePacketsLostDelta(e),this._calculatePacketsLostAverage(e)}getResult(){this._logger.verbose("Rule result requested");var e=this._getResultPacketsLostDelta();if(0!==e)return this._logger.debug("Calculated result is ".concat(e," as packetsLostDeltaResult is not zero")),{name:"pli",value:e};var t=this._getResultPacketsLostAverage();return 0!==t?(this._logger.debug("Calculated result is ".concat(t," as packetsLostAverage is not zero")),{name:"pli",value:t}):(this._logger.debug("Calculated result is 0 as neither packetsLostDeltaResult and packetsLostAverage are non-zero"),{name:"pli",value:0})}reset(){this._logger.verbose("Rule reset requested"),this._ignoreCount=0,this._lastLost=0,this._lastLostChange=0,this._lastLostChangePercentage=0}_getMultipliers(e){for(var t=[],r=2/(e*(e+1)),n=0,i=0;i<e-1;i++){var o=r*(i+1);t.push(o),n+=o}return t.push(1-n),t}_calculatePacketsLostDelta(e){this._ignoreCount<=this._getConfig().pliIgnoreReportsAmount&&this._ignoreCount++;var t=(e.packetsLostInInterval||0)-this._lastLost;this._lastLostChangePercentage=t/this._lastLostChange*100,this._lastLostChange=t,this._logger.verbose("Packets lost recalculated, lostChange=".concat(t,", lostChangePercentage=").concat(this._lastLostChangePercentage))}_calculatePacketsLostAverage(e){var{packetsInInterval:t,packetsLostInInterval:r}=e,{pliMeasurementPacketsLostMultiplier:n,pliIgnoreReportsAmount:o}=this._getConfig(),s=1,a=r<0?0:r;if(s=(a&&t?(t-a)/t:1)**3*n){var l=o,u=[...this._averageFactorData.items,s].slice(-l),c=u.length,d=this._getMultipliers(c),h=u.reduce((e,t,r)=>{var n=t>.5?1:-1;return{sum:e.sum+t,vector:e.vector+d[r]*n,prev:t||1}},{vector:0,sum:0,prev:1});this._averageFactorData.items=u,this._averageFactorData.value=h.sum/c,this._averageFactorData.vector=h.vector,this._logger.verbose("Calculated packetsLostAverage values",i({},this._averageFactorData))}else this._logger.verbose("No packetsLostFactor defined. Skipping packetsLostAverage calculation")}_getResultPacketsLostDelta(){var{pliChangeThresholdPercentage:e,pliIgnoreReportsAmount:t}=this._getConfig();return this._ignoreCount<t?(this._logger.verbose("No enough pliIgnoreReportsAmount. Returning 0"),0):(this._logger.verbose("Packets lost results: current value is ".concat(this._lastLostChangePercentage,", threshold is ").concat(e)),this._lastLostChangePercentage>e?-1:0)}_getResultPacketsLostAverage(){var{pliAverageUpFactor:e,pliAverageDownFactor:t,pliVectorDownFactor:r,pliVectorUpFactor:n}=this._getConfig();return this._averageFactorData.value>e&&this._averageFactorData.vector>n?(this._logger.verbose("Packets lost factor: value and vector are above thresholds. Reporting 1"),1):this._averageFactorData.value<t&&this._averageFactorData.vector<r?(this._logger.verbose("Packets lost factor: value and vector are below thresholds. Reporting -1"),-1):(this._logger.verbose("Packets lost factor: No significant changes detected. Reporting 0"),0)}}t.PliRule=c,n([l.default],c.prototype,"getResult",null),n([l.default],c.prototype,"_getMultipliers",null),n([l.default],c.prototype,"_calculatePacketsLostDelta",null),n([l.default],c.prototype,"_calculatePacketsLostAverage",null),n([l.default],c.prototype,"_getResultPacketsLostDelta",null),n([l.default],c.prototype,"_getResultPacketsLostAverage",null)},755:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableDebuggerConfigValues=t.defaultDebuggerConfig=void 0,t.defaultDebuggerConfig={enableRemoteDebugging:!1,debuggerUrl:"wss://doppio-player-debug.stripcdn.com",maxWSConnectionRetries:3,modulesStateGatheringPeriod:1e3},t.availableDebuggerConfigValues={}},786:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableBasePlaylistRotationControllerConfigValues=t.defaultBasePlaylistRotationControllerConfig=void 0;var n=r(4547);t.defaultBasePlaylistRotationControllerConfig={playlistLoadingTimeout:2500,forceStaticPlaylistLoadingTimeout:!1,lowLatencyMode:!0,equalPlaylistsAmountToDecline:10,blockingMode:n.EBlockingMode.WAIT_FOR_PLAYLIST,maxVODPlaylistLoadingRetries:3,maxVODFragmentLoadingRetries:3,baseVODPlaylistRetryTimeout:500,baseVODFragmentRetryTimeout:5e3,VODLoadNextSegmentThreshold:5e3,disableTimeoutsInVOD:!0,retryLowLatencyPlaylistTimeout:1e3,targetBufferMultiplier:1,disableRotateTimeoutIncrease:!0,shouldLogFragmentsHistory:!1,workerMode:!0,partHoldBack:void 0,additionalStartParts:2,sendCustomRefererHeader:!1},t.availableBasePlaylistRotationControllerConfigValues={blockingMode:{values:[n.EBlockingMode.WAIT_FOR_PLAYLIST,n.EBlockingMode.WAIT_FOR_PREFETCH_SEGMENT],isMultiple:!1}}},835:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResolutionsManagerEvents=void 0,t.ResolutionsManagerEvents={resolutionsAvailable:"resolutionsManager.resolutionsAvailable",reportCurrentResolution:"resolutionManager.reportCurrentResolution",resolutionChanged:"resolutionManager.resolutionChanged",resolutionCodecAvailable:"resolutionManager.resolutionChanged",resolutionAutoChanged:"resolutionManager.resolutionAutoChanged",requestResolutionChange:"resolutionManager.requestResolutionChange",requestRestartFromMain:"resolutionManager.requestRestartFromMain",resolutionNotFound:"resolutionManager.resolutionNotFound",resolutionsMaximumAvailable:"resolutionManager.resolutionsMaximumAvailable",entrypointURLUpdated:"resolutionManager.entrypointURLUpdated"}},858:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAudioTrackConstraints=void 0;var n=r(9661);t.getAudioTrackConstraints=e=>!!e&&("boolean"==typeof e?e:!!e.deviceId&&{deviceId:n.BROWSER_CAPABILITIES.safari?e.deviceId:{exact:e.deviceId},channelCount:2})},872:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableMinimalBufferToIncreaseEstimatorConfigValues=t.defaultMinimalBufferToIncreaseEstimatorConfig=void 0,t.defaultMinimalBufferToIncreaseEstimatorConfig={minimalBufferAmount:300},t.availableMinimalBufferToIncreaseEstimatorConfigValues={}},874:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildPlaylistUrl=void 0;var n=r(2883);t.buildPlaylistUrl=e=>{if((0,n.isValidURL)(e))return e;var t=new URL(document.location.href);if(e.startsWith("/"))return"".concat(t.origin).concat(e);var r=t.pathname.split("/").filter(e=>e.trim().length>0);return r.pop()||r.pop(),"".concat(t.origin,"/").concat(r.concat(e).join("/"))}},917:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EWebsocketTransportEvents=void 0,function(e){e.STATE_CHANGED="websocketTransport.stateChanged",e.MESSAGE_RECEIVED="websocketTransport.messageReceived",e.MESSAGE_SENT="websocketTransport.messageSent"}(r||(t.EWebsocketTransportEvents=r={}))},934:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerWorker=void 0;var o=i(r(6073)),s=r(1085),l=()=>{};class u{constructor(){a(this,"_onSocketReadyListener",l),a(this,"_onSocketClosedListener",l),a(this,"_serverUrl",""),a(this,"_wsConnection",null),a(this,"_messagesCache",[]),a(this,"_unsuccessfulConnectionAttempts",0),a(this,"_maxUnsuccessfulConnectionAttempts",0),a(this,"_roomId",(Math.random()+1).toString(36).substring(2,8))}setConfig(e,t,r,n){this._serverUrl=e,this._maxUnsuccessfulConnectionAttempts=t,this._onSocketReadyListener=r,this._onSocketClosedListener=n}connect(){this._serverUrl&&(this._wsConnection&&this.disconnect(),this._wsConnection=new WebSocket(this._serverUrl),this._wsConnection.addEventListener("error",this._onSocketError),this._wsConnection.addEventListener("open",this._onSocketOpened),this._wsConnection.addEventListener("close",this._onSocketClosed))}disconnect(){this._wsConnection&&(this._wsConnection.close(),this._wsConnection.removeEventListener("error",this._onSocketError),this._wsConnection.removeEventListener("open",this._onSocketOpened),this._wsConnection.removeEventListener("close",this._onSocketClosed),this._wsConnection=null)}reconnect(){this.disconnect(),this.connect()}sendMessage(e){this._wsConnection&&this._wsConnection.readyState===this._wsConnection.OPEN?this._wsConnection.send(JSON.stringify(e)):this._messagesCache.push(e)}_sendInitialMsg(){this.sendMessage({command:s.ECommand.CONNECT_TO_ROOM,roomId:this._roomId})}_resendMessagesFromCache(){if(this._messagesCache.length){var e=[...this._messagesCache];this._messagesCache=[],e.forEach(e=>this.sendMessage(e))}}_onSocketError(){this._unsuccessfulConnectionAttempts++,this.reconnect()}_onSocketOpened(){this._unsuccessfulConnectionAttempts=0;var e=this._serverUrl.includes("wss")?"https":"http",t="".concat(this._serverUrl.replace(/ws{1,2}/g,e),"/?roomId=").concat(this._roomId);this._onSocketReadyListener(t),this._sendInitialMsg(),this._resendMessagesFromCache()}_onSocketClosed(){}}t.DebuggerWorker=u,n([o.default],u.prototype,"_onSocketError",null),n([o.default],u.prototype,"_onSocketOpened",null),n([o.default],u.prototype,"_onSocketClosed",null)},942:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EPeerConnectionEvents=void 0,function(e){e.CONNECTION_STATE_CHANGED="peerConnection.connectionStateChanged",e.NEGOTIATION_REQUIRED="peerConnection.negotiationRequired",e.STREAM_AVAILABLE="peerConnection.streamAvailable",e.STATS_AVAILABLE="peerConnection.statsAvailable",e.RAW_STATS_REQUIRED="peerConnection.rawStatsRequired",e.RAW_STATS_AVAILABLE="peerConnection.rawStatsAvailable",e.SET_REMOTE_SDP_ERROR="peerConnection.SET_REMOTE_SDP_ERROR"}(r||(t.EPeerConnectionEvents=r={}))},954:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistValidatorDecryptStage=void 0,t.PlaylistValidatorDecryptStage=class{constructor(){a(this,"pipelinePosition",void 0)}}},1001:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.uuidv4=void 0,t.uuidv4=()=>[1e7,1e3,4e3,8e3,1e11].join("-").replace(/[018]/g,e=>(Number(e)^crypto.getRandomValues(new Uint8Array(1))[0]&15>>Number(e)/4).toString(16))},1045:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateDevices=void 0;var n=r(2108),i=(e,t)=>e.filter(e=>e.kind===t);t.enumerateDevices=s(function*(){var e=yield navigator.mediaDevices.enumerateDevices();return{audioInputs:i(e,n.EDeviceType.AUDIO_INPUT),audioOutputs:i(e,n.EDeviceType.AUDIO_OUTPUT),videoInputs:i(e,n.EDeviceType.VIDEO_INPUT)}})},1052:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(1917),i=function(){return n.A.Date.now()}},1084:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventsInPeriodWindow=void 0,t.EventsInPeriodWindow=class{constructor(){a(this,"_registeredEvents",[])}registerEvent(){this._registeredEvents.push(Date.now())}checkEventsInPeriod(e){var t=Date.now()-e;return this._registeredEvents=this._registeredEvents.filter(e=>e>=t),this._registeredEvents.length}clear(){this._registeredEvents=[]}}},1085:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ECommand=void 0,function(e){e.CONNECT_TO_ROOM="connectToRoom",e.MODULES_INFO_AVAILABLE="modulesInfoAvailable",e.MODULE_LIFECYCLE_EVENT_AVAILABLE="moduleLifecycleEventAvailable",e.CLIENT_CONNECTED="clientConnected",e.CLIENT_INFO_AVAILABLE="clientInfoAvailable",e.CLIENT_DISCONNECTED="clientDisconnected"}(r||(t.ECommand=r={}))},1111:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableAbrControllerConfigValues=t.defaultAbrControllerConfig=void 0,t.defaultAbrControllerConfig={abrOnClient:!0,checkingInterval:1e3,checkingIntervalNew:150,lockInterval:8e3,qualityPresets:[],isNewAbr:!1,bitrateEWMAFastAlpha:.9,bitrateEWMASlowAlpha:.7,bitrateCollectionTimeout:1e3,bitrateThreshold:.2,maxFPSToAssumeZero:5,fpsAfterFailCooldownTimeout:4e3,violationsToReportBitrate:3,violationsToReportFreeze:3,violationsToReportFPS:8,ignoreFPSViolationsWithoutNoise:!0,resultsToBecomeConfident:3,freezeDurationToReport:.8,failAfterUpscaleTimeout:3e3,failAfterDownscaleTimeout:4e3,failsToTimeout:2,afterDownscaleTimeout:2e4,afterUpscaleTimeout:1e4,afterFailedTimeout:2e4,afterBadBandwidthReportTimeout:5e3,afterFailsTimeout:6e4,noiseDecisionDuration:8e3,noiseTotalBitrate:1.1,abrRules:{maxFPSToAssumeZero:5,maxReportsOfZeroFpsBeforeLowerQuality:2,pliChangeThresholdPercentage:200,pliIgnoreReportsAmount:10,pliMeasurementPacketsLostMultiplier:1.05,pliAverageUpFactor:1.05,pliAverageDownFactor:.95,pliVectorUpFactor:.3,pliVectorDownFactor:-1}},t.availableAbrControllerConfigValues={}},1121:(e,t,r)=>{r.d(t,{A:()=>i});var n=Function.prototype.toString,i=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},1125:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoElementController=void 0;var o=r(5361),s=r(6847),l=r(4989),u=r(6523),c=r(6671),d=r(4578),h=r(3136),f=r(2064),p=r(4856),v=r(7882),g=r(4012),_=r(8530),m=r(9602),y=r(4678),b=r(9417),E=r(3599);class S{constructor(){a(this,"_playbackController",void 0),a(this,"_streamController",void 0),a(this,"_stateController",void 0),a(this,"_customEventsEmitter",void 0),a(this,"_autoplayController",void 0),a(this,"_timeUpdateController",void 0),a(this,"_renderController",void 0),a(this,"_updateVideoDurationId",void 0),a(this,"_streamResetDelayId",void 0),a(this,"_eventsHandler",void 0),a(this,"_state",void 0),a(this,"_config",i({},u.defaultVideoElementControllerConfig.videoElementControllerConfig)),a(this,"_loggerTransport",void 0),a(this,"_eventBus",void 0),a(this,"_logger",void 0),a(this,"attachVideoElementEvents",()=>{this._logger.debug("Attach event listeners"),this._eventsHandler.toggleEvents("attach"),this._timeUpdateController.startTimeUpdate()}),a(this,"detachVideoElementEvents",e=>{this._logger.debug("Detach event listeners"),this._eventsHandler.toggleEvents("detach",e)}),a(this,"_updated",()=>{this._eventBus.publish(d.EVideoElementControllerBusEvent.UPDATED,{})}),this._eventBus=new o.EventBus,this._loggerTransport=new l.LoggerConsoleTransport(this._eventBus),this._logger=(0,s.Logger)(this._eventBus,"VideoController"),this._logger.info("Created"),this._logger.debug("Initial config",this._config),this._createControllers()}addEventListener(e,t){this._logger.verbose("Attaching ".concat(e," event listener")),this._customEventsEmitter.addEventListener(e,t)}removeEventListener(e,t){this._logger.verbose("Detaching ".concat(e," event listener")),this._customEventsEmitter.removeEventListener(e,t)}getIsPlaying(){return this._state.getState().isPlaying}getVideoElement(){return this._state.getState().videoElement}getCanvasElement(){return this._state.getState().canvasElement}updateConfig(e){this._config=i(i({},this._config),e),this._logger.debug("Config update received, the new one: ",this._config),e.isRemote&&this.attachVideoElementEvents(),this._syncConfig()}setVideoElement(e){var t=this._state.getState().videoElement;e!==t&&(t&&this.detachVideoElementEvents(t),this._logger.info("Video element set",{videoElement:e}),this._renderController.setVideoElement(e),this.attachVideoElementEvents())}createVideoElement(){return this._logger.info("Creating video element"),this._renderController.createVideoElement(),this.getVideoElement()}setStream(e){return this._logger.info("Setting media stream"),this._state.getState().stream===e?(this._logger.verbose("Previous stream is equal to the new one. Skipping."),this):(e?this._streamController.updateMediaStream(e):this._streamController.removeMediaStream(),this._updated(),this._state.setState({stream:e}),this)}renderVideoInto(e){this._logger.info("Rendering video element into container",e),this._renderController.renderVideoInto(e)}setVolume(e){this._logger.info("Setting volume of the video element",{volume:e}),this._eventBus.publish(d.EVideoElementControllerBusEvent.SET_VOLUME,{volume:e})}getState(){return this._state.getState()}destroy(){var e;this._logger.info("Destroying"),this._config=i({},u.defaultVideoElementControllerConfig.videoElementControllerConfig),this.detachVideoElementEvents(),this._streamController.removeMediaStream(),this._renderController.destroy(),this._eventBus.publishSync(d.EVideoElementControllerBusEvent.DESTROY,{}),this._logger.info("VideoElementController was destroyed"),null===(e=this._loggerTransport)||void 0===e||e.destroy()}reinit(){this._logger.info("Reinit requested"),[this._autoplayController,this._customEventsEmitter,this._playbackController,this._streamController,this._stateController,this._timeUpdateController,this._renderController,this._eventsHandler].forEach(e=>{e&&e.init()}),this.attachVideoElementEvents(),this._logger.info("VideoElementController was reinited")}setLoggerLevels(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this._logger.info("Setting new log level",{levels:e}),this._loggerTransport&&(this._loggerTransport.destroy(),this._loggerTransport=null),e.length&&(this._loggerTransport=new l.LoggerConsoleTransport(this._eventBus,e,t,r))}_syncConfig(){var e;this._logger.verbose("Sycronizing configs across all controllers"),null!==(e=this._autoplayController)&&void 0!==e&&e.setConfig(this._config),this._eventsHandler.setConfig(this._config),this._streamController.setConfig(this._config),this._timeUpdateController.setConfig(this._config),this._renderController.setConfig(this._config),this._stateController.setConfig(this._config)}_createControllers(){this._logger.verbose("Creating all controllers"),this._state=new E.StateManager(b.INITIAL_STATE);var e={getVideoElement:this.getVideoElement,state:this._state,eventBus:this._eventBus};this._autoplayController=new h.AutoplayController(e),this._customEventsEmitter=new f.CustomEventsEmitter(e),this._eventsHandler=new y.VideoEventsHandler(e),this._playbackController=new p.PlaybackController(e),this._streamController=new _.StreamController(e),this._stateController=new g.StateController(e),this._timeUpdateController=new m.TimeUpdateController(e),this._renderController=new v.RenderController(e),this._logger.verbose("Controllers created")}}t.VideoElementController=S,n([c.bind],S.prototype,"addEventListener",null),n([c.bind],S.prototype,"removeEventListener",null),n([c.bind],S.prototype,"getIsPlaying",null),n([c.bind],S.prototype,"getVideoElement",null),n([c.bind],S.prototype,"getCanvasElement",null)},1178:(e,t)=>{var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.EBroadcastLogsEvent=t.EBroadcastStatus=void 0,function(e){e[e.PENDING=0]="PENDING",e[e.STARTED=1]="STARTED",e[e.NOT_STARTED=2]="NOT_STARTED"}(r||(t.EBroadcastStatus=r={})),function(e){e.SESSION_STARTED="SessionStarted",e.BROADCAST_SUCCESS="BroadcastSuccess",e.BROADCAST_NOT_SUCCESS="BroadcastNotSuccess",e.SOCKET_CONNECTION_STATE_CHANGED="SocketConnectionStateChanged",e.PEER_CONNECTION_STATE_CHANGED="PeerConnectionStateChanged",e.PEER_ICE_CONNECTION_STATE_CHANGED="PeerICEConnectionStateChanged",e.PEER_CONNECTION_NEGOTIATION_REQUIRED="PeerConnectionNegotiationRequired",e.PEER_ICE_CANDIDATE_REPORTED="PeerICECandidateReported",e.PEER_ICE_CANDIDATE_ERROR_REPORTED="PeerICEConnectionErrorReported",e.SOCKET_CONNECTION_OPEN_REQUESTED="SocketConnectionOpenRequested",e.SOCKET_CONNECTION_CLOSE_REQUESTED="SocketConnectionCloseRequested",e.PEER_CONNECTION_OPEN_REQUESTED="PeerConnectionOpenRequested",e.PEER_CONNECTION_CLOSE_REQUESTED="PeerConnectionCloseRequested",e.UNPUBLISH_REQUESTED="UnpublishRequested",e.SOCKET_MESSAGE_RECEIVED="SocketMessageReceived",e.SOCKET_MESSAGE_SENT="SocketMessageSent",e.USER_MEDIA_UPDATED="UserMediaUpdated",e.SENDER_UPDATED="SenderUpdated",e.PAGE_VISIBILITY_CHANGED="PageVisibilityChanged",e.NETWORK_CONNECTION_STATE_CHANGED="NetworkConnectionStateChanged",e.NEXT_SESSION_ID="NextSessionId",e.DESTROYED="Destroyed"}(n||(t.EBroadcastLogsEvent=n={}))},1192:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EAbrControllerEvents=void 0,function(e){e.PRESETS_VARIANTS_AVAILABLE="abrController.presetsVariantsAvailable",e.NOT_ENOUGH_BANDWIDTH_DETECTED="abrController.notEnoughBandwidthDetected",e.STATS_ANALYZER_DIRECTION_CHANGE="abrController.statsAnalyzerDirectionChange",e.BANDWIDTH_NOISE_CHANGE="abrController.bandwidthNoiseChange",e.SEND_NOISE_CHANGE="abrController.sendNoiseChange",e.BANDWIDTH_NOISE_TARGET_BITRATE_REACHED="abrController.bandwidthNoiseTargetBitrateReached",e.QUALITY_CHANGE_REQUESTED="abrController.qualityChangeRequested"}(r||(t.EAbrControllerEvents=r={}))},1222:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ECommonEvent=void 0,function(e){e.BROADCAST_STATE_CHANGED="commonEvents.broadcastStateChanged",e.BROADCAST_REMOTE_STATS_AVAILABLE="commonEvents.broadcastRemoteStatsAvailable",e.PLAYING_STATE_CHANGED="commonEvents.playingStateChanged",e.COMMON_ERROR="commonEvents.commonError"}(r||(t.ECommonEvent=r={}))},1245:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.DebugPanel=void 0;var o=r(7028),s=r(3102),l=r(3362),u=r(6805);class c{constructor(e){a(this,"_eventBusInstance",void 0),a(this,"_onVideoElementUpdatedListener",void 0),a(this,"_onPlayerTypesAvailableListener",void 0),a(this,"_onPlayerTypeChangedListener",void 0),a(this,"_onStreamConfigUpdatedListener",void 0),a(this,"_onLatencyEstimationAvailableListener",void 0),a(this,"_onUpscaleCalculatedListener",void 0),a(this,"_onVideoElementDimensionsCalculatedListener",void 0),a(this,"_panelContainer",document.createElement("div")),a(this,"_resolutionRow",this._createPanelRow({labelText:"Resolution:"})),a(this,"_aspectRatioRow",this._createPanelRow({labelText:"Aspect ratio:"})),a(this,"_fpsRow",this._createPanelRow({labelText:"FPS:"})),a(this,"_latencyRow",this._createPanelRow({labelText:"Latency estimation:"})),a(this,"_upscaleRow",this._createPanelRow({labelText:"Upscale factor:"})),a(this,"_droppedFramesRow",this._createPanelRow({labelText:"Frames (dropped/total):"})),a(this,"_turnServersRow",this._createPanelRow({labelText:"TURN servers:",valueContent:{innerHTML:"Disable TURN Servers",style:{padding:"5px 10px",border:"1px solid",borderRadius:"5px"}}})),a(this,"_playerTypesRow",this._createPanelRow({labelText:"Players:",valueContent:{style:{display:"flex"}}})),a(this,"_streamOverridesRow",this._createPanelRow({labelText:"Overrides:",rowStyle:{display:"flex",alignItems:"center"}})),a(this,"_refreshInterval",void 0),a(this,"_domainOverrideInput",document.createElement("input")),a(this,"_streamNameOverrideInput",document.createElement("input")),a(this,"_domainOverrideDebounce",(0,o.debounce)(this._onDomainOverrideChanged,200)),a(this,"_lastPartOverrideDebounce",(0,o.debounce)(this._onlastPartOverrideChanged,200)),a(this,"_videoElement",null),a(this,"_prevFramesCount",-1),a(this,"_prevFramesCountTs",-1),a(this,"_availablePlayerTypes",[]),a(this,"_currentPlayerType",null),a(this,"_shouldUseTURNServersState",!0),a(this,"_domainOverride",""),a(this,"_lastPartOverride",""),a(this,"_currentStreamConfig",null),a(this,"_lastKnownVideoElementDimensions",{width:0,height:0}),this._eventBusInstance=e,this._onVideoElementUpdatedListener=e.subscribe(l.EPlayersEvents.VIDEO_ELEMENT_UPDATED,this._onVideoElementUpdated),this._onPlayerTypesAvailableListener=e.subscribe(l.EPlayersEvents.PLAYER_TYPES_AVAILABLE,this._onPlayerTypesAvailable),this._onPlayerTypeChangedListener=e.subscribe(l.EPlayersEvents.PLAYER_TYPE_CHANGED,this._onPlayerTypeChanged),this._onStreamConfigUpdatedListener=e.subscribe(l.EPlayersEvents.STREAM_CONFIG_UPDATED,this._onStreamConfigUpdated),this._onLatencyEstimationAvailableListener=e.subscribe(l.EPlayersEvents.LATENCY_ESTIMATION_AVAILABLE,this._onLatencyEstimationAvailable),this._onUpscaleCalculatedListener=e.subscribe(s.EMetricsEvents.UPSCALE_CALCULATED,this._onUpscaleCalculated),this._onVideoElementDimensionsCalculatedListener=e.subscribe(s.EMetricsEvents.VIDEO_ELEMENT_DIMENSIONS_CALCULATED,this._onVideoElementDimensionsCalculated),this._streamOverridesRow.appendRowChild(this._domainOverrideInput),this._streamOverridesRow.appendRowChild(this._streamNameOverrideInput),this._domainOverrideInput.addEventListener("change",this._domainOverrideDebounce),this._streamNameOverrideInput.addEventListener("change",this._lastPartOverrideDebounce),this._panelContainer.style.display="flex",this._panelContainer.style.fontSize=".625rem",this._panelContainer.style.flexDirection="column",this._domainOverrideInput.style.background="inherit",this._domainOverrideInput.style.color="inherit",this._domainOverrideInput.style.marginRight="10px",this._domainOverrideInput.style.border="1px solid",this._streamNameOverrideInput.style.background="inherit",this._streamNameOverrideInput.style.color="inherit",this._streamNameOverrideInput.style.border="1px solid",this._turnServersRow.addRowEventListener("click",this._toggleTURNServers),this._refreshInterval=setInterval(this._refreshDebugData,1e3)}destroy(){this._eventBusInstance.unsubscribe(this._onPlayerTypesAvailableListener),this._eventBusInstance.unsubscribe(this._onVideoElementUpdatedListener),this._eventBusInstance.unsubscribe(this._onPlayerTypeChangedListener),this._eventBusInstance.unsubscribe(this._onStreamConfigUpdatedListener),this._eventBusInstance.unsubscribe(this._onLatencyEstimationAvailableListener),this._eventBusInstance.unsubscribe(this._onUpscaleCalculatedListener),this._eventBusInstance.unsubscribe(this._onVideoElementDimensionsCalculatedListener),clearInterval(this._refreshInterval),this._domainOverrideInput.removeEventListener("change",this._domainOverrideDebounce),this._streamNameOverrideInput.removeEventListener("change",this._lastPartOverrideDebounce)}_onDomainOverrideChanged(){this._domainOverride=this._domainOverrideInput.value,this._rebuildStreamConfig()}_onlastPartOverrideChanged(){this._lastPartOverride=this._streamNameOverrideInput.value,this._rebuildStreamConfig()}_rebuildStreamConfig(){if(this._currentStreamConfig){var e=i({},this._currentStreamConfig);if((this._currentPlayerType===u.EPlayerType.HLS&&e.HLSStreamUrl||this._currentPlayerType===u.EPlayerType.NATIVE&&e.NativeStreamURL)&&this._domainOverride&&this._lastPartOverride){var t=new URL(this._currentPlayerType===u.EPlayerType.NATIVE?e.NativeStreamURL:e.HLSStreamUrl);t.host=this._domainOverride;var[r,n]=this._lastPartOverride.split("?"),o=t.pathname.split("/").slice(-1)[0];t.pathname=t.pathname.replace(o,r),n&&(t.search="?".concat(n)),this._currentPlayerType===u.EPlayerType.HLS?e.HLSStreamUrl=t.toString():e.NativeStreamURL=t.toString()}this._currentPlayerType===u.EPlayerType.WEBRTC&&e.WebRTCStreamId&&e.WebRTCSignallingUrl&&(e.WebRTCSignallingUrl=this._domainOverride,e.WebRTCStreamId=this._lastPartOverride),this._eventBusInstance.publish(l.EPlayersEvents.STREAM_CONFIG_UPDATED_INTERNAL,{streamConfig:e})}}_createPanelRow(e){var{labelText:t,rowStyle:r,valueContent:n}=e,i=document.createElement("div");Object.assign(i.style,null!=r?r:{display:"flex",alignItems:"center",margin:"5px 0"});var o=document.createElement("div");o.style.minWidth="130px",o.innerHTML=t,i.appendChild(o);var s=document.createElement("div");return null!=n&&n.innerHTML&&(s.innerHTML=null==n?void 0:n.innerHTML),null!=n&&n.style&&Object.assign(s.style,null==n?void 0:n.style),i.appendChild(s),this._panelContainer.appendChild(i),{setRowValue:e=>{s.innerHTML=e},appendRowChild:e=>{s.appendChild(e)},getRowChildren:()=>s.childNodes,addRowEventListener:(e,t,r)=>{s.addEventListener(e,t,r)},removeRowEventListener:(e,t,r)=>{s.removeEventListener(e,t,r)}}}_resetOverridenValues(){if(this._currentStreamConfig&&this._currentPlayerType){if(this._currentPlayerType===u.EPlayerType.HLS&&this._currentStreamConfig.HLSStreamUrl||this._currentPlayerType===u.EPlayerType.NATIVE&&this._currentStreamConfig.NativeStreamURL){var e=new URL(this._currentPlayerType===u.EPlayerType.NATIVE?this._currentStreamConfig.NativeStreamURL:this._currentStreamConfig.HLSStreamUrl);this._domainOverrideInput.value=e.host,this._domainOverride=e.host;var t=e.pathname.split("/").slice(-1)[0];this._streamNameOverrideInput.value="".concat(t).concat(e.search),this._lastPartOverride=t}this._currentStreamConfig.WebRTCSignallingUrl&&this._currentStreamConfig.WebRTCStreamId&&this._currentPlayerType===u.EPlayerType.WEBRTC&&(this._domainOverrideInput.value=this._currentStreamConfig.WebRTCSignallingUrl,this._domainOverride=this._currentStreamConfig.WebRTCSignallingUrl,this._streamNameOverrideInput.value=this._currentStreamConfig.WebRTCStreamId,this._lastPartOverride=this._currentStreamConfig.WebRTCStreamId)}}_onStreamConfigUpdated(e){var{streamConfig:t}=e;this._currentStreamConfig=t,this._resetOverridenValues()}_onVideoElementUpdated(e){var{videoElement:t}=e;this._videoElement=t,this._prevFramesCount=-1}_onPlayerTypesAvailable(e){var{availablePlayerTypes:t}=e;this._availablePlayerTypes=t,[...this._playerTypesRow.getRowChildren()].forEach(e=>{e.removeEventListener("click",this._onPlayerTypeButtonClicked)}),this._playerTypesRow.setRowValue(""),this._availablePlayerTypes.forEach(e=>{var t=document.createElement("div");t.style.border="1px solid",t.style.borderRadius="5px",t.style.padding="5px 10px",t.style.marginRight="10px",t.innerText=e,t.dataset.playerType=e,t.addEventListener("click",this._onPlayerTypeButtonClicked),this._playerTypesRow.appendRowChild(t)})}_refreshDebugData(){var e=this._hydrateVideoElementMetrics();this._resolutionRow.setRowValue("Video: ".concat(e.videoResolution,";<br />Container: ").concat(e.elementResolution,"<br /> DPR container: ").concat(e.dprElementResolution)),this._aspectRatioRow.setRowValue("Video: ".concat(e.videoAspectRatio,"; Container: ").concat(e.elementAspectRatio)),this._fpsRow.setRowValue(e.fps),this._droppedFramesRow.setRowValue(e.framesCount),this._renderCurrentPlayerType()}_hydrateVideoElementMetrics(){if(!this._videoElement)return{videoResolution:"N/A",elementResolution:"N/A",dprElementResolution:"N/A",videoAspectRatio:"N/A",elementAspectRatio:"N/A",fps:"N/A",framesCount:"N/A"};var e=(0,u.getVideoPlaybackQuality)(this._videoElement),{videoWidth:t,videoHeight:r}=this._videoElement,{width:n,height:i}=this._lastKnownVideoElementDimensions,o="N/A";return e&&(this._prevFramesCount>-1&&(o="".concat(Math.round((e.totalVideoFrames-this._prevFramesCount)/((Date.now()-this._prevFramesCountTs)/1e3)))),this._prevFramesCount=e.totalVideoFrames,this._prevFramesCountTs=Date.now()),{videoResolution:"".concat(t,"x").concat(r),elementResolution:"".concat(n,"x").concat(i),dprElementResolution:"".concat(n*window.devicePixelRatio,"x").concat(i*window.devicePixelRatio),videoAspectRatio:t&&r?""+Math.round(t/r*100)/100:"N/A",elementAspectRatio:n&&i?""+Math.round(n/i*100)/100:"N/A",fps:o,framesCount:e?"".concat(e.totalVideoFrames,"/").concat(e.droppedVideoFrames):"N/A"}}_renderCurrentPlayerType(){[...this._playerTypesRow.getRowChildren()].forEach(e=>{var t=e;t.dataset.playerType===this._currentPlayerType?t.style.background="#1491ff":t.style.background="inherit"})}_toggleTURNServers(){this._shouldUseTURNServersState=!this._shouldUseTURNServersState,this._eventBusInstance.publish(l.EPlayersEvents.TOGGLE_TURN_SERVERS,{shouldUseTURNServers:this._shouldUseTURNServersState}),this._turnServersRow.setRowValue(this._shouldUseTURNServersState?"Disable TURN Servers":"Enable TURN servers")}_onPlayerTypeButtonClicked(e){var t=e.target;this._eventBusInstance.publish(l.EPlayersEvents.FORCE_PLAYER_TYPE,{playerType:t.dataset.playerType})}_onPlayerTypeChanged(e){var{playerType:t}=e;this._currentPlayerType=t,this._resetOverridenValues()}_onLatencyEstimationAvailable(e){var{medianLatency:t,EWMALatency:r}=e;this._latencyRow.setRowValue("".concat(t.toFixed(2)," med, ").concat(r.toFixed(2)," EWMA"))}_onUpscaleCalculated(e){var{upscaleFactor:t}=e;this._upscaleRow.setRowValue(null!==t?t.toFixed(4):"N/A")}_onVideoElementDimensionsCalculated(e){var{width:t,height:r}=e;this._lastKnownVideoElementDimensions={width:t,height:r}}get rootContainer(){return this._panelContainer}}t.DebugPanel=c,n([u.bind],c.prototype,"_onDomainOverrideChanged",null),n([u.bind],c.prototype,"_onlastPartOverrideChanged",null),n([u.bind],c.prototype,"_onStreamConfigUpdated",null),n([u.bind],c.prototype,"_onVideoElementUpdated",null),n([u.bind],c.prototype,"_onPlayerTypesAvailable",null),n([u.bind],c.prototype,"_refreshDebugData",null),n([u.bind],c.prototype,"_toggleTURNServers",null),n([u.bind],c.prototype,"_onPlayerTypeButtonClicked",null),n([u.bind],c.prototype,"_onPlayerTypeChanged",null),n([u.bind],c.prototype,"_onLatencyEstimationAvailable",null),n([u.bind],c.prototype,"_onUpscaleCalculated",null),n([u.bind],c.prototype,"_onVideoElementDimensionsCalculated",null)},1312:(e,t,r)=>{var n;!function(){var t="input is invalid type",i="object"==typeof window,o=i?window:{};o.JS_SHA256_NO_WINDOW&&(i=!1);var s=!i&&"object"==typeof self,a=!o.JS_SHA256_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node&&"renderer"!=process.type;a?o=globalThis:s&&(o=self);var l=!o.JS_SHA256_NO_COMMON_JS&&e.exports,u=r.amdO,c=!o.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,d="0123456789abcdef".split(""),h=[-2147483648,8388608,32768,128],f=[24,16,8,0],p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],v=["hex","array","digest","arrayBuffer"],g=[];!o.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!c||!o.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});var _=function(e,t){return function(r){return new S(t,!0).update(r)[e]()}},m=function(e){var t=_("hex",e);a&&(t=y(t,e)),t.create=function(){return new S(e)},t.update=function(e){return t.create().update(e)};for(var r=0;r<v.length;++r){var n=v[r];t[n]=_(n,e)}return t},y=function(e,n){var i,s=r(4394),a=r(9428).Buffer,l=n?"sha224":"sha256";return i=a.from&&!o.JS_SHA256_NO_BUFFER_FROM?a.from:function(e){return new a(e)},function(r){if("string"==typeof r)return s.createHash(l).update(r,"utf8").digest("hex");if(null==r)throw new Error(t);return r.constructor===ArrayBuffer&&(r=new Uint8Array(r)),Array.isArray(r)||ArrayBuffer.isView(r)||r.constructor===a?s.createHash(l).update(i(r)).digest("hex"):e(r)}},b=function(e,t){return function(r,n){return new T(r,t,!0).update(n)[e]()}},E=function(e){var t=b("hex",e);t.create=function(t){return new T(t,e)},t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<v.length;++r){var n=v[r];t[n]=b(n,e)}return t};function S(e,t){t?(g[0]=g[16]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=g[9]=g[10]=g[11]=g[12]=g[13]=g[14]=g[15]=0,this.blocks=g):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e}function T(e,r,n){var i,o=typeof e;if("string"===o){var s,a=[],l=e.length,u=0;for(i=0;i<l;++i)(s=e.charCodeAt(i))<128?a[u++]=s:s<2048?(a[u++]=192|s>>>6,a[u++]=128|63&s):s<55296||s>=57344?(a[u++]=224|s>>>12,a[u++]=128|s>>>6&63,a[u++]=128|63&s):(s=65536+((1023&s)<<10|1023&e.charCodeAt(++i)),a[u++]=240|s>>>18,a[u++]=128|s>>>12&63,a[u++]=128|s>>>6&63,a[u++]=128|63&s);e=a}else{if("object"!==o)throw new Error(t);if(null===e)throw new Error(t);if(c&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||c&&ArrayBuffer.isView(e)))throw new Error(t)}e.length>64&&(e=new S(r,!0).update(e).array());var d=[],h=[];for(i=0;i<64;++i){var f=e[i]||0;d[i]=92^f,h[i]=54^f}S.call(this,r,n),this.update(h),this.oKeyPad=d,this.inner=!0,this.sharedMemory=n}S.prototype.update=function(e){if(!this.finalized){var r,n=typeof e;if("string"!==n){if("object"!==n)throw new Error(t);if(null===e)throw new Error(t);if(c&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||c&&ArrayBuffer.isView(e)))throw new Error(t);r=!0}for(var i,o,s=0,a=e.length,l=this.blocks;s<a;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,this.block=l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),r)for(o=this.start;s<a&&o<64;++s)l[o>>>2]|=e[s]<<f[3&o++];else for(o=this.start;s<a&&o<64;++s)(i=e.charCodeAt(s))<128?l[o>>>2]|=i<<f[3&o++]:i<2048?(l[o>>>2]|=(192|i>>>6)<<f[3&o++],l[o>>>2]|=(128|63&i)<<f[3&o++]):i<55296||i>=57344?(l[o>>>2]|=(224|i>>>12)<<f[3&o++],l[o>>>2]|=(128|i>>>6&63)<<f[3&o++],l[o>>>2]|=(128|63&i)<<f[3&o++]):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++s)),l[o>>>2]|=(240|i>>>18)<<f[3&o++],l[o>>>2]|=(128|i>>>12&63)<<f[3&o++],l[o>>>2]|=(128|i>>>6&63)<<f[3&o++],l[o>>>2]|=(128|63&i)<<f[3&o++]);this.lastByteIndex=o,this.bytes+=o-this.start,o>=64?(this.block=l[16],this.start=o-64,this.hash(),this.hashed=!0):this.start=o}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296|0,this.bytes=this.bytes%4294967296),this}},S.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>>2]|=h[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},S.prototype.hash=function(){var e,t,r,n,i,o,s,a,l,u=this.h0,c=this.h1,d=this.h2,h=this.h3,f=this.h4,v=this.h5,g=this.h6,_=this.h7,m=this.blocks;for(e=16;e<64;++e)t=((i=m[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,r=((i=m[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,m[e]=m[e-16]+t+m[e-7]+r|0;for(l=c&d,e=0;e<64;e+=4)this.first?(this.is224?(o=300032,_=(i=m[0]-1413257819)-150054599|0,h=i+24177077|0):(o=704751109,_=(i=m[0]-210244248)-1521486534|0,h=i+143694565|0),this.first=!1):(t=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),n=(o=u&c)^u&d^l,_=h+(i=_+(r=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&v^~f&g)+p[e]+m[e])|0,h=i+(t+n)|0),t=(h>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),n=(s=h&u)^h&c^o,g=d+(i=g+(r=(_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7))+(_&f^~_&v)+p[e+1]+m[e+1])|0,t=((d=i+(t+n)|0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),n=(a=d&h)^d&u^s,v=c+(i=v+(r=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7))+(g&_^~g&f)+p[e+2]+m[e+2])|0,t=((c=i+(t+n)|0)>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),n=(l=c&d)^c&h^a,f=u+(i=f+(r=(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&g^~v&_)+p[e+3]+m[e+3])|0,u=i+(t+n)|0,this.chromeBugWorkAround=!0;this.h0=this.h0+u|0,this.h1=this.h1+c|0,this.h2=this.h2+d|0,this.h3=this.h3+h|0,this.h4=this.h4+f|0,this.h5=this.h5+v|0,this.h6=this.h6+g|0,this.h7=this.h7+_|0},S.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,o=this.h5,s=this.h6,a=this.h7,l=d[e>>>28&15]+d[e>>>24&15]+d[e>>>20&15]+d[e>>>16&15]+d[e>>>12&15]+d[e>>>8&15]+d[e>>>4&15]+d[15&e]+d[t>>>28&15]+d[t>>>24&15]+d[t>>>20&15]+d[t>>>16&15]+d[t>>>12&15]+d[t>>>8&15]+d[t>>>4&15]+d[15&t]+d[r>>>28&15]+d[r>>>24&15]+d[r>>>20&15]+d[r>>>16&15]+d[r>>>12&15]+d[r>>>8&15]+d[r>>>4&15]+d[15&r]+d[n>>>28&15]+d[n>>>24&15]+d[n>>>20&15]+d[n>>>16&15]+d[n>>>12&15]+d[n>>>8&15]+d[n>>>4&15]+d[15&n]+d[i>>>28&15]+d[i>>>24&15]+d[i>>>20&15]+d[i>>>16&15]+d[i>>>12&15]+d[i>>>8&15]+d[i>>>4&15]+d[15&i]+d[o>>>28&15]+d[o>>>24&15]+d[o>>>20&15]+d[o>>>16&15]+d[o>>>12&15]+d[o>>>8&15]+d[o>>>4&15]+d[15&o]+d[s>>>28&15]+d[s>>>24&15]+d[s>>>20&15]+d[s>>>16&15]+d[s>>>12&15]+d[s>>>8&15]+d[s>>>4&15]+d[15&s];return this.is224||(l+=d[a>>>28&15]+d[a>>>24&15]+d[a>>>20&15]+d[a>>>16&15]+d[a>>>12&15]+d[a>>>8&15]+d[a>>>4&15]+d[15&a]),l},S.prototype.toString=S.prototype.hex,S.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,o=this.h5,s=this.h6,a=this.h7,l=[e>>>24&255,e>>>16&255,e>>>8&255,255&e,t>>>24&255,t>>>16&255,t>>>8&255,255&t,r>>>24&255,r>>>16&255,r>>>8&255,255&r,n>>>24&255,n>>>16&255,n>>>8&255,255&n,i>>>24&255,i>>>16&255,i>>>8&255,255&i,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s];return this.is224||l.push(a>>>24&255,a>>>16&255,a>>>8&255,255&a),l},S.prototype.array=S.prototype.digest,S.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e},T.prototype=new S,T.prototype.finalize=function(){if(S.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();S.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),S.prototype.finalize.call(this)}};var C=m();C.sha256=C,C.sha224=m(!0),C.sha256.hmac=E(),C.sha224.hmac=E(!0),l?e.exports=C:(o.sha256=C.sha256,o.sha224=C.sha224,u&&(void 0===(n=function(){return C}.call(C,r,C,e))||(e.exports=n)))}()},1370:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availablePlaybackSpeedWatcherConfigValues=t.defaultPlaybackSpeedWatcherConfig=void 0,t.defaultPlaybackSpeedWatcherConfig={maxLiveSyncThreshold:.4,minLiveSyncThreshold:.3,maxTargetBufferMultiplier:3,targetBufferInitialMultiplier:1,targetBufferDecreaseCoefficient:.25},t.availablePlaybackSpeedWatcherConfigValues={}},1388:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.extractPeerStatsForAbr=t.getSortedPeerStats=void 0,t.getSortedPeerStats=e=>{var t={audio:{},video:{},common:{}};for(var r of e.values()){var{kind:n,type:o}=r;o&&(t[n||"common"][o]=i(i({},r),{},{timestamp:r.timestamp||Date.now()}))}return t};var r=(e,t,r)=>{var n,i,[o,s,a]=t;return null!==(n=null===(i=e[o])||void 0===i||null===(i=i[s])||void 0===i?void 0:i[a])&&void 0!==n?n:r};t.extractPeerStatsForAbr=function(e){var n,i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bitrate:0,bytes:0,framesPerSecond:0,packets:0,packetsInInterval:0,packetsLost:0,packetsLostInInterval:0,timestamp:Date.now()},s=(0,t.getSortedPeerStats)(e),a=r(s,["video","inbound-rtp","timestamp"],Date.now()),l=(a-o.timestamp)/1e3,u=null!==(n=r(s,["video","inbound-rtp","packetsReceived"],0))&&void 0!==n?n:0,c=null!==(i=r(s,["video","inbound-rtp","packetsLost"],0))&&void 0!==i?i:0,d=o.packetsLost>c?0:(c-o.packetsLost)/l||0,h=(u-o.packets)/l||0,f=r(s,["video","inbound-rtp","bytesReceived"],0),p=(f-o.bytes)/l||0;return{framesPerSecond:r(s,["video","inbound-rtp","framesPerSecond"],0)||0,bitrate:p,bytes:f,packets:u,packetsLost:c,packetsInInterval:h,packetsLostInInterval:d,timestamp:a}}},1421:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GetSideMetricsAsyncEvents=void 0,t.GetSideMetricsAsyncEvents={getPlaybackSpeedControllerMetrics:"getSideMetricsAsyncEvents.getPlaybackSpeedControllerMetrics",playbackSpeedControllerMetricsAvailable:"getSideMetricsAsyncEvents.playbackSpeedControllerMetricsAvailable",getPlayingTimeFraction:"getSideMetricsAsyncEvents.getPlayingTimeFraction",getPlayingTimeFractionAvailable:"getSideMetricsAsyncEvents.getPlayingTimeFractionAvailable"}},1470:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EReportType=void 0,function(e){e[e.PLANNED=1]="PLANNED",e[e.PRECLOSE=2]="PRECLOSE",e[e.PRECLEAR=3]="PRECLEAR"}(r||(t.EReportType=r={}))},1483:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getVideoTrackConstraints=void 0;var n=r(9661);t.getVideoTrackConstraints=(e,t)=>{if(!e)return!1;if("boolean"==typeof e)return!0;var r=e.width&&e.height?Number(e.width)/Number(e.height):t.baseAspectRatio,i={};return e.frameRate&&(i.frameRate={ideal:e.frameRate,min:15}),e.facingMode&&navigator.mediaDevices.getSupportedConstraints().facingMode&&(i.facingMode={exact:e.facingMode}),e.width&&(i.width={ideal:e.width}),e.height&&(i.height={ideal:e.height}),e.width&&e.height&&r&&(i.aspectRatio=r),e.deviceId&&(i.deviceId=n.BROWSER_CAPABILITIES.safari?e.deviceId:{exact:e.deviceId}),e.width&&e.height&&!i.facingMode&&(i.advanced=[{width:{min:e.width-t.sizeThreshold,max:e.width+t.sizeThreshold},height:{min:e.height-t.sizeThreshold,max:e.height+t.sizeThreshold}},{aspectRatio:r}]),0!==Object.keys(i).length&&i}},1496:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConfigConsumerScope=void 0;var n=r(5490);t.createConfigConsumerScope=e=>{var t={};return{configConsumerConstructor:class{constructor(r,i){a(this,"config",void 0),a(this,"_onConfigUpdatedListener",void 0),a(this,"_onConfigUpdatedWithContext",this._onConfigUpdated.bind(this)),a(this,"_configKey",void 0),a(this,"_eventBus",void 0),this._configKey=r,this._eventBus=i||e;var o=(0,n.getFieldSpecificEventName)(r);this._onConfigUpdatedListener=this._eventBus.subscribe(o,this._onConfigUpdatedWithContext),this.config=t[r]}destroy(){this._eventBus.unsubscribe(this._onConfigUpdatedListener)}_handleConfigUpdated(e,t){}_onConfigUpdated(e){t=e.newConfig;var r=e.newConfig[this._configKey];this.config=r,this._handleConfigUpdated(e.updatedValues,r)}},setConsumerConfig:e=>{t=e}}}},1573:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QueueLocker=void 0,t.QueueLocker=class{constructor(){a(this,"_queue",[]),a(this,"_isRunning",!1)}enqueue(e){this._queue.push(e),this._runNext()}_runNext(){if(!this._isRunning){var e=this._queue.shift();if(e){this._isRunning=!0;try{var t=e();Promise.resolve(t).catch(e=>console.error("QueueLocker error: ",e)).finally(()=>{this._isRunning=!1,this._runNext()})}catch(e){this._isRunning=!1,this._runNext()}}}}}},1582:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LifecycleEventsManager=void 0;var o=r(355),s=r(2513),l=r(7833),u=r(3871),c=i(r(6073)),d=r(5726),h=r(3639);class f{constructor(e){a(this,"_manifestLoaded",!1),a(this,"_firstMediaPlaylistLoaded",!1),a(this,"_firstFragmentLoaded",!1),a(this,"_firstFragmentBuffered",!1),a(this,"_eventBus",void 0),a(this,"_onManifestLoadedListener",void 0),a(this,"_onSimplePlaylistDetectedListener",void 0),a(this,"_onLLPlaylistDetectedListener",void 0),a(this,"_onVODPlaylistDetectedListener",void 0),a(this,"_onFragmentLoadedListener",void 0),a(this,"_onFragmentBufferedListener",void 0),a(this,"_onFragmentLoadErrorListener",void 0),a(this,"_onFragmentLoadAbortListener",void 0),a(this,"_onPlaylistLoadErrorListener",void 0),this._eventBus=e,this._onManifestLoadedListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlistType.multivariantDetected,this._onManifestLoaded),this._onSimplePlaylistDetectedListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlistType.simpleDetected,this._onPlaylistLoaded),this._onLLPlaylistDetectedListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlistType.llDetected,this._onPlaylistLoaded),this._onVODPlaylistDetectedListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlistType.vodDetected,this._onPlaylistLoaded),this._onFragmentLoadedListener=this._eventBus.subscribe(l.FragmentLoaderEvents.fragments.fragmentLoaded,this._onFragmentLoaded),this._onFragmentBufferedListener=this._eventBus.subscribe(o.BufferControllerEvents.fragmentAdded,this._onFragmentBuffered),this._onFragmentLoadErrorListener=this._eventBus.subscribe(l.FragmentLoaderEvents.fragments.fragmentLoadingError,this._onFragmentLoadError),this._onFragmentLoadAbortListener=this._eventBus.subscribe(l.FragmentLoaderEvents.fragments.fragmentLoadingAborted,this._onFragmentLoadError),this._onPlaylistLoadErrorListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlists.playlistLoadingError,this._onPlaylistLoadError)}destroy(){this._eventBus.unsubscribe(this._onManifestLoadedListener),this._eventBus.unsubscribe(this._onSimplePlaylistDetectedListener),this._eventBus.unsubscribe(this._onLLPlaylistDetectedListener),this._eventBus.unsubscribe(this._onVODPlaylistDetectedListener),this._eventBus.unsubscribe(this._onFragmentLoadedListener),this._eventBus.unsubscribe(this._onFragmentBufferedListener),this._eventBus.unsubscribe(this._onFragmentLoadErrorListener),this._eventBus.unsubscribe(this._onFragmentLoadAbortListener),this._eventBus.unsubscribe(this._onPlaylistLoadErrorListener)}reset(){this._manifestLoaded=!1,this._firstMediaPlaylistLoaded=!1,this._firstFragmentLoaded=!1,this._firstFragmentBuffered=!1}_onManifestLoaded(){this._manifestLoaded||(this._manifestLoaded=!0,this._eventBus.publish(h.LifecycleEventsManagerEvents.lifecycleEvent,{eventType:u.ELifecycleEvent.MANIFEST_LOADED}))}_onPlaylistLoaded(){this._firstMediaPlaylistLoaded||(this._firstMediaPlaylistLoaded=!0,this._eventBus.publish(h.LifecycleEventsManagerEvents.lifecycleEvent,{eventType:u.ELifecycleEvent.FIRST_MEDIA_PLAYLIST_LOADED}))}_onFragmentLoaded(){this._firstFragmentLoaded||(this._firstFragmentLoaded=!0,this._eventBus.publish(h.LifecycleEventsManagerEvents.lifecycleEvent,{eventType:u.ELifecycleEvent.FIRST_FRAGMENT_LOADED}))}_onFragmentBuffered(){this._firstFragmentBuffered||(this._firstFragmentBuffered=!0,this._eventBus.publish(h.LifecycleEventsManagerEvents.lifecycleEvent,{eventType:u.ELifecycleEvent.FIRST_FRAGMENT_BUFFERED}))}_onFragmentLoadError(e){var t,r,n,i;this._eventBus.publish(h.LifecycleEventsManagerEvents.lifecycleError,{errorType:u.ELifecycleError.FRAGMENT_LOAD_ERROR,nativeError:new d.NetworkError(" ".concat(null===(t=e.error)||void 0===t?void 0:t.statusText," (").concat(null===(r=e.error)||void 0===r?void 0:r.status,")"),(null===(n=e.error)||void 0===n?void 0:n.status)||-1,(null===(i=e.error)||void 0===i?void 0:i.statusText)||"No status text known")})}_onPlaylistLoadError(e){var{error:t}=e;this._eventBus.publish(h.LifecycleEventsManagerEvents.lifecycleError,{errorType:this._manifestLoaded?u.ELifecycleError.PLAYLIST_LOAD_ERROR:u.ELifecycleError.MANIFEST_LOAD_ERROR,nativeError:new d.NetworkError("Could not load ".concat(this._manifestLoaded?"playlist":"manifest",": ").concat(null==t?void 0:t.statusText,"(").concat(null==t?void 0:t.status,")"),(null==t?void 0:t.status)||-1,(null==t?void 0:t.statusText)||"No status text known")})}}t.LifecycleEventsManager=f,n([c.default],f.prototype,"_onManifestLoaded",null),n([c.default],f.prototype,"_onPlaylistLoaded",null),n([c.default],f.prototype,"_onFragmentLoaded",null),n([c.default],f.prototype,"_onFragmentBuffered",null),n([c.default],f.prototype,"_onFragmentLoadError",null),n([c.default],f.prototype,"_onPlaylistLoadError",null)},1649:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Median=void 0,t.Median=class{constructor(){a(this,"_values",[])}addValue(e){this._values.push(e)}reset(){this._values=[]}get median(){if(!this._values.length)return 0;var e=[...this._values].sort((e,t)=>e-t),t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}}},1660:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ResolutionsController=void 0;var n=r(1192),i=r(3518);class o extends i.ConfigConsumer{constructor(e){super("abrControllerConfig",e),a(this,"_availableResolutions",[]),a(this,"_currentResolutionName",null),a(this,"_currentResolution",null),a(this,"_prevResolution",null),a(this,"_nextResolution",null),a(this,"_startAutoResolution","")}setStartAutoResolution(e){this._startAutoResolution=e,this._updateCurrentResolution()}setAvailableResolutions(e){this._availableResolutions=[...e.sort((e,t)=>e.bitrate-t.bitrate)],this._updateCurrentResolution()}setCurrentResolutionName(e){this._currentResolutionName=e,this._updateCurrentResolution()}getResolutions(){return{currentResolution:this._currentResolution,prevResolution:this._prevResolution,nextResolution:this._nextResolution}}hasAnyResolutionAvailable(){var e;return!(null===(e=this._availableResolutions)||void 0===e||!e.length)}_updateCurrentResolution(){if(this._currentResolutionName||this._startAutoResolution){var e=this._availableResolutions.findIndex(e=>e.name===this._currentResolutionName);if(e>=0)this._updateCurrentResolutionsSet(e);else{if(!this._startAutoResolution||!this._availableResolutions.length)return;var t=this._getStartResolution();if(null===t)return;this._updateCurrentResolutionsSet(t),this._currentResolution&&this._currentResolution.name!==this._currentResolutionName&&this._eventBus.publish(n.EAbrControllerEvents.QUALITY_CHANGE_REQUESTED,{qualityName:this._currentResolution.name})}}}_getStartResolution(){return this._startAutoResolution&&this._availableResolutions.length?(e="source"===this._startAutoResolution?this._availableResolutions.find(e=>"source"===e.name):[...this._availableResolutions].filter(e=>"source"!==e.name).sort((e,t)=>Math.abs(parseInt(this._startAutoResolution,10)-parseInt(e.name,10))>Math.abs(parseInt(this._startAutoResolution,10)-parseInt(t.name,10))?1:-1)[0],e?this._availableResolutions.findIndex(t=>t.name===e.name):null):null;var e}_updateCurrentResolutionsSet(e){this._currentResolution=this._availableResolutions[e],this._prevResolution=this._availableResolutions[e-1],this._nextResolution=this._availableResolutions[e+1]}}t.ResolutionsController=o},1661:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof globalThis&&globalThis;function n(e){try{new e("")}catch(e){return!1}return!0}"function"==typeof r.Event&&n(r.Event)||(r.Event=function(e,t){this.bubbles=!!t&&!!t.bubbles,this.cancelable=!!t&&!!t.cancelable,this.composed=!!t&&!!t.composed,this.type=e}),void 0!==r.EventTarget&&n(r.EventTarget)||(r.EventTarget=function(){function e(){this.__listeners=new Map}return e.prototype=Object.create(Object.prototype),e.prototype.addEventListener=function(e,t,r){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only ".concat(arguments.length," present."));var n=this.__listeners,i=e.toString();n.has(i)||n.set(i,new Map);var o=n.get(i);o.has(t)||o.set(t,r)},e.prototype.removeEventListener=function(e,t,r){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only ".concat(arguments.length," present."));var n=this.__listeners,i=e.toString();if(n.has(i)){var o=n.get(i);o.has(t)&&o.delete(t)}},e.prototype.dispatchEvent=function(e){var t=this;if(!(e instanceof Event))throw new TypeError("Failed to execute 'dispatchEvent' on 'EventTarget': parameter 1 is not of type 'Event'.");var r=e.type,n=this.__listeners.get(r);if(n){var i=function(){try{"function"==typeof o?o.call(t,e):o&&"function"==typeof o.handleEvent&&o.handleEvent(e)}catch(e){setTimeout(()=>{throw e})}s&&s.once&&n.delete(o)};for(var[o,s]of n.entries())i()}return!0},e}())},1675:(e,t)=>{var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ELifecycleEvent=t.ELifecycleErrors=t.ELifecycleEvents=void 0,function(e){e.SOCKET_OPENED="SocketOpened",e.SDP_RECEIVED="SdpReceived",e.PEER_CONNECTION_ESTABLISHED="PeerConnectionEstablished"}(r||(t.ELifecycleEvents=r={})),function(e){e.SIGNALLING_ESTABLISH_ERROR="SignallingEstablishError",e.SIGNALLING_CONNECTION_ERROR="SignallingConnectionError",e.SIGNALLING_ERROR_RECOVERABLE_MESSAGE="SignallingErrorRecoverableMessage",e.SIGNALLING_ERROR_UNRECOVERABLE_MESSAGE="SignallingErrorUnrecoverableMessage",e.PEER_ESTABLISH_ERROR="PeerEstablishError",e.PEER_CONNECTION_ERROR="PeerConnectionError"}(n||(t.ELifecycleErrors=n={})),function(e){e.LIFECYCLE_EVENT="lifecycleEvents.event",e.LIFECYCLE_ERROR="lifecycleEvents.error",e.RESOLUTION_SWITCH_AUTO="lifecycleEvents.resolutionSwitchAuto"}(i||(t.ELifecycleEvent=i={}))},1694:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(5488),i=r(3149),o=r(1882),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt,c=function(e){if("number"==typeof e)return e;if((0,o.A)(e))return NaN;if((0,i.A)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,i.A)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=(0,n.A)(e);var r=a.test(e);return r||l.test(e)?u(e.slice(2),r?2:8):s.test(e)?NaN:+e}},1714:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableInactivityReconnectConfigValues=t.defaultInactivityReconnectConfig=void 0,t.defaultInactivityReconnectConfig={inactivityTimeout:5e3},t.availableInactivityReconnectConfigValues={}},1743:(e,t)=>{function r(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalThis=r,"undefined"==typeof globalThis&&(globalThis=r())},1783:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.availableConfigValues=t.defaultConfig=t.ELifecycleError=t.ELifecycleEvent=t.EPlaybackState=t.LogLevelTitlesMap=t.EEvent=t.ELogLevel=t.DoppioPlayer=void 0,r(3154);var o=r(8592),l=r(7430),u=r(9442),c=r(355),d=r(5312);Object.defineProperty(t,"EPlaybackState",{enumerable:!0,get:function(){return d.EPlaybackState}});var h=r(8169),f=r(2726),p=r(8280),v=r(5560),g=r(3229),_=r(9922),m=r(8474);Object.defineProperty(t,"ELogLevel",{enumerable:!0,get:function(){return m.ELogLevel}}),Object.defineProperty(t,"LogLevelTitlesMap",{enumerable:!0,get:function(){return m.LogLevelTitlesMap}});var y=r(9408),b=r(8082),E=r(835),S=r(450),T=r(2395),C=r(874),A=i(r(6073)),P=r(9444),R=r(1960),O=r(5736),L=r(3613),M=r(1582),w=r(3639),I=r(9893),D=r(3871);Object.defineProperty(t,"EEvent",{enumerable:!0,get:function(){return D.EEvent}}),Object.defineProperty(t,"ELifecycleError",{enumerable:!0,get:function(){return D.ELifecycleError}}),Object.defineProperty(t,"ELifecycleEvent",{enumerable:!0,get:function(){return D.ELifecycleEvent}});class N extends EventTarget{constructor(){super(),a(this,"_eventBus",new f.EventBus),a(this,"_loggerTransport",null),a(this,"_fragmentParser",new p.FragmentParser(this._eventBus)),a(this,"_fragmentQueue",new _.FragmentsQueue(this._eventBus)),a(this,"_buffer",new u.BufferController(this._eventBus)),a(this,"_resolutionManager",new b.ResolutionsManager(this._eventBus)),a(this,"_abrController",new o.AbrController(this._eventBus)),a(this,"_debugger",new R.Debugger(this._eventBus)),a(this,"_fragmentsFilter",new v.FragmentsFilter(this._eventBus)),a(this,"_fragmentsBuffer",new O.FragmentsBuffer(this._eventBus)),a(this,"_url",null),a(this,"_key",null),a(this,"_videoElement",null),a(this,"_isStarted",!1),a(this,"_onResolutionChangedListener",void 0),a(this,"_onResolutionsAvailableListener",void 0),a(this,"_onMetricsAvailableListener",void 0),a(this,"_onPlaybackStateChangedListener",void 0),a(this,"_onLifecycleEventReportedListener",void 0),a(this,"_onLifecycleErrorReportedListener",void 0),a(this,"_onFragmentsFilterProblemDetectedListener",void 0),a(this,"_onResolutionNotFoundListener",void 0),a(this,"_commonMetricsCollector",new P.CommonPlayerDebugInfo),a(this,"_lifecycleEventsManager",new M.LifecycleEventsManager(this._eventBus)),a(this,"_legacyEventsController",void 0),a(this,"_onStreamEndedListener",void 0),a(this,"_logger",void 0);var e=(Math.random()+1).toString(36).substring(7);this._eventBus.setAppId(e),this._loggerTransport=new m.LoggerConsoleTransport(this._eventBus,I.DEFAULT_LOG_LEVELS,[],[]),this._logger=(0,m.Logger)(this._eventBus,"Doppio - core"),this._logger.info("Created"),this._onResolutionsAvailableListener=this._eventBus.subscribe(E.ResolutionsManagerEvents.resolutionsAvailable,this._onResolutionsAvailable),this._onMetricsAvailableListener=this._eventBus.subscribe(c.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable),this._onResolutionChangedListener=this._eventBus.subscribe(E.ResolutionsManagerEvents.resolutionChanged,this._onResolutionChanged),this._onStreamEndedListener=this._eventBus.subscribe(c.BufferControllerEvents.endOfStreamReached,this._onStreamEnded),this._onPlaybackStateChangedListener=this._eventBus.subscribe(c.BufferControllerEvents.playbackStateChanged,this._onPlaybackStateChanged),this._legacyEventsController=new T.LegacyEvents(this.dispatchEvent.bind(this),this._eventBus),this._debugger.registerDebuggableModules({fragmentQueue:this._fragmentQueue,commonInfo:this._commonMetricsCollector,resolutionManager:this._resolutionManager,abr:this._abrController}),this._onLifecycleEventReportedListener=this._eventBus.subscribe(w.LifecycleEventsManagerEvents.lifecycleEvent,this._onLifecycleEventReported),this._onLifecycleErrorReportedListener=this._eventBus.subscribe(w.LifecycleEventsManagerEvents.lifecycleError,this._onLifecycleErrorReported),this._onResolutionNotFoundListener=this._eventBus.subscribe(E.ResolutionsManagerEvents.resolutionNotFound,this._onResolutionNotFound),this._onFragmentsFilterProblemDetectedListener=this._eventBus.subscribe(g.FragmentsFilterEvents.problemDetected,this._onFragmentFilterProblemDetected)}destroy(){var e;this._eventBus.unsubscribe(this._onResolutionsAvailableListener),this._eventBus.unsubscribe(this._onResolutionChangedListener),this._eventBus.unsubscribe(this._onMetricsAvailableListener),this._eventBus.unsubscribe(this._onStreamEndedListener),this._eventBus.unsubscribe(this._onPlaybackStateChangedListener),this._eventBus.unsubscribe(this._onLifecycleEventReportedListener),this._eventBus.unsubscribe(this._onLifecycleErrorReportedListener),this._eventBus.unsubscribe(this._onResolutionNotFoundListener),this._eventBus.unsubscribe(this._onFragmentsFilterProblemDetectedListener),this._fragmentParser.destroy(),this._buffer.destroy(),this._resolutionManager.destroy(),this._abrController.destroy(),this._fragmentQueue.destroy(),this._debugger.destroy(),this._legacyEventsController.destroy(),null!==(e=this._videoElement)&&void 0!==e&&e.removeEventListener("error",this._onMediaElementError),this._logger.info("Destroyed"),this._lifecycleEventsManager.destroy(),this._fragmentsFilter.destroy(),this._fragmentsBuffer.destroy(),setTimeout(()=>{var e;null===(e=this._loggerTransport)||void 0===e||e.destroy()},1e3),(0,S.destroyWorker)(this._eventBus.getAppId())}get isStarted(){return this._isStarted}recoverMediaError(){var e;this._buffer.detachVideoElement(),this._videoElement&&this._buffer.attachVideoElement(this._videoElement),this._resolutionManager.restart(),null===(e=this._videoElement)||void 0===e||e.play()}start(){this._url?(this._videoElement||this._logger.warn("Video element is not defined."),this._isStarted?this._restart():(this._debugger.registerDebuggableModules({bufferController:this._buffer}),this._resolutionManager.setUrl(this._url),this._isStarted=!0)):this._logger.fatal("Stream URL is not defined. Cannot start player")}setUrl(e){if(!e.trim())return this._stop(),this;var t=(0,C.buildPlaylistUrl)(e),r=this._url!==t&&this._isStarted;return this._url=t,this._key=null,r&&(this._lifecycleEventsManager.reset(),this._restart()),this}setKey(e){return this._key=e,this}setVideoElement(e){return e===this._videoElement||(this._videoElement&&(this._buffer.detachVideoElement(),this._videoElement.removeEventListener("error",this._onMediaElementError)),this._videoElement=e,this._videoElement&&(this._buffer.attachVideoElement(this._videoElement),this._buffer.scheduleSourceBufferRecreation(),this._videoElement.addEventListener("error",this._onMediaElementError))),this}getFragmentQueue(){return this._fragmentQueue.getCurrentQueue()}setLoggerLevel(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return this._loggerTransport&&(this._loggerTransport.destroy(),this._loggerTransport=null),this._loggerTransport=new m.LoggerConsoleTransport(this._eventBus,e,t,r),this}setResolutionByName(e){return this._resolutionManager.setResolutionByName(e),this}setResolutionByBitrate(e){return this._resolutionManager.setNearestResolutionByBitrate(e)}disableABR(){return this._resolutionManager.toggleAutoResolution(!1),this}enableABR(){return this._resolutionManager.toggleAutoResolution(!0),this}setConfig(e){(0,h.setConfig)(e,this._eventBus)}setMaxABRResolution(e){this._eventBus.publish(l.AbrControllerEvents.resolutionsConstraintsAvailable,e)}_restart(){var e=this;return s(function*(){var t;e._logger.info("restarting"),null!==(t=e._buffer)&&void 0!==t&&t.reset(),yield e.recoverMediaError(),e._fragmentParser.destroy(),e._fragmentParser=new p.FragmentParser(e._eventBus),e._fragmentQueue.reset(),e._url&&e._resolutionManager.setUrl(e._url)})()}_stop(){this._url=null,this._restart(),this._resolutionManager.setUrl("")}_onResolutionsAvailable(e){this.dispatchEvent(new CustomEvent(D.EEvent.VARIANTS_DETECTED,{detail:e}))}_onStreamEnded(){this.dispatchEvent(new Event(D.EEvent.STREAM_ENDED))}_onResolutionChanged(e){this.dispatchEvent(new CustomEvent(D.EEvent.RESOLUTION_CHANGED,{detail:e}))}_onBufferMetricsAvailable(e){this.dispatchEvent(new CustomEvent(D.EEvent.METRICS_AVAILABLE,{detail:e}))}_onPlaybackStateChanged(e){var{prevState:t,nextState:r}=e;this.dispatchEvent(new CustomEvent(D.EEvent.PLAYBACK_STATE_CHANGED,{detail:{prevState:t,nextState:r}}))}_onFragmentFilterProblemDetected(e){var{reason:t,fragment:r}=e;this.dispatchEvent(new CustomEvent(D.EEvent.FRAGMENT_FILTERED_OUT,{detail:{reason:t,fragment:r}}))}_onMediaElementError(){var e,t,r,n,i;y.OpenObserveLogger.reportError("VideoElementError",{msg:null===(e=this._videoElement)||void 0===e||null===(e=e.error)||void 0===e?void 0:e.message,code:null===(t=this._videoElement)||void 0===t||null===(t=t.error)||void 0===t?void 0:t.code}),this._eventBus.publish(L.FragmentsBufferEvents.saveData,{}),this._logger.error("Media error occurred ".concat(null===(r=this._videoElement)||void 0===r||null===(r=r.error)||void 0===r?void 0:r.message," ").concat(null===(n=this._videoElement)||void 0===n||null===(n=n.error)||void 0===n?void 0:n.code)),(null===(i=this._videoElement)||void 0===i?void 0:i.error)&&this.recoverMediaError()}_onLifecycleEventReported(e){var{eventType:t}=e;this.dispatchEvent(new CustomEvent(D.EEvent.LIFECYCLE_EVENT,{detail:{eventType:t}}))}_onLifecycleErrorReported(e){var{errorType:t,nativeError:r}=e;this.dispatchEvent(new CustomEvent(D.EEvent.LIFECYCLE_ERROR,{detail:{errorType:t,nativeError:r}}))}_onResolutionNotFound(){this.dispatchEvent(new CustomEvent(D.EEvent.RESOLUTION_NOT_FOUND))}_addAirPlaySourceIfNeeded(){if(this._url&&this._videoElement&&window.ManagedMediaSource){var e=document.createElement("source");e.type="application/x-mpegURL",e.src=this._url.replace(/playlistType=lowLatency/gi,""),this._videoElement.appendChild(e)}}}t.DoppioPlayer=N,n([A.default],N.prototype,"_onResolutionsAvailable",null),n([A.default],N.prototype,"_onStreamEnded",null),n([A.default],N.prototype,"_onResolutionChanged",null),n([A.default],N.prototype,"_onBufferMetricsAvailable",null),n([A.default],N.prototype,"_onPlaybackStateChanged",null),n([A.default],N.prototype,"_onFragmentFilterProblemDetected",null),n([A.default],N.prototype,"_onMediaElementError",null),n([A.default],N.prototype,"_onLifecycleEventReported",null),n([A.default],N.prototype,"_onLifecycleErrorReported",null),n([A.default],N.prototype,"_onResolutionNotFound",null);var B=r(9893);Object.defineProperty(t,"defaultConfig",{enumerable:!0,get:function(){return B.defaultConfig}}),Object.defineProperty(t,"availableConfigValues",{enumerable:!0,get:function(){return B.availableConfigValues}})},1821:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.requestMediaPermissions=void 0;var n=r(9661),i=r(9142);t.requestMediaPermissions=function(){var e=s(function*(e){return new Promise((t,r)=>{navigator.mediaDevices.getUserMedia(null!=e?e:{audio:!0,video:!0}).then(e=>{e.getTracks().forEach(e=>{e.stop()}),t(!0)}).catch(e=>{var t=e.name,o=e.message,s=i.EMediaPermissionsErrorType.GENERIC;n.BROWSER_CAPABILITIES.chrome?"NotAllowedError"===t?"Permission denied by system"===o?s=i.EMediaPermissionsErrorType.SYSTEM_PERMISSION_DENIED:"Permission denied"===o&&(s=i.EMediaPermissionsErrorType.USER_PERMISSION_DENIED):"NotReadableError"===t&&(s=i.EMediaPermissionsErrorType.COULD_NOT_START_VIDEO_SOURCE):n.BROWSER_CAPABILITIES.safari?"NotAllowedError"===t&&(s=i.EMediaPermissionsErrorType.USER_PERMISSION_DENIED):n.BROWSER_CAPABILITIES.edge?"NotAllowedError"===t?s=i.EMediaPermissionsErrorType.USER_PERMISSION_DENIED:"NotReadableError"===t&&(s=i.EMediaPermissionsErrorType.COULD_NOT_START_VIDEO_SOURCE):n.BROWSER_CAPABILITIES.firefox&&("NotFoundError"===t||"NotReadableError"===t?s=i.EMediaPermissionsErrorType.SYSTEM_PERMISSION_DENIED:"NotAllowedError"===t?s=i.EMediaPermissionsErrorType.USER_PERMISSION_DENIED:"AbortError"===t&&(s=i.EMediaPermissionsErrorType.COULD_NOT_START_VIDEO_SOURCE)),r({type:s,name:e.name,message:e.message})})})});return function(t){return e.apply(this,arguments)}}()},1854:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistParserDecryptStage=void 0,t.PlaylistParserDecryptStage=class{constructor(){a(this,"pipelinePosition",void 0)}}},1863:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPrevProjectId=t.getPrevStreamId=t.getPrevUserId=t.getPrevSessionStartTime=t.checkIfPageWasReloaded=t.setSessionStartTime=t.setProjectId=t.setUserId=t.setStreamId=t.setPageUrl=void 0;var r="__mmp_metrics_session_start_time__",n="__mmp_metrics_user_id__",i="__mmp_metrics_stream_id__",o="__mmp_metrics_page_url__",s="__mmp_metrics_project_id__",a=sessionStorage.getItem(i)||"",l=Number(sessionStorage.getItem(r)||"0"),u=sessionStorage.getItem(n),c=Number(u).toString()===u?Number(u):u||"",d=sessionStorage.getItem(o),h=sessionStorage.getItem(s)||"";t.setPageUrl=e=>{sessionStorage.setItem(o,e)},t.setStreamId=e=>{sessionStorage.setItem(i,e),(0,t.setPageUrl)(window.location.toString())},t.setUserId=e=>{sessionStorage.setItem(n,e.toString())},t.setProjectId=e=>{sessionStorage.setItem(s,e.toString())},t.setSessionStartTime=e=>{sessionStorage.setItem(r,e.toString())},t.checkIfPageWasReloaded=()=>{var e;return!!(a&&l&&c&&h&&(null===(e=window)||void 0===e?void 0:e.location.toString())===d)},t.getPrevSessionStartTime=()=>l,t.getPrevUserId=()=>c,t.getPrevStreamId=()=>a,t.getPrevProjectId=()=>h},1882:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(2383),i=r(3098),o=function(e){return"symbol"==typeof e||(0,i.A)(e)&&"[object Symbol]"==(0,n.A)(e)}},1902:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.availableAbrControllerConfigValues=t.defaultAbrControllerConfig=t.EABRRule=void 0,function(e){e.THROUGHPUT_ESTIMATOR="throughputEstimator",e.DROPPED_FRAMES_ESTIMATOR="droppedFramesEstimator",e.INSUFFICIENT_BUFFER="insufficientBuffer",e.MINIMAL_BUFFER_TO_INCREASE="minimalBufferToIncrease",e.DELTA_BUFFER="deltaBuffer",e.MAX_RESOLUTION_ESTIMATOR="maxResolution",e.LADDER_INCREASE_ESTIMATOR="ladderIncrease"}(r||(t.EABRRule=r={})),t.defaultAbrControllerConfig={enabledABRRules:[r.THROUGHPUT_ESTIMATOR,r.MINIMAL_BUFFER_TO_INCREASE,r.INSUFFICIENT_BUFFER,r.MAX_RESOLUTION_ESTIMATOR,r.LADDER_INCREASE_ESTIMATOR],cooldownPeriod:1e4,minimalBufferAmountToSwitchUp:500,isLadderIncrease:!1,bypassCooldownEstimators:[r.MAX_RESOLUTION_ESTIMATOR]},t.availableAbrControllerConfigValues={enabledABRRules:{isMultiple:!0,values:[r.DROPPED_FRAMES_ESTIMATOR,r.THROUGHPUT_ESTIMATOR,r.MINIMAL_BUFFER_TO_INCREASE,r.INSUFFICIENT_BUFFER,r.DELTA_BUFFER,r.MAX_RESOLUTION_ESTIMATOR,r.LADDER_INCREASE_ESTIMATOR]},bypassCooldownEstimators:{isMultiple:!0,values:[r.DROPPED_FRAMES_ESTIMATOR,r.THROUGHPUT_ESTIMATOR,r.MINIMAL_BUFFER_TO_INCREASE,r.INSUFFICIENT_BUFFER,r.DELTA_BUFFER,r.MAX_RESOLUTION_ESTIMATOR,r.LADDER_INCREASE_ESTIMATOR]}}},1917:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(2136),i="object"==typeof self&&self&&self.Object===Object&&self,o=n.A||i||Function("return this")()},1960:function(e,t,r){var n,o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},c=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&o(t,e,r[i]);return l(t,e),t}),d=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Debugger=void 0;var h=r(8169),f=d(r(6073)),p=r(6733),v=r(1085);class g extends h.ConfigConsumer{constructor(e){super("debugger",e),a(this,"_debuggableModules",{}),a(this,"_modulesInfoGatheringInterval",null),a(this,"_debuggerWorker",null),a(this,"_onLifecycleEventReportedListener",void 0),this._onLifecycleEventReportedListener=this._eventBus.subscribe(p.DebuggerEvents.lifecycleEvent,this._onLifecycleEventReported),this.config.enableRemoteDebugging&&this.config.debuggerUrl&&this.config.maxWSConnectionRetries&&this._startDebugger()}registerDebuggableModules(e){this._debuggableModules=i(i({},this._debuggableModules),e)}unregisterDebuggableModules(e){e.forEach(e=>{delete this._debuggableModules[e]})}destroy(){var e;super.destroy(),null!==(e=this._debuggerWorker)&&void 0!==e&&e.disconnect(),this._eventBus.unsubscribe(this._onLifecycleEventReportedListener)}_handleConfigUpdated(e){this._debuggerWorker&&(e.debuggerUrl||e.maxWSConnectionRetries)&&(this._destroyWorker(),this._getDebuggerModule()),!1===e.enableRemoteDebugging&&this._stopDebugger(),e.enableRemoteDebugging&&(this._destroyWorker(),this._getDebuggerModule()),e.modulesStateGatheringPeriod&&(this._disarmSendModulesInfoTimeout(),this._armSendModulesInfoTimeout())}_destroyWorker(){var e;null!==(e=this._debuggerWorker)&&void 0!==e&&e.disconnect(),this._debuggerWorker=null}_startDebugger(){this._getDebuggerModule(),this._armSendModulesInfoTimeout()}_stopDebugger(){this._debuggerWorker&&(this._debuggerWorker.disconnect(),this._disarmSendModulesInfoTimeout())}_sendMessage(e){var t=this;return s(function*(){(yield t._getDebuggerModule()).sendMessage(e)})()}_onConnected(e){this._eventBus.publish(p.DebuggerEvents.debuggerConnected,e),this._armSendModulesInfoTimeout()}_onDisconnected(){this._disarmSendModulesInfoTimeout()}_onLifecycleEventReported(e){this._debuggerWorker&&this.config.enableLifecycleEvents&&this._sendMessage({command:v.ECommand.MODULE_LIFECYCLE_EVENT_AVAILABLE,event:e})}_armSendModulesInfoTimeout(){this._modulesInfoGatheringInterval=globalThis.setInterval(this._sendModulesInfo,this.config.modulesStateGatheringPeriod)}_disarmSendModulesInfoTimeout(){this._modulesInfoGatheringInterval&&globalThis.clearInterval(this._modulesInfoGatheringInterval)}_unzipDebuggableModules(e){var t=i({},e);return Object.values(e).forEach(e=>{e.additionalModules&&(t=i(i({},t),this._unzipDebuggableModules(e.additionalModules)))}),t}_sendModulesInfo(){var e=this._unzipDebuggableModules(this._debuggableModules),t=Object.entries(e).reduce((e,t)=>{var[r,n]=t;return e[r]={additionalInfo:n.additionalInfo,state:n.state,groups:n.groups,status:n.status},e},{});this._sendMessage({command:v.ECommand.MODULES_INFO_AVAILABLE,payload:t})}_getDebuggerModule(){var e=this;return s(function*(){if(!e._debuggerWorker){var{DebuggerWorker:t}=yield Promise.resolve().then(()=>c(r(934)));e._debuggerWorker=new t,e._debuggerWorker.setConfig(e.config.debuggerUrl,e.config.maxWSConnectionRetries,e._onConnected,e._onDisconnected),e._debuggerWorker.connect()}return e._debuggerWorker})()}}t.Debugger=g,u([f.default],g.prototype,"_onConnected",null),u([f.default],g.prototype,"_onDisconnected",null),u([f.default],g.prototype,"_onLifecycleEventReported",null),u([f.default],g.prototype,"_sendModulesInfo",null)},2006:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbrRule=void 0;var o=r(3518),s=i(r(5354));class l extends o.ConfigConsumer{constructor(e,t){super("abrControllerConfig",t),a(this,"_localConfig",void 0),this._localConfig=e,this._applyConfig()}_handleConfigUpdated(e){if(e&&e.abrRules&&this._localConfig)for(var t in this._applyConfig(),e)if(t in this._localConfig)return void this.reset()}destroy(){super.destroy()}_getConfig(){return this._localConfig}_applyConfig(){this.config&&this.config.abrRules&&this._localConfig&&Object.keys(this._localConfig).forEach(e=>{var t=e;t in this.config.abrRules&&(this._localConfig[t]=this.config.abrRules[t])})}}t.AbrRule=l,n([s.default],l.prototype,"destroy",null),n([s.default],l.prototype,"_getConfig",null),n([s.default],l.prototype,"_applyConfig",null)},2015:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.simpleLog=void 0,t.simpleLog=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return console.log(...t.filter(e=>void 0!==e))}},2029:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferMetrics=void 0;var o=r(5976),l=r(8169),u=r(8474),c=r(835),d=r(3109),h=r(180),f=i(r(6073)),p=r(6252),v=r(355);class g extends l.ConfigConsumer{constructor(e){super("bufferController",e),a(this,"state",h.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["buffer","general"]),a(this,"additionalInfo",{}),a(this,"_videoElement",null),a(this,"_checkIntervalId",null),a(this,"_lastCheckTimestamp",0),a(this,"_lastFramesTotal",0),a(this,"_lastFramesDropped",0),a(this,"_lastFramesPlayed",0),a(this,"_lastRealFPS",0),a(this,"_lastPlaybackFPS",0),a(this,"_lastPlaybackPosition",0),a(this,"_lastBufferAmount",0),a(this,"_lastKnownLatencyZeroFrameEncodePosition",0),a(this,"_timeSync",null),a(this,"_domainCache",null),a(this,"_onLatencyExtraInformationAvailableListener",void 0),a(this,"_onEntrypointURLUpdatedListener",void 0),a(this,"_logger",void 0),this._logger=(0,u.Logger)(this._eventBus,"Doppio - BufferMetrics"),this._onLatencyExtraInformationAvailableListener=e.subscribe(v.BufferControllerEvents.latencyExtraInformationAvailable,this._onLatencyExtraInformationAvailable),this._onEntrypointURLUpdatedListener=e.subscribe(c.ResolutionsManagerEvents.entrypointURLUpdated,this._onEntrypointURLUpdated)}destroy(){var e;this._eventBus.unsubscribe(this._onLatencyExtraInformationAvailableListener),this._checkIntervalId&&globalThis.clearInterval(this._checkIntervalId),this._eventBus.unsubscribe(this._onEntrypointURLUpdatedListener),null!==(e=this._timeSync)&&void 0!==e&&e.destroy(),this._timeSync=null}setVideoElement(e){this._videoElement=e,this._rearmInterval()}removeVideoElement(){this._videoElement=null,this._checkIntervalId&&globalThis.clearInterval(this._checkIntervalId)}_handleConfigUpdated(e){Number.isNaN(e.checkMetricsInterval)||this._rearmInterval()}_rearmInterval(){this._checkIntervalId&&globalThis.clearInterval(this._checkIntervalId),this._checkIntervalId=globalThis.setInterval(this._performCheck,this.config.checkMetricsInterval)}_getCurrentBufferAmount(e){if(!this._videoElement)return this._logger.warn("Cannot compute buffer, there is no video element registered"),0;var{currentTime:t,buffered:r}=this._videoElement;return 0===r.length||t>r.end(r.length-1)?0:e?r.end(r.length-1)-t:0}_getCurrentBufferAmountWithoutGaps(e,t){if(!this._videoElement)return this._logger.warn("Cannot compute buffer, there is no video element registered"),0;if(!e)return 0;var{currentTime:r}=this._videoElement;return e.end-r+t.filter(t=>{var{start:r}=t;return r>=e.end}).reduce((e,t)=>e+(t.end-t.start),0)}_performCheck(){var e=this;return s(function*(){var t;if(!e._videoElement)return e._checkIntervalId&&globalThis.clearInterval(e._checkIntervalId),void e._logger.warn("Cannot compute metrics, there is no video element registered");var{creationTime:r,totalVideoFrames:n,droppedVideoFrames:i}=(0,p.getVideoPlaybackQuality)(e._videoElement),{buffered:s,currentTime:a,paused:l,duration:u,playbackRate:c}=e._videoElement,d=r/1e3;if(!e._lastCheckTimestamp)return e._lastCheckTimestamp=d,e._lastFramesTotal=n,e._lastFramesDropped=i,e._lastFramesPlayed=n-i,void(e._lastPlaybackPosition=a);var h=yield(0,o.getTargetBuffer)(e._eventBus),f=(yield(0,o.getPlayingTimeFraction)(e._eventBus))||0,g=n-i,_=d-e._lastCheckTimestamp,m=a-e._lastPlaybackPosition,y=n-e._lastFramesTotal,b=i-e._lastFramesDropped,E=g-e._lastFramesPlayed,S=y/_,T=y/m,C=e._lastRealFPS-S,A=e._lastPlaybackFPS-T,P=Array(s.length).fill(null).map((e,t)=>{var r={start:s.start(t),end:s.end(t),index:t,isCurrentTimeRange:!1};return(r.start<=a&&a<=r.end||l&&0===t)&&(r.isCurrentTimeRange=!0),r}),R=P.find(e=>{var{isCurrentTimeRange:t}=e;return t})||null,O=e._getCurrentBufferAmount(R),L=O<e.config.bufferEdgeThreshold,M=e._lastKnownLatencyZeroFrameEncodePosition?e._lastKnownLatencyZeroFrameEncodePosition+1e3*a:0,w=a>0&&!l&&(O<e.config.bufferStallThreshold||0===m),I=(null==R?void 0:R.index)===P.length-1,D=e._getCurrentBufferAmountWithoutGaps(R,P),N={currentTimestamp:r,currentPlaybackPosition:a,playedVideoFrames:g,totalVideoFramesDelta:y,droppedVideoFramesDelta:b,playedVideoFramesDelta:E,playbackSpeed:c,isOnBufferEdge:L,bufferAmount:O,bufferAmountWithoutGaps:D,totalVideoFrames:n,droppedVideoFrames:i,realFPS:S,playbackFPS:T,timeDelta:_,playbackPositionDelta:m,playingTimeFraction:f,realFPSDelta:C,playbackFPSDelta:A,isStallCandidate:w,bufferedTimeRanges:P,currentTimeRange:R,isInLastBufferedRange:I,knownDuration:u,isPaused:l,targetBuffer:h};M&&null!==(t=e._timeSync)&&void 0!==t&&t.currentCorrectedTime&&!e._videoElement.paused&&y>0&&(N.latency=e._timeSync.currentCorrectedTime-M),e._lastCheckTimestamp=d,e._lastFramesTotal=n,e._lastFramesDropped=i,e._lastFramesPlayed=n-i,e._lastRealFPS=S,e._lastPlaybackFPS=T,e._lastPlaybackPosition=a,e._lastBufferAmount=O,e._eventBus.publish(v.BufferControllerEvents.bufferMetricsAvailable,N),e.additionalInfo=N})()}_onLatencyExtraInformationAvailable(e){var[t,r]=e;!this._timeSync&&this.config.enableG2GLatencyMeasurement&&(this._timeSync=new d.TimeSync(this.config.timeSyncResyncInterval),this._domainCache&&this._timeSync.setUrl(this._domainCache)),this._lastKnownLatencyZeroFrameEncodePosition=r-t/90}_onEntrypointURLUpdated(e){var t,{entrypointURL:r}=e,n=new URL(r).host.split(".").slice(-2).join("."),i=this.config.timeSyncUrlTemplate.replace("{{domain}}",n);null!==(t=this._timeSync)&&void 0!==t&&t.setUrl(i),this._domainCache=i,this._lastKnownLatencyZeroFrameEncodePosition=0}}t.BufferMetrics=g,n([f.default],g.prototype,"_handleConfigUpdated",null),n([f.default],g.prototype,"_performCheck",null),n([f.default],g.prototype,"_onLatencyExtraInformationAvailable",null),n([f.default],g.prototype,"_onEntrypointURLUpdated",null)},2049:(e,t,r)=>{r.d(t,{A:()=>n});var n=Array.isArray},2050:(e,t,r)=>{r.d(t,{A:()=>h});var n=(0,r(124).A)(Object,"create"),i=Object.prototype.hasOwnProperty,o=Object.prototype.hasOwnProperty;function s(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=function(){this.__data__=n?n(null):{},this.size=0},s.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},s.prototype.get=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return i.call(t,e)?t[e]:void 0},s.prototype.has=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)},s.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this};var a=s,l=r(9469),u=r(8335),c=function(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map};function d(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}d.prototype.clear=function(){this.size=0,this.__data__={hash:new a,map:new(u.A||l.A),string:new a}},d.prototype.delete=function(e){var t=c(this,e).delete(e);return this.size-=t?1:0,t},d.prototype.get=function(e){return c(this,e).get(e)},d.prototype.has=function(e){return c(this,e).has(e)},d.prototype.set=function(e,t){var r=c(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};var h=d},2064:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomEventsEmitter=void 0;var i=r(8349),o=r(4578),s=r(6671),l=r(2085);class u extends i.CustomEventTarget{constructor(e){super(),a(this,"_eventsMap",{[o.EVideoElementControllerBusEvent.PLAYING]:this._handlePlaying,[o.EVideoElementControllerBusEvent.LOADING]:this._handleLoading,[o.EVideoElementControllerBusEvent.VIDEO_PAUSE]:this._handlePause,[o.EVideoElementControllerBusEvent.CLICK]:this._handleClick,[o.EVideoElementControllerBusEvent.DESTROY]:this.destroy,[o.EVideoElementControllerBusEvent.NATIVE_EVENT]:this._handleNativeEvent,[o.EVideoElementControllerBusEvent.UPDATE_PLAYER_RESOLUTION]:this._handleUpdatePlayerResolution,[o.EVideoElementControllerBusEvent.VIDEO_PLAYBACK_STATE_CHANGED]:this._handleVideoPlaybackStateChange,[o.EVideoElementControllerBusEvent.TIME_UPDATE_NATIVE]:this._handleTimeUpdate}),a(this,"_eventBus",void 0),this._eventBus=e.eventBus,this.init()}destroy(){this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap})}init(){this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}_handlePlaying(e){this.emitEvent(l.EVideoControllerCustomEvent.PLAYING,e)}_handleLoading(){this.emitEvent(l.EVideoControllerCustomEvent.LOADING,{})}_handlePause(){this.emitEvent(l.EVideoControllerCustomEvent.PAUSE,{})}_handleClick(e){this.emitEvent(l.EVideoControllerCustomEvent.CLICK,{originalEvent:e.originalEvent})}_handleNativeEvent(e){this.emitEvent(l.EVideoControllerCustomEvent.NATIVE_EVENT,e)}_handleUpdatePlayerResolution(e){this.emitEvent(l.EVideoControllerCustomEvent.UPDATE_PLAYER_RESOLUTION,e)}_handleTimeUpdate(e){this.emitEvent(l.EVideoControllerCustomEvent.TIME_UPDATE,e)}_handleVideoPlaybackStateChange(e){this.emitEvent(l.EVideoControllerCustomEvent.VIDEO_PLAYBACK_STATE_CHANGE,{prevState:e.prevState,nextState:e.nextState})}}t.CustomEventsEmitter=u,n([s.bind],u.prototype,"destroy",null),n([s.bind],u.prototype,"init",null),n([s.bind],u.prototype,"_handlePlaying",null),n([s.bind],u.prototype,"_handleLoading",null),n([s.bind],u.prototype,"_handlePause",null),n([s.bind],u.prototype,"_handleClick",null),n([s.bind],u.prototype,"_handleNativeEvent",null),n([s.bind],u.prototype,"_handleUpdatePlayerResolution",null),n([s.bind],u.prototype,"_handleTimeUpdate",null),n([s.bind],u.prototype,"_handleVideoPlaybackStateChange",null)},2080:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(9469),i=r(8335),o=r(2050);function s(e){var t=this.__data__=new n.A(e);this.size=t.size}s.prototype.clear=function(){this.__data__=new n.A,this.size=0},s.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},s.prototype.get=function(e){return this.__data__.get(e)},s.prototype.has=function(e){return this.__data__.has(e)},s.prototype.set=function(e,t){var r=this.__data__;if(r instanceof n.A){var s=r.__data__;if(!i.A||s.length<199)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new o.A(s)}return r.set(e,t),this.size=r.size,this};var a=s},2085:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EVideoControllerCustomEvent=void 0,function(e){e.CLICK="videoElement.click",e.PLAYING="videoElement.playing",e.LOADING="videoElement.loading",e.PAUSE="videoElement.pause",e.VIDEO_PLAYBACK_STATE_CHANGE="videoElement.videoPlaybackStateChange",e.NATIVE_EVENT="videoElement.nativeEvent",e.UPDATE_PLAYER_RESOLUTION="videoElement.updatePlayerResolution",e.TIME_UPDATE="videoElement.timeUpdate"}(r||(t.EVideoControllerCustomEvent=r={}))},2086:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Fragment=void 0;var o=r(8474),s=r(7833),l=r(2883),u=i(r(6073));class c{constructor(e,t,r){var n;a(this,"url",void 0),a(this,"duration",void 0),a(this,"msn",void 0),a(this,"pn",void 0),a(this,"isInitSection",void 0),a(this,"isTransmuxingBypassRequested",void 0),a(this,"independent",void 0),a(this,"startTs",void 0),a(this,"endTs",void 0),a(this,"data",void 0),a(this,"requestedLoadingTimeout",void 0),a(this,"stats",void 0),a(this,"error",void 0),a(this,"_logger",null),a(this,"_shouldLogHistory",!1),a(this,"_eventBus",void 0),a(this,"_history",[]),a(this,"_hasLifecycleEnded",!1),a(this,"_isStuckTimer",null),a(this,"_lastTs",Date.now()),Object.assign(this,e),this._eventBus=t,this._shouldLogHistory=r||!1,this._eventBus&&(this._logger=(0,o.Logger)(this._eventBus,"Doppio - Fragment")),this.duration=e.duration,this.msn=e.msn,this.pn=e.pn,e.playlistUrl||e.fragmentUrl?this.url=c._buildUrl(e.playlistUrl,e.fragmentUrl):this.url=e.url,null!==(n=this._logger)&&void 0!==n&&n.verbose("Fragment ".concat(this.getMsnPn()," created")),this.goToLifecycleStage("created")}getMsnPn(){return"".concat(this.msn,"/").concat(this.pn||0)}goToLifecycleStage(e){var t;if(this._clearStuckTimer(),this._shouldLogHistory&&!this._hasLifecycleEnded){var r=Date.now();this._history.push({event:e,timeSincePreviousEvent:r-this._lastTs}),this._lastTs=r,null!==(t=this._logger)&&void 0!==t&&t.debug("Fragment ".concat(this.getMsnPn()," lifecycle updated: ").concat(e)),"loadDataAborted"===e?(this._hasLifecycleEnded=!0,this._publishHistoryReadyForPrint("Fragments lifecycle: ABORTED")):"addedToBuffer"===e?(this._hasLifecycleEnded=!0,this._publishHistoryReadyForPrint("Fragments lifecycle: SUCCESS")):this._isStuckTimer=setTimeout(this._handleFragmentStuck,3e3)}}static _buildUrl(e,t){if((0,l.isValidURL)(t))return t;var r=new URL(e);if(t.startsWith("/"))return"".concat(r.origin).concat(t);var n=r.pathname.split("/");return n.pop()||n.pop(),"".concat(r.origin,"/").concat(n.concat(t).join("/"))}_handleFragmentStuck(){this._publishHistoryReadyForPrint("Fragments lifecycle: STUCK")}_publishHistoryReadyForPrint(e){var t;null===(t=this._eventBus)||void 0===t||t.publish(s.FragmentLoaderEvents.fragments.fragmentHistoryReadyForPrint,{historyString:"".concat(e," ").concat(this.getMsnPn(),":\n").concat(this._history.map(e=>"Event: ".concat(e.event,", ").concat(e.timeSincePreviousEvent,"ms since previous event")).join("\n"))})}_clearStuckTimer(){this._isStuckTimer&&clearTimeout(this._isStuckTimer)}}t.Fragment=c,n([u.default],c.prototype,"_handleFragmentStuck",null)},2108:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EDeviceType=void 0,function(e){e.VIDEO_INPUT="videoinput",e.AUDIO_INPUT="audioinput",e.AUDIO_OUTPUT="audiooutput"}(r||(t.EDeviceType=r={}))},2136:(e,t,r)=>{r.d(t,{A:()=>n});var n="object"==typeof globalThis&&globalThis&&globalThis.Object===Object&&globalThis},2142:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VODGapController=void 0;var o=r(355),s=r(8169),l=r(2513),u=r(180),c=i(r(6073));class d extends s.ConfigConsumer{constructor(e){super("bufferController",e),a(this,"state",u.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"groups",["buffer"]),a(this,"_videoElement",null),a(this,"_fragments",[]),a(this,"_lastPlaybackPosition",0),a(this,"_numberOfDetectedStallCandidates",0),a(this,"_onBufferMetricsReadyListener",void 0),a(this,"_onVODFragmentInfoAvailableListener",void 0),this._onBufferMetricsReadyListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable),this._onVODFragmentInfoAvailableListener=this._eventBus.subscribe(l.BasePlaylistRotationControllerEvents.playlists.vodFragmentsInfo,this._onVODFragmentsInfoAvailable)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onBufferMetricsReadyListener),this._eventBus.unsubscribe(this._onVODFragmentInfoAvailableListener)}setVideoElement(e){this._videoElement=e}removeVideoElement(){this._videoElement=null}_handleConfigUpdated(){}_onVODFragmentsInfoAvailable(e){this._fragments=e.map(e=>{var{fragmentEndTS:t,fragmentStartTS:r}=e;return{startTs:r,endTs:t}})}_onBufferMetricsAvailable(e){var t;if(this._fragments.length&&e.bufferedTimeRanges&&(null===(t=this._videoElement)||void 0===t||!t.paused)){var r=this._lastPlaybackPosition!==e.currentPlaybackPosition;this._lastPlaybackPosition=e.currentPlaybackPosition,r?this._numberOfDetectedStallCandidates=0:this._numberOfDetectedStallCandidates+=1;var n=!e.bufferedTimeRanges.some(e=>{var{isCurrentTimeRange:t}=e;return t}),i=!r&&this.config.numberOfCandidatesToDetectGap<=this._numberOfDetectedStallCandidates;if(n||i){var o,s,a=(null===(o=this._fragments.find(t=>{var{startTs:r}=t;return r>e.currentPlaybackPosition}))||void 0===o?void 0:o.startTs)||-1,l=(null===(s=e.bufferedTimeRanges.find(t=>{var{start:r}=t;return r>e.currentPlaybackPosition}))||void 0===s?void 0:s.start)||-1;a===l&&this._videoElement&&(this._videoElement.currentTime=l+.01,this._numberOfDetectedStallCandidates=0)}}}}t.VODGapController=d,n([c.default],d.prototype,"destroy",null),n([c.default],d.prototype,"_onVODFragmentsInfoAvailable",null),n([c.default],d.prototype,"_onBufferMetricsAvailable",null)},2189:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddStartBitrate=void 0;var n=r(6972),i=r(5323);t.AddStartBitrate=class{constructor(e){a(this,"_startBitrate",void 0),this._startBitrate=e}modify(e){var t=(0,n.convertBitratesToSDPLines)({startBitrate:this._startBitrate});return(0,i.addH264Bitrate)(t,e)}}},2222:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DeltaBufferEstimator=void 0;var o=r(8169),s=r(2513),l=r(180),u=i(r(6073));class c extends o.ConfigConsumer{constructor(e){super("deltaBufferEstimator",e),a(this,"status","Idle"),a(this,"state",l.EDebuggableModuleState.OK),a(this,"additionalInfo",{}),a(this,"groups",["abr"]),a(this,"_numberOfFalls",0),a(this,"_lastKnownBufferAmount",0),a(this,"_currentBufferAmount",0),a(this,"_onPlaylistParsedListener",void 0),this._onPlaylistParsedListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlists.playlistInfo,this._onPlaylistParsed)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onPlaylistParsedListener),this.reset()}reset(){this._numberOfFalls=0}getNextEstimatedResolution(e,t,r){return this._currentBufferAmount=r.bufferAmount,!t||this._numberOfFalls<this.config.numberOfFallsToDetect?null:e[Math.max(0,e.findIndex(e=>{var{name:r}=e;return r===t.name})-1)]}_handleConfigUpdated(){this._numberOfFalls=0}_onPlaylistParsed(){var{_currentBufferAmount:e,_lastKnownBufferAmount:t}=this;this._lastKnownBufferAmount=e,e>t&&(this._numberOfFalls=0);var r=t/e;r>1+this.config.bufferDeltaFractionToDetectFall&&this._numberOfFalls++,this.additionalInfo={numberOfFalls:this._numberOfFalls,bufferDelta:r}}}t.DeltaBufferEstimator=c,n([u.default],c.prototype,"_onPlaylistParsed",null)},2223:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BroadcastDispatcher=void 0;var o=r(6805),l=r(1388),u=r(6126),c=r(3518),d=r(5130),h=r(3947),f=r(9476),p=r(3566),v=r(5417),g=r(942),_=r(5380),m=r(3),y=r(2868),b=r(2712),E=r(7691),S=i(r(5354)),T=r(4335),C=r(480),A=r(1178),P=r(1222),R=r(5740);class O extends c.ConfigConsumer{constructor(e){super("broadcastDispatcherConfig",e),a(this,"_metadataConnectionUrl",null),a(this,"_streamId",null),a(this,"_publishCustomData",null),a(this,"_streamToken",null),a(this,"_mediaStream",null),a(this,"_isReady",!1),a(this,"_metadataTransport",null),a(this,"_peerConnection",null),a(this,"_peerConnectionWasOnline",!1),a(this,"_hasStarted",!1),a(this,"_metadataTransportReconnectAttempts",0),a(this,"_broadcastingRestartAttempts",0),a(this,"_broadcastingSoftRestartAttempts",0),a(this,"_appKey",""),a(this,"_broadcastStatus",u.EBroadcastStatus.UNKNOWN),a(this,"_publisherReportInterval",null),a(this,"_peerConfigOverride",{}),a(this,"_shouldUseTURNServers",!0),a(this,"_isTransportConnected",!1),a(this,"_probingCacheKey",null),a(this,"_timeSyncServerURLCache",""),a(this,"_regularBroadcastStopReason",""),a(this,"_onTransportStateChangedListener",void 0),a(this,"_onNegotiationRequestedListener",void 0),a(this,"_onRemoteSdpReceivedListener",void 0),a(this,"_onPeerConnectionStateChangedListener",void 0),a(this,"_onStreamUnavailableListener",void 0),a(this,"_broadcastLogs",void 0),a(this,"_onPublishFailedListener",void 0),a(this,"_onUnpublishStreamApprovedListener",void 0),a(this,"_onPeerConfigOverrideAvailable",void 0),a(this,"_onRequireStreamRestartListener",void 0),a(this,"_onInboundVideoRateReceivedListener",void 0),a(this,"_sdpPlayingModifier",new y.SDPModifier),a(this,"_logger",void 0),this._logger=(0,o.Logger)(this._eventBus,"Ristretto - BroadcastDispatcher"),this._broadcastLogs=new T.BroadcastLogs(e),this._logger.info("Created"),this._onTransportStateChangedListener=this._eventBus.subscribe(f.EMetadataTransportEvents.TRANSPORT_STATE_CHANGED,this._onTransportStateChanged),this._onNegotiationRequestedListener=this._eventBus.subscribe(g.EPeerConnectionEvents.NEGOTIATION_REQUIRED,this._onNegotiationRequested),this._onRemoteSdpReceivedListener=this._eventBus.subscribe(f.EMetadataTransportEvents.REMOTE_SDP_RECEIVED,this._onRemoteSdpReceived),this._onPeerConnectionStateChangedListener=this._eventBus.subscribe(g.EPeerConnectionEvents.CONNECTION_STATE_CHANGED,this._onPeerConnectionStateChanged),this._onPublishFailedListener=this._eventBus.subscribe(f.EMetadataTransportEvents.PUBLISH_FAILED,this._onPublishFailed),this._onStreamUnavailableListener=this._eventBus.subscribe(f.EMetadataTransportEvents.STREAM_UNAVAILABLE,this._onStreamUnavailable),this._onUnpublishStreamApprovedListener=this._eventBus.subscribe(f.EMetadataTransportEvents.UN_PUBLISH_STREAM_APPROVED,this._onUnpublishStreamApproved),this._onPeerConfigOverrideAvailable=this._eventBus.subscribe(f.EMetadataTransportEvents.PEER_CONFIG_AVAILABLE,this._onPeerConfigAvailable),this._onRequireStreamRestartListener=this._eventBus.subscribe(b.EStreamDispatcherEvent.REQUIRE_STREAM_RESTART,this._restartStreamIfPossible),this._onInboundVideoRateReceivedListener=this._eventBus.subscribe(f.EMetadataTransportEvents.INBOUND_VIDEO_RATE_RECEIVED,this._onInboundVideoRateReceived);var t=[new _.AddMinmaxBitrates(this.config.bitrate,this.config.bitrate,this.config.bitrate,this.config.bitrateThreshold)];this.config.enableStereoAudio&&t.push(new m.AddStereoModifier),this._sdpPlayingModifier.setModifiersChain(t)}destroy(){var e;super.destroy(),this.stop(),null!==(e=this._metadataTransport)&&void 0!==e&&e.destroy("Entrypoint destroy"),this._metadataTransport=null,this._broadcastLogs.destroy(),this._eventBus.unsubscribe(this._onTransportStateChangedListener),this._eventBus.unsubscribe(this._onNegotiationRequestedListener),this._eventBus.unsubscribe(this._onRemoteSdpReceivedListener),this._eventBus.unsubscribe(this._onPeerConnectionStateChangedListener),this._eventBus.unsubscribe(this._onPublishFailedListener),this._eventBus.unsubscribe(this._onStreamUnavailableListener),this._eventBus.unsubscribe(this._onUnpublishStreamApprovedListener),this._eventBus.unsubscribe(this._onPeerConfigOverrideAvailable),this._eventBus.unsubscribe(this._onRequireStreamRestartListener),this._eventBus.unsubscribe(this._onInboundVideoRateReceivedListener),this._logger.info("Destroyed")}setAppKey(e){this._logger.info("App key updated: ".concat(this._appKey," -> ").concat(e)),this._appKey=e,this._metadataTransport&&console.warn("You set the appKey while ws connection is live!")}start(){return this._isReady?(this._logger.debug("Broadcaster already is live. Skipping start"),!0):(this._logger.info("Starting broadcast"),this._metadataConnectionUrl?this._streamId?(this._metadataTransport?(this._logger.debug("Metadata transport is already available. Creating peer connection"),this._preparePeerConnection()):(this._logger.debug("No metadata transport already created. Creating new one"),this._metadataTransport=this._createMetadataTransport()),this._setIsStarted(!0),!0):(this._logger.fatal("Stream ID is not defined. Cannot start broadcasting"),!1):(this._logger.fatal("Metadata connection URL is not defined. Cannot start broadcasting"),!1))}setRegularBroadcastStopReason(e){this._regularBroadcastStopReason=e}stop(e){this._logger.info("Stopping broadcast"),this._isTransportConnected=!1,this._broadcastStatus!==u.EBroadcastStatus.UNKNOWN?(this._setNewStatus(u.EBroadcastStatus.FINISHED),this._streamId&&(this._logger.debug("Requesting MMS to stop broadcast"),this._eventBus.publish(C.EBroadcastLogsEvents.REPORT_EVENT,{event:A.EBroadcastLogsEvent.UNPUBLISH_REQUESTED,description:"Stop method of entrypoint called with reason ".concat(e,", requesting unpublish")}),this._eventBus.publishSync(f.EMetadataTransportEvents.UN_PUBLISH_STREAM,{streamId:this._streamId,regularBroadcastStopReason:this._regularBroadcastStopReason})),this._setIsStarted(!1),this._isReady=!1):this._logger.debug("It seems that broadcast did not started yet. Nothing to stop")}toggleTURNServersUsage(e){this._shouldUseTURNServers!==e&&(this._shouldUseTURNServers=e,this._setNewStatus(u.EBroadcastStatus.FINISHED),this._logger.info("TURN servers usage has been switched. Restarting peer connection"),this._createPeerConnection())}setMetadataConnectionUrl(e,t){if(this._metadataConnectionUrl!==e){try{var r=new URL(e);this._timeSyncServerURLCache="https://".concat(r.host)}catch(e){this._logger.warn("Could not parse metadata connection url",e)}this._logger.info("Metadata connection url updated: ".concat(this._metadataConnectionUrl," -> ").concat(e)),this._metadataConnectionUrl=e,t||(this._logger.debug("Requesting to restart flow: metadata connection url has been changed"),this.stop(),this._restartFlow("setMetadataConnectionUrl"))}}setStreamId(e,t){this._streamId!==e&&(this._broadcastLogs.setStreamId(e),this._peerConfigOverride={},this._logger.info("Stream id updated: ".concat(this._streamId," -> ").concat(e)),this._streamId=e,t||(this._logger.debug("Requesting to restart flow: stream id has been changed"),this.stop(),this._restartFlow("setStreamId")))}setProbingCacheKey(e){this._probingCacheKey=e}setPublishCustomData(e,t){this._publishCustomData=e,this._logger.info("Custom data for publish updated: ".concat(JSON.stringify(this._publishCustomData)," -> ").concat(JSON.stringify(e))),t||(this._logger.debug("Requesting to restart flow: custom data for publish has been changed"),this.stop(),this._restartFlow("setPublishCustomData"))}setMediaStream(e){var t;this._mediaStream!==e&&(this._logger.info("Media stream updated"),this._mediaStream=e,null===(t=this._peerConnection)||void 0===t||t.setStream(e))}setStreamToken(e,t){this._streamToken!==e&&(this._logger.info("Stream token updated: ".concat(this._streamToken," -> ").concat(e)),this._streamToken=e,t||(this._logger.debug("Requesting to restart flow: stream token has been changed"),this.stop(),this._restartFlow("setStreamToken")))}setStreamConfig(e){var t,r,n=!1;this._logger.info("Stream config updated",e),void 0!==e.mediaStream&&(null===(t=e.mediaStream)||void 0===t?void 0:t.id)!==(null===(r=this._mediaStream)||void 0===r?void 0:r.id)&&this.setMediaStream(e.mediaStream),e.probingCacheKey&&(this._probingCacheKey=e.probingCacheKey),void 0!==e.streamId&&e.streamId!==this._streamId&&(n=!0,this.setStreamId(e.streamId,!0)),void 0!==e.customData&&JSON.stringify(e.customData)!==JSON.stringify(this._publishCustomData)&&(n=!0,this.setPublishCustomData(e.customData,!0)),void 0!==e.wsUrl&&e.wsUrl!==this._metadataConnectionUrl&&(n=!0,this.setMetadataConnectionUrl(e.wsUrl,!0)),void 0!==e.streamToken&&e.streamToken!==this._streamToken&&(n=!0,this.setStreamToken(e.streamToken,!0)),this._hasStarted&&n&&this._broadcastStatus!==u.EBroadcastStatus.CONNECTING&&(this.stop(),this.start())}_handleConfigUpdated(e){if(this._togglePublisherReportInterval(),e.bitrate||e.bitrateThreshold||e.enableStereoAudio){var t=[new _.AddMinmaxBitrates(this.config.bitrate,this.config.bitrate,this.config.bitrate,this.config.bitrateThreshold)];this.config.enableStereoAudio&&t.push(new m.AddStereoModifier),this._sdpPlayingModifier.setModifiersChain(t)}}_restartFlow(e){this._broadcastingRestartAttempts=0,this._broadcastingSoftRestartAttempts=0,this._checkIsReadyToStart()&&(this._logger.debug("Restarting flow with reason ".concat(e)),this._peerConnection&&(this._logger.debug("Peer connection has been created previously. Destroying one"),this._peerConnection.destroy("Entrypoint restart flow (".concat(e,")")),this._peerConnection=null),this._metadataTransport&&(this._logger.debug("Metadata transport has been created previously. Destroying one"),this._metadataTransport.destroy("Entrypoint restart flow (".concat(e,")")),this._metadataTransport=null,this._createMetadataTransport()))}_checkIsReadyToStart(){return!!this._metadataConnectionUrl&&!!this._streamId}_setNewStatus(e){e!==this._broadcastStatus&&(this._logger.info("Broadcast status updated: ".concat(this._broadcastStatus," -> ").concat(e)),this._eventBus.publish(P.ECommonEvent.BROADCAST_STATE_CHANGED,{prevState:this._broadcastStatus,nextState:e}),this._broadcastStatus=e,this._togglePublisherReportInterval())}_onTransportStateChanged(e){var t,{prevState:r,nextState:n}=e;this._logger.debug("Transport state changed: ".concat(r," -> ").concat(n)),n===d.EMetadataTransportState.DISCONNECTED&&this._onTransportDisconnected(),n===d.EMetadataTransportState.IDLE&&r===d.EMetadataTransportState.UNKNOWN&&null!==(t=this._metadataTransport)&&void 0!==t&&t.startOverWithoutReconnect("transportStateChanged - unknownToIdle"),n===d.EMetadataTransportState.CONNECTED&&this._onTransportConnected()}_onNegotiationRequested(e){var t,{sdp:r}=e;this._broadcastingRestartAttempts=0,this._streamId?r.sdp?this._streamToken?(this._logger.info("Request SDP negotiation"),null!==(t=this._peerConnection)&&void 0!==t&&t.setLocalDescription(r),this._eventBus.publish(f.EMetadataTransportEvents.SEND_BROADCAST_SDP,{sdp:r.sdp,streamId:this._streamId,publishCustomData:this._publishCustomData,token:this._streamToken,maxBitrate:this.config.bitrate+this.config.bitrateThreshold,minBitrate:this.config.bitrate-this.config.bitrateThreshold,probingCacheKey:this._probingCacheKey})):this._logger.error("Stream token is empty"):this._logger.error("SDP is empty"):this._logger.error("Could not send sdp offer without stream id specified")}_onPublishFailed(e){var{reason:t}=e;this._logger.warn("Publish failed with reason ".concat(t)),this.stop(),this._eventBus.publish(P.ECommonEvent.COMMON_ERROR,{error:new R.RistrettoPlayerError(R.EErrorDomain.DISPATCHER,R.EErrorType.COULD_NOT_PUBLISH,!0,t)})}_onRemoteSdpReceived(e){var t,{sdp:r}=e;this._logger.info("Remote sdp received. See SDP in debug level"),this._logger.debug("Client received a remote sdp from server and going to set it to the peer connection",{sdp:r}),null===(t=this._peerConnection)||void 0===t||t.setRemoteDescription({sdp:r,type:"answer"})}_onPeerConnectionStateChanged(e){var{nextState:t,prevState:r}=e;this._logger.debug("Peer connection state changed: ".concat(r," -> ").concat(t)),t===p.EPeerConnectionState.ONLINE&&(this._peerConnectionWasOnline=!0,this._broadcastingSoftRestartAttempts=0,this._setNewStatus(u.EBroadcastStatus.CONNECTED)),[p.EPeerConnectionState.DISCONNECTING,p.EPeerConnectionState.FAILED].includes(t)&&(this._peerConnectionWasOnline?(this._logger.warn("Peer connection reported an error. Trying to restart one"),this._restartStreamIfPossible({errorOptions:{reason:"Peer connection disconnected"}})):(this._logger.warn("Peer connection reported an error while no live status detected previously"),this.stop()))}_onStreamUnavailable(e){var{reason:t,recoverable:r}=e;this._logger.warn("MMS reported stream as unavailable with reason ".concat(t)),this._restartStreamIfPossible({errorOptions:{reason:"Stream unavailable. ".concat(t),errorType:R.EErrorType.COULD_NOT_PUBLISH,recoverable:r}})}_onInboundVideoRateReceived(e){var{fps:t}=e;this._broadcastStatus===u.EBroadcastStatus.CONNECTED&&t>0&&this._setNewStatus(u.EBroadcastStatus.LIVE),this._broadcastStatus===u.EBroadcastStatus.LIVE&&0===t&&this._setNewStatus(u.EBroadcastStatus.CONNECTED)}_restartStreamIfPossible(e){var t=this;return s(function*(){var{errorOptions:r}=e;if(t._logger.verbose("There was an error during broadcast. Will consider restarting.",r),t._setNewStatus(u.EBroadcastStatus.ERRORED),null!=r&&r.recoverable&&t._isTransportConnected&&t._broadcastingSoftRestartAttempts<t.config.broadcastingSoftRestartMaxAttempts)return yield(0,E.exponentialAwait)(1,t.config.broadcastingRestartBaseTimeout),t._broadcastStatus!==u.EBroadcastStatus.ERRORED?void t._logger.verbose("Broadcast status has been changed from errored to ".concat(t._broadcastStatus,". We won't restart")):void t._restartSoft();if(-1!==t.config.broadcastingRestartMaxAttempts&&t._broadcastingRestartAttempts>=t.config.broadcastingRestartMaxAttempts)t._logger.verbose("Restarts limit has been reached. We won't restart"),t._eventBus.publish(P.ECommonEvent.COMMON_ERROR,{error:new R.RistrettoPlayerError(R.EErrorDomain.DISPATCHER,(null==r?void 0:r.errorType)||R.EErrorType.COMMON,!0,null==r?void 0:r.reason)});else{if(yield(0,E.exponentialAwait)(1,t.config.broadcastingRestartBaseTimeout),t._broadcastStatus!==u.EBroadcastStatus.ERRORED)return void t._logger.verbose("Broadcast status has been changed from errored to ".concat(t._broadcastStatus,". We won't restart"));t._restartHard()}})()}_restartHard(){var e;this._broadcastingRestartAttempts+=1,null===(e=this._metadataTransport)||void 0===e||e.startOverWithoutReconnect("hardRestart")}_restartSoft(){this._broadcastingSoftRestartAttempts+=1,this._createPeerConnection()}_onUnpublishStreamApproved(){var e;this._logger.debug("Unpublish stream approved. Destroying peer connection"),null!==(e=this._peerConnection)&&void 0!==e&&e.destroy("unpublish approved"),this._peerConnection=null}_createMetadataTransport(){return this._isTransportConnected=!1,this._logger.info("Creating metadata transport"),this._setNewStatus(u.EBroadcastStatus.CONNECTING),this._metadataTransport=new h.MetadataTransport(this._eventBus),this._metadataTransport.setDispatcherStatus(this._hasStarted),this._metadataConnectionUrl&&this._metadataTransport.setWebsocketServerUrl(this._metadataConnectionUrl),this._appKey||console.warn("AppKey isnt defined!!1"),this._metadataTransport.setAppKey(this._appKey),this._metadataTransport.setStreamId(this._streamId),this._metadataTransport}_onTransportDisconnected(){var e=this;return s(function*(){var t,r;if(null!==(t=e._peerConnection)&&void 0!==t&&t.destroy("transport disconnected"),e._peerConnection=null,null!==(r=e._metadataTransport)&&void 0!==r&&r.destroy("transport disconnected"),e._metadataTransport=null,e._isTransportConnected=!1,e._metadataTransportReconnectAttempts>=e.config.metadataReconnectMaxAttempts)return e._setNewStatus(u.EBroadcastStatus.FINISHED),void e._eventBus.publish(P.ECommonEvent.COMMON_ERROR,{error:new R.RistrettoPlayerError(R.EErrorDomain.METADATA_TRANSPORT,R.EErrorType.COULD_NOT_CONNECT_TO_METADATA_TRANSPORT,!0,"Maximum number of attempts exceeded")});e._metadataTransportReconnectAttempts+=1,e._logger.debug("Metadata transport disconnected. Trying to reconnect with delay"),yield(0,E.exponentialAwait)(1,e.config.metadataReconnectBaseTimeout),e._broadcastStatus!==u.EBroadcastStatus.FINISHED&&e._createMetadataTransport()})()}_onTransportConnected(){this._isTransportConnected=!0,this._logger.info("Transport connected. New peer connection should be created"),this._preparePeerConnection()}_preparePeerConnection(){this._streamId&&this._createPeerConnection()}_createPeerConnection(){var e;this._logger.debug("Creating peer connection"),this._peerConnectionWasOnline=!1,null!==(e=this._peerConnection)&&void 0!==e&&e.destroy("create peer connection"),this._peerConnection=null,this._peerConnection=new v.PeerConnection(this._eventBus,!0),this._peerConnection.setPeerConfigOverride(this._shouldUseTURNServers?this._peerConfigOverride:{iceServers:[],iceTransportPolicy:"all"}),this._peerConnection.setSDPLocalModifier(this._sdpPlayingModifier),this._peerConnection.createTransmitConnection(),this._timeSyncServerURLCache&&this._peerConnection.setTimeSyncServer(this._timeSyncServerURLCache),this._mediaStream&&this._peerConnection.setStream(this._mediaStream)}_sendPublisherReport(){var e=this;return s(function*(){var t,r=yield null===(t=e._peerConnection)||void 0===t?void 0:t.getRawPeerStats();if(r){var n,i,o,s,a,u=(0,l.getSortedPeerStats)(r),c={timestamp:Date.now(),videoBytesSent:null===(n=u.video["outbound-rtp"])||void 0===n?void 0:n.bytesSent,videoFramesSent:null===(i=u.video["outbound-rtp"])||void 0===i?void 0:i.framesSent,videoPacketsSent:null===(o=u.video["outbound-rtp"])||void 0===o?void 0:o.packetsSent,audioBytesSent:null===(s=u.audio["outbound-rtp"])||void 0===s?void 0:s.bytesSent,audioPacketsSent:null===(a=u.audio["outbound-rtp"])||void 0===a?void 0:a.packetsSent};e._eventBus.publish(f.EMetadataTransportEvents.SEND_PUBLISHER_REPORT,{payload:c})}})()}_togglePublisherReportInterval(){this.config.enableBackendStreamQualityRecognition&&[u.EBroadcastStatus.LIVE,u.EBroadcastStatus.CONNECTED].includes(this._broadcastStatus)?this._enablePublisherReportInterval():this._disablePublisherReportInterval()}_enablePublisherReportInterval(){this._disablePublisherReportInterval(),this.config.publisherReportInterval&&(this._publisherReportInterval=setInterval(this._sendPublisherReport,this.config.publisherReportInterval))}_disablePublisherReportInterval(){this._publisherReportInterval&&clearInterval(this._publisherReportInterval)}_setIsStarted(e){var t;this._hasStarted=e,null===(t=this._metadataTransport)||void 0===t||t.setDispatcherStatus(this._hasStarted)}_onPeerConfigAvailable(e){var t,{config:r}=e;this._peerConfigOverride=r,null===(t=this._peerConnection)||void 0===t||t.setPeerConfigOverride(this._peerConfigOverride)}}t.BroadcastDispatcher=O,n([S.default],O.prototype,"_onTransportStateChanged",null),n([S.default],O.prototype,"_onNegotiationRequested",null),n([S.default],O.prototype,"_onPublishFailed",null),n([S.default],O.prototype,"_onRemoteSdpReceived",null),n([S.default],O.prototype,"_onPeerConnectionStateChanged",null),n([S.default],O.prototype,"_onStreamUnavailable",null),n([S.default],O.prototype,"_onInboundVideoRateReceived",null),n([S.default],O.prototype,"_restartStreamIfPossible",null),n([S.default],O.prototype,"_restartHard",null),n([S.default],O.prototype,"_restartSoft",null),n([S.default],O.prototype,"_onUnpublishStreamApproved",null),n([S.default],O.prototype,"_sendPublisherReport",null),n([S.default],O.prototype,"_onPeerConfigAvailable",null)},2259:function(e,t,r){var n,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),s=0;s<r.length;s++)"default"!==r[s]&&i(t,e,r[s]);return o(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.getDebuggerWorker=void 0;var l=r(7691);t.getDebuggerWorker=s(function*(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=0,i=function(){var o=s(function*(){try{return yield Promise.resolve().then(()=>a(r(4699)))}catch(r){if(n>=e)throw r;return yield(0,l.exponentialAwait)(n,t),n++,i()}});return function(){return o.apply(this,arguments)}}();return i()})},2302:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkCodecsSupported=void 0;var n=r(6805),i=r(5851),o=r(6768);t.checkCodecsSupported=function(){var e=s(function*(e,t){try{var r="play"===e?"recvonly":"sendonly",s=new(n.WebRTCCommonHelpers.resolveRTCPeerConnection())({iceServers:[]});(0,o.isTransceiverAvailableAndWorking)(s)&&(s.addTransceiver("audio",{direction:r}),s.addTransceiver("video",{direction:r}));var a=(0,o.isTransceiverAvailableAndWorking)(s)?{}:{offerToReceiveAudio:"play"===e,offerToReceiveVideo:"play"===e},l=yield s.createOffer(a),u=(0,i.extractCodecsFromSDP)(l);return t.filter(e=>u.includes(e))}catch(e){return[]}});return function(t,r){return e.apply(this,arguments)}}()},2305:(e,t,r)=>{var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.TIME_SYNC_READABLE_UUID=t.hasInsertableStreamsSupport=void 0;var o=r(5732);t.hasInsertableStreamsSupport=Boolean(null===globalThis||void 0===globalThis?void 0:globalThis.RTCRtpScriptTransform)||Boolean(null===globalThis||void 0===globalThis||null===(n=globalThis.RTCRtpSender)||void 0===n?void 0:n.prototype.createEncodedStreams)&&Boolean(null===globalThis||void 0===globalThis||null===(i=globalThis.RTCRtpReceiver)||void 0===i?void 0:i.prototype.createEncodedStreams),t.TIME_SYNC_READABLE_UUID=(0,o.formatUUID)(new Uint8Array([8,44,150,143,119,94,73,180,141,85,164,41,236,217,137,213]))},2345:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferChunksCache=void 0;var n=r(8169);class i extends n.ConfigConsumer{constructor(e){super("bufferController",e),a(this,"_cache",[]),a(this,"_lastMsn",-1)}append(e){var t=this,r=function(){if(t._cache.length){if(n.msn!==t._lastMsn){var e=n.msn-t.config.saveLastSegmentsCount+1;t._cache=[...t._cache.filter(t=>t.isInitSection||t.msn>=e),n]}else t._cache.push(n);t._lastMsn=n.msn}else n.isInitSection&&(t._cache=[n])};for(var n of e)r()}getAll(){return this._cache}reset(){this._cache=[],this._lastMsn=-1}destroy(){super.destroy(),this._cache=[],this._lastMsn=-1}}t.BufferChunksCache=i},2346:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EUserMediaEvent=void 0,function(e){e[e.MEDIA_DEVICES_UPDATED=0]="MEDIA_DEVICES_UPDATED"}(r||(t.EUserMediaEvent=r={}))},2383:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(241),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=n.A?n.A.toStringTag:void 0,l=Object.prototype.toString,u=n.A?n.A.toStringTag:void 0,c=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":u&&u in Object(e)?function(e){var t=o.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var i=s.call(e);return n&&(t?e[a]=r:delete e[a]),i}(e):function(e){return l.call(e)}(e)}},2395:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LegacyEvents=void 0;var o=r(835),s=r(2513),l=r(7833),u=r(5395),c=r(3871),d=i(r(6073)),h=r(6733);class f{constructor(e,t){var r;a(this,"_eventBus",void 0),a(this,"_isResolutionSelected",!1),a(this,"_sendEvent",void 0),a(this,"_onPlaylistLoadingStartedListener",void 0),a(this,"_onPlaylistLoadedListener",void 0),a(this,"_onPlaylistParsedListener",void 0),a(this,"_onFragmentLoadedListener",void 0),a(this,"_onDebuggerConnectedListener",void 0),a(this,"_onResolutionChangedListener",void 0),a(this,"_onResolutionChangedAutoListener",void 0),a(this,"_onNetworkRequestSettledListener",void 0),a(this,"_isDebugEnabled",void 0),this._eventBus=t,this._sendEvent=e,this._isDebugEnabled=null===(r=document)||void 0===r||null===(r=r.cookie)||void 0===r?void 0:r.includes("__mmpDebug__=1"),this._onPlaylistLoadingStartedListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlists.playlistRequested,this._onPlaylistLoadingStarted),this._onResolutionChangedListener=this._eventBus.subscribe(o.ResolutionsManagerEvents.resolutionChanged,this._onResolutionChanged),this._onResolutionChangedAutoListener=this._eventBus.subscribe(o.ResolutionsManagerEvents.resolutionAutoChanged,this._onResolutionAutoChanged),this._onPlaylistLoadedListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlists.playlistLoaded,this._onPlaylistLoaded),this._onPlaylistParsedListener=this._eventBus.subscribe(s.BasePlaylistRotationControllerEvents.playlists.playlistInfo,this._onPlaylistInfoAvailable),this._onFragmentLoadedListener=this._eventBus.subscribe(l.FragmentLoaderEvents.fragments.fragmentLoaded,this._onFragmentLoaded),this._onDebuggerConnectedListener=this._eventBus.subscribe(h.DebuggerEvents.debuggerConnected,this._onDebuggerConnected),this._onNetworkRequestSettledListener=this._eventBus.subscribe(u.NetworkLoaderEvent.events.networkRequestSettled,this._onNetworkRequestSettled)}destroy(){this._eventBus.unsubscribe(this._onPlaylistLoadingStartedListener),this._eventBus.unsubscribe(this._onPlaylistLoadedListener),this._eventBus.unsubscribe(this._onPlaylistParsedListener),this._eventBus.unsubscribe(this._onFragmentLoadedListener),this._eventBus.unsubscribe(this._onDebuggerConnectedListener),this._eventBus.unsubscribe(this._onResolutionChangedListener),this._eventBus.unsubscribe(this._onResolutionChangedAutoListener),this._eventBus.unsubscribe(this._onNetworkRequestSettledListener)}_onPlaylistLoadingStarted(){this._isResolutionSelected||this._sendEvent(new CustomEvent(c.EEvent.MANIFEST_LOADING))}_onResolutionChanged(){this._isResolutionSelected=!0}_onPlaylistLoaded(e){var{originalUrl:t,realUrl:r,stats:n}=e;this._isResolutionSelected?this._sendEvent(new CustomEvent(c.EEvent.LEVEL_LOADED,{detail:{netStats:n}})):this._sendEvent(new CustomEvent(c.EEvent.MANIFEST_LOADED,{detail:{originalUrl:t,realUrl:r}}))}_onPlaylistInfoAvailable(e){this._sendEvent(new CustomEvent(c.EEvent.MANIFEST_PARSED,{detail:e}))}_onFragmentLoaded(e){this._sendEvent(new CustomEvent(c.EEvent.FRAG_LOADED,{detail:{netStats:e.stats,duration:e.duration}}))}_onDebuggerConnected(e){this._sendEvent(new CustomEvent(c.EEvent.DEBUGGER_CONNECTED,{detail:{panelUrl:e}}))}_onResolutionAutoChanged(e){var{prevResolution:t,nextResolution:r}=e;this._sendEvent(new CustomEvent(c.EEvent.LEVEL_SWITCHED_AUTO,{detail:{prevResolution:t,nextResolution:r}}))}_onNetworkRequestSettled(e){this._isDebugEnabled&&globalThis.dispatchEvent(new CustomEvent("mmpFetchSettled",{detail:{requestInfo:e}}))}}t.LegacyEvents=f,n([d.default],f.prototype,"_onPlaylistLoadingStarted",null),n([d.default],f.prototype,"_onResolutionChanged",null),n([d.default],f.prototype,"_onPlaylistLoaded",null),n([d.default],f.prototype,"_onPlaylistInfoAvailable",null),n([d.default],f.prototype,"_onFragmentLoaded",null),n([d.default],f.prototype,"_onDebuggerConnected",null),n([d.default],f.prototype,"_onResolutionAutoChanged",null),n([d.default],f.prototype,"_onNetworkRequestSettled",null)},2456:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerOpenObserveTransport=t.checkLogLevel=void 0;var o=r(6805),l=r(942),u=i(r(5354)),c=["verbose","debug","info","warn","error","fatal"];t.checkLogLevel=(e,t)=>c.indexOf(t)>=c.indexOf(e);class d{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"debug";a(this,"_unsentMsgCache",[]),a(this,"_unsentMsgBuffer",[]),a(this,"_sessionId",null),a(this,"_streamId",null),a(this,"_mode",null),a(this,"_lastRTCReport",[]),a(this,"_isSendingNow",!1),a(this,"_onLogMessageReceivedToken",void 0),a(this,"_onRawRTCStatsAvailableToken",void 0),a(this,"_collectorEndpoint",void 0),a(this,"_checkLogsInterval",setInterval(this._checkLogs,3e4)),a(this,"_requestRawStatsInterval",setInterval(this._requestRawStats,1e3)),a(this,"_sendRawStatsInterval",setInterval(this._sendRawStats,1e4)),a(this,"_minimalLoggerLevel",void 0),a(this,"_eventBus",void 0),this._eventBus=e,this._collectorEndpoint=t,this._onLogMessageReceivedToken=this._eventBus.subscribe(o.ELoggerEvents.LOG,this._onMessageReceived),this._onRawRTCStatsAvailableToken=this._eventBus.subscribe(l.EPeerConnectionEvents.RAW_STATS_AVAILABLE,this._onPeerConnectionStatsAvailable),this._minimalLoggerLevel=r}destroy(){this._eventBus.unsubscribe(this._onLogMessageReceivedToken),this._eventBus.unsubscribe(this._onRawRTCStatsAvailableToken),clearInterval(this._checkLogsInterval),clearInterval(this._requestRawStatsInterval),clearInterval(this._sendRawStatsInterval),this._checkLogs(!0)}setStreamId(e){e!==this._streamId&&(this._streamId&&this._onMessageReceived({domain:"Log",timestamp:Date.now(),level:"info",message:"Stream ID has been updated: ".concat(this._streamId," -> ").concat(e,". Resetting session."),payload:{}}),this._generateNewSessionId(),this._streamId=e)}setMode(e){this._mode!==e&&(this._mode&&this._onMessageReceived({domain:"Log",timestamp:Date.now(),level:"info",message:"Mode has been updated: ".concat(this._mode," -> ").concat(e,". Resetting session."),payload:{}}),this._generateNewSessionId(),this._mode=e)}_generateNewSessionId(){this._sessionId=(Math.random()+1).toString(36).substring(7)}_onMessageReceived(e){if(this._sessionId&&this._streamId&&this._mode&&(0,t.checkLogLevel)(this._minimalLoggerLevel,e.level)){var r={sessionId:this._sessionId,streamId:this._streamId,timestamp:Date.now(),event:"[".concat(e.domain,"] ").concat(e.level),description:e.message,mode:this._mode,details:JSON.stringify(e.payload)};this._isSendingNow?this._unsentMsgBuffer.push(r):this._unsentMsgCache.push(r)}}_onPeerConnectionStatsAvailable(e){var{stats:t}=e;t&&(this._lastRTCReport=[...t.values()])}_requestRawStats(){this._eventBus.publish(l.EPeerConnectionEvents.RAW_STATS_REQUIRED,{})}_sendRawStats(){if(this._lastRTCReport){var e=!!this._lastRTCReport.find(e=>{var{type:t}=e;return"inbound-rtp"===t}),t=this._lastRTCReport.filter(t=>{var{type:r}=t;return r===(e?"inbound-rtp":"outbound-rtp")}),r=t.filter(e=>{var{kind:t}=e;return"audio"===t}),n=t.filter(e=>{var{kind:t}=e;return"video"===t}),i={rtpStats:{mode:e?"receive":"broadcast"},transports:[]};this._lastRTCReport.filter(e=>{var{type:t}=e;return"transport"===t}).forEach(e=>{var t=e,r=this._lastRTCReport.filter(e=>"codec"===e.type&&e.transportId===t.id),n=this._lastRTCReport.filter(e=>"local-candidate"===e.type&&e.transportId===t.id),o=this._lastRTCReport.filter(e=>"remote-candidate"===e.type&&e.transportId===t.id),s=this._lastRTCReport.filter(e=>"candidate-pair"===e.type&&e.transportId===t.id);i.transports.push({codecs:r.map(e=>({sdpFmtpLine:e.sdpFmptLine,mimeType:e.mimeType})),dtlsState:t.dtlsState,bytesSent:t.bytesSent,packetsSent:t.packetsSent,bytesReceived:t.bytesReceived,packetsReceived:t.packetsReceived,dtlsRole:t.dtlsRole,iceRole:t.iceRole,iceState:t.iceState,candidateParis:s.map(e=>({isSelected:t.selectedCandidatePairId===e.id,state:e.state,nominated:e.nominated||!1,bytesSent:e.bytesSent,bytesReceived:e.bytesReceived,localCandidateId:e.localCandidateId,remoteCandidateId:e.remoteCandidateId,totalRoundTripTime:e.totalRoundTripTime,currentRoundTripTime:e.currentRoundTripTime,availableOutgoingBitrate:e.availableOutgoingBitrate,availableIncomingBitrate:e.availableIncomingBitrate,requestsReceived:e.requestsReceived,requestsSent:e.requestsSent,responsesReceived:e.responsesReceived,responsesSent:e.responsesSent})),candidates:{local:n.map(e=>({networkType:e.networkType,address:e.address,ip:e.ip,id:e.id,port:e.port,protocol:e.protocol,candidateType:e.candidateType,tcpType:e.tcpType})),remote:o.map(e=>({networkType:e.networkType,address:e.address,ip:e.ip,id:e.id,port:e.port,protocol:e.protocol,candidateType:e.candidateType,tcpType:e.tcpType}))}})}),n&&(i.rtpStats.videoFrames=n.reduce((t,r)=>t+((e?r.framesReceived:r.framesSent)||0),0),i.rtpStats.videoPackets=n.reduce((t,r)=>t+((e?r.packetsReceived:r.packetsSent)||0),0)),r&&(i.rtpStats.audioPackets=r.reduce((t,r)=>t+((e?r.packetsReceived:r.packetsSent)||0),0)),this._onMessageReceived({domain:"RTPStats",timestamp:Date.now(),level:"info",message:"RTP stats ready",payload:i})}}_checkLogs(e){var t=this;return s(function*(){try{if(!t._unsentMsgBuffer.length&&!t._unsentMsgCache.length)return;t._isSendingNow=!0,e&&Boolean(navigator.sendBeacon)?navigator.sendBeacon(t._collectorEndpoint,JSON.stringify({flfyRistrettoLogs:t._unsentMsgCache})):yield fetch(t._collectorEndpoint,{method:"POST",mode:"cors",body:JSON.stringify({flfyRistrettoLogs:t._unsentMsgCache})}),t._unsentMsgCache=[...t._unsentMsgBuffer],t._unsentMsgBuffer=[],t._isSendingNow=!1}catch(e){t._isSendingNow=!1}})()}}t.LoggerOpenObserveTransport=d,n([u.default],d.prototype,"_onMessageReceived",null),n([u.default],d.prototype,"_onPeerConnectionStatsAvailable",null),n([u.default],d.prototype,"_requestRawStats",null),n([u.default],d.prototype,"_sendRawStats",null),n([u.default],d.prototype,"_checkLogs",null)},2461:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availablePeerConnectionConfigValues=t.defaultPeerConnectionConfig=void 0,t.defaultPeerConnectionConfig={awaitForIceGatheringBeforeSignalling:!1,closeNativeConnectionOnDestroy:!0,bundlePolicy:"balanced",iceCandidatePoolSize:0,iceServers:[],iceTransportPolicy:"relay",rtcpMuxPolicy:"require",statsCollectionScheme:{},setIceServersForFirefox:!1,statsGatheringPeriod:500,playoutDelayHint:void 0,timeSyncResyncInterval:-1,enableG2GLatencyMeasurement:!1,timeSyncUrlTemplate:"//time.{{domain}}/time"},t.availablePeerConnectionConfigValues={bundlePolicy:{isMultiple:!1,values:["balanced","max-bundle","max-compat"]},iceTransportPolicy:{isMultiple:!1,values:["all","relay"]}}},2464:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableTargetBufferDecreaserConfigValues=t.defaultTargetBufferDecreaserConfig=void 0,t.defaultTargetBufferDecreaserConfig={periodOfEventsToCancelDecrease:1e4},t.availableTargetBufferDecreaserConfigValues={}},2502:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.AbstractWrapper=void 0;var i=r(3362),o=r(6805);class l{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,"_videoElement",null),a(this,"_lastKnownConfig",{}),a(this,"_lastKnownStreamConfig",null),a(this,"_playerInstance",null),a(this,"_eventBusInstance",void 0),a(this,"_isStarted",void 0),a(this,"_isAbrEnabled",void 0),a(this,"_appKey",void 0),a(this,"_metricsCollector",null),a(this,"_persistent",void 0),this._eventBusInstance=e,this._eventBusInstance.publish(i.EPlayersEvents.MODULE_LOADED,{}),this._persistent=!!t.persistent}setMetricsCollector(e){this._metricsCollector=e}destroy(){return this._destroyPlayerInstance(),this._isStarted=!1,this}setAppKey(e){return this._appKey=e,this}setVideoElement(e){var t;return this._videoElement=e,e&&null!==(t=this._playerInstance)&&void 0!==t&&t.setVideoElement(e),this}recreatePlayerInstance(){var e=this;return s(function*(){e._playerInstance&&(e.destroy(),e._playerInstance=null),yield e._createPlayerInstance()})()}start(){var e=this;return s(function*(){var t;return e._playerInstance||(yield e.recreatePlayerInstance()),null!==(t=e._playerInstance)&&void 0!==t&&t.start(),e._isStarted=!0,e})()}stop(){return this._isStarted=!1,this._persistent&&this._playerInstance&&"stop"in this._playerInstance?this._playerInstance.stop():this._destroyPlayerInstance(),this}setPlayerConfig(e){var t;return this._lastKnownConfig=e,null!==(t=this._playerInstance)&&void 0!==t&&t.setConfig(e,!0),this}_destroyPlayerInstance(){this._playerInstance&&(this._detachEventListeners(),this._playerInstance.destroy(),this._playerInstance=null)}}t.AbstractWrapper=l,n([o.AsyncGuarderDecorator],l.prototype,"recreatePlayerInstance",null),n([o.AsyncGuarderDecorator],l.prototype,"start",null)},2512:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Debugger=void 0;var l=r(3518),u=r(2259),c=o(r(5354)),d=r(5148),h=r(2646);class f extends l.ConfigConsumer{constructor(e){super("debugger",e),a(this,"_debuggableModules",{}),a(this,"_modulesInfoGatheringInterval",null),a(this,"_debuggerWorker",null),a(this,"_onLifecycleEventReportedListener",void 0),this._onLifecycleEventReportedListener=this._eventBus.subscribe(d.EDebuggerEvent.LIFECYCLE_EVENT,this._onLifecycleEventReported),this.config.enableRemoteDebugging&&this.config.debuggerUrl&&this.config.maxWSConnectionRetries&&this._startDebugger()}registerDebuggableModules(e){this._debuggableModules=i(i({},this._debuggableModules),e)}unregisterDebuggableModules(e){e.forEach(e=>{delete this._debuggableModules[e]})}destroy(){var e;super.destroy(),null!==(e=this._debuggerWorker)&&void 0!==e&&e.disconnect(),this._eventBus.unsubscribe(this._onLifecycleEventReportedListener)}_handleConfigUpdated(e){this._debuggerWorker&&(e.debuggerUrl||e.maxWSConnectionRetries)&&(this._destroyWorker(),this._getDebuggerModule()),!1===e.enableRemoteDebugging&&this._stopDebugger(),e.enableRemoteDebugging&&(this._destroyWorker(),this._getDebuggerModule()),e.modulesStateGatheringPeriod&&(this._disarmSendModulesInfoTimeout(),this._armSendModulesInfoTimeout())}_startDebugger(){this._getDebuggerModule(),this._armSendModulesInfoTimeout()}_stopDebugger(){this._debuggerWorker&&(this._debuggerWorker.disconnect(),this._disarmSendModulesInfoTimeout())}_destroyWorker(){var e;null!==(e=this._debuggerWorker)&&void 0!==e&&e.disconnect(),this._debuggerWorker=null}_sendMessage(e){var t=this;return s(function*(){(yield t._getDebuggerModule()).sendMessage(e)})()}_onConnected(e){this._eventBus.publish(d.EDebuggerEvent.DEBUGGER_CONNECTED,e),this._armSendModulesInfoTimeout()}_onDisconnected(){this._disarmSendModulesInfoTimeout()}_onLifecycleEventReported(e){this._debuggerWorker&&this._sendMessage({command:h.ECommand.MODULE_LIFECYCLE_EVENT_AVAILABLE,event:e})}_armSendModulesInfoTimeout(){this._modulesInfoGatheringInterval=globalThis.setInterval(this._sendModulesInfo,this.config.modulesStateGatheringPeriod)}_disarmSendModulesInfoTimeout(){this._modulesInfoGatheringInterval&&globalThis.clearInterval(this._modulesInfoGatheringInterval)}_unzipDebuggableModules(e){var t=i({},e);return Object.values(e).forEach(e=>{e.additionalModules&&(t=i(i({},t),this._unzipDebuggableModules(e.additionalModules)))}),t}_sendModulesInfo(){var e=this._unzipDebuggableModules(this._debuggableModules),t=Object.entries(e).reduce((e,t)=>{var[r,n]=t;return e[r]={additionalInfo:n.additionalInfo,state:n.state,status:n.status},e},{});this._sendMessage({command:h.ECommand.MODULES_INFO_AVAILABLE,payload:t})}_getDebuggerModule(){var e=this;return s(function*(){if(!e._debuggerWorker){var{DebuggerWorker:t}=yield(0,u.getDebuggerWorker)();e._debuggerWorker=new t,e._debuggerWorker.setConfig(e.config.debuggerUrl,e.config.maxWSConnectionRetries,e._onConnected,e._onDisconnected),e._debuggerWorker.connect()}return e._debuggerWorker})()}}t.Debugger=f,n([c.default],f.prototype,"_onConnected",null),n([c.default],f.prototype,"_onDisconnected",null),n([c.default],f.prototype,"_onLifecycleEventReported",null),n([c.default],f.prototype,"_sendModulesInfo",null)},2513:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BasePlaylistRotationControllerEvents=void 0,t.BasePlaylistRotationControllerEvents={playlistType:{multivariantDetected:"basePlaylistRotator.playlistType.multivariantDetected",simpleDetected:"basePlaylistRotator.playlistType.simpleDetected",llDetected:"basePlaylistRotator.playlistType.llDetected",vodDetected:"basePlaylistRotator.playlistType.vodDetected"},playlists:{playlistRequested:"basePlaylistRotator.playlists.playlistRequested",playlistLoaded:"basePlaylistRotator.playlists.playlistLoaded",playlistLoadingError:"basePlaylistRotator.playlists.playlistLoadingError",playlistParsed:"basePlaylistRotator.playlists.playlistLoadingError",playlistInfo:"basePlaylistRotator.playlists.playlistInfo",vodFragmentsInfo:"basePlaylistRotator.playlists.VODFragmentsInfo",independenceTypeUpdate:"basePlaylistRotator.playlists.independenceTypeUpdate",renditionReportsUpdated:"basePlaylistRotator.playlists.renditionReportsUpdated",lastPlaylistOfSegmentLoaded:"basePlaylistRotator.playlists.lastPlaylistOfSegmentLoaded"},fragments:{fragmentsDetected:"basePlaylistRotator.fragments.fragmentsDetected",requestReleaseFromCache:"basePlaylistRotator.fragments.requestReleaseFromCache",periodFragmentsFound:"basePlaylistRotator.fragments.periodFragmentsFound"}}},2534:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ENetworkLoadFetchNetworkEvent=void 0,function(e){e.FETCH="fetch",e.ABORT="abort",e.DESTROY="destroy",e.DATA_READY="dataReady",e.STATS_READY="statsReady",e.CHANGE_STATE="changeState",e.ERROR="error",e.REDIRECT_DETECTED="redirectDetected"}(r||(t.ENetworkLoadFetchNetworkEvent=r={}))},2564:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isTrackEmpty=void 0;var n=r(6914);t.isTrackEmpty=e=>{if(!e)return!0;var{muted:t,enabled:r,readyState:i}=e;return t||!r||i===n.EMediaStreamTrackState.ENDED}},2621:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistPostParseDecryptStage=void 0;var n=r(1854);class i extends n.PlaylistParserDecryptStage{constructor(){super(...arguments),a(this,"pipelinePosition","postParse")}}t.PlaylistPostParseDecryptStage=i},2628:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.InactivityReconnectManager=void 0;var i=r(6805),o=r(3518),s=r(5354);class l extends o.ConfigConsumer{constructor(e,t){super("IInactivityReconnectConfig",e),a(this,"_timeouts",void 0),a(this,"_callback",void 0),a(this,"_logger",void 0),this._logger=(0,i.Logger)(this._eventBus,"Ristretto - InactivityReconnectManager"),this._timeouts=new Map,this._callback=t,this._logger.info("Created")}arm(e){this._logger.verbose("Arm inactivity watchdog for event ".concat(e)),this.disarm(e);var t=setTimeout(()=>this._handleInactivity(e),this.config.inactivityTimeout);this._timeouts.set(e,t)}disarm(e){this._logger.verbose("Disarm inactivity watchdog for event ".concat(e));var t=this._timeouts.get(e);t&&(clearTimeout(t),this._timeouts.delete(e))}destroy(){for(var e of(super.destroy(),this._logger.info("Destroyed"),this._timeouts.values()))clearTimeout(e)}_handleInactivity(e){for(var t of(this._logger.warn("Recreating the connection due to event: ".concat(e)),this._timeouts.values()))clearTimeout(t);this._callback()}}t.InactivityReconnectManager=l,n([s.bind],l.prototype,"_handleInactivity",null)},2634:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}},2646:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ECommand=void 0,function(e){e.CONNECT_TO_ROOM="connectToRoom",e.MODULES_INFO_AVAILABLE="modulesInfoAvailable",e.MODULE_LIFECYCLE_EVENT_AVAILABLE="moduleLifecycleEventAvailable",e.CLIENT_CONNECTED="clientConnected",e.CLIENT_INFO_AVAILABLE="clientInfoAvailable",e.CLIENT_DISCONNECTED="clientDisconnected"}(r||(t.ECommand=r={}))},2661:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments.length<=0?void 0:arguments[0])?1:Number(arguments.length<=0?void 0:arguments[0]);return t?Array.prototype.reduce.call(this,function(r,n){return Array.isArray(n)?r.push(...e.call(n,t-1)):r.push(n),r},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(){return this.map(...arguments).flat()},writable:!0})},2683:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.combineArrayBuffers=t.findBoxesInArrayBuffer=void 0,t.findBoxesInArrayBuffer=e=>{for(var t=new DataView(e),r=0,n=[];r<e.byteLength;){var i=t.getUint32(r,!1),o={size:i,name:(new TextDecoder).decode(e.slice(r+4,r+8)),payload:e.slice(r+8,r+i)};r+=i,n.push(o)}return n},t.combineArrayBuffers=e=>{var t=e.reduce((e,t)=>e+t.byteLength,0),r=new Uint8Array(t);return e.reduce((e,t)=>(r.set(new Uint8Array(t),e),e+t.byteLength),0),r.buffer}},2702:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.emulatePlayOnVideoElement=t.getVideoElement=void 0;var r=null;t.getVideoElement=()=>r||(r=document.createElement("video")),t.emulatePlayOnVideoElement=()=>(0,t.getVideoElement)().play()},2712:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EStreamDispatcherEvent=void 0,function(e){e.MEDIA_STREAM_AVAILABLE="streamDispatcher.mediaStreamAvailable",e.REQUIRE_STREAM_RESTART="streamDispatcher.requireStreamRestart"}(r||(t.EStreamDispatcherEvent=r={}))},2726:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventBus=void 0;var n=r(83);class i extends n.EventBus{}t.EventBus=i},2733:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferStallsDetector=void 0;var o=r(355),s=r(8169),l=i(r(6073));class u extends s.ConfigConsumer{constructor(e){super("bufferStallsDetector",e),a(this,"_isPrevCheckStalled",!1),a(this,"_onBufferMetricsAvailableListener",void 0),this._onBufferMetricsAvailableListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onBufferMetricsAvailableListener)}_handleConfigUpdated(){}_onBufferMetricsAvailable(e){var{isStallCandidate:t,bufferedTimeRanges:r,currentPlaybackPosition:n}=e,i=r.slice(-1)[0],s=i?i.end-n:0,a=t&&s<this.config.bufferAmountToDetectStall;this._isPrevCheckStalled!==a&&(this._isPrevCheckStalled=a,this._eventBus.publish(o.BufferControllerEvents.playbackStallChanged,a))}}t.BufferStallsDetector=u,n([l.default],u.prototype,"destroy",null),n([l.default],u.prototype,"_handleConfigUpdated",null),n([l.default],u.prototype,"_onBufferMetricsAvailable",null)},2750:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableDeltaBufferEstimatorConfigValues=t.defaultDeltaBufferEstimatorConfig=void 0,t.defaultDeltaBufferEstimatorConfig={bufferDeltaFractionToDetectFall:.1,numberOfFallsToDetect:2},t.availableDeltaBufferEstimatorConfigValues={}},2789:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e){return function(t){return e(t)}}},2862:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableWebsocketTransportConfigValues=t.defaultWebsocketTransportConfig=void 0,t.defaultWebsocketTransportConfig={isQueueAllowed:!0,maxConnectRetries:10,pendingStateConnectionTimeout:5e3},t.availableWebsocketTransportConfigValues={}},2868:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SDPModifier=void 0;var n=r(6510);t.SDPModifier=class{constructor(){a(this,"_modifiersChain",[new n.DummyModifier])}setModifiersChain(e){this._modifiersChain=e}addModifier(e){this._modifiersChain.push(e)}clearChain(){this._modifiersChain=[new n.DummyModifier]}modifySdp(e){return this._modifiersChain.length?this._modifiersChain.reduce((e,t)=>t.modify(e),e):e}}},2883:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isValidURL=void 0,t.isValidURL=e=>{try{var t=new URL(e);return Boolean(t.origin)}catch(e){return!1}}},2886:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeElementFromDocument=t.noop=t.applyVolumeToVideoElement=void 0,t.applyVolumeToVideoElement=(e,t)=>{if(!t||t<0)e.muted=!0,e.volume=0;else{var r=Math.min(t,1);isNaN(r)||(e.muted=!1,e.volume=r)}},t.noop=()=>{},t.removeElementFromDocument=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)}},2911:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.awaitForStopConfirmation=void 0;var n=r(9476);t.awaitForStopConfirmation=e=>new Promise(t=>{e.subscribeOnce(n.EMetadataTransportEvents.STREAM_STOP_APPROVED,()=>{t()})})},2916:()=>{function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){var r=this.event&&this.event.type,n="unload"===r||"beforeunload"===r,i="XMLHttpRequest"in this?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");i.open("POST",e,!n),i.withCredentials=!0,i.setRequestHeader("Accept","*/*"),"string"==typeof t?(i.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),i.responseType="text"):t instanceof Blob&&t.type&&i.setRequestHeader("Content-Type",t.type);try{i.send(t)}catch(e){return!1}return!0}(function(){"navigator"in this||(this.navigator={}),"function"!=typeof this.navigator.sendBeacon&&(this.navigator.sendBeacon=t.bind(this))}).call("object"===("undefined"==typeof window?"undefined":e(window))?window:{})},2945:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FpsRule=void 0;var n=r(6805),i=r(2006);class o extends i.AbrRule{constructor(e){super({maxFPSToAssumeZero:0,maxReportsOfZeroFpsBeforeLowerQuality:0},e),a(this,"_nearZeroReportsAmount",0),a(this,"_fpsWasPositive",!1),a(this,"_logger",void 0),this._logger=(0,n.Logger)(e,"ABR/Rules/FPS"),this._logger.info("Created")}handleStats(e){var t=e.framesPerSecond||0;this._logger.verbose("Reported FPS is ".concat(t,", threshold is ").concat(this._getConfig().maxFPSToAssumeZero)),t<this._getConfig().maxFPSToAssumeZero?(this._nearZeroReportsAmount++,this._logger.verbose("FPS is low. Near zero reports amount increased. New value is ".concat(this._nearZeroReportsAmount))):(this._logger.verbose("FPS restored. Rolling back near zero reports"),this._fpsWasPositive=!0,this._nearZeroReportsAmount=0)}getResult(){var e;return this._logger.verbose("Rule result requested"),this._fpsWasPositive||(e=0),e=this._nearZeroReportsAmount<this._getConfig().maxReportsOfZeroFpsBeforeLowerQuality?0:-1,this._logger.debug("Calculated result is ".concat(e)),{name:"fps",value:e}}reset(){this._logger.verbose("Rule reset requested"),this._fpsWasPositive=!1,this._nearZeroReportsAmount=0}}t.FpsRule=o},2973:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EWMA=void 0,t.EWMA=class{constructor(e,t){a(this,"_previousFastValue",null),a(this,"_previousSlowValue",null),a(this,"_fastAlpha",void 0),a(this,"_slowAlpha",void 0),this._fastAlpha=e,this._slowAlpha=t}addValue(e){var{_fastAlpha:t,_slowAlpha:r}=this;this._previousFastValue=t*e+(1-t)*(this._previousFastValue||e),this._previousSlowValue=r*e+(1-r)*(this._previousSlowValue||e)}getCurrentValue(){return this._previousSlowValue&&this._previousFastValue?Math.min(this._previousFastValue,this._previousSlowValue):0}getCurrentMaximalValue(){return this._previousFastValue&&this._previousSlowValue?Math.max(this._previousSlowValue,this._previousFastValue):0}reset(){this._previousSlowValue=null,this._previousFastValue=null}}},2995:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncGuarder=void 0,t.AsyncGuarder=class{constructor(){a(this,"_currentPromise",null)}run(e){return this._currentPromise||(this._currentPromise=new Promise((t,r)=>{Promise.resolve().then(()=>e()).then(e=>{this._currentPromise=null,t(e)}).catch(e=>{this._currentPromise=null,r(e)})})),this._currentPromise}}},3050:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableThroughputEstimatorValues=t.defaultThroughputEstimatorConfig=void 0,t.defaultThroughputEstimatorConfig={optimalResolutionLowerBound:.45,optimalResolutionUpperBound:.88,amountOfFragmentToBecomeConfident:15},t.availableThroughputEstimatorValues={}},3060:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RunningAverage=void 0,t.RunningAverage=class{constructor(){a(this,"_avg",0),a(this,"_count",0)}addValue(e){this._count++,this._avg+=(e-this._avg)/this._count}reset(){var e=this._avg;return this._avg=0,this._count=0,e}get avg(){return this._avg}}},3064:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InsufficientBufferEstimator=void 0;var n=r(8169),i=r(180);class o extends n.ConfigConsumer{constructor(e){super("insufficientBufferEstimator",e),a(this,"status","Idle"),a(this,"state",i.EDebuggableModuleState.OK),a(this,"groups",["abr"]),a(this,"additionalInfo",{}),a(this,"_hasPassedMinimalBuffer",!1)}destroy(){super.destroy()}reset(){this._hasPassedMinimalBuffer=!1}getNextEstimatedResolution(e,t,r){var n=r.bufferAmount>this.config.minimalBufferAmount;!this._hasPassedMinimalBuffer&&n&&(this._hasPassedMinimalBuffer=!0);var i=!this.config.ignoreMetricsBeforeBufferExceedsMinimal||this._hasPassedMinimalBuffer;if(this.additionalInfo.isResultsConfident=i,this.additionalInfo.isBufferExceedsMinimal=n,this.additionalInfo.hasPassedMinimalBuffer=this._hasPassedMinimalBuffer,!i||n||!t)return null;this._hasPassedMinimalBuffer=!1;var o=e.slice(-1)[0],s=t.url===o.url?t:e[e.findIndex(e=>{var{name:r}=e;return r===t.name})+1];return this.config.switchToMinimalResolution?o:s}_handleConfigUpdated(){this._hasPassedMinimalBuffer=!1}}t.InsufficientBufferEstimator=o},3098:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e){return null!=e&&"object"==typeof e}},3102:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EMetricsEvents=void 0,function(e){e.SESSION_ID_RECREATED="sessionIdRecreated",e.UPSCALE_CALCULATED="upscaleCalculated",e.VIDEO_ELEMENT_DIMENSIONS_CALCULATED="videoElementDimensionsCalculated"}(r||(t.EMetricsEvents=r={}))},3109:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeSync=void 0,t.TimeSync=class{constructor(e){a(this,"_timeServerURL",null),a(this,"_retryTimeoutId",null),a(this,"_positionAtZero",0),a(this,"_abortController",new AbortController),a(this,"_resyncInterval",-1),this._resyncInterval=e}setUrl(e){this._timeServerURL=e,this._retryTimeoutId&&clearTimeout(this._retryTimeoutId),this._checkDrift()}destroy(){this._abortController.abort(),this._retryTimeoutId&&clearTimeout(this._retryTimeoutId)}_checkDrift(){var t=this;return s(function*(){if(t._timeServerURL)try{var r=yield fetch("".concat(t._timeServerURL,"?orig=doppio"),{cache:"no-cache",signal:t._abortController.signal});if(!r.ok)throw new Error("Could not get time sync response: ".concat(r.status));var n=performance.now(),i=0,o=performance.getEntriesByName("".concat(t._timeServerURL,"/time"))[0],{requestStart:s,responseStart:a,responseEnd:l}=o||{};s&&a&&l&&(i=(a-s)/2+(l-a),performance.clearResourceTimings());var u=1e3*Number(yield r.text());t._positionAtZero=u+i-n,t._retryTimeoutId&&clearTimeout(t._retryTimeoutId),t._resyncInterval>-1&&(t._retryTimeoutId=setTimeout(()=>t._checkDrift(),t._resyncInterval))}catch(e){if(t._retryTimeoutId&&clearTimeout(t._retryTimeoutId),"AbortController"===e.name)return;t._retryTimeoutId=setTimeout(()=>t._checkDrift(),1e3)}})()}get currentCorrectedTime(){return this._positionAtZero>0?Math.round(this._positionAtZero+performance.now()):Date.now()}}},3136:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoplayController=void 0;var i=r(6847),o=r(4578),s=r(6671),l=0;class u{constructor(e){a(this,"_config",{}),a(this,"_logger",void 0),a(this,"_eventsMap",{[o.EVideoElementControllerBusEvent.CAN_PLAY]:this._checkAutoplayEnabled,[o.EVideoElementControllerBusEvent.DESTROY]:this.destroy,[o.EVideoElementControllerBusEvent.FORCE_PLAY_AFTER_PAUSE]:this._forcePlayAfterPause,[o.EVideoElementControllerBusEvent.RESET_CHECKING_AUTOPLAY_COUNT]:this._resetCheckingAutoplayCount}),a(this,"_state",void 0),a(this,"_eventBus",void 0),this._state=e.state,this._eventBus=e.eventBus,this._logger=(0,i.Logger)(this._eventBus,"VideoElementController - AutoplayController"),this._logger.info("Created"),this._logger.debug("Initial config",this._config),this._logger.debug("Initial state",this._state),this.init()}setConfig(e){this._logger.debug("Config update received, the new one:",e),this._config=e}destroy(){this._logger.info("Destroying"),this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap})}init(){this._logger.info("Initialization requested, attaching eventBus listeners"),this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}_handleConfigUpdated(){}_forcePlayAfterPause(e){if(void 0===this._config.autoplay||this._config.autoplay){this._logger.verbose("Trying to force video to play. Reason: ".concat(e.reason));var t=this._state.getState();!t.startedPlaying||t.isPlaying||this._config.canBePaused?this._logger.verbose("Currently unable to autoplay the video"):this._checkAutoplayEnabled()}else this._logger.verbose("Autoplay is disabled.")}_checkAutoplayEnabled(){if(this._logger.debug("Checking if autoplay is possible"),this._state.getState().canPlay)if(void 0===this._config.autoplay||this._config.autoplay){if(l>this._config.limitCheckingAutoplay)return this._logger.verbose("Unable to autoplay the video. The limit of autoplay checking (".concat(this._config.limitCheckingAutoplay,") is exceeded")),void this._eventBus.publish(o.EVideoElementControllerBusEvent.PAUSED,{});l+=1,this._logger.verbose("Autoplay is used to play the video"),this._eventBus.publish(o.EVideoElementControllerBusEvent.VIDEO_START,{})}else this._logger.verbose("Autoplay is disabled.");else this._logger.verbose("No canPlay event caught, skipping check")}_resetCheckingAutoplayCount(){l=0}}t.AutoplayController=u,n([s.bind],u.prototype,"destroy",null),n([s.bind],u.prototype,"init",null),n([s.bind],u.prototype,"_forcePlayAfterPause",null),n([s.bind],u.prototype,"_checkAutoplayEnabled",null),n([s.bind],u.prototype,"_resetCheckingAutoplayCount",null)},3149:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3153:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(){return[]}},3154:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),r(1743),r(9979),r(6868),r(4264),r(2661)},3161:(e,t,r)=>{r.d(t,{A:()=>n});var n=r(1917).A["__core-js_shared__"]},3205:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AsyncGuarderDecorator=function(e,t,r){var i=r.value,o=Symbol(t.toString());return r.value=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var s=this[o];s||(s=new n.AsyncGuarder,this[o]=s),s.run(()=>{try{var e=i.apply(this,t);return Promise.resolve(e)}catch(t){return Promise.reject(t)}})},r};var n=r(2995)},3229:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentsFilterEvents=void 0,t.FragmentsFilterEvents={fragmentsReleased:"fragmentsFilter.fragmentsReleased",problemDetected:"fragmentsFilter.problemDetected"}},3241:function(e,t,r){var n,o=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsCollector=void 0,r(2916);var l=r(398),u=r(8376),c=r(3102),d=r(1863),h=r(5307),f=r(6805),p=r(8602),v=r(1470),g=r(5810),_={audioJitter:"AudioJitter",videoJitter:"VideoJitter",buffer:"Buffer",framesEncoded:"FramesEncoded",framesSent:"FramesSent",targetBuffer:"TargetBuffer",chunkLoadDuration:"ChunkLoadDuration",chunkLoadTTFB:"ChunkLoadTTFB",playlistLoadDuration:"PlaylistLoadDuration",playlistLoadTTFB:"PlaylistLoadTTFB",chunkSize:"ChunkSize",playlistSize:"PlaylistSize"},m={latency:"Latency"},y={framesDecoded:"framesDecoded",nackCount:"nackCount",totalFreezesDuration:"totalFreezesDuration",totalPausesDuration:"totalPausesDuration",fecPacketsReceived:"fecPacketsReceived",fecPacketsDiscarded:"fecPacketsDiscarded",framesReceived:"framesReceived",packetsLost:"packetsLost",packetsDiscarded:"packetsDiscarded",packetsReceived:"packetsReceived",totalFramesDecoded:"totalFramesDecoded",totalFramesDropped:"totalFramesDropped",upscaleFactorAvg:"upscaleFactorAvg",upscaleFactorMax:"upscaleFactorMax"},b=Number(null===(n=window)||void 0===n?void 0:n.localStorage.getItem("__mmpMetricsSendInterval__"))||3e4;class E{constructor(e,t,r){a(this,"_userId",null),a(this,"_sessionStartTime",null),a(this,"_playerType",null),a(this,"_streamId",null),a(this,"_currentMetricsState",{}),a(this,"_currentDomain",""),a(this,"_sendMetricsInterval",null),a(this,"_eventsCache",[]),a(this,"_currentManualResolution",null),a(this,"_currentRenditionSwitchMode",null),a(this,"_abTestsMap",{}),a(this,"_abTestsSupport",{}),a(this,"_additionalFields",{}),a(this,"_urlPostfix",""),a(this,"_timeOrigin",performance.timeOrigin),a(this,"_eventSequenceNumber",0),a(this,"_userType","unknown"),a(this,"_regularBroadcastStopReason",""),a(this,"_sessionId",""),a(this,"_baseUrl",void 0),a(this,"_aggregatedMetrics",new p.AggregatedMetrics),a(this,"_aggregatedMetricsV2",new l.AggregatedMetricsV2),a(this,"_projectId",void 0),a(this,"_eventBus",void 0),this._baseUrl=e,this._projectId=t,this._eventBus=r,(0,d.checkIfPageWasReloaded)()&&this._registerReloadEvent()}destroy(){this.stop()}stop(){this._disarmMetricsSend(),this.immediatelySendMetrics(!0),this._sessionStartTime=null,this._streamId=null,(0,d.setStreamId)(""),this._eventSequenceNumber=0}registerMetrics(e){var t=Object.keys(i(i({},_),m)).concat(["totalRoundTripTime","responsesReceived"]);void 0!==e.totalRoundTripTime&&void 0!==e.responsesReceived&&(this._aggregatedMetrics.addValue("RTT",e.totalRoundTripTime/e.responsesReceived),delete e.totalRoundTripTime,delete e.responsesReceived),Object.entries(e).forEach(e=>{var[r,n]=e;if(t.includes(r))this._aggregatedMetrics.addValue(_[r],n),this._aggregatedMetricsV2.addValue(m[r],n);else{var i=y[r];this._currentMetricsState[i]=n}})}setAbTests(e){this._abTestsMap=e}setAbTestsSupport(e){this._abTestsSupport=e}setAdditionalFields(e){this._additionalFields=e}updateCDNUrl(e){var{host:t}=new URL(e);this._currentDomain!==t&&(this._currentDomain=t)}setTimeOrigin(e){this._timeOrigin=e}setUserId(e){this._userId!==e&&this._recreateSessionId(e)}setProjectId(e){this._projectId!==e&&this._recreateSessionId(void 0,e)}setUserType(e){this._userType=e}setPlayerType(e){e!==this._playerType&&(this._playerType&&this.registerEvent("PlayerTypeSwitched",{prevPlayerType:this._playerType,nextPlayerType:e}),e===h.EPlayerType.BROADCAST?this._urlPostfix="_broadcast":this._userId&&(this._urlPostfix=Number(this._userId)%2==0?"_user":"_guest"),this._playerType=e,this._recreateSessionId())}setStreamId(e){e!==this._streamId&&((0,d.setStreamId)(e),this._streamId=e,this._recreateSessionId())}setManualResolution(e){this._currentManualResolution!==e&&(this._currentManualResolution&&this.registerEvent("RenditionSwitchedManual",{prevResolution:this._currentManualResolution,nextResolution:e}),this._currentManualResolution=e)}setRenditionSwitchMode(e){this._currentRenditionSwitchMode!==e&&(this._currentRenditionSwitchMode&&this.registerEvent("RenditionSelectModeSwitched",{prevMode:this._currentRenditionSwitchMode,nextMode:e}),this._currentRenditionSwitchMode=e)}prepareMetrics(){return i(i(i({},this._currentMetricsState),this._aggregatedMetrics.getAllValues()),this._aggregatedMetricsV2.getAllValues())}registerEvent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.hasEnoughInfoForMetricsAndEvents){var r=this._buildEventsSingleMessage(e,t);this._registerRawEvent(r)}}clear(){this._aggregatedMetrics.clearAllValues(),this._currentMetricsState={}}setRegularBroadcastStopReason(e){this._regularBroadcastStopReason=e}immediatelySendMetrics(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.hasEnoughInfoForMetricsAndEvents){var t=e?"SessionTerminated":"TabBlurred";this.registerEvent(t,{reason:this._regularBroadcastStopReason}),e||this._armMetricsSendInterval(),this._sendCurrentState("all",!0)}}_possiblyCreateSessionId(){this._playerType&&this._streamId&&!this._sessionStartTime&&(this._sessionStartTime=performance.now()+this._timeOrigin,this._armMetricsSendInterval(),this.registerEvent("SessionStarted"),(0,d.setSessionStartTime)(this._sessionStartTime),this._sessionId="".concat(this._sessionStartTime,":").concat(this._userId),this._eventBus.publish(c.EMetricsEvents.SESSION_ID_RECREATED,{}))}_registerRawEvent(e){this._eventsCache.push(e),this._eventSequenceNumber++}_registerReloadEvent(){this._registerRawEvent(this._buildEventsSingleMessage("PageReloaded",{},{streamId:(0,d.getPrevStreamId)().toString(),userId:(0,d.getPrevUserId)(),sessionStartTime:(0,d.getPrevSessionStartTime)(),projectId:(0,d.getPrevProjectId)()}))}_recreateSessionId(e,t){if(!this._sessionStartTime)return void 0!==e&&this._applyUserId(e),void 0!==t&&this._applyProjectId(t),void this._possiblyCreateSessionId();this.registerEvent("SessionTerminated",{reason:this._regularBroadcastStopReason}),this._sendCurrentState("metrics"),this._eventSequenceNumber=0,this._sessionStartTime=performance.now()+this._timeOrigin,this._sessionId="".concat(this._sessionStartTime,":").concat(this._userId),this._aggregatedMetricsV2.clearReportValues(),void 0!==e&&this._applyUserId(e),void 0!==t&&this._applyProjectId(t),this.registerEvent("SessionStarted"),this._eventBus.publish(c.EMetricsEvents.SESSION_ID_RECREATED,{})}_armMetricsSendInterval(){this._disarmMetricsSend(),this._sendMetricsInterval=setInterval(this._sendCurrentState,b)}_disarmMetricsSend(){this._sendMetricsInterval&&(clearInterval(this._sendMetricsInterval),this._sendMetricsInterval=null)}_sendCurrentState(){var e=arguments,t=this;return s(function*(){var r=e.length>0&&void 0!==e[0]?e[0]:"all",n=e.length>1&&void 0!==e[1]&&e[1];if(["events","all"].includes(r)){var i=[...t._eventsCache];i.length&&(t._eventsCache=[],yield t._performFetchRequest({url:"".concat(t._baseUrl,"/events").concat(t._urlPostfix),data:{events:i},onError:()=>{t._eventsCache.push(...i)},isTerminating:n}))}if(["metrics","all"].includes(r)){if(!t.hasEnoughInfoForMetricsAndEvents)return void t.clear();var o=t._buildSingleMetricsMessage(t.prepareMetrics());yield t._performFetchRequest({url:"".concat(t._baseUrl,"/metrics").concat(t._urlPostfix),data:o,onSuccess:()=>{t.clear()},isTerminating:n})}})()}get currentRenditionSelectMode(){return this._currentRenditionSwitchMode}get hasEnoughInfoForMetricsAndEvents(){return!!(this._playerType&&this._streamId&&this._sessionStartTime&&this._userId)}get missingFieldsForMetricsAndEvents(){return Object.entries({playerType:this._playerType,streamId:this._streamId,sessionStartTime:this._sessionStartTime,userId:this._userId}).filter(e=>{var[t,r]=e;return Boolean(r)}).map(e=>{var[t]=e;return t})}_buildEventsSingleMessage(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i(i({eventType:e,payload:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},sessionStartTime:this._sessionStartTime,userId:this._userId,streamId:this._streamId,playerImpl:"MMP",playerType:this._playerType,timestamp:Date.now(),projectId:this._projectId,cdnDomain:this._currentDomain,abTests:this._abTestsMap,abTestsSupport:this._abTestsSupport,mmpVersion:g.MMP_VERSION,sequenceNumber:this._eventSequenceNumber,userType:"unknown"!==this._userType?this._userType:void 0},this._additionalFields||{}),t)}_buildSingleMetricsMessage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i(i(i({},e),{},{sessionStartTime:this._sessionStartTime,userId:this._userId,streamId:this._streamId,playerImpl:"MMP",playerType:this._playerType,timestamp:Date.now(),projectId:this._projectId,cdnDomain:this._currentDomain,reportType:v.EReportType.PRECLEAR,abTests:this._abTestsMap,abTestsSupport:this._abTestsSupport,mmpVersion:g.MMP_VERSION,userType:"unknown"!==this._userType?this._userType:void 0},this._additionalFields||{}),t)}_performFetchRequest(e){var t=this;return s(function*(){var{url:r,data:n,onError:i=()=>{},onSuccess:o=()=>{},isTerminating:s=!1}=e,a=JSON.stringify(n),l=new AbortController,c=setTimeout(()=>{l.abort("Timeout")},5e3),d="".concat((0,u.hash)(a)).concat(a);if(s)navigator.sendBeacon(r,d);else try{var h=yield fetch(r,{body:d,signal:l.signal,method:"POST",cache:"no-cache"});h.ok||t._onFetchError({payloadSize:d.length,responseCode:h.status,responseBody:yield h.text(),requestUrl:r,nativeError:""}),clearTimeout(c),o()}catch(n){t._onFetchError({payloadSize:d.length,responseCode:0,responseBody:"N/A",requestUrl:r,nativeError:n.toString()}),i(n)}})()}_onFetchError(e){var t=this;return s(function*(){try{var r,n;yield fetch("".concat(t._baseUrl,"/logs"),{body:JSON.stringify(i(i({},e),{},{userId:null!==(r=t._userId)&&void 0!==r?r:-1,sessionStartTime:null!==(n=t._sessionStartTime)&&void 0!==n?n:-1})),method:"POST",cache:"no-cache"})}catch(e){console.warn("Could not report fetch error:",e)}})()}get baseUrl(){return this._baseUrl}get projectId(){return this._projectId}get sessionId(){return this._sessionId}_applyUserId(e){this._playerType&&this._playerType===h.EPlayerType.BROADCAST?this._urlPostfix="_broadcast":this._urlPostfix=Number(e)%2==0?"_user":"_guest",this._userId=e,(0,d.setUserId)(e)}_applyProjectId(e){this._projectId=e,(0,d.setProjectId)(e)}}t.MetricsCollector=E,o([f.bind],E.prototype,"_sendCurrentState",null)},3273:(e,t)=>{var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.EStreamStatusErrorType=t.EIncomingMessage=t.EOutgoingMessage=void 0,function(e){e.PONG="pong",e.CONNECTION="connection",e.AVAILABLE_STREAM="availableStream",e.GET_STREAM_INFO="getStreamInfo",e.PUBLISH_STREAM="publishStream",e.PLAY_STREAM="playStream",e.CHANGE_QUALITY="changeQuality",e.UN_PUBLISH_STREAM="unPublishStream",e.STOP_STREAM="stopStream",e.MUTE_TRACK="muteTrack",e.PUBLISHER_REPORT="publisherReport",e.UPDATE_CONFIG="updateConfig"}(r||(t.EOutgoingMessage=r={})),function(e){e.GET_USER_DATA="getUserData",e.NOTIFY_STREAM_STATUS_EVENT="notifyStreamStatusEvent",e.PING="ping",e.GET_VERSION="getVersion",e.AVAILABLE_STREAM="availableStream",e.GET_STREAM_INFO_REPLY="getStreamInfoReply",e.NOTIFY_AUDIO_CODEC="notifyAudioCodec",e.SET_REMOTE_SDP="setRemoteSDP",e.NOTIFY_VIDEO_FORMAT="notifyVideoFormat",e.INBOUND_VIDEO_RATE="inboundVideoRate",e.CONNECTED="connected",e.CHANGE_QUALITY_STATUS="changeQualityStatus",e.MUTE_TRACK_REPLY="muteTrackReply",e.FAIL="fail",e.CONNECTION_CLOSED="closeConnection"}(n||(t.EIncomingMessage=n={})),function(e){e.RECOVERABLE="recoverable",e.UNRECOVERABLE="unrecoverable"}(i||(t.EStreamStatusErrorType=i={}))},3309:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultWatchDogConfig=void 0,t.defaultWatchDogConfig={ignoreDurationMs:5e3,shouldStopPlayer:!1}},3325:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UserMedia=void 0;var l=o(r(6996)),u=r(9699),c=r(5515),d=r(2346),h=r(5361),f=r(8349),p=r(6847),v=r(4989),g=r(6375),_=r(6671),m=r(858),y=r(1483),b=r(1045),E=r(1821),S=r(6857),T=r(4780);class C extends f.CustomEventTarget{constructor(){super(),a(this,"_currentMediaStream",null),a(this,"_mediaCheckCache",null),a(this,"_cachedRequestedDevices",void 0),a(this,"_allowedDevice",{audioinput:void 0,videoinput:void 0}),a(this,"_mediaDevices",null),a(this,"_fakeVideoTrack",null),a(this,"_fakeAudioTrack",null),a(this,"_eventBus",new h.EventBus),a(this,"_logger",(0,p.Logger)(this._eventBus,"UserMedia")),a(this,"_loggerTransport",new v.LoggerConsoleTransport(this._eventBus)),this._logger.info("Created"),navigator.mediaDevices.addEventListener("devicechange",this._onDevicesChanged)}destroy(){navigator.mediaDevices.removeEventListener("devicechange",this._onDevicesChanged),this._logger.info("Destroyed"),this._stopCurrentStream()}requestPermissions(e){var t=this;return s(function*(){if(t._logger.info("Requesting permissions"),t._mediaCheckCache&&(0,l.default)(e,t._cachedRequestedDevices))return t._logger.debug("Has previous check results cached. Returning it"),t._logger.info("Check results",i({},t._mediaCheckCache)),t._mediaCheckCache;var r=e||{video:!0,audio:!0};try{return t._logger.verbose("Request both video and audio permissions"),yield(0,E.requestMediaPermissions)(r),t._cachedRequestedDevices=e,yield t._findAllowedDevices(r),t._logger.debug("No exceptions thrown while checking permissions. Saving both as available in cache"),t._mediaCheckCache={video:{isAvailable:!0,error:null},audio:{isAvailable:!0,error:null},allowedDevices:t._allowedDevice},t._logger.info("Check results",i({},t._mediaCheckCache)),t._mediaCheckCache}catch(r){t._logger.debug("Got an exception while checking both audio and video permissions. Checking them individually",{exception:r.toString()});var n={video:{isAvailable:!1,error:null},audio:{isAvailable:!1,error:null},allowedDevices:t._allowedDevice};return null!=e&&e.audio&&(n.audio=yield t._checkKindPermissions({video:!1,audio:!0}),t._logger.verbose("Audio permissions result: ".concat(n.audio.isAvailable))),null!=e&&e.video&&(n.video=yield t._checkKindPermissions({video:!0,audio:!1}),t._logger.verbose("Video permissions result: ".concat(n.video.isAvailable))),t._mediaCheckCache=n,t._logger.debug("Got individual check results",i({},n)),t._logger.info("Check results",i({},t._mediaCheckCache)),t._mediaCheckCache}})()}getVideoDevices(){var e=this;return s(function*(){e._logger.info("Getting video devices list");var t=yield e._getMediaDevices();return e._logger.info("Got video devices",t),t.videoInputs})()}getAudioInputDevices(){var e=this;return s(function*(){e._logger.info("Getting audio input devices list");var t=yield e._getMediaDevices();return e._logger.info("Got audio input devices",t),t.audioInputs})()}getAudioOutputDevices(){var e=this;return s(function*(){e._logger.info("Getting audio output devices list");var t=yield e._getMediaDevices();return e._logger.info("Got audio output devices",t),t.audioOutputs})()}getMediaStream(e,t,r){var n=this;return s(function*(){n._logger.info("Getting media stream",{constraints:e,defaults:t});var i={};if(e.audio&&(n._logger.debug("Audio constraints are specified in requested constraints. Mapping it"),i.audio=(0,m.getAudioTrackConstraints)(e.audio),n._logger.debug("Audio constraints mapped",{constraints:i.audio})),e.video&&(n._logger.debug("Video constraints are specified in requested constraints. Mapping it"),i.video=(0,y.getVideoTrackConstraints)(e.video,t),n._logger.debug("Video constraints mapped",{constraints:i.video})),n._logger.info("Final constraints for media stream",{mappedConstraints:i}),!n._currentMediaStream){n._logger.debug("No current media stream known. Creating new stream");var o=yield n._createNewStream(i,r);return n._logger.info("Media stream is ready",{mediaStream:o}),o}var s=!(0,S.isStreamInactive)(n._currentMediaStream.stream);if(s&&(yield n._isCurrentStreamSatisfiesConstraints(i)))return n._logger.debug("Current stream is active and satisfies constraints. Returning cached one"),n._logger.info("Media stream is ready",{mediaStream:n._currentMediaStream.stream}),n._currentMediaStream.stream;n._logger.debug("Current stream ".concat(s?"does not satisfies constraints":"is inactive",". Creating new stream")),yield n._stopCurrentStream();var a=yield n._createNewStream(i);return n._logger.info("Media stream is ready",{mediaStream:a}),a})()}_stopCurrentStream(){var e=this;return s(function*(){e._logger.debug("Stopping current media stream"),e._currentMediaStream?(e._stopFakeStreams(),yield(0,T.stopStream)(e._currentMediaStream.stream),e._currentMediaStream=null):e._logger.verbose("No current stream known. Skipping")})()}_findAllowedDevices(e){var t=this;return s(function*(){var r;try{r=yield navigator.mediaDevices.getUserMedia({audio:null==e?void 0:e.audio,video:null==e?void 0:e.video});var n=new Set(r.getTracks().map(e=>e.getSettings().deviceId));return(yield navigator.mediaDevices.enumerateDevices()).forEach(e=>{!n.has(e.deviceId)||"videoinput"!==e.kind&&"audioinput"!==e.kind||(t._allowedDevice[e.kind]=e.deviceId)}),t._allowedDevice}catch(e){return t._allowedDevice}finally{r&&(0,T.stopStream)(r)}})()}_checkKindPermissions(e){var t=this;return s(function*(){t._logger.debug("Checking kind permissions",{constraints:e});var n={isAvailable:!1,error:null};try{t._logger.verbose("Requesting media permissions for constraints",{constraints:e}),n.isAvailable=yield(0,E.requestMediaPermissions)(e),t._logger.verbose("Successfully got permissions for constraints",{constraints:e})}catch(r){t._logger.verbose("Could not get permissions for constraints",{constraints:e,error:r}),n.isAvailable=!1,n.error=r}return t._logger.debug("Final result of permissions check",{constraints:e,checkResults:n}),n})()}_getMediaStream(e){var t=this;return s(function*(){t._logger.debug("Getting media stream with constraints",{constraints:e});var r=(0,g.resolveGetUserMedia)(),n=yield r(e);return t._currentMediaStream={constraints:e,stream:n},t._logger.debug("Resulting media stream",{mediaStream:t._currentMediaStream.stream}),t._currentMediaStream.stream})()}_createNewStream(e,t){var r=this;return s(function*(){r._logger.debug("Creating new media stream with constraints",{constraints:e});try{var n=yield r._getMediaStream(e);return r._appendFakeTracks(n,t),n}catch(t){if(r._logger.warn("Got an error while creating new media stream",{error:t,constraints:e}),t instanceof OverconstrainedError&&"OverconstrainedError"===t.name&&"deviceId"===t.constraint){r._logger.verbose("Trying to get stream with no audio deviceId specified");var o=i(i({},e),{},{audio:!0});return yield r._getMediaStream(o)}throw t}})()}_appendFakeTracks(e,t){if(null!=t&&t.useVideoFakeTrack&&0===e.getVideoTracks().length){var r;this._fakeVideoTrack=new c.FakeVideoTrack;var n=null===(r=this._fakeVideoTrack)||void 0===r?void 0:r.fakeTrack;n&&e.addTrack(n)}if(null!=t&&t.useAudioFakeTrack&&0===e.getAudioTracks().length){var i;this._fakeAudioTrack=new u.FakeAudioTrack;var o=null===(i=this._fakeAudioTrack)||void 0===i?void 0:i.fakeTrack;o&&e.addTrack(o)}}_stopFakeStreams(){var e,t,r,n,i,o,s=null===(e=this._fakeVideoTrack)||void 0===e?void 0:e.fakeTrack,a=null===(t=this._fakeAudioTrack)||void 0===t?void 0:t.fakeTrack;s&&(null!==(r=this._currentMediaStream)&&void 0!==r&&r.stream.removeTrack(s),null!==(n=this._fakeVideoTrack)&&void 0!==n&&n.stopFakeStream()),a&&(null!==(i=this._currentMediaStream)&&void 0!==i&&i.stream.removeTrack(a),null===(o=this._fakeAudioTrack)||void 0===o||o.stopFakeStream())}_getMediaDevices(){var e=this;return s(function*(){return e._logger.verbose("Getting media devices"),e._mediaDevices?(e._logger.verbose("Has media devices in cache, returning them",{devices:e._mediaDevices}),e._mediaDevices):(e._mediaDevices=yield(0,b.enumerateDevices)(),e._mediaDevices)})()}_isCurrentStreamSatisfiesConstraints(e){var t=this;return s(function*(){if(t._logger.debug("Checking if current media stream satisfies constraints",{constraints:e,mediaStream:t._currentMediaStream}),!t._currentMediaStream)return t._logger.verbose("No current media stream available"),!1;try{if(e.video){t._logger.verbose("Checking video track constraints");var r=t._currentMediaStream.stream.getVideoTracks()[0];if(!r&&e.video)return t._logger.verbose("No video track in media stream and constraints has video"),!1;if(r&&!e.video)return t._logger.verbose("There is video track in media stream and constraints has no video"),!1;if("object"==typeof e.video&&e.video.deviceId&&r.getCapabilities().deviceId!==e.video.deviceId)return t._logger.verbose("Constraints has video device ID and it not matches current device id"),!1;r&&"boolean"!=typeof e.video&&(t._logger.verbose("Trying to apply new constraints for video"),yield r.applyConstraints(e.video))}}catch(e){return t._logger.debug("Could not apply constraints or get capabilities of video track",{error:e}),!1}try{if(e.audio){t._logger.verbose("Checking audio track constraints");var n=t._currentMediaStream.stream.getAudioTracks()[0];if(!n&&e.audio)return t._logger.verbose("No audio track in media stream and constraints has audio"),!1;if(n&&!e.audio)return t._logger.verbose("There is audio track in media stream and constraints has no audio"),!1;if("object"==typeof e.audio&&e.audio.deviceId&&n.getCapabilities().deviceId!==e.audio.deviceId)return t._logger.verbose("Constraints has audio device ID and it not matches current device id"),!1;n&&"boolean"!=typeof e.audio&&(t._logger.verbose("Trying to apply new constraints for audio"),yield n.applyConstraints(e.audio))}}catch(e){return t._logger.debug("Could not apply constraints or get capabilities of audio track",{error:e}),!1}return!0})()}_onDevicesChanged(){var e=this;return s(function*(){e._logger.debug("Media devices has changed"),e._mediaDevices=null;var t=yield e._getMediaDevices();e._mediaDevices=t,e.emitEvent(d.EUserMediaEvent.MEDIA_DEVICES_UPDATED,t)})()}get streamFPS(){var e;if(null===(e=this._currentMediaStream)||void 0===e||!e.stream)return null;var t=this._currentMediaStream.stream.getVideoTracks()[0];if(!t)return null;try{return t.getSettings().frameRate||null}catch(t){return null}}}t.UserMedia=C,n([_.bind],C.prototype,"_onDevicesChanged",null)},3326:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.extractEncodeTimestampFromExtraData=t.ENCODE_TIMESTAMP_SEI_MESSAGE_UUID=void 0,t.ENCODE_TIMESTAMP_SEI_MESSAGE_UUID=new Uint8Array([8,44,150,143,119,94,73,180,141,85,164,41,236,217,137,213]);var r=String.fromCharCode(...t.ENCODE_TIMESTAMP_SEI_MESSAGE_UUID);t.extractEncodeTimestampFromExtraData=e=>{var[t,n]=e.split(";"),i=Uint8Array.from(atob(n),e=>e.charCodeAt(0));if(String.fromCharCode(...i.slice(0,16))!==r)return[];for(var o=i.slice(16,24),s=0,a=o.length-1;a>=0;a--)s+=o[a]*256**a;return t&&s?[Number(t),s]:[]}},3359:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LiveGapController=void 0;var o,s=r(355),l=r(8169),u=r(8474),c=r(180),d=i(r(6073)),h=r(5206);!function(e){e.UNKNOWN="unknown",e.GAP="gap",e.IN_RANGE="inRange",e.END_OF_RANGE="endOfRange"}(o||(o={}));class f extends l.ConfigConsumer{constructor(e){super("bufferController",e),a(this,"state",c.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"groups",["buffer"]),a(this,"_lastPlaybackPosition",0),a(this,"_videoElement",null),a(this,"_numberOfDetectedStallCandidates",0),a(this,"_onBufferMetricsReadyListener",void 0),a(this,"_logger",void 0),a(this,"_lifecycleEventReporter",void 0),this._logger=(0,u.Logger)(e,"Doppio - LiveGapController"),this._logger=(0,u.Logger)(this._eventBus,"Doppio - LiveGapController"),this._lifecycleEventReporter=(0,h.LifecycleEventReporterFactory)("LiveGapController",this._eventBus),this._onBufferMetricsReadyListener=this._eventBus.subscribe(s.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsReady)}setVideoElement(e){this._videoElement=e}removeVideoElement(){this._videoElement=null}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onBufferMetricsReadyListener)}_handleConfigUpdated(){}_checkIfJumpNeeded(e){var t=!1,r=o.UNKNOWN,n=this._lastPlaybackPosition!==e.currentPlaybackPosition;this._lastPlaybackPosition=e.currentPlaybackPosition,n?this._numberOfDetectedStallCandidates=0:this._numberOfDetectedStallCandidates+=1;var i=!e.bufferedTimeRanges.some(e=>{var{isCurrentTimeRange:t}=e;return t});return!n&&this.config.numberOfCandidatesToDetectGap<=this._numberOfDetectedStallCandidates&&(this._numberOfDetectedStallCandidates=0,this._lifecycleEventReporter("Playback stalled"),this._logger.info("Playback position didnt changed since last check"),t=!0,r=e.currentTimeRange&&e.currentTimeRange.end-e.currentPlaybackPosition<this.config.endOfRangeThreshold?o.END_OF_RANGE:o.IN_RANGE),i&&(this._lifecycleEventReporter("Gap detected"),this._logger.info("Gap detected"),t=!0,r=o.GAP),this.additionalInfo.isInLastBufferedRange=e.isInLastBufferedRange,this.additionalInfo.isPlaybackPositionChanged=n,this.additionalInfo.isInGap=i,this.additionalInfo.stuckType=r,{isJumpNeeded:t,stuckType:r}}_onBufferMetricsReady(e){var t,r;if(e.bufferedTimeRanges.length&&0!==(null===(t=this._videoElement)||void 0===t?void 0:t.currentTime)&&(null===(r=this._videoElement)||void 0===r||!r.paused)){var{isJumpNeeded:n,stuckType:i}=this._checkIfJumpNeeded(e);return n?(this._lifecycleEventReporter("Gap detected. Skipping it"),[o.END_OF_RANGE,o.GAP].includes(i)?this._jumpToNextRangeStart(e):this._nudgePlayback(e)):void 0}}_setNextPlaybackPosition(e){this._videoElement&&(this._videoElement.currentTime=e)}_jumpToNextRangeStart(e){if(e.isInLastBufferedRange||e.currentPlaybackPosition>=e.bufferedTimeRanges.slice(-1)[0].end)this._nudgePlayback(e);else{var t=e.bufferedTimeRanges.find(t=>{var{start:r}=t;return r>e.currentPlaybackPosition});t?(this._lifecycleEventReporter("Jump to next range requested, jumping to ".concat(t.start+.01)),this._setNextPlaybackPosition(t.start+.01)):this._nudgePlayback(e)}}_nudgePlayback(e){if(!e.isOnBufferEdge){var t=e.currentPlaybackPosition+this.config.nudgePlaybackAmount;this._lifecycleEventReporter("Nudge playback position"),this._setNextPlaybackPosition(t)}}}t.LiveGapController=f,n([d.default],f.prototype,"destroy",null),n([d.default],f.prototype,"_handleConfigUpdated",null),n([d.default],f.prototype,"_onBufferMetricsReady",null)},3362:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EPlayersEvents=void 0,function(e){e.MODULE_LOADED="playerEvents.moduleLoaded",e.PLAYBACK_STATE_CHANGED="playerEvents.playbackStateChanged",e.DEBUGGER_CONNECTED="playerEvents.debuggerConnected",e.ERROR="playerEvents.error",e.AUTO_RESOLUTION_SWITCHED="playerEvents.autoResolutionSwitched",e.RESOLUTION_SWITCHED="playerEvents.resolutionSwitched",e.VIDEO_PLAYBACK_STATE_CHANGED="playerEvents.videoPlaybackStateChanged",e.RESOLUTIONS_AVAILABLE="playerEvents.resolutionsAvailable",e.RESOLUTION_NOT_FOUND="playerEvents.resolutionNotFound",e.VIDEO_ELEMENT_UPDATED="playerEvents.videoElementUpdated",e.PLAYER_TYPES_AVAILABLE="playerEvents.playerTypesAvailable",e.TOGGLE_TURN_SERVERS="playerEvents.toggleTURNServers",e.FORCE_PLAYER_TYPE="playerEvents.forcePlayerType",e.PLAYER_TYPE_CHANGED="playerEvents.playerTypeChanged",e.STREAM_CONFIG_UPDATED="playerEvents.streamConfigUpdated",e.STREAM_CONFIG_UPDATED_INTERNAL="playerEvents.streamConfigUpdatedInternal",e.BROADCAST_SUPPORTED_CHANGE="playerEvents.broadcastSupportedChange",e.LATENCY_ESTIMATION_AVAILABLE="playerEvents.latencyEstimationAvailable",e.STREAM_LOAD_ERROR="playerEvents.streamLoadError",e.FRAG_LOADED="playerEvents.fragLoaded"}(r||(t.EPlayersEvents=r={}))},3518:(e,t,r)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigConsumer=t.setConfig=t._ConfigConsumer=void 0;var i=r(6805),o=r(5984);n=(0,i.createConfig)(o.defaultConfig),t._ConfigConsumer=n.ConfigConsumer,t.setConfig=n.setConfig;class s extends t._ConfigConsumer{}t.ConfigConsumer=s},3549:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(3149),i=r(1052),o=r(1694),s=Math.max,a=Math.min,l=function(e,t,r){var l,u,c,d,h,f,p=0,v=!1,g=!1,_=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var r=l,n=u;return l=u=void 0,p=t,d=e.apply(n,r)}function y(e){var r=e-f;return void 0===f||r>=t||r<0||g&&e-p>=c}function b(){var e=(0,i.A)();if(y(e))return E(e);h=setTimeout(b,function(e){var r=t-(e-f);return g?a(r,c-(e-p)):r}(e))}function E(e){return h=void 0,_&&l?m(e):(l=u=void 0,d)}function S(){var e=(0,i.A)(),r=y(e);if(l=arguments,u=this,f=e,r){if(void 0===h)return function(e){return p=e,h=setTimeout(b,t),v?m(e):d}(f);if(g)return clearTimeout(h),h=setTimeout(b,t),m(f)}return void 0===h&&(h=setTimeout(b,t)),d}return t=(0,o.A)(t)||0,(0,n.A)(r)&&(v=!!r.leading,c=(g="maxWait"in r)?s((0,o.A)(r.maxWait)||0,t):c,_="trailing"in r?!!r.trailing:_),S.cancel=function(){void 0!==h&&clearTimeout(h),p=0,l=f=u=h=void 0},S.flush=function(){return void 0===h?d:E((0,i.A)())},S}},3559:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StreamDispatcher=void 0;var o=r(6805),l=r(3518),u=r(5130),c=r(3947),d=r(9476),h=r(3566),f=r(5417),p=r(942),v=r(2189),g=r(3),_=r(2868),m=r(6882),y=r(2712),b=r(8045),E=r(7691),S=i(r(5354)),T=r(1222),C=r(5740);class A extends l.ConfigConsumer{constructor(e){super("streamDispatcherConfig",e),a(this,"state",b.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"_metadataConnectionUrl",null),a(this,"_streamId",null),a(this,"_aclToken",null),a(this,"_isReady",!1),a(this,"_isStarted",!1),a(this,"_metadataTransport",null),a(this,"_peerConnection",null),a(this,"_peerConnectionWasOnline",!1),a(this,"_metadataTransportReconnectAttempts",0),a(this,"_streamRestartAttempts",0),a(this,"_peerConfigOverride",{}),a(this,"_appKey",""),a(this,"_playingStatus",m.EStreamStatus.UNKNOWN),a(this,"_shouldUseTURNServers",!0),a(this,"_presets",[]),a(this,"_videoElement",null),a(this,"_timeSyncServerURLCache",""),a(this,"_streamHasVideoSideInfo",!1),a(this,"_metadataActionsCache",[]),a(this,"_logger",void 0),a(this,"_onTransportStateChangedListener",void 0),a(this,"_onPeerConnectionStateChangedListener",void 0),a(this,"_onGetStreamInfoReplyListener",void 0),a(this,"_onNegotiationRequestedListener",void 0),a(this,"_onRemoteSdpReceivedListener",void 0),a(this,"_onMediaStreamAvailableListener",void 0),a(this,"_onStreamUnavailableListener",void 0),a(this,"_onSetRemoteSdpErrorListener",void 0),a(this,"_onStopStreamApprovedListener",void 0),a(this,"_onPeerConfigOverrideAvailableListener",void 0),a(this,"_onRequireStreamRestartListener",void 0),a(this,"_sdpPlayingModifier",new _.SDPModifier),a(this,"_streamInfoWasReceived",!1),this._logger=(0,o.Logger)(this._eventBus,"Ristretto - StreamDispatcher"),this._onTransportStateChangedListener=this._eventBus.subscribe(d.EMetadataTransportEvents.TRANSPORT_STATE_CHANGED,this._onTransportStateChanged),this._onNegotiationRequestedListener=this._eventBus.subscribe(p.EPeerConnectionEvents.NEGOTIATION_REQUIRED,this._onNegotiationRequested),this._onRemoteSdpReceivedListener=this._eventBus.subscribe(d.EMetadataTransportEvents.REMOTE_SDP_RECEIVED,this._onRemoteSdpReceived),this._onMediaStreamAvailableListener=this._eventBus.subscribe(p.EPeerConnectionEvents.STREAM_AVAILABLE,this._onMediaStreamAvailable),this._onPeerConnectionStateChangedListener=this._eventBus.subscribe(p.EPeerConnectionEvents.CONNECTION_STATE_CHANGED,this._onPeerConnectionStateChanged),this._onStreamUnavailableListener=this._eventBus.subscribe(d.EMetadataTransportEvents.STREAM_UNAVAILABLE,this._onStreamUnavailable),this._onSetRemoteSdpErrorListener=this._eventBus.subscribe(p.EPeerConnectionEvents.SET_REMOTE_SDP_ERROR,this._onSetRemoteSdpError),this._onStopStreamApprovedListener=this._eventBus.subscribe(d.EMetadataTransportEvents.STREAM_STOP_APPROVED,this._onStopStreamApproved),this._onPeerConfigOverrideAvailableListener=this._eventBus.subscribe(d.EMetadataTransportEvents.PEER_CONFIG_AVAILABLE,this._onPeerConfigAvailable),this._onGetStreamInfoReplyListener=this._eventBus.subscribe(d.EMetadataTransportEvents.GET_STREAM_INFO_REPLY,this._onGetStreamInfoReply),this._onRequireStreamRestartListener=this._eventBus.subscribe(y.EStreamDispatcherEvent.REQUIRE_STREAM_RESTART,this._restartStreamIfPossible);var t=[new v.AddStartBitrate(this.config.startBitrate)];this.config.enableStereoAudio&&t.push(new g.AddStereoModifier),this._sdpPlayingModifier.setModifiersChain(t),this._logger.info("Created")}destroy(){var e;super.destroy(),this._eventBus.unsubscribe(this._onTransportStateChangedListener),this._eventBus.unsubscribe(this._onGetStreamInfoReplyListener),this._eventBus.unsubscribe(this._onNegotiationRequestedListener),this._eventBus.unsubscribe(this._onRemoteSdpReceivedListener),this._eventBus.unsubscribe(this._onMediaStreamAvailableListener),this._eventBus.unsubscribe(this._onPeerConnectionStateChangedListener),this._eventBus.unsubscribe(this._onStreamUnavailableListener),this._eventBus.unsubscribe(this._onSetRemoteSdpErrorListener),this._eventBus.unsubscribe(this._onStopStreamApprovedListener),this._eventBus.unsubscribe(this._onPeerConfigOverrideAvailableListener),this._eventBus.unsubscribe(this._onRequireStreamRestartListener),this.stop(!0),null!==(e=this._metadataTransport)&&void 0!==e&&e.destroy("entrypoint destroy"),this._metadataTransport=null,this._streamInfoWasReceived=!1,this._logger.info("Destroyed")}setAppKey(e){this._appKey=e,this._logger.info("App key updated: ".concat(this._appKey," -> ").concat(e)),this._metadataTransport&&console.warn("You set the appKey while ws connection is live!")}setVideoElement(e){this._videoElement=e}getClosestResolutionByBitrate(e){return this._presets.find(t=>t.bitrate<=e+(this.config.resolutionBitrateThreshold||0))}toggleTURNServersUsage(e){this._shouldUseTURNServers!==e&&(this._shouldUseTURNServers=e,this._setNewStatus(m.EStreamStatus.FINISHED),this._logger.info("TURN servers usage has been switched. Restarting peer connection"),this._createPeerConnection())}setMetadataConnectionUrl(e,t){var r;if((null===(r=this._metadataTransport)||void 0===r?void 0:r.state)===u.EMetadataTransportState.STOPPING)return this._logger.info("Transport is stopping. Caching setMedatadataConnectionURL('".concat(e,"', ").concat(t,")")),void this._metadataActionsCache.push(()=>{this.setMetadataConnectionUrl(e,t)});if(this._logger.info("Metadata url updated: ".concat(this._metadataConnectionUrl," -> ").concat(e)),this._metadataConnectionUrl!==e){try{var n,i=new URL(e);null!==(n=this._peerConnection)&&void 0!==n&&n.setTimeSyncServer("https://".concat(i.host)),this._timeSyncServerURLCache="".concat(window.location.protocol,"//").concat(i.host)}catch(e){this._logger.warn("Could not parse metadata connection url",e)}this._metadataConnectionUrl=e,this._streamInfoWasReceived=!1,t||(this._logger.debug("Requesting to restart flow: metadata connection url has been changed"),this._restartFlow())}}setStreamId(e,t){if(this._streamId!==e){var r,n,i,o;if(this._logger.info("Stream id updated: ".concat(this._streamId," -> ").concat(e)),this._peerConfigOverride={},null!==(r=this._metadataTransport)&&void 0!==r&&r.setStreamId(e),(null===(n=this._metadataTransport)||void 0===n?void 0:n.state)===u.EMetadataTransportState.STOPPING&&this._isStarted)return this._logger.info("Transport is stopping. Caching setStreamId('".concat(e,"', ").concat(t,")")),void this._metadataActionsCache.push(()=>{this.setStreamId(e,t)});this._streamInfoWasReceived=!1,this._streamId=e,t?!this._isStarted||this._playingStatus!==m.EStreamStatus.CONNECTING&&(null===(i=this._metadataTransport)||void 0===i?void 0:i.state)!==u.EMetadataTransportState.IDLE||(this._logger.info("Will try to start negotiation now, because streamId was changed, and the stream is not playing even though it is supposed to play"),null===(o=this._metadataTransport)||void 0===o||o.startOverWithoutReconnect("setStreamId")):(this._logger.debug("Requesting to restart flow: stream id has been changed"),this._restartFlow())}}setAclToken(e,t){if(this._logger.info("Acl token updated: ".concat(this._aclToken," -> ").concat(e)),this._aclToken!==e){var r,n;if((null===(r=this._metadataTransport)||void 0===r?void 0:r.state)===u.EMetadataTransportState.STOPPING)return this._logger.info("Transport is stopping. Caching setAclToken('".concat(e,"', ").concat(t,")")),void this._metadataActionsCache.push(()=>{this.setAclToken(e,t)});this._aclToken=e,this._streamInfoWasReceived=!1,null!==(n=this._metadataTransport)&&void 0!==n&&n.setAclToken(this._aclToken),t||(this._logger.debug("Requesting to restart flow: acl token has been changed"),this._restartFlow())}}setStreamConfig(e,t){var r;if((null===(r=this._metadataTransport)||void 0===r?void 0:r.state)===u.EMetadataTransportState.STOPPING)return this._logger.info("Transport is stopping. Caching setStreamConfig(".concat(JSON.stringify(e,null,2),")")),void this._metadataActionsCache.push(()=>{this.setStreamConfig(e,t)});var n=!1;this._logger.info("Stream config updated",e),void 0!==e.aclToken&&e.aclToken!==this._aclToken&&(n=!0,this.setAclToken(e.aclToken,!0)),void 0!==e.streamId&&e.streamId!==this._streamId&&(n=!t,this.setStreamId(e.streamId,!0)),void 0!==e.wsUrl&&e.wsUrl!==this._metadataConnectionUrl&&(n=!0,this.setMetadataConnectionUrl(e.wsUrl,!0)),n&&this._restartFlow()}start(){return this._setIsStarted(!0),this._isReady?(this._logger.debug("Player already is live. Skipping start"),!0):(this._metadataConnectionUrl||this._logger.warn("Metadata connection URL is not defined. Set metadataConnectionUrl to start the player"),this._streamId||this._logger.warn("Stream ID is not defined. Set streamId to start the player"),this._metadataTransport?(this._setNewStatus(m.EStreamStatus.CONNECTING),this._metadataTransport.state===u.EMetadataTransportState.IDLE?(this._logger.debug("Metadata transport is in idle state. Requesting to connect"),this._metadataTransport.startOverWithoutReconnect("start")):(this._logger.debug("Metadata transport is already available. Creating peer connection"),this._preparePeerConnection())):(this._logger.debug("No metadata transport already created. Creating new one"),this._metadataTransport=this._createMetadataTransport()),!0)}stop(e){this._setIsStarted(!1),this._logger.info("Stopping broadcast"),this._playingStatus!==m.EStreamStatus.UNKNOWN?(this._streamId&&(this._logger.debug("Requesting MMS to stop broadcast"),this._eventBus.publishSync(d.EMetadataTransportEvents.STOP_STREAM,{streamId:this._streamId})),this._isReady=!1,this._setNewStatus(m.EStreamStatus.FINISHED),e&&this._onStopStreamApproved()):this._logger.debug("It seems that broadcast did not started yet. Nothing to stop")}getStream(){return this._peerConnection?this._peerConnection.mediaStream:null}_handleConfigUpdated(e){var t;void 0!==e.metadataReconnectMaxAttempts&&(this._metadataTransportReconnectAttempts=0),e.streamRestartMaxAttempts&&(this._streamRestartAttempts=0),void 0!==e.isFastStartEnabled&&(null===(t=this._metadataTransport)||void 0===t||t.setIsFastStartEnabled(e.isFastStartEnabled))}_onStreamInfoAvailable(){if(this._streamInfoWasReceived=!0,this.config.startResolutionBitrate){var e,t=this.getClosestResolutionByBitrate(this.config.startResolutionBitrate);t&&(null===(e=this._metadataTransport)||void 0===e||e.setQuality(t.name))}this._preparePeerConnection()}_restartFlow(){this._metadataTransportReconnectAttempts=0,this._streamRestartAttempts=0,this._logger.debug("Restarting flow"),this._peerConnection&&(this._logger.debug("Peer connection has been created previously. Destroying one"),this._peerConnection.destroy("restart flow"),this._peerConnection=null),(this._metadataTransport||this._playingStatus===m.EStreamStatus.FINISHED)&&(this._metadataTransport&&(this._logger.debug("Metadata transport has been created previously. Destroying one"),this._metadataTransport.destroy("restart flow"),this._metadataTransport=null),this._createMetadataTransport())}_createMetadataTransport(){return this._logger.info("Creating metadata transport"),this._metadataTransport&&(this._logger.debug("Metadata transport already created. Destroying previous one"),this._metadataTransport.destroy("create metadata transport")),this._setNewStatus(m.EStreamStatus.CONNECTING),this._metadataTransport=new c.MetadataTransport(this._eventBus),this._metadataTransport.setDispatcherStatus(this._isStarted),this._aclToken&&this._metadataTransport.setAclToken(this._aclToken),this.config.startResolution&&!this.config.startResolutionBitrate&&this._metadataTransport.setQuality(this.config.startResolution),this._streamId&&this._metadataTransport.setStreamId(this._streamId),this._metadataConnectionUrl&&this._metadataTransport.setWebsocketServerUrl(this._metadataConnectionUrl),this._metadataTransport.setIsFastStartEnabled(this.config.isFastStartEnabled),this._appKey||console.warn("AppKey isnt defined!!1"),this._metadataTransport.setAppKey(this._appKey),this._metadataTransport}_onTransportStateChanged(e){var t,{prevState:r,nextState:n,isGetStreamInfoMessageSupported:i}=e;this._logger.debug("Transport state changed: ".concat(r," -> ").concat(n)),n===u.EMetadataTransportState.DISCONNECTED&&this._onTransportDisconnected(),n===u.EMetadataTransportState.IDLE&&r===u.EMetadataTransportState.UNKNOWN&&this._isStarted&&null!==(t=this._metadataTransport)&&void 0!==t&&t.startOverWithoutReconnect("transportStateChanged"),n===u.EMetadataTransportState.CONNECTED&&this._onTransportConnected(i),this._metadataTransport&&r===u.EMetadataTransportState.STOPPING&&n===u.EMetadataTransportState.IDLE&&this._metadataActionsCache.length&&(this._logger.info("Reapplying cached actions"),this._metadataActionsCache.forEach(e=>{e(this._metadataTransport)}),this._metadataActionsCache=[])}_onSetRemoteSdpError(){this._logger.error("Caught error when trying to set remote sdp",{playingStatus:this._playingStatus,status:this.status,isReady:this._isReady,metadataConnectionUrl:this._metadataConnectionUrl})}_onGetStreamInfoReply(e){var t=this;return s(function*(){e.status?("videoSideDataExtensions"in e&&void 0!==e.videoSideDataExtensions&&(t._streamHasVideoSideInfo=e.videoSideDataExtensions),t._presets="bitrate"in e?Object.entries(e.bitrate).sort((e,t)=>{var[r,n]=e,[i,o]=t;return o-n}).map((e,t)=>{var[r,n]=e;return{name:r,bitrate:n,priority:0-t,type:"source"===r?"source":"base"}}).filter(e=>{var{name:t}=e;return!t.includes("blurred")}):Object.entries(e.profiles).sort((e,t)=>{var[r,n]=e,[i,o]=t;return o.bitrate-n.bitrate}).map((e,t)=>{var[r,n]=e;return{name:r,abr:n.abr,bitrate:n.bitrate,fps:n.fps,width:n.width,height:n.height,priority:0-t,type:"source"===r?"source":"base"}}).filter(e=>{var{name:t}=e;return!t.includes("blurred")}),t._onStreamInfoAvailable(),t._eventBus.publish(d.EMetadataTransportEvents.STREAM_INFO_AVAILABLE,{presets:t._presets,status:e.status})):t._restartStreamIfPossible({errorOptions:{reason:e.errorMessage}})})()}_onPeerConnectionStateChanged(e){var{prevState:t,nextState:r}=e;this._logger.info("private ristretto streamDispatcher _onPeerConnectionStateChanged, private ristretto streamDispatcher _onPeerConnectionStateChanged ".concat(t," -> ").concat(r),{metadataConnectionUrl:this._metadataConnectionUrl,status:this.status}),r===h.EPeerConnectionState.ONLINE&&(this._setNewStatus(m.EStreamStatus.LIVE),this._peerConnectionWasOnline=!0),[h.EPeerConnectionState.DISCONNECTING,h.EPeerConnectionState.FAILED].includes(r)&&(this._peerConnectionWasOnline?(this._setNewStatus(m.EStreamStatus.FINISHED),this._logger.warn("Peer connection reported an error. Trying to restart one"),this._createPeerConnection()):this.stop())}_onTransportDisconnected(){var e=this;return s(function*(){var t,r;if(e._logger.info("Metadata transport disconnected."),null!==(t=e._peerConnection)&&void 0!==t&&t.destroy("transport disconnected"),e._peerConnection=null,null!==(r=e._metadataTransport)&&void 0!==r&&r.destroy("transport disconnected"),e._metadataTransport=null,e._metadataTransportReconnectAttempts>=e.config.metadataReconnectMaxAttempts)return e._setNewStatus(m.EStreamStatus.FINISHED),void e._eventBus.publish(T.ECommonEvent.COMMON_ERROR,{error:new C.RistrettoPlayerError(C.EErrorDomain.METADATA_TRANSPORT,C.EErrorType.COULD_NOT_CONNECT_TO_METADATA_TRANSPORT,!0,"Maximum number of attempts exceeded")});e._metadataTransportReconnectAttempts+=1,e._logger.info("Metadata transport disconnected. Trying to reconnect with delay"),yield(0,E.exponentialAwait)(1,e.config.metadataReconnectBaseTimeout),e._playingStatus!==m.EStreamStatus.FINISHED&&e._createMetadataTransport()})()}_requestStreamInfo(){this._streamInfoWasReceived=!1,this._eventBus.publishSync(d.EMetadataTransportEvents.GET_STREAM_INFO,{})}_onTransportConnected(e){e&&this.config.shouldGetStreamInfo&&!this.config.startResolution.includes("_blurred")?(this._logger.info("GetStreamInfo message is supported by view server. Requesting stream info"),this._requestStreamInfo()):(this._logger.info("GetStreamInfo message is not supported by view server. Forcing to proceed."),this._streamInfoWasReceived=!0),this._logger.debug("Transport is connected now"),this._metadataTransportReconnectAttempts=0,this._preparePeerConnection()}_publishCommonError(){var{reason:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._logger.error("publishCommonError: Stream is not available for some reason and restart attempts limit has been reached. Gonna emit an error",{reason:e,metadataConnectionUrl:this._metadataConnectionUrl}),this._eventBus.publish(T.ECommonEvent.COMMON_ERROR,{error:new C.RistrettoPlayerError(C.EErrorDomain.DISPATCHER,C.EErrorType.STREAM_NOT_FOUND,!0,e)})}_restartStreamIfPossible(e){var t=this;return s(function*(){if(t._setNewStatus(m.EStreamStatus.ERRORED),t._logger.info("restartStreamIfPossible: Stream is not available, maybe we should try restart it, if we are still below restart attempts limit",{streamRestartAttempts:t._streamRestartAttempts,streamRestartMaxAttempts:t.config.streamRestartMaxAttempts,metadataConnectionUrl:t._metadataConnectionUrl}),-1!==t.config.streamRestartMaxAttempts&&t._streamRestartAttempts>=t.config.streamRestartMaxAttempts)t._publishCommonError(e.errorOptions);else{var r,n;t._logger.info("restartStreamIfPossible before await",{metadataConnectionUrl:t._metadataConnectionUrl});var i=t.config.streamRestartShouldUseExponentialTimeout?t._streamRestartAttempts:1;if(yield(0,E.exponentialAwait)(i,t.config.streamRestartBaseTimeout),t._playingStatus!==m.EStreamStatus.ERRORED)return void t._logger.info("restartStreamIfPossible playingStatus is not errored, so we're not trying to restart",{metadataConnectionUrl:t._metadataConnectionUrl,currentPlayingStatus:t._playingStatus});t._logger.info("restartStreamIfPossible after await - gonna restart",{metadataConnectionUrl:t._metadataConnectionUrl}),t._streamRestartAttempts+=1,null!==(r=t._metadataTransport)&&void 0!==r&&r.setQuality(t.config.startResolution||"source"),null===(n=t._metadataTransport)||void 0===n||n.startOverWithoutReconnect("restartStreamIfPossible")}})()}_onStreamUnavailable(e){var t=this;return s(function*(){var{reason:r,recoverable:n}=e;t._logger.debug("MMS reported requested stream as unavailable with reason ".concat(r)),["Authentication failed","Stream has gone","Stream not found"].includes(r)||t._eventBus.publish(T.ECommonEvent.COMMON_ERROR,{error:new C.RistrettoPlayerError(C.EErrorDomain.DISPATCHER,C.EErrorType.COMMON,!1,r)}),t._logger.info("onStreamUnavailable",{reason:r,recoverable:n,metadataConnectionUrl:t._metadataConnectionUrl}),t._restartStreamIfPossible({errorOptions:{reason:r}})})()}_onNegotiationRequested(e){var t,{sdp:r}=e;this._streamId?r.sdp?(null!==(t=this._peerConnection)&&void 0!==t&&t.setLocalDescription(r),this._logger.info("Peer connection requested negotiation. Start signalling"),this._eventBus.publish(d.EMetadataTransportEvents.SEND_RECEIVE_SDP,{streamId:this._streamId,sdp:r.sdp})):this._logger.error("SDP is empty"):this._logger.error("Could not send sdp offer without stream id specified")}_onRemoteSdpReceived(e){var{sdp:t}=e;this._streamRestartAttempts=0,this._logger.info("Remote SDP received");try{var r;null===(r=this._peerConnection)||void 0===r||r.setRemoteDescription({sdp:t,type:"answer"})}catch(t){this._eventBus.publish(T.ECommonEvent.COMMON_ERROR,{error:new C.RistrettoPlayerError(C.EErrorDomain.PEER_CONNECTION,C.EErrorType.COULD_NOT_PUBLISH,!0,t.toString())})}}_onMediaStreamAvailable(e){var{stream:t}=e;this._eventBus.publish(y.EStreamDispatcherEvent.MEDIA_STREAM_AVAILABLE,{mediaStream:t})}_onPeerConfigAvailable(e){var t,{config:r}=e;this._peerConfigOverride=r,this._logger.debug("Peer connection config override received, see config in details",r),null===(t=this._peerConnection)||void 0===t||t.setPeerConfigOverride(this._peerConfigOverride)}_onStopStreamApproved(){var e;this._isReady||(this._logger.info("Stream stop approved. Destroying peer connection"),null!==(e=this._peerConnection)&&void 0!==e&&e.destroy("stop stream approved"),this._peerConnection=null,this._isStarted&&(this._logger.info("Stream has to be live according to isStarted flag. Will try to start again"),this.start()))}_preparePeerConnection(){this._streamId&&this._streamInfoWasReceived&&this._createPeerConnection()}_createPeerConnection(){var e;this._peerConnectionWasOnline=!1,this._logger.debug("Creating peer connection"),null!==(e=this._peerConnection)&&void 0!==e&&e.destroy("create peer connection"),this._peerConnection=null,this._peerConnection=new f.PeerConnection(this._eventBus,this._streamHasVideoSideInfo),this._peerConnection.setPeerConfigOverride(this._shouldUseTURNServers?this._peerConfigOverride:{iceServers:[],iceTransportPolicy:"all"}),this._peerConnection.setSDPLocalModifier(this._sdpPlayingModifier),this._peerConnection.setKind(this.config.kind),this._peerConnection.createReceiveConnection(),this._timeSyncServerURLCache&&this._peerConnection.setTimeSyncServer(this._timeSyncServerURLCache)}_setNewStatus(e){e!==this._playingStatus&&(e===m.EStreamStatus.LIVE&&(this._streamRestartAttempts=0),this._logger.info("Playing status updated: ".concat(this._playingStatus," -> ").concat(e)),this._eventBus.publish(T.ECommonEvent.PLAYING_STATE_CHANGED,{prevState:this._playingStatus,nextState:e}),this._playingStatus=e)}_setIsStarted(e){var t;this._isStarted=e,null===(t=this._metadataTransport)||void 0===t||t.setDispatcherStatus(this._isStarted)}get additionalModules(){return{peerConnection:this._peerConnection}}}t.StreamDispatcher=A,n([S.default],A.prototype,"_onStreamInfoAvailable",null),n([S.default],A.prototype,"_onTransportStateChanged",null),n([S.default],A.prototype,"_onSetRemoteSdpError",null),n([S.default],A.prototype,"_onGetStreamInfoReply",null),n([S.default],A.prototype,"_onPeerConnectionStateChanged",null),n([S.default],A.prototype,"_restartStreamIfPossible",null),n([S.default],A.prototype,"_onStreamUnavailable",null),n([S.default],A.prototype,"_onNegotiationRequested",null),n([S.default],A.prototype,"_onRemoteSdpReceived",null),n([S.default],A.prototype,"_onMediaStreamAvailable",null),n([S.default],A.prototype,"_onPeerConfigAvailable",null),n([S.default],A.prototype,"_onStopStreamApproved",null)},3566:(e,t)=>{var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.EPeerConnectionState=t.ENativePeerConnectionState=t.ENativeIceConnectionState=void 0,function(e){e.NEW="new",e.CHECKING="checking",e.CONNECTED="connected",e.COMPLETED="completed",e.FAILED="failed",e.DISCONNECTED="disconnected",e.CLOSED="closed"}(r||(t.ENativeIceConnectionState=r={})),function(e){e.NEW="new",e.CONNECTING="connecting",e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.FAILED="failed",e.CLOSED="closed"}(n||(t.ENativePeerConnectionState=n={})),function(e){e.UNKNOWN="unknown",e.CONNECTING="connecting",e.ONLINE="online",e.DISCONNECTING="disconnecting",e.OFFLINE="offline",e.FAILED="failed",e.CLOSED="closed",e.DESTROYED="destroyed"}(i||(t.EPeerConnectionState=i={}))},3572:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parseCSSTransformString=void 0,t.parseCSSTransformString=e=>{var t=1,r=1,n=(e=>{for(var t,r=[],n=/(\w+)\(([^)]+)\)/g;null!==(t=n.exec(e));){var i=t[1],o=t[2].split(",").map(e=>parseFloat(e.trim()));r.push({fn:i,args:o})}return r})(e);for(var{fn:i,args:o}of n)switch(i){case"scale":1===o.length?(t*=o[0],r*=o[0]):(t*=o[0],r*=o[1]);break;case"scaleX":t*=o[0];break;case"scaleY":r*=o[0];break;case"scale3d":t*=o[0],r*=o[1];break;case"matrix":t*=o[0],r*=o[3];break;case"matrix3d":t*=o[0],r*=o[5]}return{scaleX:t,scaleY:r}}},3599:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StateManager=void 0,t.StateManager=class{constructor(e){a(this,"_initState",void 0),a(this,"_state",void 0),this._initState=i({},e),this._state=i({},e)}setState(e,t){Object.assign(this._state,e),t&&t(this._state)}getState(){return this._state}resetState(){this.setState(this._initState)}}},3601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableBufferStallsDetectorConfigValues=t.defaultBufferStallsDetectorConfig=void 0,t.defaultBufferStallsDetectorConfig={bufferAmountToDetectStall:.1},t.availableBufferStallsDetectorConfigValues={}},3613:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentsBufferEvents=void 0,t.FragmentsBufferEvents={saveData:"fragmentsBufferEvents.saveData"}},3631:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(124),i=r(1917),o=(0,n.A)(i.A,"WeakMap")},3639:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LifecycleEventsManagerEvents=void 0,t.LifecycleEventsManagerEvents={lifecycleEvent:"LifecycleEventsManager.LIFECYCLE_EVENT",lifecycleError:"LifecycleEventsManager.LIFECYCLE_ERROR"}},3677:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.V1PostParseValidator=void 0;var n=r(7104);class i extends n.PlaylistPostParseValidatorStage{constructor(){super()}validateScheme(e,t,r){var n,i=null==e||null===(n=e.custom)||void 0===n?void 0:n.mmpCorruptionScheme;return Array.isArray(i)&&i.includes(t)&&i.includes(r)}}t.V1PostParseValidator=i},3703:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableStreamDispatcherConfigValues=t.defaultStreamDispatcherConfig=void 0,t.defaultStreamDispatcherConfig={startBitrate:100,enableStereoAudio:!0,isFastStartEnabled:!0,kind:["audio","video"],metadataReconnectBaseTimeout:500,metadataReconnectMaxAttempts:10,streamRestartBaseTimeout:1e3,streamRestartMaxAttempts:100,streamRestartShouldUseExponentialTimeout:!1,startResolution:"source",resolutionBitrateThreshold:1e5,shouldGetStreamInfo:!0},t.availableStreamDispatcherConfigValues={kind:{isMultiple:!0,values:["audio","video"]}}},3736:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},3774:function(e){var t;"undefined"!=typeof self&&self,t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){var n=r(5),i=r(1),o=i.toHex,s=i.ceilHeapSize,a=r(6),l=function(e){for(e+=9;e%64>0;e+=1);return e},u=function(e,t){var r=new Int32Array(e,t+320,5),n=new Int32Array(5),i=new DataView(n.buffer);return i.setInt32(0,r[0],!1),i.setInt32(4,r[1],!1),i.setInt32(8,r[2],!1),i.setInt32(12,r[3],!1),i.setInt32(16,r[4],!1),n},c=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(t=t||65536)%64>0)throw new Error("Chunk size must be a multiple of 128 bit");this._offset=0,this._maxChunkLen=t,this._padMaxChunkLen=l(t),this._heap=new ArrayBuffer(s(this._padMaxChunkLen+320+20)),this._h32=new Int32Array(this._heap),this._h8=new Int8Array(this._heap),this._core=new n({Int32Array:Int32Array},{},this._heap)}return e.prototype._initState=function(e,t){this._offset=0;var r=new Int32Array(e,t+320,5);r[0]=1732584193,r[1]=-271733879,r[2]=-1732584194,r[3]=271733878,r[4]=-1009589776},e.prototype._padChunk=function(e,t){var r=l(e),n=new Int32Array(this._heap,0,r>>2);return function(e,t){var r=new Uint8Array(e.buffer),n=t%4,i=t-n;switch(n){case 0:r[i+3]=0;case 1:r[i+2]=0;case 2:r[i+1]=0;case 3:r[i+0]=0}for(var o=1+(t>>2);o<e.length;o++)e[o]=0}(n,e),function(e,t,r){e[t>>2]|=128<<24-(t%4<<3),e[14+(2+(t>>2)&-16)]=r/(1<<29)|0,e[15+(2+(t>>2)&-16)]=r<<3}(n,e,t),r},e.prototype._write=function(e,t,r,n){a(e,this._h8,this._h32,t,r,n||0)},e.prototype._coreCall=function(e,t,r,n,i){var o=r;this._write(e,t,r),i&&(o=this._padChunk(r,n)),this._core.hash(o,this._padMaxChunkLen)},e.prototype.rawDigest=function(e){var t=e.byteLength||e.length||e.size||0;this._initState(this._heap,this._padMaxChunkLen);var r=0,n=this._maxChunkLen;for(r=0;t>r+n;r+=n)this._coreCall(e,r,n,t,!1);return this._coreCall(e,r,t-r,t,!0),u(this._heap,this._padMaxChunkLen)},e.prototype.digest=function(e){return o(this.rawDigest(e).buffer)},e.prototype.digestFromString=function(e){return this.digest(e)},e.prototype.digestFromBuffer=function(e){return this.digest(e)},e.prototype.digestFromArrayBuffer=function(e){return this.digest(e)},e.prototype.resetState=function(){return this._initState(this._heap,this._padMaxChunkLen),this},e.prototype.append=function(e){var t=0,r=e.byteLength||e.length||e.size||0,n=this._offset%this._maxChunkLen,i=void 0;for(this._offset+=r;t<r;)i=Math.min(r-t,this._maxChunkLen-n),this._write(e,t,i,n),t+=i,(n+=i)===this._maxChunkLen&&(this._core.hash(this._maxChunkLen,this._padMaxChunkLen),n=0);return this},e.prototype.getState=function(){var e=void 0;if(this._offset%this._maxChunkLen)e=this._heap.slice(0);else{var t=new Int32Array(this._heap,this._padMaxChunkLen+320,5);e=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{offset:this._offset,heap:e}},e.prototype.setState=function(e){return this._offset=e.offset,20===e.heap.byteLength?new Int32Array(this._heap,this._padMaxChunkLen+320,5).set(new Int32Array(e.heap)):this._h32.set(new Int32Array(e.heap)),this},e.prototype.rawEnd=function(){var e=this._offset,t=e%this._maxChunkLen,r=this._padChunk(t,e);this._core.hash(r,this._padMaxChunkLen);var n=u(this._heap,this._padMaxChunkLen);return this._initState(this._heap,this._padMaxChunkLen),n},e.prototype.end=function(){return o(this.rawEnd().buffer)},e}();e.exports=c,e.exports._core=n},function(e,t){for(var r=new Array(256),n=0;n<256;n++)r[n]=(n<16?"0":"")+n.toString(16);e.exports.toHex=function(e){for(var t=new Uint8Array(e),n=new Array(e.byteLength),i=0;i<n.length;i++)n[i]=r[t[i]];return n.join("")},e.exports.ceilHeapSize=function(e){var t=0;if(e<=65536)return 65536;if(e<16777216)for(t=1;t<e;t<<=1);else for(t=16777216;t<e;t+=16777216);return t},e.exports.isDedicatedWorkerScope=function(e){var t="WorkerGlobalScope"in e&&e instanceof e.WorkerGlobalScope,r="SharedWorkerGlobalScope"in e&&e instanceof e.SharedWorkerGlobalScope,n="ServiceWorkerGlobalScope"in e&&e instanceof e.ServiceWorkerGlobalScope;return t&&!r&&!n}},function(e,t,r){e.exports=function(){var e=r(0),t=function(e,r,n,i,o){var s=new self.FileReader;s.onloadend=function(){if(s.error)return o(s.error);var a=s.result;r+=s.result.byteLength;try{e.append(a)}catch(e){return void o(e)}r<i.size?t(e,r,n,i,o):o(null,e.end())},s.readAsArrayBuffer(i.slice(r,r+n))},n=!0;return self.onmessage=function(r){if(n){var i=r.data.data,o=r.data.file,s=r.data.id;if(void 0!==s&&(o||i)){var a=r.data.blockSize||4194304,l=new e(a);l.resetState();var u=function(e,t){e?self.postMessage({id:s,error:e.name}):self.postMessage({id:s,hash:t})};i&&function(e,t,r){try{return r(null,e.digest(t))}catch(e){return r(e)}}(l,i,u),o&&t(l,0,a,o,u)}}},function(){n=!1}}},function(e,t,r){var n=r(4),i=r(0),o=r(7),s=r(2),a=r(1).isDedicatedWorkerScope,l="undefined"!=typeof self&&a(self);i.disableWorkerBehaviour=l?s():function(){},i.createWorker=function(){var e=n(2),t=e.terminate;return e.terminate=function(){URL.revokeObjectURL(e.objectURL),t.call(e)},e},i.createHash=o,e.exports=i},function(e,t,r){function n(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var n=r(r.s=ENTRY_MODULE);return n.default||n}var i="[\\.|\\-|\\+|\\w|/|@]+",o="\\((/\\*.*?\\*/)?s?.*?("+i+").*?\\)";function s(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function a(e,t,n){var a={};a[n]=[];var l=t.toString(),u=l.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!u)return a;for(var c,d=u[1],h=new RegExp("(\\\\n|\\W)"+s(d)+o,"g");c=h.exec(l);)"dll-reference"!==c[3]&&a[n].push(c[3]);for(h=new RegExp("\\("+s(d)+'\\("(dll-reference\\s('+i+'))"\\)\\)'+o,"g");c=h.exec(l);)e[c[2]]||(a[n].push(c[1]),e[c[2]]=r(c[1]).m),a[c[2]]=a[c[2]]||[],a[c[2]].push(c[4]);return a}function l(e){return Object.keys(e).reduce(function(t,r){return t||e[r].length>0},!1)}e.exports=function(e,t){t=t||{};var i={main:r.m},o=t.all?{main:Object.keys(i)}:function(e,t){for(var r={main:[t]},n={main:[]},i={main:{}};l(r);)for(var o=Object.keys(r),s=0;s<o.length;s++){var u=o[s],c=r[u].pop();if(i[u]=i[u]||{},!i[u][c]&&e[u][c]){i[u][c]=!0,n[u]=n[u]||[],n[u].push(c);for(var d=a(e,e[u][c],u),h=Object.keys(d),f=0;f<h.length;f++)r[h[f]]=r[h[f]]||[],r[h[f]]=r[h[f]].concat(d[h[f]])}}return n}(i,e),s="";Object.keys(o).filter(function(e){return"main"!==e}).forEach(function(e){for(var t=0;o[e][t];)t++;o[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",s=s+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+o[e].map(function(t){return JSON.stringify(t)+": "+i[e][t].toString()}).join(",")+"});\n"}),s=s+"("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+o.main.map(function(e){return JSON.stringify(e)+": "+i.main[e].toString()}).join(",")+"})(self);";var u=new window.Blob([s],{type:"text/javascript"});if(t.bare)return u;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),d=new window.Worker(c);return d.objectURL=c,d}},function(e,t){e.exports=function(e,t,r){"use asm";var n=new e.Int32Array(r);function i(e,t){e=e|0;t=t|0;var r=0,i=0,o=0,s=0,a=0,l=0,u=0,c=0,d=0,h=0,f=0,p=0,v=0,g=0;o=n[t+320>>2]|0;a=n[t+324>>2]|0;u=n[t+328>>2]|0;d=n[t+332>>2]|0;f=n[t+336>>2]|0;for(r=0;(r|0)<(e|0);r=r+64|0){s=o;l=a;c=u;h=d;p=f;for(i=0;(i|0)<64;i=i+4|0){g=n[r+i>>2]|0;v=((o<<5|o>>>27)+(a&u|~a&d)|0)+((g+f|0)+1518500249|0)|0;f=d;d=u;u=a<<30|a>>>2;a=o;o=v;n[e+i>>2]=g}for(i=e+64|0;(i|0)<(e+80|0);i=i+4|0){g=(n[i-12>>2]^n[i-32>>2]^n[i-56>>2]^n[i-64>>2])<<1|(n[i-12>>2]^n[i-32>>2]^n[i-56>>2]^n[i-64>>2])>>>31;v=((o<<5|o>>>27)+(a&u|~a&d)|0)+((g+f|0)+1518500249|0)|0;f=d;d=u;u=a<<30|a>>>2;a=o;o=v;n[i>>2]=g}for(i=e+80|0;(i|0)<(e+160|0);i=i+4|0){g=(n[i-12>>2]^n[i-32>>2]^n[i-56>>2]^n[i-64>>2])<<1|(n[i-12>>2]^n[i-32>>2]^n[i-56>>2]^n[i-64>>2])>>>31;v=((o<<5|o>>>27)+(a^u^d)|0)+((g+f|0)+1859775393|0)|0;f=d;d=u;u=a<<30|a>>>2;a=o;o=v;n[i>>2]=g}for(i=e+160|0;(i|0)<(e+240|0);i=i+4|0){g=(n[i-12>>2]^n[i-32>>2]^n[i-56>>2]^n[i-64>>2])<<1|(n[i-12>>2]^n[i-32>>2]^n[i-56>>2]^n[i-64>>2])>>>31;v=((o<<5|o>>>27)+(a&u|a&d|u&d)|0)+((g+f|0)-1894007588|0)|0;f=d;d=u;u=a<<30|a>>>2;a=o;o=v;n[i>>2]=g}for(i=e+240|0;(i|0)<(e+320|0);i=i+4|0){g=(n[i-12>>2]^n[i-32>>2]^n[i-56>>2]^n[i-64>>2])<<1|(n[i-12>>2]^n[i-32>>2]^n[i-56>>2]^n[i-64>>2])>>>31;v=((o<<5|o>>>27)+(a^u^d)|0)+((g+f|0)-899497514|0)|0;f=d;d=u;u=a<<30|a>>>2;a=o;o=v;n[i>>2]=g}o=o+s|0;a=a+l|0;u=u+c|0;d=d+h|0;f=f+p|0}n[t+320>>2]=o;n[t+324>>2]=a;n[t+328>>2]=u;n[t+332>>2]=d;n[t+336>>2]=f}return{hash:i}}},function(e,t){var r=this,n=void 0;"undefined"!=typeof self&&void 0!==self.FileReaderSync&&(n=new self.FileReaderSync);var i=function(e,t,r,n,i,o){var s=void 0,a=o%4,l=(i+a)%4,u=i-l;switch(a){case 0:t[o]=e[n+3];case 1:t[o+1-(a<<1)|0]=e[n+2];case 2:t[o+2-(a<<1)|0]=e[n+1];case 3:t[o+3-(a<<1)|0]=e[n]}if(!(i<l+(4-a))){for(s=4-a;s<u;s=s+4|0)r[o+s>>2]=e[n+s]<<24|e[n+s+1]<<16|e[n+s+2]<<8|e[n+s+3];switch(l){case 3:t[o+u+1|0]=e[n+u+2];case 2:t[o+u+2|0]=e[n+u+1];case 1:t[o+u+3|0]=e[n+u]}}};e.exports=function(e,t,o,s,a,l){if("string"==typeof e)return function(e,t,r,n,i,o){var s=void 0,a=o%4,l=(i+a)%4,u=i-l;switch(a){case 0:t[o]=e.charCodeAt(n+3);case 1:t[o+1-(a<<1)|0]=e.charCodeAt(n+2);case 2:t[o+2-(a<<1)|0]=e.charCodeAt(n+1);case 3:t[o+3-(a<<1)|0]=e.charCodeAt(n)}if(!(i<l+(4-a))){for(s=4-a;s<u;s=s+4|0)r[o+s>>2]=e.charCodeAt(n+s)<<24|e.charCodeAt(n+s+1)<<16|e.charCodeAt(n+s+2)<<8|e.charCodeAt(n+s+3);switch(l){case 3:t[o+u+1|0]=e.charCodeAt(n+u+2);case 2:t[o+u+2|0]=e.charCodeAt(n+u+1);case 1:t[o+u+3|0]=e.charCodeAt(n+u)}}}(e,t,o,s,a,l);if(e instanceof Array)return i(e,t,o,s,a,l);if(r&&r.Buffer&&r.Buffer.isBuffer(e))return i(e,t,o,s,a,l);if(e instanceof ArrayBuffer)return i(new Uint8Array(e),t,o,s,a,l);if(e.buffer instanceof ArrayBuffer)return i(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),t,o,s,a,l);if(e instanceof Blob)return function(e,t,r,i,o,s){var a=void 0,l=s%4,u=(o+l)%4,c=o-u,d=new Uint8Array(n.readAsArrayBuffer(e.slice(i,i+o)));switch(l){case 0:t[s]=d[3];case 1:t[s+1-(l<<1)|0]=d[2];case 2:t[s+2-(l<<1)|0]=d[1];case 3:t[s+3-(l<<1)|0]=d[0]}if(!(o<u+(4-l))){for(a=4-l;a<c;a=a+4|0)r[s+a>>2]=d[a]<<24|d[a+1]<<16|d[a+2]<<8|d[a+3];switch(u){case 3:t[s+c+1|0]=d[c+2];case 2:t[s+c+2|0]=d[c+1];case 1:t[s+c+3|0]=d[c]}}}(e,t,o,s,a,l);throw new Error("Unsupported data type.")}},function(e,t,r){var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(0),o=r(1).toHex,s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._rusha=new i,this._rusha.resetState()}return e.prototype.update=function(e){return this._rusha.append(e),this},e.prototype.digest=function(e){var t=this._rusha.rawEnd().buffer;if(!e)return t;if("hex"===e)return o(t);throw new Error("unsupported digest encoding")},n(e,[{key:"state",get:function(){return this._rusha.getState()},set:function(e){this._rusha.setState(e)}}]),e}();e.exports=function(){return new s}}])},e.exports=t()},3814:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoElementMetrics=void 0;var i=r(3102),o=r(3060),s=r(8745),l=r(6805);class u{constructor(e,t,r){a(this,"_collectMetricsInterval",null),a(this,"_videoElement",null),a(this,"_isPageVisible",!1),a(this,"_isStalledByCurrentTime",!0),a(this,"_prevPlaybackPosition",null),a(this,"_checkCurrentTimeInterval",null),a(this,"_isPaused",!1),a(this,"_resolutions",[]),a(this,"_metricsCollector",void 0),a(this,"_upscaleAvg",new o.RunningAverage),a(this,"_upscaleMax",new s.RunningMax),a(this,"_eventBus",void 0),a(this,"_upscaleCalculationService",void 0),a(this,"_onSessionIdRecreatedListener",void 0),this._metricsCollector=e,this._eventBus=t,this._upscaleCalculationService=r,this._onSessionIdRecreatedListener=t.subscribe(i.EMetricsEvents.SESSION_ID_RECREATED,this._onSessionIdRecreated)}destroy(){this._detachEventListeners(),this._disarmMetricsCollectionInterval(),this._disarmCurrentTimeCheck(),this._eventBus.unsubscribe(this._onSessionIdRecreatedListener)}setVideoElement(e){this._detachEventListeners(),this._disarmMetricsCollectionInterval(),this._disarmCurrentTimeCheck(),this._videoElement=e,this._attachEventListeners(),e&&(this._armMetricsCollectionInterval(),this._armCurrentTimeCheck()),this._resendOngoingState()}setResolutions(e){this._resolutions=[...e].sort((e,t)=>t.height-e.height)}setIsPaused(e){this._isPaused=e}_armMetricsCollectionInterval(){this._disarmMetricsCollectionInterval(),this._collectMetricsInterval=setInterval(this._collectVideoElementMetrics,500)}_disarmMetricsCollectionInterval(){this._collectMetricsInterval&&clearInterval(this._collectMetricsInterval)}_armCurrentTimeCheck(){this._disarmCurrentTimeCheck(),this._checkCurrentTimeInterval=setInterval(this._checkCurrentTime,50)}_disarmCurrentTimeCheck(){this._checkCurrentTimeInterval&&clearInterval(this._checkCurrentTimeInterval)}_attachEventListeners(){this._videoElement&&(this._videoElement.addEventListener("canplay",this._onCanPlay),this._videoElement.addEventListener("play",this._onPlay),this._videoElement.addEventListener("pause",this._onPause),this._videoElement.addEventListener("stalled",this._onStalledNative),this._videoElement.addEventListener("waiting",this._onStalledNative),this._videoElement.addEventListener("error",this._onErrorReported),document.addEventListener("visibilitychange",this._onVisibilityChanged),this._isPageVisible="visible"===document.visibilityState)}_detachEventListeners(){this._videoElement&&(this._videoElement.removeEventListener("canplay",this._onCanPlay),this._videoElement.removeEventListener("play",this._onPlay),this._videoElement.removeEventListener("pause",this._onPause),this._videoElement.removeEventListener("stalled",this._onStalledNative),this._videoElement.removeEventListener("waiting",this._onStalledNative),this._videoElement.removeEventListener("error",this._onErrorReported),document.removeEventListener("visibilitychange",this._onVisibilityChanged))}_collectVideoElementMetrics(){if(this._videoElement){var{videoWidth:e,videoHeight:t}=this._videoElement,r=e>=t,n=this._resolutions.length>0?r?this._resolutions[0].width:this._resolutions[0].height:void 0,o=this._upscaleCalculationService.getCurrentUpscaleFactor(n);this._eventBus.publish(i.EMetricsEvents.UPSCALE_CALCULATED,{upscaleFactor:o}),null!==o&&(this._upscaleAvg.addValue(o),this._upscaleMax.addValue(o));var{totalVideoFrames:s,droppedVideoFrames:a}=(0,l.getVideoPlaybackQuality)(this._videoElement),u=0;try{Array(this._videoElement.buffered.length).fill(null).forEach((e,t)=>{var r,n,i,o,[s=0,a=0]=[null===(r=this._videoElement)||void 0===r?void 0:r.buffered.start(t),null===(n=this._videoElement)||void 0===n?void 0:n.buffered.end(t)];a<=((null===(i=this._videoElement)||void 0===i?void 0:i.currentTime)||0)||(u+=a-Math.max((null===(o=this._videoElement)||void 0===o?void 0:o.currentTime)||0,s))})}catch(e){}var c={totalFramesDecoded:s,totalFramesDropped:a,buffer:u};this._upscaleMax.max>-1/0&&(c.upscaleFactorAvg=this._upscaleAvg.avg,c.upscaleFactorMax=this._upscaleMax.max),this._registerMetrics(c)}}_onCanPlay(){this._registerEvent("ReadyToPlay")}_onPlay(){this._videoElement&&this._videoElement.readyState>1&&this._registerEvent("Played")}_onPause(){this._registerEvent("Paused")}_onStalledNative(){this._registerEvent("StalledNative")}_onVisibilityChanged(){var e="visible"===document.visibilityState;e!==this._isPageVisible&&(e?this._registerEvent("TabFocused"):this._isPaused||this._metricsCollector.immediatelySendMetrics(),this._isPageVisible=e)}_onErrorReported(){var e;(null===(e=this._videoElement)||void 0===e||null===(e=e.error)||void 0===e?void 0:e.code)&&![1,2].includes(this._videoElement.error.code)&&this._registerEvent("MediaDecodingError",{errorMessage:this._videoElement.error.message})}_checkCurrentTime(){if(!this._videoElement)return this._prevPlaybackPosition=null,void(this._isStalledByCurrentTime||(this._isStalledByCurrentTime=!0,this._registerEvent("Stalled")));if(!this._prevPlaybackPosition||!this._videoElement.currentTime||this._videoElement.currentTime<this._prevPlaybackPosition)this._prevPlaybackPosition=this._videoElement.currentTime;else{var e=this._prevPlaybackPosition===this._videoElement.currentTime;this._prevPlaybackPosition=this._videoElement.currentTime,this._isStalledByCurrentTime!==e&&(this._isStalledByCurrentTime=e,e?this._registerEvent("Stalled"):this._registerEvent("Played",{reason:"exitFromStallByCurrentTime"}))}}_registerEvent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._isPaused||this._metricsCollector.registerEvent(e,t)}_registerMetrics(e){this._isPaused||this._metricsCollector.registerMetrics(e)}_onSessionIdRecreated(){this._upscaleMax.reset(),this._upscaleAvg.reset()}_resendOngoingState(){this._videoElement&&this._videoElement.readyState>this._videoElement.HAVE_CURRENT_DATA&&(this._registerEvent("OngoingSessionDetected"),this._registerEvent("ReadyToPlay"),!this._videoElement.paused&&this._videoElement.played.length>0&&this._videoElement.currentTime>0&&this._registerEvent("Played"))}}t.VideoElementMetrics=u,n([l.bind],u.prototype,"_collectVideoElementMetrics",null),n([l.bind],u.prototype,"_onCanPlay",null),n([l.bind],u.prototype,"_onPlay",null),n([l.bind],u.prototype,"_onPause",null),n([l.bind],u.prototype,"_onStalledNative",null),n([l.bind],u.prototype,"_onVisibilityChanged",null),n([l.bind],u.prototype,"_onErrorReported",null),n([l.bind],u.prototype,"_checkCurrentTime",null),n([l.bind],u.prototype,"_onSessionIdRecreated",null)},3831:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(6912),i=r(2049),o=function(e,t,r){var o=t(e);return(0,i.A)(e)?o:(0,n.A)(o,r(e))}},3846:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MinimalBufferToIncreaseEstimator=void 0;var n=r(8169),i=r(180);class o extends n.ConfigConsumer{constructor(e){super("minimalBufferToIncreaseEstimator",e),a(this,"state",i.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"groups",["abr"])}destroy(){super.destroy()}reset(){}getNextEstimatedResolution(e,t,r){return 1e3*r.bufferAmount>this.config.minimalBufferAmount?null:t}_handleConfigUpdated(){}}t.MinimalBufferToIncreaseEstimator=o},3871:(e,t)=>{var r,n,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.EErrorType=t.EEvent=t.ELifecycleError=t.ELifecycleEvent=void 0,function(e){e.MANIFEST_LOADED="ManifestLoaded",e.FIRST_MEDIA_PLAYLIST_LOADED="FirstMediaPlaylistLoaded",e.FIRST_FRAGMENT_LOADED="FirstFragmentLoaded",e.FIRST_FRAGMENT_BUFFERED="FirstFragmentBuffered"}(r||(t.ELifecycleEvent=r={})),function(e){e.MANIFEST_LOAD_ERROR="ManifestLoadError",e.PLAYLIST_LOAD_ERROR="PlaylistLoadError",e.FRAGMENT_LOAD_ERROR="FragmentLoadError"}(n||(t.ELifecycleError=n={})),function(e){e.VARIANTS_DETECTED="variantDetected",e.RESOLUTION_CHANGED="resolutionChanged",e.METRICS_AVAILABLE="metricsAvailable",e.ERROR="error",e.MANIFEST_LOADING="manifestLoading",e.MANIFEST_LOADED="manifestLoaded",e.MANIFEST_PARSED="manifestParsed",e.LEVEL_LOADED="levelLoaded",e.LEVEL_SWITCHED="levelSwitched",e.LEVEL_SWITCHED_AUTO="levelSwitchedAuto",e.LEVEL_SWITCHING="levelSwitching",e.MEDIA_ATTACHED="mediaAttached",e.MEDIA_DETACHED="mediaDetached",e.FRAG_LOADED="fragmentLoaded",e.LEVEL_METADATA_LOADED="levelMetadataLoaded",e.STREAM_STATE_TRANSITION="streamStateTransition",e.PLAYBACK_STATE_CHANGED="playbackStateChanged",e.FRAG_BUFFERED="fragBuffered",e.DEBUGGER_CONNECTED="debuggerConnected",e.STREAM_ENDED="streamEnded",e.LIFECYCLE_EVENT="lifecycleEvent",e.LIFECYCLE_ERROR="lifecycleError",e.FRAGMENT_FILTERED_OUT="fragmentFilteredOut",e.RESOLUTION_NOT_FOUND="resolutionNotFound"}(i||(t.EEvent=i={})),function(e){e.MEDIA_ERROR="mediaError",e.NETWORK_ERROR="networkError",e.PARSING_ERROR="parsingError"}(o||(t.EErrorType=o={}))},3908:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ESocketConnectionState=void 0,function(e){e.UNKNOWN="ESCS/unknown",e.CONNECTED="ESCS/connected",e.OFFLINE="ESCS/offline"}(r||(t.ESocketConnectionState=r={}))},3947:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataTransport=void 0;var l=r(6805),u=r(1222),c=r(1675),d=r(2305),h=r(5130),f=r(9476),p=r(3908),v=r(3273),g=r(917),_=r(576),m=r(2911),y=r(6882),b=r(2712),E=r(9074),S=r(8692),T=r(1001),C=o(r(5354)),A=r(2628),P=r(7937),R=r(480),O=r(1178),L=r(7647);class M{constructor(e){a(this,"_mediaSessionId",(0,T.uuidv4)()),a(this,"_quality","source"),a(this,"_appKey",null),a(this,"_aclToken",null),a(this,"_isMuteEventSupported",!1),a(this,"_streamId",null),a(this,"_sendFlexFECOverhead",!1),a(this,"_abrPolicy",h.EAbrPolicy.UNKNOWN),a(this,"_websocketServerUrl",null),a(this,"_isFastStartEnabled",!1),a(this,"_flexFECOverhead",0),a(this,"_state",h.EMetadataTransportState.UNKNOWN),a(this,"_lastPlayPlayStreamParams",null),a(this,"_supportsGetStreamInfo",!0),a(this,"_dispatcherStatus",!1),a(this,"_playingState",null),a(this,"_transport",void 0),a(this,"_getStreamInfoListener",void 0),a(this,"_setQualityListener",void 0),a(this,"_setReceiveSDPListener",void 0),a(this,"_setBroadcastSDPListener",void 0),a(this,"_muteTrackListener",void 0),a(this,"_stopStreamListener",void 0),a(this,"_onWebsocketTransportStateChangedListener",void 0),a(this,"_onWebsocketTransportMessageReceivedListener",void 0),a(this,"_onSendPublisherReportListener",void 0),a(this,"_onRawMessageSentListener",void 0),a(this,"_unpublishStreamListener",void 0),a(this,"_onSetNoiseLevelListener",void 0),a(this,"_onPlayingStatusChangedListener",void 0),a(this,"_logger",void 0),a(this,"_eventBus",void 0),a(this,"_inactivityManager",void 0),this._eventBus=e,this._logger=(0,l.Logger)(this._eventBus,"Ristretto - MetadataTransport"),this._transport=new _.WebsocketTransport(this._eventBus),this._inactivityManager=new A.InactivityReconnectManager(this._eventBus,this._handleInactivityReconnect),this._getStreamInfoListener=this._eventBus.subscribe(f.EMetadataTransportEvents.GET_STREAM_INFO,this._getStreamInfo),this._setQualityListener=this._eventBus.subscribe(f.EMetadataTransportEvents.SET_QUALITY,this._setQuality),this._setReceiveSDPListener=this._eventBus.subscribe(f.EMetadataTransportEvents.SEND_RECEIVE_SDP,this._setReceiveSDP),this._setBroadcastSDPListener=this._eventBus.subscribe(f.EMetadataTransportEvents.SEND_BROADCAST_SDP,this._setBroadcastSDP),this._muteTrackListener=this._eventBus.subscribe(f.EMetadataTransportEvents.MUTE_TRACK,this._muteTrack),this._stopStreamListener=this._eventBus.subscribe(f.EMetadataTransportEvents.STOP_STREAM,this._stopStream),this._onWebsocketTransportMessageReceivedListener=this._eventBus.subscribe(g.EWebsocketTransportEvents.MESSAGE_RECEIVED,this._onWebsocketTransportMessageReceived),this._onWebsocketTransportStateChangedListener=this._eventBus.subscribe(g.EWebsocketTransportEvents.STATE_CHANGED,this._onWebsocketTransportStateChanged),this._onRawMessageSentListener=this._eventBus.subscribe(f.EMetadataTransportEvents.SEND_RAW_MESSAGE,this._sendRawMessage),this._unpublishStreamListener=this._eventBus.subscribe(f.EMetadataTransportEvents.UN_PUBLISH_STREAM,this._unPublishStream),this._onSendPublisherReportListener=this._eventBus.subscribe(f.EMetadataTransportEvents.SEND_PUBLISHER_REPORT,this._sendPublisherReport),this._onSetNoiseLevelListener=this._eventBus.subscribe(f.EMetadataTransportEvents.SET_NOISE_LEVEL,this._setNoiseLevel),this._onPlayingStatusChangedListener=this._eventBus.subscribe(u.ECommonEvent.PLAYING_STATE_CHANGED,this._handlePlayingStateChanged),this._eventBus.publish(R.EBroadcastLogsEvents.REPORT_EVENT,{event:O.EBroadcastLogsEvent.SOCKET_CONNECTION_OPEN_REQUESTED,description:"Metadata transport created"}),this._logger.info("Created")}destroy(e){this._logger.info("Destroyed with reason ".concat(e)),this._transport.destroy(),this._inactivityManager.destroy(),this._eventBus.publish(R.EBroadcastLogsEvents.REPORT_EVENT,{event:O.EBroadcastLogsEvent.SOCKET_CONNECTION_CLOSE_REQUESTED,description:"Metadata transport close requested with reason ".concat(e)}),this._eventBus.unsubscribe(this._getStreamInfoListener),this._eventBus.unsubscribe(this._setQualityListener),this._eventBus.unsubscribe(this._setReceiveSDPListener),this._eventBus.unsubscribe(this._setBroadcastSDPListener),this._eventBus.unsubscribe(this._muteTrackListener),this._eventBus.unsubscribe(this._stopStreamListener),this._eventBus.unsubscribe(this._onWebsocketTransportStateChangedListener),this._eventBus.unsubscribe(this._onWebsocketTransportMessageReceivedListener),this._eventBus.unsubscribe(this._onRawMessageSentListener),this._eventBus.unsubscribe(this._onSendPublisherReportListener),this._eventBus.unsubscribe(this._unpublishStreamListener),this._eventBus.unsubscribe(this._onSetNoiseLevelListener),this._eventBus.unsubscribe(this._onPlayingStatusChangedListener)}setAclToken(e){this._logger.debug("ACL token updated: ".concat(this._aclToken," -> ").concat(e)),this._aclToken=e}sendStopStreamMessage(){this._logger.debug("Trying to send stopStream message"),this._streamId&&this._state===h.EMetadataTransportState.CONNECTED?this._eventBus.publishSync(f.EMetadataTransportEvents.STOP_STREAM,{streamId:this._streamId}):this._logger.debug("No streamId defined or transport is not connected. Could not send stopStream message")}setAppKey(e){this._logger.debug("App key updated: ".concat(this._appKey," -> ").concat(e)),this._appKey=e}setQuality(e){this._logger.debug("Quality updated: ".concat(this._quality," -> ").concat(e)),this._quality=e}resendPlayStreamWithPreviousData(){this._lastPlayPlayStreamParams&&(this._logger.warn("resendPlayStreamWithPreviousData: Some error must have occured after the previous playStream, going to send another playStream",i({},this._lastPlayPlayStreamParams)),this._sendPlayStream(this._lastPlayPlayStreamParams))}startOverWithoutReconnect(e){this._logger.debug("Start over without reconnect requested, the reason is ".concat(e)),this._streamId&&this._startSessionNegotiation(this._streamId,"startOverWithoutReconnect")}setStreamId(e){var t=this;return s(function*(){t._streamId!==e&&(t._logger.debug("Stream id updated: ".concat(t._streamId," -> ").concat(e,". Resending playStream event")),t._state===h.EMetadataTransportState.CONNECTED&&(t.sendStopStreamMessage(),t._logger.verbose("Stream id update flow: Awaiting for stopStream confirmation"),yield(0,m.awaitForStopConfirmation)(t._eventBus),t._logger.verbose("Stream id update flow: StopStream confirmed"),t._streamId=e,t._streamId?t._dispatcherStatus?(t._logger.verbose("Stream id update flow: restart session negotiation"),t._startSessionNegotiation(t._streamId,"setStreamId"),t._setState(h.EMetadataTransportState.UNKNOWN)):t._logger.warn("Stream id was set while dispatcher is inactive! Skipping renegotiation"):t._logger.verbose("Stream id update flow: no streamId defined, could not restart session negotiation")),t._streamId=e)})()}setWebsocketServerUrl(e){this._websocketServerUrl!==e&&(this._supportsGetStreamInfo=!0,this._logger.debug("Websocket url updated: ".concat(this._websocketServerUrl," -> ").concat(e)),this.sendStopStreamMessage(),this._setState(h.EMetadataTransportState.UNKNOWN),this._websocketServerUrl=e,this._transport.setWebsocketUrl(e))}setIsFastStartEnabled(e){this._logger.debug("FastStart status updated: ".concat(this._isFastStartEnabled," -> ").concat(e)),this._isFastStartEnabled=e}setFlexFECOverhead(e){this._logger.debug("FlexFEXOverhead amount updated: ".concat(this._flexFECOverhead," -> ").concat(e)),this._flexFECOverhead=e}setSendFlexFECOverhead(e){this._logger.debug("FlexFEXOverhead message status updated: ".concat(this._sendFlexFECOverhead," -> ").concat(e)),this._sendFlexFECOverhead=e}setDispatcherStatus(e){this._dispatcherStatus=e}_sendRawMessage(e){var{msg:t}=e;this._transport.sendRawMessage(t)}_setState(e){if(this._state!==e){e===h.EMetadataTransportState.IDLE&&this._state===h.EMetadataTransportState.UNKNOWN&&this._eventBus.publish(c.ELifecycleEvent.LIFECYCLE_EVENT,{eventType:c.ELifecycleEvents.SOCKET_OPENED});var t=this._state;this._state=e,this._logger.debug("State changed: ".concat(this._state," -> ").concat(e)),this._eventBus.publish(f.EMetadataTransportEvents.TRANSPORT_STATE_CHANGED,{prevState:t,nextState:e,isGetStreamInfoMessageSupported:this._supportsGetStreamInfo})}}_getStreamInfo(e){var{streamId:t}=e;this._logger.debug("Sending availableStream message for stream id ".concat(t)),this._transport.sendMessage({message:v.EOutgoingMessage.GET_STREAM_INFO,data:{mediaSessionId:this._mediaSessionId,modelName:t||this._streamId||""}})}_setQuality(e){var{quality:t}=e;t!==this._quality&&(this._logger.debug("Requesting MMS to change quality: ".concat(this._quality," -> ").concat(t)),this._quality=t,this._transport.isReady()&&this._playingState===y.EStreamStatus.LIVE&&!this._isInPendingState()&&this._transport.sendMessage({message:v.EOutgoingMessage.CHANGE_QUALITY,data:{mediaSessionId:this._mediaSessionId,quality:this._quality}}))}_setReceiveSDP(e){this._logger.debug("setReceiveSDP: An offer was created by client and now going to be sent to the server"),this._sendPlayStream(e)}_sendPlayStream(e){var{sdp:t,streamId:r}=e;this._lastPlayPlayStreamParams={sdp:t,streamId:r},this._eventBus.publish(c.ELifecycleEvent.RESOLUTION_SWITCH_AUTO,{nextResolution:this._quality}),this._logger.debug("Requesting MMS to start stream playback for streamId ".concat(r));var n={hasAudio:!0,hasVideo:!0,mediaProvider:"WebRTC",mediaSessionId:this._mediaSessionId,name:r,published:!1,quality:this._quality,record:!1,sdp:t,transport:"UDP",status:"PENDING",width:0,height:0,bitrate:0,minBitrate:0,maxBitrate:0,fastStart:this._isFastStartEnabled};this._sendFlexFECOverhead&&(n.flexfecOverhead=this._flexFECOverhead),this._transport.sendMessage({message:v.EOutgoingMessage.PLAY_STREAM,data:[n]})}_setBroadcastSDP(e){var t,r,n,o,{sdp:s,streamId:a,publishCustomData:l={},token:u,minBitrate:c,maxBitrate:h,probingCacheKey:f}=e,p={videoSideDataExtensions:{}};d.hasInsertableStreamsSupport&&(p.videoSideDataExtensions.clockSEIUuid=d.TIME_SYNC_READABLE_UUID);var g={constraints:{video:{minBitrate:c,maxBitrate:h}},streamCapabilities:p,custom:i({token:u,userId:Number(a),moduleVersion:L.RISTRETTO_VERSION},l),hasAudio:!0,hasVideo:!0,mediaProvider:"WebRTC",mediaSessionId:this._mediaSessionId,name:a,published:!0,record:!1,sdp:s,transport:null},_="safari"===E.browserInfo.getBrowserName(!0)&&!(null===(t=E.browserInfo.getBrowserVersion())||void 0===t||!t.includes("18.4")),m="safari"===E.browserInfo.getBrowserName(!0)&&!(null===(r=E.browserInfo.getBrowserVersion())||void 0===r||!r.includes("18.5")),y="ios"===E.browserInfo.getOSName(!0)&&!(null===(n=E.browserInfo.getOSVersion())||void 0===n||!n.includes("18.4")),b="ios"===E.browserInfo.getOSName(!0)&&!(null===(o=E.browserInfo.getOSVersion())||void 0===o||!o.includes("18.5"));(_||y||m||b)&&(g.forceVideoClockRate=1e6),f&&(g.probingCacheKey=f),this._transport.sendMessage({message:v.EOutgoingMessage.PUBLISH_STREAM,data:[g]})}_muteTrack(e){var{isMuted:t}=e;this._isMuteEventSupported?(this._logger.debug("Requesting MMS to change status of track mute: ".concat(t)),this._transport.sendMessage({message:v.EOutgoingMessage.MUTE_TRACK,data:{mediaSessionId:this._mediaSessionId,muteAudioTrack:t}})):this._logger.debug("Mute track requested while no confirmation of support is received")}_stopStream(e){var{streamId:t}=e;this._logger.debug("Requesting MMS to stop stream for streamId ".concat(t," in current state ").concat(this._state)),this._state!==h.EMetadataTransportState.STOPPING?[h.EMetadataTransportState.UNKNOWN,h.EMetadataTransportState.IDLE].includes(this._state)?this._logger.info("Skipping stopStream message as we are still in idle state"):(this._transport.sendMessage({message:v.EOutgoingMessage.STOP_STREAM,data:[{hasAudio:!0,hasVideo:!0,mediaProvider:"WebRTC",mediaSessionId:this._mediaSessionId,name:t,published:!1,record:!1}]}),this._setState(h.EMetadataTransportState.STOPPING)):this._logger.warn("Still waiting for the server response for the previous STOP_STREAM. Another STOP_STREAM won't be send")}_unPublishStream(e){var{streamId:t,regularBroadcastStopReason:r}=e;this._logger.debug("Notifying MMS about stream unpublish for streamId ".concat(t)),this._transport.sendMessage({message:v.EOutgoingMessage.UN_PUBLISH_STREAM,data:[{hasAudio:!0,hasVideo:!0,mediaProvider:"WebRTC",mediaSessionId:this._mediaSessionId,name:t,published:!1,record:!1,regularBroadcastStopReason:r||void 0}]})}_onWebsocketTransportStateChanged(e){var{nextState:t,prevState:r}=e;this._logger.debug("Underlying transport state changed: ".concat(r," -> ").concat(t)),t===p.ESocketConnectionState.CONNECTED&&(this._logger.verbose("Underlying transport is connected now."),this._setState(h.EMetadataTransportState.IDLE)),t===p.ESocketConnectionState.OFFLINE&&(this._logger.verbose("Transport is offline now. Recreating media session id"),this._mediaSessionId=(0,T.uuidv4)(),this._setState(h.EMetadataTransportState.DISCONNECTED))}_handlePlayingStateChanged(e){var{nextState:t}=e;this._playingState=t}_onWebsocketTransportMessageReceived(e){if(this._logger.verbose('WebSocket message "'.concat(e.message,'" received.'),e),this._state!==h.EMetadataTransportState.STOPPING||e.message===v.EIncomingMessage.NOTIFY_STREAM_STATUS_EVENT)switch(e.message!==v.EIncomingMessage.PING&&this._eventBus.publish(f.EMetadataTransportEvents.STREAM_RELATED_MESSAGE_RECEIVED,{}),e.message){case v.EIncomingMessage.PING:this._respondPing();break;case v.EIncomingMessage.CONNECTED:this._handleConnectedMessage(e.data);break;case v.EIncomingMessage.SET_REMOTE_SDP:this._onRemoteSdpAvailable(e.data[0],e.data[1]);break;case v.EIncomingMessage.GET_USER_DATA:this._handleGetUserDataMessage();break;case v.EIncomingMessage.GET_STREAM_INFO_REPLY:this._handleGetStreamInfoReply(e.data);break;case v.EIncomingMessage.NOTIFY_STREAM_STATUS_EVENT:return void this._handleNotifyStreamStatusEvent(e.data[0]);case v.EIncomingMessage.CHANGE_QUALITY_STATUS:return void this._handleChangeQualityStatus(e.data);case v.EIncomingMessage.FAIL:return void this._handleFailMessage(e.data[0]);case v.EIncomingMessage.CONNECTION_CLOSED:return void this._handleConnectionClosed(e.data);case v.EIncomingMessage.INBOUND_VIDEO_RATE:this._handleInboundVideoRate(e.data[0])}else this._logger.info("Ignoring message because we are waiting for stop confirmation")}_handleInactivityReconnect(){this._mediaSessionId=(0,T.uuidv4)(),this._setState(h.EMetadataTransportState.DISCONNECTED)}_onDifferMediaSessionIdDetected(){this._eventBus.publish(b.EStreamDispatcherEvent.REQUIRE_STREAM_RESTART,{errorOptions:{reason:"Different media session id was detected"}}),this._logger.warn("Media session id has been changed")}_isInPendingState(){return this._state===h.EMetadataTransportState.STOPPING||this._state===h.EMetadataTransportState.CONNECTING}_handleConnectionClosed(e){this._isInPendingState()&&this._setState(h.EMetadataTransportState.UNKNOWN),this._logger.warn("Connection closed with reason ".concat(e.description,", starting over")),this._eventBus.publish(b.EStreamDispatcherEvent.REQUIRE_STREAM_RESTART,{errorOptions:{reason:"Connection closed"}})}_handleInboundVideoRate(e){var{fps:t}=e;this._inactivityManager.arm(P.EInactivityTriggerMessage.INBOUND_VIDEO_RATE_INACTIVITY),this._eventBus.publish(R.EBroadcastLogsEvents.REPORT_EVENT,{event:O.EBroadcastLogsEvent.BROADCAST_SUCCESS,description:"First inboundVideoRate message received"}),this._eventBus.publish(f.EMetadataTransportEvents.INBOUND_VIDEO_RATE_RECEIVED,{fps:t})}_handleFailMessage(e){this._isInPendingState()&&this._setState(h.EMetadataTransportState.UNKNOWN),this._eventBus.publish(f.EMetadataTransportEvents.PUBLISH_FAILED,{reason:"".concat(e.info," at ").concat(e.apiMethod)})}_handleChangeQualityStatus(e){this._eventBus.publish(f.EMetadataTransportEvents.CHANGE_QUALITY_STATUS,{payload:e})}_handleNotifyStreamStatusEvent(e){var t=this;return s(function*(){t._state!==h.EMetadataTransportState.STOPPING||"STOPPED"===e.status?("FAILED"===e.status&&(t._logger.info("handleNotifyStreamStatusEvent, status FAILED; Client received notifyStreamStatusEvent from the server",e),t._eventBus.publish(f.EMetadataTransportEvents.STREAM_UNAVAILABLE,{reason:e.info||"",recoverable:(0,S.isErrorRecoverable)(e.info)}),t._setState(h.EMetadataTransportState.IDLE)),"STOPPED"===e.status&&"Stopped by user"===e.info&&(t._setState(h.EMetadataTransportState.IDLE),t._eventBus.publish(f.EMetadataTransportEvents.STREAM_STOP_APPROVED,{})),"UNPUBLISHED"===e.status&&(t._setState(h.EMetadataTransportState.IDLE),t._eventBus.publish(f.EMetadataTransportEvents.UN_PUBLISH_STREAM_APPROVED,{})),"PLAYING"===e.status&&(t._isInPendingState()&&t._setState(h.EMetadataTransportState.CONNECTED),t._eventBus.publish(f.EMetadataTransportEvents.STREAM_PLAYING,{quality:t._quality}))):t._logger.info("Ignoring streamStatusEvent as waiting for stopped status")})()}_handleConnectedMessage(e){e&&(this._isMuteEventSupported=e.features.muteTracks),e.features.abrPolicy&&(this._abrPolicy=e.features.abrPolicy===h.EAbrPolicy.CLIENT?h.EAbrPolicy.CLIENT:h.EAbrPolicy.SERVER),"boolean"==typeof e.features.getStreamInfo&&(this._supportsGetStreamInfo=e.features.getStreamInfo),e.peerConfig&&this._eventBus.publish(f.EMetadataTransportEvents.PEER_CONFIG_AVAILABLE,{config:e.peerConfig}),this._setState(h.EMetadataTransportState.CONNECTED)}_handleGetUserDataMessage(){this._setState(h.EMetadataTransportState.CONNECTED)}_startSessionNegotiation(e,t){this._logger.debug("Start session negotiation, the reason is ".concat(t)),this._appKey?this._state!==h.EMetadataTransportState.CONNECTING?(this._mediaSessionId=(0,T.uuidv4)(),this._setState(h.EMetadataTransportState.CONNECTING),this._transport.sendMessage({message:v.EOutgoingMessage.CONNECTION,data:[{appKey:this._appKey,clientBrowserVersion:navigator.userAgent,clientOSVersion:navigator.appVersion,mediaProviders:["WebRTC"],custom:{name:e,aclAuth:this._aclToken||""}}]})):this._logger.warn("Still waiting for the server response for the previous CONNECTION. Another CONNECTION won't be send"):this._logger.warn("App key is not defined. Cannot start negotiation")}_respondPing(){this._transport.sendMessage({message:v.EOutgoingMessage.PONG,data:[]})}_onRemoteSdpAvailable(e,t){e!==this._mediaSessionId&&this._onDifferMediaSessionIdDetected(),this._eventBus.publish(c.ELifecycleEvent.LIFECYCLE_EVENT,{eventType:c.ELifecycleEvents.SDP_RECEIVED}),this._eventBus.publish(f.EMetadataTransportEvents.REMOTE_SDP_RECEIVED,{sdp:t})}_handleGetStreamInfoReply(e){e.mediaSessionId===this._mediaSessionId?this._eventBus.publish(f.EMetadataTransportEvents.GET_STREAM_INFO_REPLY,e):this._onDifferMediaSessionIdDetected()}_sendPublisherReport(e){var{payload:t}=e;this._transport.sendMessage({message:v.EOutgoingMessage.PUBLISHER_REPORT,data:[i(i({},t),{},{mediaSessionId:this._mediaSessionId})]})}_setNoiseLevel(e){var{value:t}=e;this._transport.sendMessage({message:v.EOutgoingMessage.UPDATE_CONFIG,data:{mediaSessionId:this._mediaSessionId,config:{"wl.mouflon.NoiseControl.min_bitrate":t}}})}get state(){return this._state}}t.MetadataTransport=M,n([C.default],M.prototype,"_sendRawMessage",null),n([C.default],M.prototype,"_getStreamInfo",null),n([C.default],M.prototype,"_setQuality",null),n([C.default],M.prototype,"_setReceiveSDP",null),n([C.default],M.prototype,"_sendPlayStream",null),n([C.default],M.prototype,"_setBroadcastSDP",null),n([C.default],M.prototype,"_muteTrack",null),n([C.default],M.prototype,"_stopStream",null),n([C.default],M.prototype,"_unPublishStream",null),n([C.default],M.prototype,"_onWebsocketTransportStateChanged",null),n([C.default],M.prototype,"_handlePlayingStateChanged",null),n([C.default],M.prototype,"_onWebsocketTransportMessageReceived",null),n([C.default],M.prototype,"_handleInactivityReconnect",null),n([C.default],M.prototype,"_sendPublisherReport",null),n([C.default],M.prototype,"_setNoiseLevel",null)},3952:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ELoggerEvents=t.EventBus=void 0;var n,i=r(83);r(5458),t.EventBus=new i.EventBus,function(e){e.LOG="logger.log"}(n||(t.ELoggerEvents=n={}))},3988:(e,t,r)=>{r.d(t,{A:()=>n});var n=r(1917).A.Uint8Array},3998:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AggregationsContainer=void 0,t.AggregationsContainer=class{constructor(e){a(this,"_values",[]),a(this,"_maxValue",-1/0),a(this,"_minValue",1/0),a(this,"_avgValue",0),a(this,"_count",0),a(this,"_sum",0),a(this,"_isMaxEnabled",!1),a(this,"_isMinEnabled",!1),a(this,"_isAvgEnabled",!1),a(this,"_isMedianEnabled",!1),a(this,"_isCountEnabled",!1),a(this,"_isSumEnabled",!1),e.includes("median")&&(this._isMedianEnabled=!0),e.includes("min")&&(this._isMinEnabled=!0),e.includes("max")&&(this._isMaxEnabled=!0),e.includes("avg")&&(this._isCountEnabled=!0,this._isAvgEnabled=!0),e.includes("count")&&(this._isCountEnabled=!0),e.includes("sum")&&(this._isSumEnabled=!0)}addValue(e){this._isCountEnabled&&this._increaseCounter(),this._isSumEnabled&&this._addToSum(e),this._isMedianEnabled&&this._values.push(e),this._isMaxEnabled&&this._addMaxValue(e),this._isMinEnabled&&this._addMinValue(e),this._isAvgEnabled&&this._addAvgValue(e)}addValues(e){e.forEach(e=>{this.addValue(e)})}clear(){this._values=[],this._maxValue=-1/0,this._minValue=1/0,this._avgValue=0,this._count=0,this._sum=0}clearMedian(){this._values=[]}clearMax(){this._maxValue=-1/0}clearMin(){this._minValue=-1/0}_increaseCounter(){this._count++}_addMaxValue(e){e>this._maxValue&&(this._maxValue=e)}_addMinValue(e){e<this._minValue&&(this._minValue=e)}_addAvgValue(e){this._avgValue+=(e-this._avgValue)/this._count}_addToSum(e){this._sum+=e}get max(){return this._maxValue>-1/0?this._maxValue:null}get min(){return this._minValue<1/0?this._minValue:null}get avg(){return this._count?this._avgValue:null}get count(){return this._count}get sum(){return this._sum}get median(){if(!this._values.length)return null;var e=[...this._values].sort((e,t)=>e-t),t=Math.floor(e.length/2);return e.length%2==0?(e[t-1]+e[t])/2:e[t]}}},4012:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.StateController=void 0;var o=r(6847),s=r(4578),l=r(5458),u=r(6671);class c{constructor(e){a(this,"_config",{}),a(this,"_logger",void 0),a(this,"_eventsMap",{[s.EVideoElementControllerBusEvent.PLAYING]:this._handlePlaying,[s.EVideoElementControllerBusEvent.LOADING]:this._handleLoading,[s.EVideoElementControllerBusEvent.VIDEO_PAUSE]:this._handlePause,[s.EVideoElementControllerBusEvent.CAN_PLAY]:this._handleCanPlay,[s.EVideoElementControllerBusEvent.PAUSED]:this._handlePaused,[s.EVideoElementControllerBusEvent.RESTART]:this._handleRestart,[s.EVideoElementControllerBusEvent.UPDATED]:this._handleUpdate,[s.EVideoElementControllerBusEvent.STALLED]:this._handleStalled,[s.EVideoElementControllerBusEvent.WAITING]:this._handleWaiting,[s.EVideoElementControllerBusEvent.UPDATE_PLAYER_RESOLUTION]:this._handleUpdatePlayerResolution,[s.EVideoElementControllerBusEvent.ERROR]:this._handleError,[s.EVideoElementControllerBusEvent.SET_VOLUME]:this._handleSetVolume,[s.EVideoElementControllerBusEvent.DESTROY]:this.destroy}),a(this,"_state",void 0),a(this,"_eventBus",void 0),this._state=e.state,this._eventBus=e.eventBus,this._logger=(0,o.Logger)(this._eventBus,"VideoElementController - StateController"),this._logger.info("Created"),this._logger.verbose("Initial state",e.state),this.init()}setConfig(e){this._logger.debug("Config update received, the new one:",e),this._config=e}destroy(){this._logger.info("Destroy"),this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap}),this._state.resetState(),this._state.setState({isDestroyed:!0})}init(){this._logger.info("Initialization requested, attaching eventBus listeners"),this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}_updateState(e){var t=this._state.getState().videoPlaybackState,r=t;e.isPlaying?r=l.EPlaybackState.PLAYING:e.isLoading?r=l.EPlaybackState.LOADING:e.isPaused?r=l.EPlaybackState.PAUSED:e.isError&&(r=l.EPlaybackState.ERROR),this._logger.debug("State updated: ".concat(t," -> ").concat(r)),this._state.setState(i(i({},e),{},{videoPlaybackState:r})),t!==r&&this._eventBus.publish(s.EVideoElementControllerBusEvent.VIDEO_PLAYBACK_STATE_CHANGED,{prevState:t,nextState:r})}_handlePlaying(){this._logger.debug("Playing event received"),this._updateState({isPlaying:!0,startedPlaying:!0,isLoading:!1,isStalled:!1,isWaiting:!1,isPaused:!1,isError:!1})}_handleLoading(){this._logger.debug("Loading event received"),this._updateState({isLoading:!0,isPlaying:!1})}_handlePause(){this._logger.debug("Pause event received"),this._updateState({isPlaying:!1,isPaused:!0})}_handlePaused(){this._logger.debug("Paused event received"),this._updateState({isPlaying:!1,isLoading:!1,isPaused:!0})}_handleCanPlay(){this._logger.debug("CanPlay event received"),this._updateState({canPlay:!0,isDestroyed:!1})}_handleRestart(){this._logger.debug("Restart event received"),this._updateState({isRestarted:!0})}_handleStalled(){this._logger.debug("Stalled event received"),this._updateState({isStalled:!0})}_handleWaiting(){this._logger.debug("Waiting event received"),this._updateState({isWaiting:!0})}_handleError(){this._logger.debug("Error event received"),this._updateState({isError:!0})}_handleSetVolume(e){var{volume:t}=e;this._logger.debug("Volume event received",{volume:t}),this._updateState({volume:t})}_handleUpdatePlayerResolution(e){this._logger.debug("Player resolution event received",{height:e.height,width:e.width}),this._updateState({videoElementResolution:{height:e.height,width:e.width}})}_handleUpdate(){this._logger.debug("Update event received"),this._updateState({canPlay:!1,isLoading:!0,isPlaying:!1,isRestarted:!1,isPaused:!1,isError:!1})}}t.StateController=c,n([u.bind],c.prototype,"destroy",null),n([u.bind],c.prototype,"init",null),n([u.bind],c.prototype,"_updateState",null),n([u.bind],c.prototype,"_handlePlaying",null),n([u.bind],c.prototype,"_handleLoading",null),n([u.bind],c.prototype,"_handlePause",null),n([u.bind],c.prototype,"_handlePaused",null),n([u.bind],c.prototype,"_handleCanPlay",null),n([u.bind],c.prototype,"_handleRestart",null),n([u.bind],c.prototype,"_handleStalled",null),n([u.bind],c.prototype,"_handleWaiting",null),n([u.bind],c.prototype,"_handleError",null),n([u.bind],c.prototype,"_handleSetVolume",null),n([u.bind],c.prototype,"_handleUpdatePlayerResolution",null),n([u.bind],c.prototype,"_handleUpdate",null)},4022:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var n=r(3549),i=r(3149),o=function(e,t,r){var o=!0,s=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return(0,i.A)(r)&&(o="leading"in r?!!r.leading:o,s="trailing"in r?!!r.trailing:s),(0,n.A)(e,t,{leading:o,maxWait:t,trailing:s})}},4030:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OriginalTargetBufferDecreaser=void 0;var o=r(355),s=r(6791),l=r(8169),u=r(180),c=r(1084),d=i(r(6073));class h extends l.ConfigConsumer{constructor(e){super("originalTargetBufferDecreaser",e),a(this,"state",u.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["PlaybackSpeed"]),a(this,"additionalInfo",void 0),a(this,"_nextCheckTimestamp",0),a(this,"_currentMultiplier",0),a(this,"_increaseEventsCollector",new c.EventsInPeriodWindow),a(this,"_onTargetBufferIncreasedListener",void 0),a(this,"_onBufferMetricsAvailableListener",void 0),this.additionalInfo={isDecreasingDisabled:!1,currentMultiplier:this._currentMultiplier},this._onTargetBufferIncreasedListener=this._eventBus.subscribe(s.TargetBufferEvents.targetBufferIncreased,this._onTargetBufferIncreased),this._onBufferMetricsAvailableListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onTargetBufferIncreasedListener),this._eventBus.unsubscribe(this._onBufferMetricsAvailableListener)}_updateIsDisabledAdditionalInfo(){this.additionalInfo.isDecreasingDisabled=!0}_updateMultiplier(){this._currentMultiplier+=1,this.additionalInfo.currentMultiplier=this._currentMultiplier}_onTargetBufferIncreased(){this._increaseEventsCollector.registerEvent(),this._eventBus.publish(s.TargetBufferEvents.originalTargetBufferDisable,{}),this._updateIsDisabledAdditionalInfo()}_onBufferMetricsAvailable(){0!==this._nextCheckTimestamp&&this._nextCheckTimestamp<performance.now()&&this.config.allowTargetBufferDecrease&&0===this._increaseEventsCollector.checkEventsInPeriod(this.config.targetBufferDecreaseTimeout)&&this._currentMultiplier<this.config.maxTargetBufferMultiplier&&(this._eventBus.publish(s.TargetBufferEvents.originalTargetBufferDecreaseRequested,{}),this._updateMultiplier(),this._nextCheckTimestamp=performance.now()+this.config.targetBufferDecreaseTimeout),this._nextCheckTimestamp=0===this._nextCheckTimestamp?performance.now()+this.config.targetBufferDecreaseTimeout:this._nextCheckTimestamp}}t.OriginalTargetBufferDecreaser=h,n([d.default],h.prototype,"destroy",null),n([d.default],h.prototype,"_onTargetBufferIncreased",null),n([d.default],h.prototype,"_onBufferMetricsAvailable",null)},4040:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.queued=void 0;var n=r(1573);t.queued=()=>{var e=new WeakMap;return function(t,r,i){var o=i.value;return i.value=function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var s=e.get(this);s||(s=new n.QueueLocker,e.set(this,s)),s.enqueue(()=>o.apply(this,r))},i}}},4099:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e,t){return e.has(t)}},4121:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackStateController=void 0;var o=r(355),s=r(1421),l=r(6791),u=r(5312),c=r(8169),d=r(835),h=r(6701),f=r(9088),p=i(r(6073));class v extends c.ConfigConsumer{constructor(e){super("playbackStateController",e),a(this,"_currentState",u.EPlaybackState.IDLE),a(this,"_numberOfStallsOnEdge",0),a(this,"_videoElement",null),a(this,"_syncOnNextMetrics",!1),a(this,"_isInStall",!1),a(this,"_targetLiveEdge",6),a(this,"_stallTS",0),a(this,"_startTS",0),a(this,"_stalledTimeRanges",[]),a(this,"_onPlaybackMetricsReadyListener",void 0),a(this,"_onResolutionChangedListener",void 0),a(this,"_onFragmentRequestedListener",void 0),a(this,"_stallsToChangeState",3),a(this,"_onPlaylistInfoAvailableListener",void 0),a(this,"_onPlayingTimeFractionRequestedListener",void 0),this._onPlaybackMetricsReadyListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onMetricsAvailable),this._onResolutionChangedListener=this._eventBus.subscribe(d.ResolutionsManagerEvents.resolutionChanged,this.reset),this._onFragmentRequestedListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.fragmentLoader.fragments.fragmentLoadingStarted,this._onFragmentRequested),this._onPlaylistInfoAvailableListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.playlistRotator.playlists.playlistInfo,this._onPlaylistInfoAvailable),this._onPlayingTimeFractionRequestedListener=this._eventBus.subscribe(s.GetSideMetricsAsyncEvents.getPlayingTimeFraction,this._onPlayingTimeFractionRequested)}destroy(){var e,t,r;super.destroy(),this._eventBus.unsubscribe(this._onPlaybackMetricsReadyListener),this._eventBus.unsubscribe(this._onResolutionChangedListener),this._eventBus.unsubscribe(this._onFragmentRequestedListener),this._eventBus.unsubscribe(this._onPlaylistInfoAvailableListener),this._eventBus.unsubscribe(this._onPlayingTimeFractionRequestedListener),null!==(e=this._videoElement)&&void 0!==e&&e.removeEventListener("canplaythrough",this._onCanPlayThrough),null!==(t=this._videoElement)&&void 0!==t&&t.removeEventListener("play",this._onPlay),null===(r=this._videoElement)||void 0===r||r.removeEventListener("playing",this._onPlaying)}setVideoElement(e){var t,r,n,i,o;this._videoElement&&(this._videoElement.removeEventListener("canplaythrough",this._onCanPlayThrough),null!==(t=this._videoElement)&&void 0!==t&&t.removeEventListener("play",this._onPlay),null!==(r=this._videoElement)&&void 0!==r&&r.removeEventListener("playing",this._onPlaying)),this._videoElement=e,null!==(n=this._videoElement)&&void 0!==n&&n.addEventListener("canplaythrough",this._onCanPlayThrough),null!==(i=this._videoElement)&&void 0!==i&&i.addEventListener("play",this._onPlay),null===(o=this._videoElement)||void 0===o||o.addEventListener("playing",this._onPlaying)}reset(){this._currentState=u.EPlaybackState.IDLE,this._numberOfStallsOnEdge=0}resetPlayingTimeCollector(){this._stallTS=0,this._startTS=0,this._stalledTimeRanges=[]}_handleConfigUpdated(){}_setNextState(e){e!==this._currentState&&(this._eventBus.publish(o.BufferControllerEvents.playbackStateChanged,{prevState:this._currentState,nextState:e}),this._currentState=e)}_onFragmentRequested(){this._currentState===u.EPlaybackState.IDLE&&this._setNextState(u.EPlaybackState.LOADING)}_onMetricsAvailable(e){if(this._syncOnNextMetrics&&e.bufferedTimeRanges.length&&(this._syncOnNextMetrics=!1,this._syncToLiveEdge(e.bufferedTimeRanges.slice(-1)[0].end)),this._currentState!==u.EPlaybackState.IDLE){this._isInStall!==e.isStallCandidate&&(this._isInStall=e.isStallCandidate,e.isStallCandidate?this._onStall():this._onPlaying());var t=0===e.playbackPositionDelta&&e.isOnBufferEdge;if(!t)return this._numberOfStallsOnEdge=0,void this._setNextState(u.EPlaybackState.PLAYING);t&&this._currentState===u.EPlaybackState.PLAYING&&this._numberOfStallsOnEdge++,this._numberOfStallsOnEdge>=this._stallsToChangeState&&this._setNextState(u.EPlaybackState.PAUSED),this._isInStall&&this.config.stallDurationToDisableTargetBufferDecrease<=Date.now()-this._stallTS&&this._eventBus.publish(l.TargetBufferEvents.originalTargetBufferDisable,{})}}_onCanPlayThrough(){var e;this._startTS||(this._startTS=Date.now()),this.config.autoPlay&&(null===(e=this._videoElement)||void 0===e||e.play())}_onPlaylistInfoAvailable(e){this._targetLiveEdge=(0,f.getPartHoldback)(e,3*e.targetDuration)}_onPlay(){this.config.syncToLiveEdge&&this._videoElement&&(this._videoElement.buffered.length?this._syncToLiveEdge(this._videoElement.buffered.end(this._videoElement.buffered.length-1)):this._syncOnNextMetrics=!0)}_getDesiredPosition(e){return e-this.config.syncToLiveDelta*this._targetLiveEdge}_syncToLiveEdge(e){var t;if(this._videoElement&&null!==(t=this._videoElement)&&void 0!==t&&t.buffered.length){var r=this._getDesiredPosition(e);r>this._videoElement.buffered.start(0)&&r>this._videoElement.currentTime&&(this._videoElement.currentTime=r)}}_onPlaying(){this._stallTS&&(this._stalledTimeRanges.push({startTS:this._stallTS,endTS:Date.now()}),this._stallTS=0)}_onStall(){this._stallTS=Date.now()}_onPlayingTimeFractionRequested(){var e=this._calculatePlayingTimeFraction();this._eventBus.publish(s.GetSideMetricsAsyncEvents.getPlayingTimeFractionAvailable,e)}_calculatePlayingTimeFraction(){if(!this._startTS)return null;var e=Date.now()-this.config.playingTimeFractionCollectionWindow;this._stalledTimeRanges=this._stalledTimeRanges.filter(t=>{var{endTS:r}=t;return r>e});var t=Date.now()-this._startTS,r=t-this._stalledTimeRanges.reduce((e,t)=>e+(t.endTS-t.startTS),0)-(this._stallTS?Date.now()-this._stallTS:0);return this._startTS=Date.now(),r/t}}t.PlaybackStateController=v,n([p.default],v.prototype,"reset",null),n([p.default],v.prototype,"_onFragmentRequested",null),n([p.default],v.prototype,"_onMetricsAvailable",null),n([p.default],v.prototype,"_onCanPlayThrough",null),n([p.default],v.prototype,"_onPlaylistInfoAvailable",null),n([p.default],v.prototype,"_onPlay",null),n([p.default],v.prototype,"_onPlaying",null),n([p.default],v.prototype,"_onPlayingTimeFractionRequested",null)},4130:(e,t,r)=>{r.d(t,{A:()=>R});var n=r(2080),i=r(8300),o=r(3736),s=r(4099),a=function(e,t,r,n,a,l){var u=1&r,c=e.length,d=t.length;if(c!=d&&!(u&&d>c))return!1;var h=l.get(e),f=l.get(t);if(h&&f)return h==t&&f==e;var p=-1,v=!0,g=2&r?new i.A:void 0;for(l.set(e,t),l.set(t,e);++p<c;){var _=e[p],m=t[p];if(n)var y=u?n(m,_,p,t,e,l):n(_,m,p,e,t,l);if(void 0!==y){if(y)continue;v=!1;break}if(g){if(!(0,o.A)(t,function(e,t){if(!(0,s.A)(g,t)&&(_===e||a(_,e,r,n,l)))return g.push(t)})){v=!1;break}}else if(_!==m&&!a(_,m,r,n,l)){v=!1;break}}return l.delete(e),l.delete(t),v},l=r(241),u=r(3988),c=r(6984),d=r(4877),h=r(9959),f=l.A?l.A.prototype:void 0,p=f?f.valueOf:void 0,v=r(9042),g=Object.prototype.hasOwnProperty,_=r(7803),m=r(2049),y=r(4616),b=r(4749),E="[object Arguments]",S="[object Array]",T="[object Object]",C=Object.prototype.hasOwnProperty,A=function(e,t,r,i,o,s){var l=(0,m.A)(e),f=(0,m.A)(t),A=l?S:(0,_.A)(e),P=f?S:(0,_.A)(t),R=(A=A==E?T:A)==T,O=(P=P==E?T:P)==T,L=A==P;if(L&&(0,y.A)(e)){if(!(0,y.A)(t))return!1;l=!0,R=!1}if(L&&!R)return s||(s=new n.A),l||(0,b.A)(e)?a(e,t,r,i,o,s):function(e,t,r,n,i,o,s){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new u.A(e),new u.A(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,c.A)(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var l=d.A;case"[object Set]":var f=1&n;if(l||(l=h.A),e.size!=t.size&&!f)return!1;var v=s.get(e);if(v)return v==t;n|=2,s.set(e,t);var g=a(l(e),l(t),n,i,o,s);return s.delete(e),g;case"[object Symbol]":if(p)return p.call(e)==p.call(t)}return!1}(e,t,A,r,i,o,s);if(!(1&r)){var M=R&&C.call(e,"__wrapped__"),w=O&&C.call(t,"__wrapped__");if(M||w){var I=M?e.value():e,D=w?t.value():t;return s||(s=new n.A),o(I,D,r,i,s)}}return!!L&&(s||(s=new n.A),function(e,t,r,n,i,o){var s=1&r,a=(0,v.A)(e),l=a.length;if(l!=(0,v.A)(t).length&&!s)return!1;for(var u=l;u--;){var c=a[u];if(!(s?c in t:g.call(t,c)))return!1}var d=o.get(e),h=o.get(t);if(d&&h)return d==t&&h==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=s;++u<l;){var _=e[c=a[u]],m=t[c];if(n)var y=s?n(m,_,c,t,e,o):n(_,m,c,e,t,o);if(!(void 0===y?_===m||i(_,m,r,n,o):y)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var b=e.constructor,E=t.constructor;b==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof E&&E instanceof E||(f=!1)}return o.delete(e),o.delete(t),f}(e,t,r,i,o,s))},P=r(3098),R=function e(t,r,n,i,o){return t===r||(null==t||null==r||!(0,P.A)(t)&&!(0,P.A)(r)?t!=t&&r!=r:A(t,r,n,i,e,o))}},4181:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.humanSize=t.getPresetQuality=void 0,t.getPresetQuality=e=>(null==e?void 0:e.presetQuality)||(null==e?void 0:e.name),t.humanSize=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=0===e?0:Math.floor(Math.log(e)/Math.log(1024));return"".concat(((t?e:e/8)/1024**r).toFixed(2)," ").concat(["","k","M","G","T"][r]).concat(t?"Bit":"B")}},4216:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.logLevels=t.LogLevelTitlesMap=t.convertLogLevel=t.LogLevelNameToIdMap=t.ELogLevel=void 0,function(e){e[e.FATAL=0]="FATAL",e[e.ERROR=1]="ERROR",e[e.WARN=2]="WARN",e[e.INFO=3]="INFO",e[e.DEBUG=4]="DEBUG",e[e.VERBOSE=5]="VERBOSE"}(r||(t.ELogLevel=r={})),t.LogLevelNameToIdMap={fatal:r.FATAL,error:r.ERROR,warn:r.WARN,info:r.INFO,debug:r.DEBUG,verbose:r.VERBOSE},t.convertLogLevel=e=>"number"==typeof e?e:t.LogLevelNameToIdMap[e],t.LogLevelTitlesMap={[r.FATAL]:"Fatal",[r.WARN]:"Warning",[r.ERROR]:"Error",[r.INFO]:"Info",[r.DEBUG]:"Debug",[r.VERBOSE]:"Verbose"},t.logLevels=["verbose","debug","info","warn","error","fatal"]},4264:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=(0,r(1743).getGlobalThis)();"function"!=typeof n.queueMicrotask&&(n.queueMicrotask=function(e){Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))})},4266:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableFragmentLoaderConfigValues=t.defaultFragmentLoaderConfig=void 0,t.defaultFragmentLoaderConfig={fragmentLoadingTimeout:2500,workerMode:!0,sequentialMode:!1},t.availableFragmentLoaderConfigValues={}},4335:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BroadcastLogs=void 0;var o=r(5042),l=i(r(5354)),u=r(480),c=r(1178);class d{constructor(e){a(this,"_streamId",null),a(this,"_sessionId",null),a(this,"_messagesCache",[]),a(this,"_messagesBuffer",[]),a(this,"_broadcastStatus",c.EBroadcastStatus.PENDING),a(this,"_reportNotStartedStreamTimeout",null),a(this,"_sendInterval",null),a(this,"_isSendingNow",!1),a(this,"_endpointURL","https://metrics.doppiostreams.com/api/front/v2/logs/streaming"),a(this,"_eventBus",void 0),a(this,"_onReportEventRequestedListener",void 0),this._eventBus=e,this._onReportEventRequestedListener=this._eventBus.subscribe(u.EBroadcastLogsEvents.REPORT_EVENT,this.onReportEventRequested),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("online",this._onOnline),window.addEventListener("offline",this._onOffline)}destroy(){document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("online",this._onOnline),window.removeEventListener("offline",this._onOffline),this._eventBus.unsubscribe(this._onReportEventRequestedListener),this.onReportEventRequested({event:c.EBroadcastLogsEvent.DESTROYED,description:"Broadcast logs destroyed"}),this._sendMessages(),this._streamId=null,this._disarmInterval(),this._disarmNotStartedBroadcastReport()}startSession(e){var t=(0,o.nanoid)();this._sessionId&&this.onReportEventRequested({event:c.EBroadcastLogsEvent.NEXT_SESSION_ID,description:"Session has terminated. Id of the new session is ".concat(t),details:{nextSessionId:t}}),this._broadcastStatus=c.EBroadcastStatus.PENDING,this._armNotStartedBroadcastReport(),this._sessionId=t,this._sendMessages(),this._armInterval(),this.onReportEventRequested({event:c.EBroadcastLogsEvent.SESSION_STARTED,description:"Broadcast session started",details:{invoker:e}})}setStreamId(e){this._streamId=e,this.startSession("local:setStreamId")}onReportEventRequested(e){var{event:t,description:r,details:n}=e;if(this._sessionId&&this._streamId){if(t===c.EBroadcastLogsEvent.BROADCAST_SUCCESS){if(this._broadcastStatus===c.EBroadcastStatus.STARTED)return;this._broadcastStatus=c.EBroadcastStatus.STARTED,this._disarmNotStartedBroadcastReport()}var i={modelId:this._streamId,sessionId:this._sessionId,event:t,description:r,details:n,timestamp:Date.now(),broadcaster:"mmp"};this._isSendingNow?this._messagesBuffer.push(i):this._messagesCache.push(i)}}_armInterval(){this._disarmInterval(),this._sendInterval=setInterval(()=>{this._sendMessages()},3e4)}_disarmInterval(){this._sendInterval&&clearInterval(this._sendInterval)}_sendMessages(){var t=this;return s(function*(){try{if(!t._messagesBuffer.length&&!t._messagesCache.length)return;t._isSendingNow=!0,yield fetch(t._endpointURL,{method:"POST",mode:"cors",body:JSON.stringify({detailedBroadcastLog:t._messagesCache})}),t._messagesCache=[...t._messagesBuffer],t._messagesBuffer=[],t._isSendingNow=!1}catch(e){t._isSendingNow=!1}})()}_disarmNotStartedBroadcastReport(){this._reportNotStartedStreamTimeout&&clearTimeout(this._reportNotStartedStreamTimeout)}_armNotStartedBroadcastReport(){this._disarmNotStartedBroadcastReport(),this._reportNotStartedStreamTimeout=setTimeout(this._onNotStartedStreamTimeoutFired,1e4)}_onNotStartedStreamTimeoutFired(e){if(this._broadcastStatus===c.EBroadcastStatus.PENDING){var t=e?"No broadcast success event received in 10 seconds after broadcast session started":"No broadcast success event received and session is about to be terminated";this._broadcastStatus=c.EBroadcastStatus.NOT_STARTED,this.onReportEventRequested({event:c.EBroadcastLogsEvent.BROADCAST_NOT_SUCCESS,description:t})}}_onOnline(){this.onReportEventRequested({event:c.EBroadcastLogsEvent.NETWORK_CONNECTION_STATE_CHANGED,description:"Network connection state changed, client is online now"})}_onOffline(){this.onReportEventRequested({event:c.EBroadcastLogsEvent.NETWORK_CONNECTION_STATE_CHANGED,description:"Network connection state changed, client is offline now"})}_onVisibilityChange(){this._sessionId&&("visible"===document.visibilityState?this.onReportEventRequested({event:c.EBroadcastLogsEvent.PAGE_VISIBILITY_CHANGED,description:"Page is visible now"}):(navigator.sendBeacon(this._endpointURL,JSON.stringify({detailedBroadcastLog:[...this._messagesCache,{sessionId:this._sessionId,modelId:this._streamId,timestamp:Date.now(),event:c.EBroadcastLogsEvent.PAGE_VISIBILITY_CHANGED,description:"Page is hidden now"}]})),this._messagesCache=[]))}}t.BroadcastLogs=d,n([l.default],d.prototype,"onReportEventRequested",null),n([l.default],d.prototype,"_onNotStartedStreamTimeoutFired",null),n([l.default],d.prototype,"_onOnline",null),n([l.default],d.prototype,"_onOffline",null),n([l.default],d.prototype,"_onVisibilityChange",null)},4354:(e,t)=>{var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.EModuleLoadingState=t.EMouflonPlayerEvent=void 0,function(e){e.PLAYBACK_STATE_CHANGED="playbackStateChanged",e.VIDEO_PLAYBACK_STATE_CHANGED="videoPlaybackStateChanged",e.AVAILABLE_PLAYER_TYPES_UPDATED="availablePlayerModesUpdated",e.DEBUGGER_CONNECTED="debuggerConnected",e.ERROR="error",e.NATIVE_EVENT="nativeEvent",e.RESOLUTIONS_AVAILABLE="resolutionsAvailable",e.UPDATE_PLAYER_RESOLUTION="updatePlayerResolution",e.AUTO_RESOLUTION_SWITCHED="autoResolutionSwitched",e.RESOLUTION_SWITCHED="resolutionSwitched",e.TIME_UPDATE="timeUpdate",e.MODULE_LOADING_STATE_CHANGED="moduleLoadingStateChanged",e.PLAYING="playing",e.RESOLUTION_NOT_FOUND="resolutionNotFound",e.BROADCAST_SUPPORTED_CHANGE="broadcastSupportedChange",e.STREAM_LOAD_ERROR="streamLoadError",e.FRAG_LOADED="fragLoaded"}(r||(t.EMouflonPlayerEvent=r={})),function(e){e.LOADING="loading",e.LOADED="loaded"}(n||(t.EModuleLoadingState=n={}))},4389:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createConfig=void 0;var n=r(83),o=r(5821),s=r(1496),a=r(5490);t.createConfig=e=>{var t=i({},e),r=new n.EventBus,{configConsumerConstructor:l,setConsumerConfig:u}=(0,s.createConfigConsumerScope)(r);return u(e),{getConfigField:e=>t[e],setConfig:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=Object.entries(e).reduce((e,t)=>{var[r,n]=t;return e[r]=i(i({},e[r]),n),e},i({},t)),l=(0,o.ObjectDeepDiff)(t,s);t=s,Object.entries(l).forEach(e=>{var[t,i]=e,o=(0,a.getFieldSpecificEventName)(t);n?r.publishSync(o,{updatedValues:i,newConfig:s}):r.publish(o,{updatedValues:i,newConfig:s})}),u(t)},getConfig:()=>t,resetConfig:()=>{t=i({},e)},ConfigConsumer:l}}},4394:()=>{},4453:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(7271),i=(0,r(367).A)(Object.keys,Object),o=Object.prototype.hasOwnProperty,s=function(e){if(!(0,n.A)(e))return i(e);var t=[];for(var r in Object(e))o.call(e,r)&&"constructor"!=r&&t.push(r);return t}},4480:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableTargetBufferIncreaserConfigValues=t.defaultTargetBufferIncreaserConfig=void 0,t.defaultTargetBufferIncreaserConfig={bufferAmountToIncrease:200,bufferAmountThreshold:300},t.availableTargetBufferIncreaserConfigValues={}},4507:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,function(r,n){return Array.isArray(n)?r.push.apply(r,e.call(n,t-1)):r.push(n),r},[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0})},4526:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackSpeedActuator=void 0;var o=r(8548),s=r(6791),l=r(8169),u=r(180),c=i(r(6073));class d extends l.ConfigConsumer{constructor(e){super("playbackSpeedActuator",e),a(this,"state",u.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["PlaybackSpeed"]),a(this,"_videoElement",null),a(this,"_currentPlaybackSpeed",o.EPlaybackRateMode.NORMAL),a(this,"_onPlaybackSpeedChangedListener",void 0),this._onPlaybackSpeedChangedListener=this._eventBus.subscribe(s.PlaybackSpeedEvents.setPlaybackSpeed,this._onPlaybackSpeedChanged)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onPlaybackSpeedChangedListener)}setVideoElement(e){this._videoElement=e,this._setPlaybackSpeed()}_handleConfigUpdated(){this._setPlaybackSpeed()}_onPlaybackSpeedChanged(e){this._currentPlaybackSpeed=e,this._setPlaybackSpeed()}_setPlaybackSpeed(){if(this._videoElement){var e={[o.EPlaybackRateMode.FAST]:this.config.maxPlaybackRate,[o.EPlaybackRateMode.NORMAL]:1,[o.EPlaybackRateMode.SLOW]:this.config.minPlaybackRate};this._videoElement.playbackRate=e[this._currentPlaybackSpeed]}}get additionalInfo(){return{currentPlaybackMode:this._currentPlaybackSpeed}}}t.PlaybackSpeedActuator=d,n([c.default],d.prototype,"destroy",null),n([c.default],d.prototype,"_handleConfigUpdated",null),n([c.default],d.prototype,"_onPlaybackSpeedChanged",null)},4547:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EBlockingMode=void 0,function(e){e.WAIT_FOR_PREFETCH_SEGMENT="waitForSegment",e.WAIT_FOR_PLAYLIST="waitForPlaylist"}(r||(t.EBlockingMode=r={}))},4578:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EVideoElementControllerBusEvent=void 0,function(e){e.NATIVE_EVENT="videoElementController.nativeEvent",e.CLICK="videoElementController.click",e.FORCE_PLAY_AFTER_PAUSE="videoElementController.forcePlayAfterPause",e.VIDEO_START="videoElementController.videoStart",e.VIDEO_PAUSE="videoElementController.videoPause",e.VIDEO_RESET="videoElementController.videoReset",e.PAUSED="videoElementController.paused",e.PLAYING="videoElementController.playing",e.LOADING="videoElementController.loading",e.LOADED="videoElementController.loaded",e.UPDATED="videoElementController.updated",e.DESTROY="videoElementController.destroy",e.STREAM_RESET="videoElementController.streamReset",e.CAN_PLAY="videoElementController.canPlay",e.REMOVE_MEDIA_STREAM="videoElementController.removeMediaStream",e.ERROR="videoElementController.error",e.ABORT="videoElementController.abort",e.STALLED="videoElementController.stalled",e.WAITING="videoElementController.waiting",e.UPDATE_PLAYER_RESOLUTION="videoElementController.updatePlayerResolution",e.RESET_CHECKING_AUTOPLAY_COUNT="videoElementController.resetCheckingAutoplayCount",e.CANCEL_RESET_STREAM="videoElementController.cancelResetStream",e.RESTART="videoElementController.restart",e.TIME_UPDATE_NATIVE="videoElementController.native",e.UPDATE_MEDIA_STREAM="videoElementController.updateMediaStream",e.VIDEO_ELEMENT_RECREATED="videoElementController.videoElementRecreated",e.VIDEO_PLAYBACK_STATE_CHANGED="videoElementController.videoPlaybackStateChanged",e.SET_VOLUME="videoElementController.setVolume"}(r||(t.EVideoElementControllerBusEvent=r={}))},4612:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Broadcaster=t.checkIfBroadcastSupported=t.EBroadcasterEvent=void 0;var o,l=r(2223),u=r(5851),c=r(2302),d=i(r(5354)),h=r(480),f=r(1178),p=r(7813),v=r(1222);!function(e){e.BROADCAST_STATE_CHANGED="broadcastStateChanged"}(o||(t.EBroadcasterEvent=o={})),t.checkIfBroadcastSupported=s(function*(){var e=[u.KNOWN_CODECS.H264,u.KNOWN_CODECS.VP8],t=yield(0,c.checkCodecsSupported)("broadcast",e);return e.some(e=>t.includes(e))});class g extends p.CommonEntrypoint{constructor(){var e;super(),a(this,"_videoElement",null),a(this,"_mediaStream",null),a(this,"_streamToken",null),a(this,"_streamIdCached",null),a(this,"_broadcastDispatcher",new l.BroadcastDispatcher(this._eventBus)),a(this,"_onBroadcastStatusChangedListener",void 0),this._onBroadcastStatusChangedListener=this._eventBus.subscribe(v.ECommonEvent.BROADCAST_STATE_CHANGED,this._onBroadcastStateChanged),null===(e=this._loggerOOTransport)||void 0===e||e.setMode("Broadcast")}static checkSupport(){return s(function*(){return yield(0,t.checkIfBroadcastSupported)()})()}destroy(){super.destroy(),this._broadcastDispatcher.destroy(),this._eventBus.unsubscribe(this._onBroadcastStatusChangedListener)}setRegularBroadcastStopReason(e){this._broadcastDispatcher.setRegularBroadcastStopReason(e)}setVideoElement(e){this._videoElement=e,this._logger.info("New video element attached to the player instance"),this._mediaStream&&(this._videoElement.srcObject=this._mediaStream)}setAppKey(e){this._broadcastDispatcher.setAppKey(e)}setProbingCacheKey(e){this._broadcastDispatcher.setProbingCacheKey(e)}setWSServerUrl(e){this._broadcastDispatcher.setMetadataConnectionUrl(e)}setStreamId(e){var t;this._broadcastDispatcher.setStreamId(e),null!==(t=this._loggerOOTransport)&&void 0!==t&&t.setStreamId(e),this._streamIdCached=e}setPublishCustomData(e){this._broadcastDispatcher.setPublishCustomData(e)}setMediaStream(e){this._mediaStream=e,this._broadcastDispatcher.setMediaStream(e);var[t,r]=[e.getVideoTracks()[0],e.getAudioTracks()[0]];this._eventBus.publish(h.EBroadcastLogsEvents.REPORT_EVENT,{event:f.EBroadcastLogsEvent.USER_MEDIA_UPDATED,description:"User media stream updated",details:{hasVideoTrack:!!t,hasAudioTrack:!!r,isVideoMuted:null==t?void 0:t.muted,isAudioMuted:null==r?void 0:r.muted}}),this._videoElement&&(this._videoElement.srcObject=this._mediaStream)}setStreamToken(e){this._streamToken=e,this._broadcastDispatcher.setStreamToken(e)}setStreamConfig(e){var t;e.mediaStream&&(this._mediaStream=e.mediaStream,this._videoElement&&(this._videoElement.srcObject=this._mediaStream)),e.streamToken&&(this._streamToken=e.streamToken),this._broadcastDispatcher.setStreamConfig(e),e.streamId&&(null!==(t=this._loggerOOTransport)&&void 0!==t&&t.setStreamId(e.streamId),this._streamIdCached=e.streamId)}start(){this._logger.info("Starting broadcasting loop"),this._videoElement||this._logger.warn("Video element is not defined. Feel free to define it later"),this._isStarted=this._broadcastDispatcher.start()}stop(){this._broadcastDispatcher.stop()}toggleTURNServersUsage(e){this._broadcastDispatcher.toggleTURNServersUsage(e)}_retuneOOLogger(){var e,t;null!==(e=this._loggerOOTransport)&&void 0!==e&&e.setMode("Receive"),this._streamIdCached&&(null===(t=this._loggerOOTransport)||void 0===t||t.setStreamId(this._streamIdCached))}_onMediaStreamAvailable(e){var{mediaStream:t}=e;this._mediaStream=t,this._logger.info("Ready to play"),this._videoElement&&(this._videoElement.srcObject=t)}_onBroadcastStateChanged(e){var{prevState:t,nextState:r}=e;this.emitEvent(o.BROADCAST_STATE_CHANGED,{prevState:t,nextState:r})}}t.Broadcaster=g,n([d.default],g.prototype,"_onMediaStreamAvailable",null),n([d.default],g.prototype,"_onBroadcastStateChanged",null)},4616:(t,r,n)=>{n.d(r,{A:()=>u});var i=n(1917),o=n(4639),s="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=s&&e&&!e.nodeType&&e,l=a&&a.exports===s?i.A.Buffer:void 0,u=(l?l.isBuffer:void 0)||o.A},4639:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(){return!1}},4678:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.VideoEventsHandler=void 0;var i=r(6847),o=r(4578),s=r(6671);class l{constructor(e){a(this,"_props",void 0),a(this,"_config",{}),a(this,"_logger",void 0),a(this,"_timeUpdateEventWasLogged",!1),a(this,"_eventsMap",{[o.EVideoElementControllerBusEvent.VIDEO_ELEMENT_RECREATED]:this._handleVideoElementRecreated,[o.EVideoElementControllerBusEvent.DESTROY]:this._handleDestroy}),a(this,"_state",void 0),a(this,"_eventBus",void 0),a(this,"_onVideoClick",e=>{this._logger.verbose('"click" video native event fired'),this._handleNativeEvent(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.CLICK,{originalEvent:e})}),a(this,"_onSeeked",e=>{this._logger.verbose('"seeked" video native event fired'),this._handleNativeEvent(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.FORCE_PLAY_AFTER_PAUSE,{reason:"seeked video native event"})}),a(this,"_onRateChange",e=>{this._logger.verbose('"ratechange" video native event fired'),this._handleNativeEvent(e),e.target&&!e.target.playbackRate&&this._eventBus.publish(o.EVideoElementControllerBusEvent.FORCE_PLAY_AFTER_PAUSE,{reason:"video playbackRate is 0"})}),a(this,"_onCanPlayThrough",e=>{this._logger.verbose('"canplaythrough" video native event fired');var t=this._state.getState();this._handleNativeEvent(e),(t.isStalled||t.isWaiting)&&this._eventBus.publish(o.EVideoElementControllerBusEvent.FORCE_PLAY_AFTER_PAUSE,{reason:"canplaythrough video native event fired, and video is in the state of either stalled or waiting"})}),a(this,"_onPlayingHandler",e=>{this._logger.verbose('"playing" video native event fired'),this._logger.info("Video has started playing"),this._handleNativeEvent(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.PLAYING,{isAutoplay:!this._state.getState().isAutoplayError})}),a(this,"_onAbortHandler",e=>{this._logger.verbose('"abort" video native event fired'),this._handleNativeEvent(e),e.defaultPrevented||this._eventBus.publish(o.EVideoElementControllerBusEvent.LOADING,{})}),a(this,"_onPauseHandler",e=>{this._logger.verbose('"pause" video native event fired'),this._handleNativeEvent(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.VIDEO_PAUSE,{}),this._eventBus.publish(o.EVideoElementControllerBusEvent.FORCE_PLAY_AFTER_PAUSE,{reason:"pause video event fired (most likely user paused the video manually)"})}),a(this,"_onCanPlayHandler",e=>{this._logger.verbose('"canplay" video native event fired'),this._handleNativeEvent(e),e.defaultPrevented||(this._state.setState({canPlay:!0}),this._eventBus.publish(o.EVideoElementControllerBusEvent.CAN_PLAY,{}))}),a(this,"_onErrorHandler",e=>{if(this._logger.error('"error" video native event fired',{error:e}),this._handleNativeEvent(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.ERROR,{originalEvent:e}),!e.defaultPrevented){var t,{MEDIA_ERR_SRC_NOT_SUPPORTED:r}=MediaError,n=null===(t=this._props.getVideoElement())||void 0===t?void 0:t.error;(null==n?void 0:n.code)!==r&&(this._logger.verbose("Video element error is not of MEDIA_ERR_SRC_NOT_SUPPORTED kind. Requesting reset"),this._eventBus.publish(o.EVideoElementControllerBusEvent.VIDEO_RESET,{}))}}),a(this,"_onTimeUpdateHandler",e=>{this._handleNativeEvent(e),this._timeUpdateEventWasLogged||(this._logger.verbose('"timeupdate" video native event fired for the first time'),this._timeUpdateEventWasLogged=!0),this._eventBus.publishSync(o.EVideoElementControllerBusEvent.TIME_UPDATE_NATIVE,{originalEvent:e})}),a(this,"_onLoadStartHandler",e=>{this._handleNativeEvent(e),this._logger.verbose('"loadstart" video native event fired');var{timeoutUpdateStream:t}=this._config;this._eventBus.publish(o.EVideoElementControllerBusEvent.LOADING,{}),this._eventBus.publish(o.EVideoElementControllerBusEvent.STREAM_RESET,{reason:"onLoadStartHandler",timeout:t})}),a(this,"_onLoadedDataHandler",e=>{this._logger.verbose('"loadeddata" video native event fired'),this._handleNativeEvent(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.LOADED,{})}),a(this,"_onWaiting",e=>{this._logger.verbose('"waiting" video native event fired');var{timeoutWaitingStream:t}=this._config;this._handleNativeEvent(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.WAITING,{}),this._eventBus.publish(o.EVideoElementControllerBusEvent.LOADING,{}),this._eventBus.publish(o.EVideoElementControllerBusEvent.STREAM_RESET,{reason:"onWaiting",timeout:t})}),a(this,"_onStalled",e=>{this._logger.verbose('"stalled" video native event fired');var{timeoutWaitingStream:t}=this._config;this._handleNativeEvent(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.STALLED,{}),this._eventBus.publish(o.EVideoElementControllerBusEvent.STREAM_RESET,{reason:"onStalled",timeout:t})}),a(this,"_onEndFullscreenHandler",e=>{this._handleNativeEvent(e)}),this._props=e,this._state=e.state,this._eventBus=e.eventBus,this._logger=(0,i.Logger)(this._eventBus,"VideoElementController - VideoEventsHandler"),this.init()}setConfig(e){this._config=e}init(){this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}toggleEvents(e,t){var r=t||this._props.getVideoElement();if(r){var n="attach"===e?"addEventListener":"removeEventListener";r[n]("click",this._onVideoClick),r[n]("playing",this._onPlayingHandler),r[n]("abort",this._onAbortHandler),r[n]("pause",this._onPauseHandler),r[n]("canplay",this._onCanPlayHandler),r[n]("error",this._onErrorHandler),r[n]("timeupdate",this._onTimeUpdateHandler),r[n]("loadstart",this._onLoadStartHandler),r[n]("loadeddata",this._onLoadedDataHandler),r[n]("waiting",this._onWaiting),r[n]("stalled",this._onStalled),r[n]("canplaythrough",this._onCanPlayThrough),r[n]("seeked",this._onSeeked),r[n]("ratechange",this._onRateChange),r[n]("webkitendfullscreen",this._onEndFullscreenHandler),"addEventListener"===n?this._logger.verbose("event listeners are ATTACHED to the video element"):this._logger.verbose("event listeners are DETACHED from the video element")}}_handleVideoElementRecreated(){this.toggleEvents("attach")}_handleDestroy(){this.toggleEvents("detach"),this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap})}_handleNativeEvent(e){this._eventBus.publishSync(o.EVideoElementControllerBusEvent.NATIVE_EVENT,{eventName:e.type,event:e})}}t.VideoEventsHandler=l,n([s.bind],l.prototype,"init",null),n([s.bind],l.prototype,"_handleVideoElementRecreated",null),n([s.bind],l.prototype,"_handleDestroy",null)},4699:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerWorker=void 0;var o=i(r(5354)),s=r(2646),l=()=>{};class u{constructor(){a(this,"_onSocketReadyListener",l),a(this,"_onSocketClosedListener",l),a(this,"_serverUrl",""),a(this,"_wsConnection",null),a(this,"_messagesCache",[]),a(this,"_unsuccessfulConnectionAttempts",0),a(this,"_maxUnsuccessfulConnectionAttempts",0),a(this,"_roomId",(Math.random()+1).toString(36).substring(2,8))}setConfig(e,t,r,n){this._serverUrl=e,this._maxUnsuccessfulConnectionAttempts=t,this._onSocketReadyListener=r,this._onSocketClosedListener=n}connect(){this._serverUrl&&(this._wsConnection&&this.disconnect(),this._wsConnection=new WebSocket(this._serverUrl),this._wsConnection.addEventListener("error",this._onSocketError),this._wsConnection.addEventListener("open",this._onSocketOpened),this._wsConnection.addEventListener("close",this._onSocketClosed))}disconnect(){this._wsConnection&&(this._wsConnection.removeEventListener("error",this._onSocketError),this._wsConnection.removeEventListener("open",this._onSocketOpened),this._wsConnection.removeEventListener("close",this._onSocketClosed),this._wsConnection.close(),this._wsConnection=null)}reconnect(){this.disconnect(),this.connect()}sendMessage(e){this._wsConnection&&this._wsConnection.readyState===this._wsConnection.OPEN?this._wsConnection.send(JSON.stringify(e)):this._messagesCache.push(e)}_sendInitialMsg(){this.sendMessage({command:s.ECommand.CONNECT_TO_ROOM,roomId:this._roomId})}_resendMessagesFromCache(){if(this._messagesCache.length){var e=[...this._messagesCache];this._messagesCache=[],e.forEach(e=>this.sendMessage(e))}}_onSocketError(){this._unsuccessfulConnectionAttempts++,this.reconnect()}_onSocketOpened(){this._unsuccessfulConnectionAttempts=0;var e=this._serverUrl.includes("wss")?"https":"http",t="".concat(this._serverUrl.replace(/ws{1,2}/g,e),"/?roomId=").concat(this._roomId);this._onSocketReadyListener(t),this._sendInitialMsg(),this._resendMessagesFromCache()}_onSocketClosed(){}}t.DebuggerWorker=u,n([o.default],u.prototype,"_onSocketError",null),n([o.default],u.prototype,"_onSocketOpened",null),n([o.default],u.prototype,"_onSocketClosed",null)},4749:(e,t,r)=>{r.d(t,{A:()=>c});var n=r(2383),i=r(5254),o=r(3098),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1;var a=r(2789),l=r(4841),u=l.A&&l.A.isTypedArray,c=u?(0,a.A)(u):function(e){return(0,o.A)(e)&&(0,i.A)(e.length)&&!!s[(0,n.A)(e)]}},4780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stopStream=void 0,t.stopStream=e=>{e&&(e.getTracks().forEach(t=>{t.stop(),e.removeTrack(t)}),e.stop&&e.stop())}},4792:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(2634),i=r(3153),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),(0,n.A)(s(e),function(t){return o.call(e,t)}))}:i.A},4841:(t,r,n)=>{n.d(r,{A:()=>l});var i=n(2136),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,s=o&&e&&!e.nodeType&&e,a=s&&s.exports===o&&i.A.process,l=function(){try{return s&&s.require&&s.require("util").types||a&&a.binding&&a.binding("util")}catch(t){}}()},4856:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackController=void 0;var i=r(6847),o=r(4578),l=r(6671),u=r(469);class c{constructor(e){a(this,"_logger",void 0),a(this,"_eventsMap",{[o.EVideoElementControllerBusEvent.VIDEO_START]:this._startVideo,[o.EVideoElementControllerBusEvent.VIDEO_PAUSE]:this._pauseVideo,[o.EVideoElementControllerBusEvent.VIDEO_RESET]:this._resetVideo,[o.EVideoElementControllerBusEvent.RESTART]:this._restart,[o.EVideoElementControllerBusEvent.DESTROY]:this._destroy}),a(this,"_state",void 0),a(this,"_eventBus",void 0),this._state=e.state,this._eventBus=e.eventBus,this._logger=(0,i.Logger)(this._eventBus,"VideoElementController - PlaybackController"),this._logger.info("Created"),this._logger.debug("Initial state",this._state),this.init()}init(){this._logger.info("Initialization requested, attaching eventBus listeners"),this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}_startVideo(){var e=this._state.getState().videoElement;if(this._logger.verbose("Starting the video"),e)return e.playbackRate||(e.playbackRate=1),this._logger.debug("Play call is added to the promises queue"),(0,u.addMediaAction)(e,"play").then(()=>{this._logger.debug("Play call resolved"),this._state.getState().canPlay&&this._eventBus.publish(o.EVideoElementControllerBusEvent.PLAYING,{})}).catch(e=>{this._state.setState({isAutoplayError:!0}),this._logger.error("An error occured when trying to play the video.",{error:e}),this._state.getState().canPlay&&this._eventBus.publish(o.EVideoElementControllerBusEvent.PAUSED,{})})}_pauseVideo(){this._logger.debug("Pausing the video");var e=this._state.getState().videoElement;if(e)return this._logger.debug("Pause call is added to the promises queue"),(0,u.addMediaAction)(e,"pause").then(()=>{this._logger.debug("Pause call resolved")}).catch(e=>{this._logger.warn("Could not pause video",e)})}_loadVideo(){this._logger.verbose("Loading the video");var e=this._state.getState().videoElement;if(null==e||!e.src||!e.src.startsWith("blob"))return e?(this._logger.debug("Load call is added to the promises queue"),(0,u.addMediaAction)(e,"load").then(()=>{this._logger.debug("Load call resolved")}).catch(e=>{this._logger.warn("Could not load video",e)})):void 0;this._logger.debug("Stream seems to be blob. Skipping load")}_resetVideo(){this._logger.verbose("Resetting the video"),this._state.getState().videoElement&&(this._eventBus.publish(o.EVideoElementControllerBusEvent.LOADING,{}),this._loadVideo())}_restart(){var e=this;return s(function*(){e._logger.verbose("Restarting the video"),yield e._pauseVideo(),e._startVideo()})()}_destroy(){this._logger.info("Destroying"),this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap})}}t.PlaybackController=c,n([l.bind],c.prototype,"init",null),n([l.bind],c.prototype,"_startVideo",null),n([l.bind],c.prototype,"_pauseVideo",null),n([l.bind],c.prototype,"_loadVideo",null),n([l.bind],c.prototype,"_resetVideo",null),n([l.bind],c.prototype,"_restart",null),n([l.bind],c.prototype,"_destroy",null)},4859:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableSwitchHistoryConfigValues=t.defaultSwitchHistoryConfig=void 0,t.defaultSwitchHistoryConfig={banResolutionDuration:7e3},t.availableSwitchHistoryConfigValues={}},4877:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e,n){r[++t]=[n,e]}),r}},4937:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.HLSCommon=t.isHLSSupported=t.resolveSourceBuffer=t.resolveMediaSource=void 0,t.resolveMediaSource=()=>window.MediaSource||window.WebKitMediaSource||window.ManagedMediaSource,t.resolveSourceBuffer=()=>window.SourceBuffer||window.WebKitSourceBuffer||window.ManagedSourceBuffer,t.isHLSSupported=()=>{var e=(0,t.resolveMediaSource)();if(!e)return!1;var r=(0,t.resolveSourceBuffer)(),n="function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!r||r.prototype&&"function"==typeof r.prototype.appendBuffer&&"function"==typeof r.prototype.remove;return n&&i},t.HLSCommon={isHLSSupported:t.isHLSSupported}},4943:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MaximalResolutionsEstimator=void 0;var s=o(r(6996)),l=r(7430),u=r(180),c=o(r(6073));class d{constructor(e){a(this,"_eventBus",void 0),a(this,"state",u.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"groups",["abr"]),a(this,"_lastAvailableResolutions",[]),a(this,"_currentResolutionsLimit",null),a(this,"_estimatedResolution",null),a(this,"_onResolutionsConstraintsAvailableListener",void 0),this._eventBus=e,this._onResolutionsConstraintsAvailableListener=this._eventBus.subscribe(l.AbrControllerEvents.resolutionsConstraintsAvailable,this._onResolutionsConstraintsAvailable)}destroy(){this._eventBus.unsubscribe(this._onResolutionsConstraintsAvailableListener)}reset(){}getNextEstimatedResolution(e){return this._lastAvailableResolutions!==e&&(this._lastAvailableResolutions=e,this._calculationAvailableResolution(this._currentResolutionsLimit)),this._estimatedResolution}_onResolutionsConstraintsAvailable(e){(0,s.default)(this._currentResolutionsLimit,e)||this._calculationAvailableResolution(e)}_meetsLimits(e,t){return!(void 0!==(null==t?void 0:t.bitrate)&&e.bitrate>(null==t?void 0:t.bitrate)||void 0!==(null==t?void 0:t.height)&&e.height>(null==t?void 0:t.height)||void 0!==(null==t?void 0:t.width)&&e.width>(null==t?void 0:t.width)||void 0!==(null==t?void 0:t.fps)&&(void 0===e.fps||+e.fps>+(null==t?void 0:t.fps)))}_calculationAvailableResolution(e){var t;if(this._currentResolutionsLimit=i({},e),0!==(null===(t=this._lastAvailableResolutions)||void 0===t?void 0:t.length))if(null!==e){var r=this._lastAvailableResolutions.filter(t=>!e||this._meetsLimits(t,e));this._estimatedResolution=r[0]||this._lastAvailableResolutions.slice(-1)[0]}else this._estimatedResolution=null}}t.MaximalResolutionsEstimator=d,n([c.default],d.prototype,"_onResolutionsConstraintsAvailable",null)},4947:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkLoadFetch=void 0;var n=r(5921),i=r(6967),o=r(6308);t.NetworkLoadFetch=class{constructor(e){a(this,"requestUrl",""),a(this,"realUrl",""),a(this,"mode",""),a(this,"error",void 0),a(this,"_dataChunks",[]),a(this,"_receivedLength",0),a(this,"_abortController",new AbortController),a(this,"_startLoadTimestamp",0),a(this,"_isAborted",!1),a(this,"_config",void 0),this._config=e}abort(){this._isAborted=!0,this._abortController.abort()}fetch(e,t){var r=this;return s(function*(){try{var o;globalThis.performance&&globalThis.performance.clearResourceTimings&&globalThis.performance.clearResourceTimings(),r._config.onChangeState(i.ELoadingState.LOADING),r._startLoadTimestamp=Date.now(),r.requestUrl=e,r.mode=t,r._receivedLength=0;var s=new Request(r.requestUrl),a={signal:r._abortController.signal};r._config.requestCustomReferer&&(a.headers={"X-Referer":r._config.requestCustomReferer});var l=yield fetch(s,a);r.realUrl=l.url;var u=null===(o=l.body)||void 0===o?void 0:o.getReader();if(!u)throw new Error;for(;;){var{done:c,value:d}=yield u.read();if(c)break;r._dataChunks.push(d),r._receivedLength+=d.length}if(!l.ok&&(!l.status||l.status>399))throw r.error={status:l.status,statusText:l.statusText||r._receivedLength?String.fromCharCode(...(0,n.mergeUint8Arrays)(r._dataChunks)):""},new Error;var h=(0,n.mergeUint8Arrays)(r._dataChunks).buffer;r._config.onDataReady("text"!==r.mode?h:new TextDecoder("utf-8").decode(h)),r._config.onStatsReady(r._getNetworkStats()),r.realUrl!==r.requestUrl&&r._config.onRedirectDetected(r.requestUrl,r.realUrl),r._config.onChangeState(i.ELoadingState.LOADED,{realUrl:l.url,status:l.status})}catch(e){if(r._isAborted)return r._config.onStatsReady(r._getNetworkStats()),void r._config.onChangeState(i.ELoadingState.ABORTED);r.error||(r.error={status:-1,statusText:e.toString()}),r._config.onError(r.error),r._config.onChangeState(i.ELoadingState.ERROR,{status:r.error.status})}})()}_getNetworkStats(){var e=Date.now()-this._startLoadTimestamp,t="text"===this.mode?"text":"binary";return(0,o.getNetworkStats)(this.requestUrl,e,this._receivedLength,t)}}},4971:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPlayerTypesByStreamConfig=void 0;var n=r(5307);t.getPlayerTypesByStreamConfig=e=>{var t=[n.EPlayerType.UNKNOWN];return e.HLSStreamUrl&&t.push(n.EPlayerType.HLS),e.WebRTCStreamId&&e.WebRTCSignallingUrl&&(t.push(n.EPlayerType.WEBRTC),e.MediaStream&&t.push(n.EPlayerType.BROADCAST)),e.NativeStreamURL&&t.push(n.EPlayerType.NATIVE),t}},4989:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.LoggerConsoleTransport=void 0;var i=r(5458),o=r(6671),s=r(2015),l=r(6847),u=r(3952),c={debug:(e,t)=>(0,s.simpleLog)("%c".concat(e),"color: rgb(102, 102, 102)",t),verbose:(e,t)=>(0,s.simpleLog)("%c".concat(e),"color: rgb(36, 114, 200)",t),info:(e,t)=>(0,s.simpleLog)("%c".concat(e),"color: rgb(13, 188, 121)",t),warn:(e,t)=>(0,s.simpleLog)("%c".concat(e),"color: rgb(229, 229, 16)",t),error:(e,t)=>(0,s.simpleLog)("%c".concat(e),"color: rgb(241, 76, 76)",t),fatal:(e,t)=>(0,s.simpleLog)("%c".concat(e),"background: rgb(241, 76, 76); color: #fff",t)},d=[];class h{constructor(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];a(this,"_enableErrorAutoLog",void 0),a(this,"_levels",void 0),a(this,"_onLogMessageReceivedToken",void 0),a(this,"_onErrorReceivedToken",void 0),a(this,"_ignoreDomains",void 0),a(this,"_additionalScopeSubscriptions",void 0),a(this,"_eventBus",void 0),a(this,"_appId",void 0),this._levels=t,this._eventBus=e,this._enableErrorAutoLog=o,this._onLogMessageReceivedToken=this._eventBus.subscribe(u.ELoggerEvents.LOG,this._onMessageReceived),this._onErrorReceivedToken=this._eventBus.subscribe(i.ECommonEvent.COMMON_ERROR,this._onErrorReceived),this._ignoreDomains=n,this._additionalScopeSubscriptions=r.map(e=>this._eventBus.subscribe(e,t=>{this._onAdditionalScopeMessageReceived(e,t)})),this._appId="".concat((Math.random()+1).toString(36).substring(2,6))}destroy(){this._eventBus.unsubscribe(this._onLogMessageReceivedToken),this._eventBus.unsubscribe(this._onErrorReceivedToken),this._additionalScopeSubscriptions.forEach(this._eventBus.unsubscribe)}_onMessageReceived(e){var{domain:t,timestamp:r,level:n,message:i,payload:o}=e;this._levels.includes(n)&&!this._ignoreDomains.includes(t)&&(c[n]||c.info)("(".concat(this._appId,") :: [").concat(t,"] ").concat(n.toUpperCase(),":\n").concat(i,"@").concat(r),o)}_onAdditionalScopeMessageReceived(e,t){(0,c.verbose)("[".concat(e,"] Event receiver with payload ").concat(t," @ ").concat(performance.now()))}_onErrorReceived(e){var{error:t}=e;this._enableErrorAutoLog&&(0,l.Logger)(this._eventBus,"COMMON ERROR").error("Error in ".concat(t.domain,": ").concat(t.message," ").concat(t.info&&" ("+t.info+")"))}}t.LoggerConsoleTransport=h,n([o.bind],h.prototype,"_onMessageReceived",null),n([o.bind],h.prototype,"_onAdditionalScopeMessageReceived",null),n([o.bind],h.prototype,"_onErrorReceived",null)},5021:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentParserEvents=void 0,t.FragmentParserEvents={fragments:{fragmentsParsed:"fragmentParser.fragments.fragmentsParsed",videoFragmentParsed:"fragmentParser.fragments.videoFragmentParsed",audioFragmentParsed:"fragmentParser.fragments.audioFragmentParsed"}}},5030:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableInsufficientBufferEstimatorConfigValues=t.defaultInsufficientBufferEstimatorConfig=void 0,t.defaultInsufficientBufferEstimatorConfig={minimalBufferAmount:.1,ignoreMetricsBeforeBufferExceedsMinimal:!0,switchToMinimalResolution:!1},t.availableInsufficientBufferEstimatorConfigValues={}},5042:e=>{e.exports={nanoid:function(){for(var e="",t=0|(arguments.length>0&&void 0!==arguments[0]?arguments[0]:21);t--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e},customAlphabet:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:21;return function(){for(var r="",n=0|(arguments.length>0&&void 0!==arguments[0]?arguments[0]:t);n--;)r+=e[Math.random()*e.length|0];return r}}}},5088:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbrControllerNew=void 0;var s=r(6805),l=r(1192),u=r(1388),c=r(1222),d=r(1675),h=r(9476),f=r(3273),p=r(917),v=r(942),g=r(6882),_=o(r(5354)),m=r(9622),y=r(7370),b=r(1660),E=r(7838);class S extends m.BaseABRController{constructor(e){super(e),a(this,"_requireStatsInterval",null),a(this,"_isStreamLive",!1),a(this,"_isEnabled",!1),a(this,"_lastUpscaleTimestamp",performance.now()),a(this,"_lastFailTimestamp",performance.now()),a(this,"_lastAfterFailsTimeout",0),a(this,"_failsAmount",0),a(this,"_lastFailedResolution",null),a(this,"_lastDownscaleTimestamp",performance.now()),a(this,"_lastBadBandwidthReportTimestamp",performance.now()),a(this,"_bandwidthNoiseController",void 0),a(this,"_resolutionsController",void 0),a(this,"_statsAnalyzer",void 0),a(this,"_onTargetBitrateReachedListener",void 0),a(this,"_handleBandwidthNoiseChangeListener",void 0),a(this,"_onNotEnoughBandwidthDetectedListener",void 0),a(this,"_onQualityChangeRequestedListener",void 0),a(this,"_peerConnectionStatsAvailableListener",void 0),a(this,"_playingStateChangeListener",void 0),a(this,"_websocketMessageSentListener",void 0),a(this,"_logger",void 0),this._logger=(0,s.Logger)(this._eventBus,"Ristretto - AbrController (new)"),this._bandwidthNoiseController=new y.BandwidthNoiseController(e),this._resolutionsController=new b.ResolutionsController(e),this._statsAnalyzer=new E.StatsAnalyzer(e,this._bandwidthNoiseController),this._onTargetBitrateReachedListener=this._eventBus.subscribe(l.EAbrControllerEvents.BANDWIDTH_NOISE_TARGET_BITRATE_REACHED,this._onTargetBitrateReached),this._handleBandwidthNoiseChangeListener=this._eventBus.subscribe(l.EAbrControllerEvents.BANDWIDTH_NOISE_CHANGE,this._handleBandwidthNoiseChange),this._onNotEnoughBandwidthDetectedListener=this._eventBus.subscribe(l.EAbrControllerEvents.NOT_ENOUGH_BANDWIDTH_DETECTED,this._onNotEnoughBandwidthDetected),this._onQualityChangeRequestedListener=this._eventBus.subscribe(l.EAbrControllerEvents.QUALITY_CHANGE_REQUESTED,this._onQualityChangeRequested),this._peerConnectionStatsAvailableListener=this._eventBus.subscribe(v.EPeerConnectionEvents.RAW_STATS_AVAILABLE,this._handlePeerConnectionStatsAvailable),this._playingStateChangeListener=this._eventBus.subscribe(c.ECommonEvent.PLAYING_STATE_CHANGED,this._handlePlayingStateChange),this._websocketMessageSentListener=this._eventBus.subscribe(p.EWebsocketTransportEvents.MESSAGE_SENT,this._handleWebsocketMessageSent)}toggleAbrStatus(e){this._logger.info("toggleAbrStatus",{isEnabled:e}),this._isEnabled=e,this._updateRequireStatsInterval(),this._isEnabled||this._bandwidthNoiseController.reset()}updateCurrentPreset(e){this._logger.info("Resolution was manually set",{resolutionName:e}),this._resolutionsController.setCurrentResolutionName(e);var{currentResolution:t}=this._resolutionsController.getResolutions();t&&(this._statsAnalyzer.setTargetBitrate(t.bitrate),this._bandwidthNoiseController.setCurrentResolutionBitrate(t.bitrate))}updateStartAutoPreset(e){this._logger.info("Setting start resolution",{resolutionName:e}),this._resolutionsController.setStartAutoResolution(e)}updateQualityPresets(e){var{presets:t}=e;this._logger.info("Set available resolutions",{presets:t}),this._resolutionsController.setAvailableResolutions(t);var{currentResolution:r}=this._resolutionsController.getResolutions();r&&(this._statsAnalyzer.setTargetBitrate(r.bitrate),this._bandwidthNoiseController.setCurrentResolutionBitrate(r.bitrate)),this._updateRequireStatsInterval()}destroy(){this._eventBus.unsubscribe(this._onTargetBitrateReachedListener),this._eventBus.unsubscribe(this._handleBandwidthNoiseChangeListener),this._eventBus.unsubscribe(this._onNotEnoughBandwidthDetectedListener),this._eventBus.unsubscribe(this._onQualityChangeRequestedListener),this._eventBus.unsubscribe(this._peerConnectionStatsAvailableListener),this._eventBus.unsubscribe(this._playingStateChangeListener),this._eventBus.unsubscribe(this._websocketMessageSentListener),this._requireStatsInterval&&globalThis.clearInterval(this._requireStatsInterval),this._logger.info("Destroyed"),super.destroy(),this._bandwidthNoiseController.reset(),this._statsAnalyzer.reset()}_handleConfigUpdated(){this._updateRequireStatsInterval()}_updateRequireStatsInterval(){var e;this._requireStatsInterval&&globalThis.clearInterval(this._requireStatsInterval),this._isEnabled&&this._isStreamLive&&this.config.abrOnClient&&this.config.checkingIntervalNew&&(null===(e=this._resolutionsController)||void 0===e?void 0:e.hasAnyResolutionAvailable())&&(this._requireStatsInterval=globalThis.setInterval(()=>{this._eventBus.publish(v.EPeerConnectionEvents.RAW_STATS_REQUIRED,{})},this.config.checkingIntervalNew))}_handlePlayingStateChange(e){var{nextState:t,prevState:r}=e;this._logger.info("Playing state changed: ".concat(r," -> ").concat(t)),this._isStreamLive=t===g.EStreamStatus.LIVE,this._updateRequireStatsInterval()}_onTargetBitrateReached(){this._logger.verbose("Target bitrate was reached. Will try to increase resolution"),this._bandwidthNoiseController.reset();var{nextResolution:e}=this._resolutionsController.getResolutions();this._lastUpscaleTimestamp=performance.now(),e&&(this._setNewQuality(e.name),this._statsAnalyzer.setTargetBitrate(e.bitrate))}_handleBandwidthNoiseChange(e){this._logger.verbose("Will request to set the noise level",{value:e.value});var t=this._resolutionsController.getResolutions().currentResolution;Number(e.value)>0?this._statsAnalyzer.setTargetBitrate(e.value):t&&this._statsAnalyzer.setTargetBitrate(t.bitrate),this._eventBus.publish(h.EMetadataTransportEvents.SET_NOISE_LEVEL,e)}_checkIfTestNeeded(){var{currentResolution:e,nextResolution:t}=this._resolutionsController.getResolutions();this._checkTimings()&&e&&t&&e.bitrate!==t.bitrate&&!this._bandwidthNoiseController.hasNoise()&&this._bandwidthNoiseController.startEstimation(t.bitrate)}_checkTimings(){var e=performance.now();return e-this._lastDownscaleTimestamp>this.config.afterDownscaleTimeout&&e-this._lastUpscaleTimestamp>this.config.afterUpscaleTimeout&&e-this._lastFailTimestamp>this.config.afterFailedTimeout&&e-this._lastBadBandwidthReportTimestamp>this.config.afterBadBandwidthReportTimeout&&(!this._lastAfterFailsTimeout||e-this._lastAfterFailsTimeout>this.config.afterFailsTimeout)}_checkTimingsForDownscale(){var e=performance.now();return e-this._lastUpscaleTimestamp>this.config.failAfterUpscaleTimeout&&e-this._lastDownscaleTimestamp>this.config.failAfterDownscaleTimeout}_onNotEnoughBandwidthDetected(){this._lastBadBandwidthReportTimestamp=performance.now();var{prevResolution:e,currentResolution:t,nextResolution:r}=this._resolutionsController.getResolutions();if(this._logger.verbose("Not enough bandwidth"),this._bandwidthNoiseController.hasNoise()){if(this._logger.info("Bad bandwidth detected during the test. Reset"),this._bandwidthNoiseController.reset(),this._lastFailTimestamp=performance.now(),!r)return;this._lastFailedResolution!==r.name&&this._lastFailedResolution?(this._failsAmount=0,this._lastFailedResolution=r.name):this._failsAmount++,this._failsAmount>=this.config.failsToTimeout&&(this._logger.info("Failed to upscale to ".concat(r.name," ").concat(this._failsAmount," times. Waiting")),this._lastAfterFailsTimeout=performance.now())}else{if(!this._checkTimingsForDownscale())return void this._logger.info("Bad bandwidth detected. Ignoring due to timings");this._logger.info("Bad bandwidth detected. Rolling back to the previous resolution"),e&&(this._setNewQuality(e.name),t&&this._statsAnalyzer.setTargetBitrate(e.bitrate)),this._lastDownscaleTimestamp=performance.now()}}_onQualityChangeRequested(e){this._logger.info("Request to change to ".concat(e.qualityName)),this._setNewQuality(e.qualityName);var t=this._resolutionsController.getResolutions().currentResolution;t&&this._statsAnalyzer.setTargetBitrate(t.bitrate)}_setNewQuality(e){this._logger.info("Quality change requested to ".concat(e)),this._isEnabled&&(this._eventBus.publish(h.EMetadataTransportEvents.SET_QUALITY,{quality:e}),this._statsAnalyzer.reset()),this._resolutionsController.setCurrentResolutionName(e);var t=this._resolutionsController.getResolutions().currentResolution;t&&this._isEnabled&&this._eventBus.publish(d.ELifecycleEvent.RESOLUTION_SWITCH_AUTO,{prevResolution:t.name,nextResolution:e})}_handlePeerConnectionStatsAvailable(e){if(this._isEnabled){this._logger.verbose("Peer connection stats received"),this._checkIfTestNeeded();var t=(0,u.getSortedPeerStats)(e.stats);this._statsAnalyzer.updateStats([i(i({},t.video),t.common)])}}_handleWebsocketMessageSent(e){var t;e.message===f.EOutgoingMessage.PLAY_STREAM&&(null===(t=e.data[0])||void 0===t?void 0:t.quality)&&this.updateStartAutoPreset(e.data[0].quality.toString())}}t.AbrControllerNew=S,n([_.default],S.prototype,"_updateRequireStatsInterval",null),n([_.default],S.prototype,"_handlePlayingStateChange",null),n([_.default],S.prototype,"_onTargetBitrateReached",null),n([_.default],S.prototype,"_handleBandwidthNoiseChange",null),n([_.default],S.prototype,"_onNotEnoughBandwidthDetected",null),n([_.default],S.prototype,"_onQualityChangeRequested",null),n([_.default],S.prototype,"_setNewQuality",null),n([_.default],S.prototype,"_handlePeerConnectionStatsAvailable",null),n([_.default],S.prototype,"_handleWebsocketMessageSent",null)},5121:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferCleaner=void 0;var o=r(355),s=r(8169),l=r(8474),u=r(2513),c=i(r(6073));class d extends s.ConfigConsumer{constructor(e){super("bufferController",e),a(this,"_isPaused",!1),a(this,"_isInVodMode",!1),a(this,"_fragmentTimeRanges",[]),a(this,"_videoElement",null),a(this,"_onBufferMetricsReadyListener",void 0),a(this,"_onPeriodFragmentsFound",void 0),a(this,"_onVODFragmentsInfoAvailableListener",void 0),a(this,"_logger",void 0),this._logger=(0,l.Logger)(e,"Doppio - BufferCleaner"),this._logger=(0,l.Logger)(this._eventBus,"Doppio - BufferCleaner"),this._onBufferMetricsReadyListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable),this._onPeriodFragmentsFound=this._eventBus.subscribe(u.BasePlaylistRotationControllerEvents.fragments.periodFragmentsFound,this._onFragmentPeriodFound),this._onVODFragmentsInfoAvailableListener=this._eventBus.subscribe(u.BasePlaylistRotationControllerEvents.playlists.vodFragmentsInfo,this._onVODFragmentsInfoAvailable)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onPeriodFragmentsFound),this._eventBus.unsubscribe(this._onVODFragmentsInfoAvailableListener),this._eventBus.unsubscribe(this._onBufferMetricsReadyListener)}start(){this._isPaused=!1}pause(){this._isPaused=!0}setVODMode(e){this._isInVodMode=e}setVideoElement(e){this._videoElement=e}removeVideoElement(){this._videoElement=null}_handleConfigUpdated(){}_onVODFragmentsInfoAvailable(e){this._fragmentTimeRanges=e.map(e=>{var{fragmentStartTS:t,fragmentEndTS:r}=e;return{startTS:t,endTS:r}})}_onBufferMetricsAvailable(e){if(!(this._isPaused||0===e.bufferedTimeRanges.length||this._isInVodMode&&this._fragmentTimeRanges.length)){var t,r,n=e.isPaused?[{startTS:e.currentPlaybackPosition-1,endTS:e.currentPlaybackPosition+1},{startTS:(null===(t=e.bufferedTimeRanges.slice(-1)[0])||void 0===t?void 0:t.end)-this.config.maxBackBufferAmount/1e3,endTS:null===(r=e.bufferedTimeRanges.slice(-1)[0])||void 0===r?void 0:r.end}]:[{startTS:e.currentPlaybackPosition-this.config.maxBackBufferAmount/1e3,endTS:e.bufferedTimeRanges.slice(-1)[0].end}];this._clearBufferWithSafetyTimeRanges(n)}}_onFragmentPeriodFound(e){var{endTsOfPeriod:t}=e;if(!(this._isPaused||!this._videoElement||this._videoElement.currentTime<this.config.maxBackBufferAmount/1e3)){var{currentTime:r}=this._videoElement,n=[{startTS:r-this.config.maxBackBufferAmount/1e3,endTS:t}];this._clearBufferWithSafetyTimeRanges(n)}}_clearBufferWithSafetyTimeRanges(e){var t;if(null!==(t=this._videoElement)&&void 0!==t&&t.buffered.length){var r=e.sort((e,t)=>e.startTS-t.startTS).filter(e=>{var{startTS:t,endTS:r}=e;return t<r}).map((t,r)=>({startTS:r>0?e[r-1].endTS:0,endTS:t.startTS})).filter(e=>{var{startTS:t,endTS:r}=e;return t<r});this._isInVodMode&&Number.isFinite(this._videoElement.duration)&&e.length&&e.slice(-1)[0].endTS<this._videoElement.duration&&r.push({startTS:e.slice(-1)[0].endTS,endTS:this._videoElement.duration}),r.forEach(e=>{this._eventBus.publish(o.BufferControllerEvents.requestSourceBufferOperation,t=>{this._logger.verbose("Removing buffered range ".concat(e.startTS," -> ").concat(e.endTS)),t.remove(e.startTS,e.endTS)})})}}}t.BufferCleaner=d,n([c.default],d.prototype,"destroy",null),n([c.default],d.prototype,"_handleConfigUpdated",null),n([c.default],d.prototype,"_onVODFragmentsInfoAvailable",null),n([c.default],d.prototype,"_onBufferMetricsAvailable",null),n([c.default],d.prototype,"_onFragmentPeriodFound",null)},5130:(e,t)=>{var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.EAbrPolicy=t.EMetadataTransportState=void 0,function(e){e.UNKNOWN="unknown",e.CONNECTED="connected",e.DISCONNECTED="disconnected",e.IDLE="idle",e.STOPPING="stopping",e.CONNECTING="connecting"}(r||(t.EMetadataTransportState=r={})),function(e){e.UNKNOWN="unknown",e.CLIENT="client",e.SERVER="server"}(n||(t.EAbrPolicy=n={}))},5148:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EDebuggerEvent=void 0,function(e){e.LIFECYCLE_EVENT="debugger.lifecycleEvent",e.DEBUGGER_CONNECTED="debugger.connected"}(r||(t.EDebuggerEvent=r={}))},5170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbortController=t.AbortSignal=void 0;class r{constructor(){Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}addEventListener(e,t,r){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:r})}removeEventListener(e,t){if(e in this.listeners)for(var r=this.listeners[e],n=0,i=r.length;n<i;n++)if(r[n].callback===t)return void r.splice(n,1)}dispatchEvent(e){var t=this;if(e.type in this.listeners){for(var r=this.listeners[e.type].slice(),n=function(){var n=r[i];try{n.callback.call(t,e)}catch(e){Promise.resolve().then(()=>{throw e})}n.options&&n.options.once&&t.removeEventListener(e.type,n.callback)},i=0,o=r.length;i<o;i++)n();return!e.defaultPrevented}}}class n extends r{constructor(){super(),this.listeners||r.call(this),Object.defineProperty(this,"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(this,"reason",{value:void 0,writable:!0,configurable:!0})}toString(){return"[object AbortSignal]"}dispatchEvent(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),super.dispatchEvent(e)}}t.AbortSignal=n;class i{constructor(){Object.defineProperty(this,"signal",{value:new n,writable:!0,configurable:!0})}abort(e){var t;t=new Event("abort");var r=e;void 0===r&&((r=new Error("This operation was aborted")).name="AbortError"),this.signal.reason=r,this.signal.dispatchEvent(t)}toString(){return"[object AbortController]"}}t.AbortController=i,function(e){(function(e){return"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController})(e)&&("undefined"!=typeof Symbol&&Symbol.toStringTag&&(i.prototype[Symbol.toStringTag]="AbortController",n.prototype[Symbol.toStringTag]="AbortSignal"),e.AbortController=i,e.AbortSignal=n)}("undefined"!=typeof self?self:globalThis)},5175:(e,t,r)=>{r.d(t,{A:()=>u});var n=r(2383),i=r(3098),o=function(e){return(0,i.A)(e)&&"[object Arguments]"==(0,n.A)(e)},s=Object.prototype,a=s.hasOwnProperty,l=s.propertyIsEnumerable,u=o(function(){return arguments}())?o:function(e){return(0,i.A)(e)&&a.call(e,"callee")&&!l.call(e,"callee")}},5182:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TargetBufferIncreaser=void 0;var o=r(355),s=r(6791),l=r(8169),u=r(180),c=i(r(6073));class d extends l.ConfigConsumer{constructor(e){super("targetBufferIncreaser",e),a(this,"state",u.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["PlaybackSpeed"]),a(this,"_hasFallenBelowLine",!0),a(this,"_onBufferMetricsAvailableListener",void 0),this._onBufferMetricsAvailableListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onBufferMetricsAvailableListener)}_handleConfigUpdated(){}_onBufferMetricsAvailable(e){this._hasFallenBelowLine?1e3*e.bufferAmountWithoutGaps>=this.config.bufferAmountThreshold&&(this._hasFallenBelowLine=!1):1e3*e.bufferAmountWithoutGaps<this.config.bufferAmountToIncrease&&(this._hasFallenBelowLine=!0,this._eventBus.publish(s.TargetBufferEvents.targetBufferIncreaseRequested,{}))}get additionalInfo(){return{hasFallenBelowLine:this._hasFallenBelowLine}}}t.TargetBufferIncreaser=d,n([c.default],d.prototype,"destroy",null),n([c.default],d.prototype,"_onBufferMetricsAvailable",null)},5206:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LifecycleEventReporterFactory=void 0;var n=r(6733);t.LifecycleEventReporterFactory=(e,t)=>r=>{t.publish(n.DebuggerEvents.lifecycleEvent,{module:e,eventInfo:r,timestamp:Date.now()})}},5221:(e,t)=>{function r(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getGlobalThis=r,"undefined"==typeof globalThis&&(globalThis=r())},5238:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableDebuggerConfigValues=t.defaultDebuggerConfig=void 0,t.defaultDebuggerConfig={enableRemoteDebugging:!1,debuggerUrl:"wss://doppio-player-debug.stripcdn.com",maxWSConnectionRetries:3,modulesStateGatheringPeriod:1e3,enableLifecycleEvents:!0},t.availableDebuggerConfigValues={}},5254:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},5264:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availablePlaybackSpeedActuatorConfigValues=t.defaultPlaybackSpeedActuatorConfig=void 0,t.defaultPlaybackSpeedActuatorConfig={maxPlaybackRate:1.05,minPlaybackRate:.9},t.availablePlaybackSpeedActuatorConfigValues={}},5307:(e,t)=>{var r,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.EPlayerErrorType=t.EPlaybackState=t.AVAILABLE_PLAYER_TYPES=t.EPlayerType=void 0,function(e){e.HLS="hls",e.WEBRTC="webrtc",e.BROADCAST="broadcast",e.NATIVE="native",e.UNKNOWN="unknown"}(r||(t.EPlayerType=r={})),t.AVAILABLE_PLAYER_TYPES=[r.HLS,r.BROADCAST,r.WEBRTC,r.NATIVE,r.UNKNOWN],function(e){e.IDLE="idle",e.LOADING="loading",e.PAUSED="paused",e.PLAYING="playing",e.ERROR="error"}(n||(t.EPlaybackState=n={})),function(e){e.BROADCAST_NOT_SUPPORTED_BY_BROWSER="broadcastNotSupportedByBrowser"}(i||(t.EPlayerErrorType=i={}))},5312:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EPlaybackState=void 0,function(e){e.IDLE="idle",e.LOADING="loading",e.PLAYING="playing",e.PAUSED="paused",e.ERROR="error"}(r||(t.EPlaybackState=r={}))},5323:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addH264Bitrate=void 0;var r=/^a=rtpmap:(\d+)\sH264/gm;t.addH264Bitrate=(e,t)=>{var n=t.match(r);return n?[...n].reduce((t,n)=>{var i,o=null===(i=r.exec(n))||void 0===i?void 0:i[1];return r.exec(""),t.replace(new RegExp("a=fmtp:".concat(o," .*")),t=>"".concat(t,"; ").concat(e))},t):t}},5353:(e,t,r)=>{r.d(t,{A:()=>i});var n=/^(?:0|[1-9]\d*)$/,i=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},5354:(e,t)=>{function r(e,t,r){if(!r||"function"!=typeof r.value)throw new TypeError("Only methods can be decorated with @bind. <".concat(t,"> is not a method!"));return{configurable:!0,get(){var e,n=null===(e=r.value)||void 0===e?void 0:e.bind(this);return Object.defineProperty(this,t,{value:n,configurable:!0,writable:!0}),n}}}Object.defineProperty(t,"__esModule",{value:!0}),t.bind=r,t.default=r},5356:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThroughputEstimator=void 0;var o=r(8923),s=r(9115),l=r(8169),u=r(5395),c=r(180),d=i(r(6073));class h extends l.ConfigConsumer{constructor(e){super("throughputEstimator",e),a(this,"state",c.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"groups",["abr"]),a(this,"_isResultsConfident",!1),a(this,"_fragmentsLoadedAmount",0),a(this,"_throughputHistory",void 0),a(this,"_onNetworkMetricsReadyListener",void 0),this._throughputHistory=new o.ThroughputHistory(this._eventBus),this._onNetworkMetricsReadyListener=this._eventBus.subscribe(u.NetworkLoaderEvent.stats.statsReady,this._onNetworkStatsReady)}destroy(){super.destroy(),this._throughputHistory.destroy(),this._eventBus.unsubscribe(this._onNetworkMetricsReadyListener)}reset(){this._throughputHistory.reset(),this._isResultsConfident=!1}getNextEstimatedResolution(e){var{realSpeedWithoutTTFB:t,measuredSpeed:r,ttfb:n}=this._throughputHistory.getCurrentBitrateEstimate();if(this.additionalInfo={realSpeedWithoutTTFB:t,measuredSpeed:r,ttfb:n},!e.length||!r||!this._isResultsConfident)return null;var i=(0,s.getKBitsSpeedFromPlaylistBitrate)(e[0].bitrate)/(n+(0,s.getKBitsSpeedFromPlaylistBitrate)(e[0].bitrate)/t);if((0,s.getKBitsSpeedFromPlaylistBitrate)(e[0].bitrate)<i)return e[0];var o=e.find(e=>{var{bitrate:r}=e,i=(0,s.getKBitsSpeedFromPlaylistBitrate)(r),o=i/(n+i/t);return o*this.config.optimalResolutionLowerBound<=i&&i<=o*this.config.optimalResolutionUpperBound});return o||e.find(e=>{var{bitrate:t}=e;return(0,s.getKBitsSpeedFromPlaylistBitrate)(t)<=r*this.config.optimalResolutionLowerBound})||e.slice(-1)[0]}_handleConfigUpdated(){}_onNetworkStatsReady(e){"binary"!==e.type||this._isResultsConfident||(this._fragmentsLoadedAmount+=1,this._fragmentsLoadedAmount>=this.config.amountOfFragmentToBecomeConfident&&(this._isResultsConfident=!0))}}t.ThroughputEstimator=h,n([d.default],h.prototype,"_handleConfigUpdated",null),n([d.default],h.prototype,"_onNetworkStatsReady",null)},5361:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventBus=void 0;var n=r(83);Object.defineProperty(t,"EventBus",{enumerable:!0,get:function(){return n.EventBus}})},5373:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GapController=void 0;var n=r(3359),i=r(2142),o=r(180);t.GapController=class{constructor(e){a(this,"_eventBus",void 0),a(this,"groups",["buffer"]),a(this,"_liveGapController",null),a(this,"_vodGapController",null),a(this,"_videoElement",null),a(this,"_isInVODMode",!1),this._eventBus=e,this._liveGapController=new n.LiveGapController(this._eventBus),this._recreateGapController()}destroy(){var e,t;null!==(e=this._vodGapController)&&void 0!==e&&e.destroy(),null===(t=this._liveGapController)||void 0===t||t.destroy()}setIsVod(e){this._isInVODMode=e,this._recreateGapController()}setVideoElement(e){this._videoElement=e,this._liveGapController&&this._liveGapController.setVideoElement(e),this._vodGapController&&this._vodGapController.setVideoElement(e)}removeVideoElement(){var e,t;this._videoElement=null,null!==(e=this._liveGapController)&&void 0!==e&&e.removeVideoElement(),null===(t=this._vodGapController)||void 0===t||t.removeVideoElement()}_recreateGapController(){var e,t;null!==(e=this._vodGapController)&&void 0!==e&&e.destroy(),null!==(t=this._liveGapController)&&void 0!==t&&t.destroy(),this._isInVODMode?this._vodGapController=new i.VODGapController(this._eventBus):this._liveGapController=new n.LiveGapController(this._eventBus),this._videoElement&&this.setVideoElement(this._videoElement)}get status(){var e,t;return(null===(e=this._vodGapController)||void 0===e?void 0:e.status)||(null===(t=this._liveGapController)||void 0===t?void 0:t.status)||"Idle"}get state(){var e,t;return(null===(e=this._vodGapController)||void 0===e?void 0:e.state)||(null===(t=this._liveGapController)||void 0===t?void 0:t.state)||o.EDebuggableModuleState.OK}get additionalInfo(){var e,t;return(null===(e=this._vodGapController)||void 0===e?void 0:e.additionalInfo)||(null===(t=this._liveGapController)||void 0===t?void 0:t.additionalInfo)||{}}}},5380:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddMinmaxBitrates=void 0;var n=r(6972),i=r(5323);t.AddMinmaxBitrates=class{constructor(e,t,r,n){a(this,"_defaultMinBitrate",void 0),a(this,"_defaultBitrate",void 0),a(this,"_bitrateThreshold",void 0),a(this,"_bitrate",void 0),this._defaultMinBitrate=t,this._defaultBitrate=r,this._bitrateThreshold=n,this._bitrate=e}modify(e){var{_bitrate:t,_defaultBitrate:r,_defaultMinBitrate:o,_bitrateThreshold:s}=this,a=t?t-s:o,l=t?t+s:r,u=t||a,c=(0,n.convertBitratesToSDPLines)({minBitrate:a,maxBitrate:l,startBitrate:u});return(0,i.addH264Bitrate)(c,e)}}},5395:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkLoaderEvent=void 0,t.NetworkLoaderEvent={events:{browserRedirectDetected:"networkLoader.events.browserRedirectDetected",networkRequestSettled:"networkLoader.events.networkRequestSettled"},stats:{statsReady:"networkLoader.stats.statsEvent"}}},5417:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PeerConnection=void 0;var l=r(6805),u=r(3518),c=r(1675),d=r(7011),h=r(2305),f=r(8754),p=r(8045),v=r(6768),g=o(r(5354)),_=r(3566),m=r(942),y=r(236),b=r(480),E=r(1178),S=r(1222),T=r(5740);class C extends u.ConfigConsumer{constructor(e,t){super("peerConnectionConfig",e),a(this,"state",p.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"mediaStream",null),a(this,"_peerConnectionConfigOverride",{}),a(this,"_connectionState",_.EPeerConnectionState.UNKNOWN),a(this,"_iceConnectionState",_.ENativeIceConnectionState.NEW),a(this,"_peerConnectionState",_.ENativePeerConnectionState.NEW),a(this,"_connection",null),a(this,"_offerConfig",void 0),a(this,"_sdpLocalModifier",null),a(this,"_sdpRemoteModifier",null),a(this,"_kind",[]),a(this,"_peerStats",new f.PeerConnectionStats),a(this,"_statsGatheringInterval",null),a(this,"_isGatheringFinished",!1),a(this,"_requireRawStatsListener",void 0),a(this,"_latencyController",void 0),a(this,"_logger",void 0),a(this,"_shouldEnableInsertableStreams",void 0),this._shouldEnableInsertableStreams=this.config.enableG2GLatencyMeasurement&&t,this._latencyController=new d.LatencyController(e,this.config.timeSyncResyncInterval),this._logger=(0,l.Logger)(this._eventBus,"Ristretto - PeerConnection"),this._logger.info("Created");var r=i({framesDecoded:{originalPath:"inbound-rtp:video.framesDecoded",modifier:"delta",reducer:"last",filter:"raw"},jitterBufferDelay:{originalPath:"inbound-rtp:video.jitterBufferDelay",modifier:"delta",reducer:"last",filter:"raw"},jitterBufferEmittedCount:{originalPath:"inbound-rtp:video.jitterBufferEmittedCount",modifier:"delta",reducer:"last",filter:"raw"},jitterBufferMinimumDelay:{originalPath:"inbound-rtp:video.jitterBufferMinimumDelay",modifier:"delta",reducer:"last",filter:"raw"},totalAssemblyTime:{originalPath:"inbound-rtp:video.totalAssemblyTime",modifier:"delta",reducer:"last",filter:"raw"},totalProcessingDelay:{originalPath:"inbound-rtp:video.totalProcessingDelay",modifier:"delta",reducer:"last",filter:"raw"}},"string"==typeof this.config.statsCollectionScheme?JSON.parse(this.config.statsCollectionScheme):this.config.statsCollectionScheme||{});this._peerStats.setScheme(r),this._requireRawStatsListener=this._eventBus.subscribe(m.EPeerConnectionEvents.RAW_STATS_REQUIRED,this._handleRequireRawStats),this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.PEER_CONNECTION_OPEN_REQUESTED,description:"Peer connection created"})}destroy(e){super.destroy(),this.closeConnection("PC destroy: ".concat(e)),this._disarmStatsGatheringInterval(),this._latencyController.destroy(),this._eventBus.unsubscribe(this._requireRawStatsListener),this._logger.info("Destroyed")}setKind(e){this._logger.info("Kind updated: ".concat(JSON.stringify(this._kind)," -> ").concat(JSON.stringify(e))),this._kind=e}setPeerConfigOverride(e){this._logger.info("Peer config override updated: ".concat(JSON.stringify(this._peerConnectionConfigOverride)," -> ").concat(JSON.stringify(e))),this._peerConnectionConfigOverride=e}getState(){return this._connectionState}setStream(e){if(this._connection){this._logger.info("Stream updated");var t=this._connection.getSenders();if(t.length){this._logger.debug("Senders already registered. Updating with the new one");var[r,n]=[e.getVideoTracks()[0],e.getAudioTracks()[0]],[i,o]=[t.find(e=>{var{track:t}=e;return(null==t?void 0:t.kind)===(null==r?void 0:r.kind)}),t.find(e=>{var{track:t}=e;return(null==t?void 0:t.kind)===(null==n?void 0:n.kind)})];i&&(this._logger.verbose("Video track found in the new stream. Replacing"),this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.SENDER_UPDATED,description:"Replacing video track in existing sender"}),i.replaceTrack(r)),!i&&r&&(this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.SENDER_UPDATED,description:"Could not find existing video sender among available senders. Add new"}),this._connection.addTrack(r,e)),o&&(this._logger.verbose("Audio track found in the new stream. Replacing"),this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.SENDER_UPDATED,description:"Replacing audio track in existing sender"}),o.replaceTrack(n)),!o&&n&&(this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.SENDER_UPDATED,description:"Could not find existing audio sender among available senders. Add new"}),this._connection.addTrack(n,e))}else{this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.SENDER_UPDATED,description:"No senders created previously. Adding new one for each track"}),this._logger.debug("No senders created previously. Adding new one for each track"),e.getTracks().forEach(t=>{var r;this._logger.verbose("New track with kind ".concat(t.kind," has been added")),null===(r=this._connection)||void 0===r||r.addTrack(t,e)});var s=this._connection.getSenders().find(e=>{var{track:t}=e;return"video"===(null==t?void 0:t.kind)}),a=this._connection.getSenders().find(e=>{var{track:t}=e;return"audio"===(null==t?void 0:t.kind)});s&&h.hasInsertableStreamsSupport&&this._shouldEnableInsertableStreams&&this._latencyController.transformVideoSender(s),a&&h.hasInsertableStreamsSupport&&this._shouldEnableInsertableStreams&&this._latencyController.transformAudioSender(a)}}}setSDPLocalModifier(e){this._sdpLocalModifier=e}setSDPRemoteModifier(e){this._sdpRemoteModifier=e}setRemoteDescription(e){var t;if(this._connection){e.sdp=this._sdpRemoteModifier&&e.sdp?this._sdpRemoteModifier.modifySdp(e.sdp):e.sdp;var r=null===(t=e.sdp)||void 0===t||null===(t=t.match(/H2\d\d/))||void 0===t?void 0:t[0];r&&this._latencyController.setVideoCodecs(r),this._logger.info("setRemoteDescription: Going to set remote SDP to the Peer Connection",{connectionState:this._connectionState,peerConnectionState:this._peerConnectionState}),this._connection.setRemoteDescription(e).catch(e=>{this._logger.error("Failed to set remote description",{connectionState:this._connectionState,peerConnectionState:this._peerConnectionState,error:e}),this._eventBus.publish(m.EPeerConnectionEvents.SET_REMOTE_SDP_ERROR,{})}),this.status="Awaiting for peer connection"}}setLocalDescription(e){this._connection&&(this._logger.debug("Trying to set local SDP for peer connection. See SDP in details",e),e.sdp=this._sdpLocalModifier&&e.sdp?this._sdpLocalModifier.modifySdp(e.sdp):e.sdp,this._connection.setLocalDescription(e).catch(()=>{this._logger.error("Can't set local sdp - The SDP does not match the previously generated SDP for this type")}))}closeConnection(e){var t;this._logger.info("Closing connection"),this._detachEventListeners(),this.config.closeNativeConnectionOnDestroy&&null!==(t=this._connection)&&void 0!==t&&t.close(),this._connection=null,this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.PEER_CONNECTION_CLOSE_REQUESTED,description:"Peer connection closed with reason ".concat(e)}),this._setConnectionState(_.EPeerConnectionState.DESTROYED)}createReceiveConnection(){var e;if(this._kind.length){this._logger.info("Creating receive connection");var t=l.WebRTCCommonHelpers.resolveRTCPeerConnection(),{iceServers:r,iceTransportPolicy:n,iceCandidatePoolSize:o,rtcpMuxPolicy:s,bundlePolicy:a}=this.config,u=i(i({iceServers:r||[],iceTransportPolicy:n,iceCandidatePoolSize:o,bundlePolicy:a,rtcpMuxPolicy:s},this._peerConnectionConfigOverride),{},{encodedInsertableStreams:h.hasInsertableStreamsSupport&&this._shouldEnableInsertableStreams});v.isFirefox&&!this.config.setIceServersForFirefox&&(this._logger.debug("Current browser is Firefox and no setIceServersForFirefox flag provided. Resetting to an empty array"),u.iceServers=[]),"relay"!==n||null!==(e=u.iceServers)&&void 0!==e&&e.some(e=>{var{urls:t}=e;return(Array.isArray(t)?t:[t]).some(e=>e.startsWith("turn:"))})||(this._logger.warn("ICE transport policy set as 'relay', but no TURN server defined. Force transport policy to 'all'"),u.iceTransportPolicy="all"),this._connection=new t(u),this._peerStats.setPeerConnection(this._connection),this._armStatsGatheringInterval(),(0,v.isTransceiverAvailableAndWorking)(this._connection)?(this._logger.debug("Add transceivers"),this._kind.includes("audio")&&(this._logger.verbose("Found audio kind in kinds array. Add to tranciever"),this._connection.addTransceiver("audio",{direction:"recvonly"})),this._kind.includes("video")&&(this._logger.verbose("Found video kind in kinds array. Add to tranciever"),this._connection.addTransceiver("video",{direction:"recvonly"}))):(this._logger.debug("Set offer config for receive"),this._offerConfig={voiceActivityDetection:!0,offerToReceiveAudio:this._kind.includes("audio"),offerToReceiveVideo:this._kind.includes("video"),iceRestart:!1},this._logger.verbose("See final offer config in details",this._offerConfig),this._onNegotiationNeeded()),this._attachEventListeners()}else this._logger.warn("Transceiver kinds are not defined. Could not start receive connection!")}createTransmitConnection(){var e;this._logger.info("Creating transmit connection");var t=l.WebRTCCommonHelpers.resolveRTCPeerConnection(),{iceServers:r,iceTransportPolicy:n,iceCandidatePoolSize:o,rtcpMuxPolicy:s,bundlePolicy:a}=this.config,u=i(i({iceServers:r,iceTransportPolicy:n,iceCandidatePoolSize:o,bundlePolicy:a,rtcpMuxPolicy:s},this._peerConnectionConfigOverride),{},{encodedInsertableStreams:h.hasInsertableStreamsSupport&&this._shouldEnableInsertableStreams});v.isFirefox&&!this.config.setIceServersForFirefox&&(this._logger.debug("Current browser is Firefox and no setIceServersForFirefox flag provided. Resetting to an empty array"),u.iceServers=[]),"relay"!==n||null!==(e=u.iceServers)&&void 0!==e&&e.some(e=>{var{urls:t}=e;return(Array.isArray(t)?t:[t]).some(e=>e.startsWith("turn:"))})||(this._logger.warn("ICE transport policy set as 'relay', but no TURN server defined. Force transport policy to 'all'"),u.iceTransportPolicy="all"),this._connection=new t(u),this._peerStats.setPeerConnection(this._connection),this._armStatsGatheringInterval(),this._offerConfig=(0,v.isTransceiverAvailableAndWorking)(this._connection)?{}:{offerToReceiveVideo:!1,offerToReceiveAudio:!1,voiceActivityDetection:!1,iceRestart:!0},this._attachEventListeners()}getRawPeerStats(){var e=this;return s(function*(){return e._peerStats.getRawStats()})()}setTimeSyncServer(e){var{host:t,protocol:r}=new URL(e),n=t.split(".").slice(-2).join("."),i=this.config.timeSyncUrlTemplate.replace("{{domain}}",n).replace("//","".concat(r,"//"));this._latencyController.setTimeSyncServer(i)}_handleConfigUpdated(e){if(void 0!==e.statsCollectionScheme){var t="string"==typeof e.statsCollectionScheme?JSON.parse(e.statsCollectionScheme):e.statsCollectionScheme;this._peerStats.setScheme(t)}void 0!==e.statsGatheringPeriod&&this._armStatsGatheringInterval(),e.playoutDelayHint&&this._updatePlayoutDelayHint()}_handleRequireRawStats(e){var t=this;return s(function*(){var{subscriberId:r}=e,n=yield t.getRawPeerStats();n&&t._eventBus.publish(m.EPeerConnectionEvents.RAW_STATS_AVAILABLE,{stats:n,subscriberId:r})})()}_armStatsGatheringInterval(){this._disarmStatsGatheringInterval(),this._statsGatheringInterval=globalThis.setInterval(this._getStats,this.config.statsGatheringPeriod)}_disarmStatsGatheringInterval(){this._statsGatheringInterval&&globalThis.clearInterval(this._statsGatheringInterval)}_getStats(){var e=this;return s(function*(){var t=yield e._peerStats.getStatsByScheme();t&&(t.framesDecoded&&t.totalAssemblyTime&&t.totalProcessingDelay&&t.jitterBufferEmittedCount&&e._latencyController.onRTCStatsReady({framesDecoded:t.framesDecoded,jitterBufferEmittedCount:t.jitterBufferEmittedCount,totalAssemblyTime:t.totalAssemblyTime,totalProcessingDelay:t.totalProcessingDelay}),e._eventBus.publish(m.EPeerConnectionEvents.STATS_AVAILABLE,{stats:t}))})()}_attachEventListeners(){this._connection&&(this._connection.addEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged),this._connection.addEventListener("negotiationneeded",this._onNegotiationNeeded),this._connection.addEventListener("track",this._onTrackAdded),this._connection.addEventListener("icecandidate",this._onIceCandidate),this._connection.addEventListener("icegatheringstatechange",this._onIceGatheringStateChanged),this._connection.addEventListener("connectionstatechange",this._onConnectionStateChanged),this._connection.addEventListener("icecandidateerror",this._onIceCandidateError))}_detachEventListeners(){this._connection&&(this._connection.removeEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged),this._connection.removeEventListener("negotiationneeded",this._onNegotiationNeeded),this._connection.removeEventListener("track",this._onTrackAdded),this._connection.removeEventListener("icecandidate",this._onIceCandidate),this._connection.removeEventListener("icegatheringstatechange",this._onIceGatheringStateChanged),this._connection.removeEventListener("connectionstatechange",this._onConnectionStateChanged),this._connection.removeEventListener("icecandidateerror",this._onIceCandidateError))}_setConnectionState(e){var t;e!==this._connectionState&&(e===_.EPeerConnectionState.ONLINE&&this._eventBus.publish(c.ELifecycleEvent.LIFECYCLE_EVENT,{eventType:c.ELifecycleEvents.PEER_CONNECTION_ESTABLISHED}),this._connectionState===_.EPeerConnectionState.ONLINE&&[_.EPeerConnectionState.DISCONNECTING,_.EPeerConnectionState.FAILED].includes(e)&&this._eventBus.publish(c.ELifecycleEvent.LIFECYCLE_ERROR,{errorType:c.ELifecycleErrors.PEER_CONNECTION_ERROR,nativeError:new Error(null===(t=this._connection)||void 0===t?void 0:t.connectionState)}),this._eventBus.publish(m.EPeerConnectionEvents.CONNECTION_STATE_CHANGED,{prevState:this._connectionState,nextState:e}),this._logger.info("PeerConnection state changed: ".concat(this._connectionState," -> ").concat(e)),this._connectionState=e)}_onConnectionStateChanged(){if(this._connection&&this._peerConnectionState!==this._connection.connectionState){var e=this._connection.connectionState;this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.PEER_CONNECTION_STATE_CHANGED,description:"Peer connection state changed to ".concat(this._connection.connectionState),details:{prevState:this._connectionState,nextState:e}}),this._logger.info("Peer native connection state changed: ".concat(this._peerConnectionState," -> ").concat(e)),this._peerConnectionState=e,this._setConnectionState((0,y.nativeStateToConnectionStateMapper)(this._peerConnectionState))}}_onIceConnectionStateChanged(){if(this._connection&&this._connection.iceConnectionState!==this._iceConnectionState){if(["connected","completed"].includes(this._connection.iceConnectionState)){var e=this._connection.getSenders().find(e=>{var t;return"video"===(null===(t=e.track)||void 0===t?void 0:t.kind)});if(e){var t,r=null===(t=e.getParameters().codecs[0])||void 0===t?void 0:t.mimeType;r&&this._latencyController.setVideoCodecs(r)}}var n=this._connection.iceConnectionState;this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.PEER_ICE_CONNECTION_STATE_CHANGED,description:"Peer ICE connection state changed to ".concat(this._connection.iceConnectionState),details:{prevState:this._connection.iceConnectionState,nextState:n}}),this._logger.info("ICE connection state changed: ".concat(this._iceConnectionState," -> ").concat(this._connection.iceConnectionState)),this._iceConnectionState=n}}_onNegotiationNeeded(){var e=this;return s(function*(){if(e._connection)if(e._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.PEER_CONNECTION_NEGOTIATION_REQUIRED,description:"Peer connection requested a negotiation",details:{awaitForIceGatheringBeforeSignalling:e.config.awaitForIceGatheringBeforeSignalling,isGatheringFinished:e._isGatheringFinished}}),e._logger.debug("Peer connection required negotiation"),!e.config.awaitForIceGatheringBeforeSignalling||e._isGatheringFinished){e.status="Awaiting SDP offer";var t=yield e._connection.createOffer(e._offerConfig);e._eventBus.publish(m.EPeerConnectionEvents.NEGOTIATION_REQUIRED,{sdp:t})}else e.status="Awaiting ICE gathering"})()}_onTrackAdded(e){var{track:t,receiver:r}=e;this._logger.debug("Track added with kind ".concat(t.kind)),h.hasInsertableStreamsSupport&&this._shouldEnableInsertableStreams&&("video"===t.kind?this._latencyController.transformVideoReceiver(r):this._latencyController.transformAudioReceiver(r)),this.mediaStream||(this._logger.info("Media stream is available now"),this.mediaStream=new MediaStream,this._eventBus.publish(m.EPeerConnectionEvents.STREAM_AVAILABLE,{stream:this.mediaStream})),this.mediaStream.addTrack(t),this._updatePlayoutDelayHint()}_onIceCandidateError(e){this._logger.warn("Ice candidate reported an error: ".concat(e.errorText)),this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.PEER_ICE_CANDIDATE_ERROR_REPORTED,description:"ICE candidate reported an error",details:{error:e.errorText}}),this._eventBus.publish(c.ELifecycleEvent.LIFECYCLE_ERROR,{errorType:c.ELifecycleErrors.PEER_ESTABLISH_ERROR,nativeError:new Error(e.errorText)}),this._eventBus.publish(S.ECommonEvent.COMMON_ERROR,{error:new T.RistrettoPlayerError(T.EErrorDomain.PEER_CONNECTION,T.EErrorType.COULD_NOT_CONNECT_PEER,!1,"Connection to ".concat(e.url," could not be established: ").concat(e.errorText," [").concat(e.errorCode,"]"))})}_onIceCandidate(e){this._eventBus.publish(b.EBroadcastLogsEvents.REPORT_EVENT,{event:E.EBroadcastLogsEvent.PEER_ICE_CANDIDATE_REPORTED,description:"New ICE candidate reported",details:{candidate:e.candidate}}),this._logger.debug("New ICE Candidate: ",{candidate:e.candidate})}_onIceGatheringStateChanged(){var e;this._logger.debug("ICE gathering state changed, new state is ".concat(null===(e=this._connection)||void 0===e?void 0:e.iceGatheringState)),!this._isGatheringFinished&&this.config.awaitForIceGatheringBeforeSignalling&&this._connection&&"complete"===this._connection.iceGatheringState&&(this._isGatheringFinished=!0,this.status="Awaiting SDP offer",this._onNegotiationNeeded())}_getReceivers(){return this._connection?this._connection.getReceivers():[]}_updatePlayoutDelayHint(){var{playoutDelayHint:e}=this.config;e&&this._getReceivers().forEach(t=>{t.playoutDelayHint=e})}get additionalInfo(){return this._connection?{metrics:this._connection.getStats()}:{}}}t.PeerConnection=C,n([g.default],C.prototype,"_handleRequireRawStats",null),n([g.default],C.prototype,"_getStats",null),n([g.default],C.prototype,"_setConnectionState",null),n([g.default],C.prototype,"_onConnectionStateChanged",null),n([g.default],C.prototype,"_onIceConnectionStateChanged",null),n([g.default],C.prototype,"_onNegotiationNeeded",null),n([g.default],C.prototype,"_onTrackAdded",null),n([g.default],C.prototype,"_onIceCandidateError",null),n([g.default],C.prototype,"_onIceCandidate",null),n([g.default],C.prototype,"_onIceGatheringStateChanged",null)},5458:(e,t)=>{var r,n,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.ECommonEvent=t.EPlaybackStartType=t.EPlaybackState=t.EPlayerType=void 0,function(e){e.HLS="hls",e.WEBRTC="webrtc",e.NATIVE="native",e.BROADCAST="broadcast",e.UNKNOWN="unknown"}(r||(t.EPlayerType=r={})),function(e){e.IDLE="idle",e.LOADING="loading",e.PAUSED="paused",e.PLAYING="playing",e.ERROR="error"}(n||(t.EPlaybackState=n={})),function(e){e.WAITING="waiting",e.AUTO="auto",e.MANUAL="manual"}(i||(t.EPlaybackStartType=i={})),function(e){e.BROADCAST_STATE_CHANGED="commonEvents.broadcastStateChanged",e.BROADCAST_REMOTE_STATS_AVAILABLE="commonEvents.broadcastRemoteStatsAvailable",e.PLAYING_STATE_CHANGED="commonEvents.playingStateChanged",e.COMMON_ERROR="commonEvents.commonError"}(o||(t.ECommonEvent=o={}))},5488:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(7880),i=/^\s+/,o=function(e){return e?e.slice(0,(0,n.A)(e)+1).replace(i,""):e}},5490:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFieldSpecificEventName=t.EventBus=t.ConfigProviderEvents=void 0;var n=r(83);t.ConfigProviderEvents={configUpdated:"configProvider.configUpdated"},t.EventBus=new n.EventBus,t.getFieldSpecificEventName=e=>"".concat(t.ConfigProviderEvents.configUpdated,".").concat(e)},5515:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FakeVideoTrack=void 0;var n=r(4780);t.FakeVideoTrack=class{constructor(){a(this,"_canvasDomElement",null),a(this,"_canvasStream",null),a(this,"_drawIntervalId",null)}get fakeTrack(){var e;return this._canvasStream||this._initFakeStream(),this._statPlaying(),null===(e=this._canvasStream)||void 0===e?void 0:e.getVideoTracks()[0]}stopFakeStream(){var e;this._canvasStream&&(null!==this._drawIntervalId&&(clearInterval(this._drawIntervalId),this._drawIntervalId=null),(0,n.stopStream)(this._canvasStream),this._canvasStream=null,(null===(e=this._canvasDomElement)||void 0===e?void 0:e.parentElement)&&(this._canvasDomElement.remove(),this._canvasDomElement=null))}_statPlaying(){if(this._canvasDomElement){var e=this._canvasDomElement.getContext("2d");e&&(this._drawIntervalId=setInterval(()=>{var t;e.fillStyle="rgb(".concat(255*Math.random(),",0,0)"),null==e||e.fillRect(0,0,1,1),(null===(t=this._canvasStream)||void 0===t?void 0:t.getVideoTracks()[0]).requestFrame()},1e3/30))}}_initFakeStream(){this._canvasStream&&this.stopFakeStream(),this._canvasDomElement=document.createElement("canvas"),this._canvasDomElement.width=240,this._canvasDomElement.height=240,this._canvasStream=this._canvasDomElement.captureStream(29)}}},5544:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RISTRETTO_VERSION=t.availableConfigValues=t.defaultConfig=t.ECommonEvents=t.EBroadcasterEvent=t.Broadcaster=t.logLevels=t.EPlayerEvent=t.Player=t.EStreamStatus=t.EBroadcastStatus=void 0;var n=r(6126);Object.defineProperty(t,"EBroadcastStatus",{enumerable:!0,get:function(){return n.EBroadcastStatus}});var i=r(6882);Object.defineProperty(t,"EStreamStatus",{enumerable:!0,get:function(){return i.EStreamStatus}});var o=r(131);Object.defineProperty(t,"Player",{enumerable:!0,get:function(){return o.Player}}),Object.defineProperty(t,"EPlayerEvent",{enumerable:!0,get:function(){return o.EPlayerEvent}});var s=r(6805);Object.defineProperty(t,"logLevels",{enumerable:!0,get:function(){return s.logLevels}});var a=r(4612);Object.defineProperty(t,"Broadcaster",{enumerable:!0,get:function(){return a.Broadcaster}}),Object.defineProperty(t,"EBroadcasterEvent",{enumerable:!0,get:function(){return a.EBroadcasterEvent}});var l=r(7813);Object.defineProperty(t,"ECommonEvents",{enumerable:!0,get:function(){return l.ECommonEvents}});var u=r(5984);Object.defineProperty(t,"defaultConfig",{enumerable:!0,get:function(){return u.defaultConfig}}),Object.defineProperty(t,"availableConfigValues",{enumerable:!0,get:function(){return u.availableConfigValues}});var c=r(7647);Object.defineProperty(t,"RISTRETTO_VERSION",{enumerable:!0,get:function(){return c.RISTRETTO_VERSION}})},5560:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentsFilter=void 0;var o=r(8169),s=r(3229),l=r(2683),u=r(8083),c=r(8474),d=i(r(6073)),h=r(3613);class f extends o.ConfigConsumer{constructor(e){super("fragmentsFilter",e),a(this,"_logger",void 0),a(this,"_onFragmentReleasedListenerToken",void 0),a(this,"_lastKnownInitSectionNumberOfTracks",null),this._logger=(0,c.Logger)(e,"Doppio - FragmentsFilter"),this._logger=(0,c.Logger)(this._eventBus,"Doppio - FragmentsFilter"),this._onFragmentReleasedListenerToken=this._eventBus.subscribe(u.FragmentsQueueEvents.fragmentsReleased,this._onFragmentReleasedFromQueue)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onFragmentReleasedListenerToken)}_onFragmentReleasedFromQueue(e){var t=[];for(var r of e)if(r.isInitSection)this._parseInitSection(r),t.push(r);else{var n=this._parseMediaFragment(r);this.config.filterOutInconsistentTracks&&!n||t.push(r)}this._eventBus.publish(s.FragmentsFilterEvents.fragmentsReleased,t)}_parseInitSection(e){this._logger.debug("Parsing init section");var t=(0,l.findBoxesInArrayBuffer)(e.data),r=t.find(e=>{var{name:t}=e;return"moov"===t})||null;if(this._logger.verbose("Found following root boxes: ".concat(t.map(e=>{var{name:t}=e;return t}).join(", "))),r){var n=(0,l.findBoxesInArrayBuffer)(r.payload);this._logger.verbose("Found following child of moov boxes: ".concat(n.map(e=>{var{name:t}=e;return t}).join(", ")));var i=n.filter(e=>{var{name:t}=e;return"trak"===t});this._logger.info("Found ".concat(i.length," trak boxes")),this._lastKnownInitSectionNumberOfTracks=i.length}}_parseMediaFragment(e){if(null===this._lastKnownInitSectionNumberOfTracks)return!0;var t=(0,l.findBoxesInArrayBuffer)(e.data),r=t.filter(e=>{var{name:t}=e;return"sidx"===t});this._logger.verbose("Found following root boxes: ".concat(t.map(e=>{var{name:t}=e;return t}).join(", ")));var n=t.filter(e=>{var{name:t}=e;return"moof"===t}),i=[],o=!1;for(var a of(r.length>0&&r.length%this._lastKnownInitSectionNumberOfTracks!==0&&(this._logger.warn("Inconsistent media chunk: number of SIDX boxes is invalid, ".concat(r.length," found, ").concat(this._lastKnownInitSectionNumberOfTracks," expected")),i.push("Number of SIDX boxes (".concat(r.length,") is not equal to the known amount of media tracks (").concat(this._lastKnownInitSectionNumberOfTracks,")")),o=!0),n)){var u=(0,l.findBoxesInArrayBuffer)(a.payload),c=u.filter(e=>{var{name:t}=e;return"traf"===t});this._logger.verbose("Found following child of moof boxes: ".concat(u.map(e=>{var{name:t}=e;return t}).join(", "))),c.length!==this._lastKnownInitSectionNumberOfTracks&&(this._logger.warn("Inconsistent media chunk: number of TRAF boxes is invalid, ".concat(c.length," found, ").concat(this._lastKnownInitSectionNumberOfTracks," expected")),i.push("Number of TRAF boxes (".concat(c.length,") is not equal to the known amount of media tracks (").concat(this._lastKnownInitSectionNumberOfTracks,")")),o=!0)}return o&&(this._logger.warn("Fragment ".concat(e.getMsnPn()," should be reported")),this._eventBus.publish(s.FragmentsFilterEvents.problemDetected,{fragment:e.url.split("/").slice(-1)[0],reason:i.join("; ")}),this._eventBus.publish(h.FragmentsBufferEvents.saveData,{})),o}}t.FragmentsFilter=f,n([d.default],f.prototype,"_onFragmentReleasedFromQueue",null)},5720:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.m3u8Hydrator=void 0;var r=(e,t)=>e.reduce((e,t)=>(t.startTs=e.prevStart,t.endTs=t.startTs+t.duration,e.prevStart=t.endTs,e.parts.push(t),e),{parts:[],prevStart:t}).parts;t.m3u8Hydrator=function(e){var t,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=e.mediaSequence,a=e.segments.map((e,t)=>i(i({},e),{},{uri:e.uri,msnNumber:s+t,partNumber:0,parts:((null==e?void 0:e.parts)||[]).map((e,r)=>i(i({},e),{},{msnNumber:s+t,partNumber:r}))})).map(e=>(e.parts=e.dateTimeObject?r(e.parts,e.dateTimeObject.getTime()/1e3):e.parts,e)),l=s+a.length,u=((null===(t=e.preloadSegment)||void 0===t?void 0:t.parts)||[]).map((e,t)=>i(i({},e),{},{msnNumber:l,partNumber:t})),c=((null===(n=e.preloadSegment)||void 0===n?void 0:n.preloadHints)||[]).map((e,t)=>i(i({},e),{},{msnNumber:l,partNumber:t+u.length})),d=a.slice(-1)[0],h=i(i({},e.preloadSegment),{},{parts:e.preloadSegment&&d.dateTimeObject?r(u,d.dateTimeObject.getTime()/1e3+d.duration):u,preloadHints:c,msnNumber:l,partNumber:0}),f=i(i({},e),{},{segments:a,preloadSegment:h});return void 0!==o.partHoldBack&&(f.partHoldBack=o.partHoldBack),f}},5726:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkError=t.EError=void 0,function(e){e.SAME_PLAYLIST_LOADED_MORE_TIMES="Same playlist was loaded more than expected times. Looks lise server is malfunctioning"}(r||(t.EError=r={}));class n extends Error{constructor(e,t,r){super(e),a(this,"statusCode",void 0),a(this,"statusText",void 0),this.name="DoppioNetworkError",this.statusCode=t,this.statusText=r}}t.NetworkError=n},5732:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.formatUUID=void 0;var r=[4,2,2,2,6];t.formatUUID=e=>r.reduce((t,r)=>{var n=[...e.slice(t.offset,t.offset+r)].map(e=>e.toString(16).padStart(2,"0")).join("");return{result:t.result.concat(n),offset:t.offset+r}},{offset:0,result:[]}).result.join("-")},5736:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentsBuffer=void 0;var o=r(8169),s=r(2683),l=r(8083),u=r(8474),c=i(r(6073)),d=r(3613);class h extends o.ConfigConsumer{constructor(e){super("fragmentBuffer",e),a(this,"_logger",void 0),a(this,"_onFragmentReleasedListenerToken",void 0),a(this,"_onSaveDataRequestedListenerToken",void 0),a(this,"_initSectionCache",null),a(this,"_expectedUnitedChunkName",""),a(this,"_fragmentsCache",[]),this._logger=(0,u.Logger)(this._eventBus,"Doppio - FragmentsBuffer"),this._onFragmentReleasedListenerToken=this._eventBus.subscribe(l.FragmentsQueueEvents.fragmentsReleased,this._onFragmentReleasedFromQueue),this._onSaveDataRequestedListenerToken=this._eventBus.subscribe(d.FragmentsBufferEvents.saveData,this.sendUnitedChunk)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onFragmentReleasedListenerToken),this._eventBus.unsubscribe(this._onSaveDataRequestedListenerToken),this._initSectionCache=null,this._fragmentsCache=[]}sendUnitedChunk(){if(this._initSectionCache&&!(Math.random()>this.config.saveProbability))try{var t=(0,s.combineArrayBuffers)([this._initSectionCache.data].concat(...this._fragmentsCache.map(e=>{var{data:t}=e;return t}))),r=new Headers;r.append("Content-Type","video/mp4"),fetch("https://".concat(this.config.baseChunksSaverUrl,"/").concat(this._expectedUnitedChunkName),{method:"PUT",headers:r,body:t,redirect:"follow"}).catch(e=>{this._logger.warn("Could not save problem chunks: ".concat(e))})}catch(e){this._logger.warn("Could not save problem chunks: ".concat(e))}}_onFragmentReleasedFromQueue(e){var t=this;try{var r,n=function(){if(i.isInitSection)return{v:(t._initSectionCache=i,t._expectedUnitedChunkName=i.url.split("/").slice(-1)[0],void(t._fragmentsCache=[]))};t._fragmentsCache.push(i);var r=Math.max(...e.map(e=>{var{msn:t}=e;return t})),n=Math.max(0,r-t.config.numberOfFragmentsToKeepInBuffer+1);t._fragmentsCache=t._fragmentsCache.filter(e=>{var{msn:t}=e;return t>=n})};for(var i of e)if(r=n())return r.v}catch(e){this._logger.warn("Could not handle fragment"),this._fragmentsCache=[],this._initSectionCache=null}}}t.FragmentsBuffer=h,n([c.default],h.prototype,"sendUnitedChunk",null),n([c.default],h.prototype,"_onFragmentReleasedFromQueue",null)},5740:(e,t)=>{var r,n;Object.defineProperty(t,"__esModule",{value:!0}),t.RistrettoPlayerError=t.EErrorType=t.EErrorDomain=void 0,function(e){e.METADATA_TRANSPORT="metadataTransport",e.METADATA_UNDERLYING_CONNECTION="metadataUnderlyingConnection",e.PEER_CONNECTION="peerConnection",e.DISPATCHER="dispatcher",e.COMMON="common"}(r||(t.EErrorDomain=r={})),function(e){e.COULD_NOT_CONNECT_TO_METADATA_TRANSPORT="Could not connect to metadata transport",e.COULD_NOT_CONNECT_PEER="Could not connect to peer",e.STREAM_NOT_FOUND="Stream unavailable",e.COULD_NOT_PUBLISH="Could not publish",e.COMMON="common"}(n||(t.EErrorType=n={}));class i extends Error{constructor(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0;super(t),a(this,"domain",void 0),a(this,"info",void 0),a(this,"isFatal",void 0),this.domain=e,this.info=n,this.isFatal=r}}t.RistrettoPlayerError=i},5746:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LLNewPlaylistRotationController=void 0;var o=r(355),s=r(2086),l=r(363),u=r(835),c=r(164),d=r(2513),h=r(4547),f=r(7833),p=r(6304),v=r(450),g=r(180),_=r(9088),m=i(r(6073)),y=r(1743);class b extends c.BasePlaylistRotationController{constructor(e,t,r){var{url:n,startManifest:i,initialMSN:s,initialPN:l,lastLoadedFragment:u}=t;super("LLPlaylistRotationController","playlistLoader",r,e),a(this,"state",g.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"groups",["loader"]),a(this,"_playlistLoaderTimeout",null),a(this,"_nextMSN",-1),a(this,"_nextPN",-1),a(this,"_partHoldBack",-1),a(this,"_lastLoadedFragment",null),a(this,"_awaitingFragmentURL",null),a(this,"_hasLoadedInitialAmount",!1),a(this,"_onSegmentLoadedListener",void 0),a(this,"_onSegmentFailedListener",void 0),a(this,"_onSegmentAbortedListener",void 0),a(this,"_onFragmentAddedListener",void 0),this._lifecycleEventReporter("Created"),this._url=n,this._lastLoadedFragment=u,i?this._handleParsedPlaylist(i):(this._nextMSN=Number.isFinite(s)?s:-1,this._nextPN=Number.isFinite(l)?l:-1,this._loadNextPlaylist()),this._onSegmentLoadedListener=this._eventBus.subscribe(f.FragmentLoaderEvents.fragments.fragmentLoaded,this._onFragmentFinished),this._onSegmentFailedListener=this._eventBus.subscribe(f.FragmentLoaderEvents.fragments.fragmentLoadingError,this._onFragmentFinished),this._onSegmentAbortedListener=this._eventBus.subscribe(f.FragmentLoaderEvents.fragments.fragmentLoadingAborted,this._onFragmentFinished),this._onFragmentAddedListener=this._eventBus.subscribe(o.BufferControllerEvents.fragmentAdded,this._onFragmentAdded),this.config.targetBufferMultiplier&&this.config.targetBufferMultiplier<1&&this._logger.warn("Target buffer multiplier set to value lower than 1. It is unsafe to load less than target-duration, forcing no multiplier instead")}destroy(){var e;this._isActive=!1,super.destroy(),null!==(e=this._currentPlaylistLoader)&&void 0!==e&&e.destroy(),this._currentPlaylistLoader=null,this._logger.info("Destroy controller"),this._eventBus.unsubscribe(this._onSegmentLoadedListener),this._eventBus.unsubscribe(this._onSegmentAbortedListener),this._eventBus.unsubscribe(this._onSegmentFailedListener),this._eventBus.unsubscribe(this._onFragmentAddedListener),this._lifecycleEventReporter("Destroyed")}abortCurrentPlaylistLoading(){this._logger.info("Aborting current loading playlist")}setURL(e,t){var r;t?this._url=e:(this._logger.info("Setting new url ".concat(e)),null!==(r=this._currentPlaylistLoader)&&void 0!==r&&r.destroy(),this._url=e,this._nextPN=-1,this._nextMSN=-1,this._loadNextPlaylist())}_handleConfigUpdated(e){if(e.equalPlaylistsAmountToDecline&&(this._samePlaylistsCount=0),!1===e.lowLatencyMode){var t,r=this._parsePlaylist({data:this._lastPlaylistContent,isCorruptRequested:!(null===(t=this._currentPlaylistLoader)||void 0===t||!t.queryParams.has(p.PlaylistDecryptHandler.SCHEME_QUERY_PARAMETER_NAME))});r?this._handleSimplePlaylistDetected(r):this._eventBus.publish(u.ResolutionsManagerEvents.requestRestartFromMain,{})}}_loadNextPlaylist(){var e;if(this._isActive){var{playlistLoadingTimeout:t}=this.config;this._logger.debug("Loading next playlist"),this._lifecycleEventReporter("Loading next playlist with url ".concat(this._url)),this.status="Loading playlist",this._currentPlaylistLoader&&this._currentPlaylistLoader.cancel("Another playlist with url ".concat(this._url," scheduled to load"));var r=this._buildUrl();this._currentPlaylistLoader=new v.NetworkLoader({url:r,loadingTimeout:t,autoLoad:!0,mode:"text",onStateChanged:this._onPlaylistLoadingStateChanged,workerMode:this.config.workerMode,requestCustomReferer:this.config.sendCustomRefererHeader?null===(e=(0,y.getGlobalThis)().location)||void 0===e?void 0:e.href:void 0},this._eventBus),this._eventBus.publish(d.BasePlaylistRotationControllerEvents.playlists.playlistRequested,{})}else this._logger.warn("Loader was destroying, but we trying to load next playlist!")}_handleParsedPlaylist(e){var t,r,n,i,o,a,u;this._lifecycleEventReporter("Playlist parsed");var c=Math.max(this.config.targetBufferMultiplier,1);if(this._partHoldBack=(0,_.getPartHoldback)(e,e.targetDuration||2)*c,this._isMultiVariantPlaylist(e))this._handleMultivariantManifestDetected(e);else if(this._isSimplePlaylist(e))this._handleSimplePlaylistDetected(e);else if(this._isVODPlaylist(e))this._handleVODPlaylist(e);else{var f=0===(e.preloadSegment.parts||[]).length,p=e.segments.flatMap((t,r)=>{var n=[];return r&&t.map.uri===e.segments[r-1].map.uri||n.push(new s.Fragment({url:t.map.uri,independent:l.EIndependenceType.INDEPENDENT,msn:t.msnNumber,pn:-1,duration:0,isTransmuxingBypassRequested:!0,isInitSection:!0,startTs:t.dateTimeObject.getTime(),endTs:t.dateTimeObject.getTime()},this._eventBus,this.config.shouldLogFragmentsHistory)),n.push(...t.parts.map(t=>{var r,{uri:n,independent:i,partNumber:o,startTs:a,endTs:u,msnNumber:c,duration:d}=t;return new s.Fragment({url:n,independent:i?l.EIndependenceType.INDEPENDENT:l.EIndependenceType.PART,msn:c,pn:o,duration:d,isTransmuxingBypassRequested:!(null===(r=e.segments[0].map)||void 0===r||!r.uri),startTs:a,endTs:u},this._eventBus,this.config.shouldLogFragmentsHistory)})),n}).concat(null!==(t=e.preloadSegment)&&void 0!==t&&t.map&&e.preloadSegment.map.uri!==e.segments.slice(-1)[0].map.uri?[new s.Fragment({url:e.preloadSegment.map.uri,duration:0,independent:l.EIndependenceType.UNKNOWN,msn:e.preloadSegment.msnNumber,pn:-1,isTransmuxingBypassRequested:!0,isInitSection:!0},this._eventBus,this.config.shouldLogFragmentsHistory)]:[]).concat((e.preloadSegment.parts||[]).map(t=>{var r,{uri:n,independent:i=!1,msnNumber:o,partNumber:a,startTs:u,endTs:c,duration:d}=t;return new s.Fragment({url:n,independent:i?l.EIndependenceType.INDEPENDENT:l.EIndependenceType.PART,msn:o,pn:a,duration:d,isTransmuxingBypassRequested:!(null===(r=e.segments[0].map)||void 0===r||!r.uri),startTs:u,endTs:c},this._eventBus,this.config.shouldLogFragmentsHistory)})).filter(e=>{var{msn:t,pn:r}=e;return-1===r||!this._hasLoadedInitialAmount||t>this._nextMSN||t===this._nextMSN&&r>=this._nextPN}),v=p.reverse(),g=v.reduce((e,t)=>(e.currentDuration<this._partHoldBack&&(e.currentIndex+=1,e.currentDuration+=t.duration),e),{currentDuration:0,currentIndex:-1}).currentIndex,m=this._lastLoadedFragment?v.findIndex(e=>{var t;return(e.startTs||0)<((null===(t=this._lastLoadedFragment)||void 0===t?void 0:t.endTs)||0)}):-1,y=Math.min(v.length,Math.max(g,m)+this.config.additionalStartParts);this._logger.debug("Minimal part ".concat(null===(r=v[y])||void 0===r?void 0:r.msn,":").concat(null===(n=v[y])||void 0===n?void 0:n.pn,"(").concat(new Date((null===(i=v[y])||void 0===i?void 0:i.startTs)||0),")"));var b=v.findIndex((e,t)=>{var{independent:r}=e;return t>=y&&r===l.EIndependenceType.INDEPENDENT});-1===b&&(b=v.length-1),this._logger.debug("Part to start load from: ".concat(null===(o=v[b])||void 0===o?void 0:o.msn,":").concat(null===(a=v[b])||void 0===a?void 0:a.pn));var E=b>-1?v.filter((e,t)=>-1===e.pn||t<=b).reverse():p;this.config.blockingMode===h.EBlockingMode.WAIT_FOR_PREFETCH_SEGMENT&&Array.isArray(e.preloadSegment.preloadHints)&&e.preloadSegment.preloadHints.length&&(this._awaitingFragmentURL=(null===(u=e.preloadSegment.preloadHints[0])||void 0===u?void 0:u.uri)||null,E.push(...e.preloadSegment.preloadHints.map(t=>{var r,{uri:n,msnNumber:i,partNumber:o}=t;return new s.Fragment({url:n,independent:l.EIndependenceType.UNKNOWN,msn:i,pn:o,duration:0,isTransmuxingBypassRequested:!(null===(r=e.segments[0].map)||void 0===r||!r.uri)},this._eventBus,this.config.shouldLogFragmentsHistory)}))),this._handleFragmentsDetected(E),this._hasLoadedInitialAmount=!0,this._nextMSN=e.mediaSequence+e.segments.length,this._nextPN=(e.preloadSegment.parts||[]).length,this.additionalInfo.msn=this._nextMSN,this.additionalInfo.pn=this._nextPN,this.status="Awaiting fragment to load next playlist",f&&this._eventBus.publish(d.BasePlaylistRotationControllerEvents.playlists.lastPlaylistOfSegmentLoaded,{}),this.config.blockingMode!==h.EBlockingMode.WAIT_FOR_PLAYLIST||this._loadNextPlaylist()}}_planNextLoad(){this._playlistLoaderTimeout=(0,y.getGlobalThis)().setTimeout(()=>{this._loadNextPlaylist()},this.config.retryLowLatencyPlaylistTimeout)}_buildUrl(){var e=new URL(this._url||""),t=new URLSearchParams([...e.searchParams,...this._playlistDecryptHandler.corruptionQueryParams]);return-1!==this._nextPN&&-1!==this._nextMSN&&(t.set("_HLS_msn","".concat(this._nextMSN)),t.set("_HLS_part","".concat(this._nextPN))),e.search=t.toString(),e}_onFragmentFinished(e){this._logger.debug("".concat(e.startTs," -> ").concat(e.endTs," loaded (").concat(e.getMsnPn(),")")),this.config.blockingMode===h.EBlockingMode.WAIT_FOR_PREFETCH_SEGMENT&&this._awaitingFragmentURL===e.url&&(this._logger.debug("Prefetch segment is ready now, loading next playlist"),this._loadNextPlaylist())}_onFragmentAdded(e){this._lastLoadedFragment=e}}t.LLNewPlaylistRotationController=b,n([m.default],b.prototype,"_handleConfigUpdated",null),n([m.default],b.prototype,"_onFragmentFinished",null),n([m.default],b.prototype,"_onFragmentAdded",null)},5803:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbrController=void 0;var s=r(6805),l=r(1675),u=r(9476),c=r(3273),d=r(917),h=r(942),f=r(6882),p=o(r(5354)),v=r(1222),g=r(1192),_=r(4181),m=r(1388),y=r(9622),b=r(496);class E extends y.BaseABRController{constructor(e){super(e),a(this,"_requireStatsInterval",null),a(this,"_lockTimerInterval",null),a(this,"_peerConnectionStatsAvailableListener",void 0),a(this,"_updateQualityPresetsListener",void 0),a(this,"_playingStateChangeListener",void 0),a(this,"_websocketMessageSentListener",void 0),a(this,"_prevPrevStats",void 0),a(this,"_qualityPresets",[]),a(this,"_currentQualityPreset",null),a(this,"_rulesController",null),a(this,"_isLocked",!1),a(this,"_isAbrEnabled",!1),a(this,"_isStreamLive",!1),a(this,"_logger",void 0),this._logger=(0,s.Logger)(this._eventBus,"Ristretto - AbrController"),this._peerConnectionStatsAvailableListener=this._eventBus.subscribe(h.EPeerConnectionEvents.RAW_STATS_AVAILABLE,this._handlePeerConnectionStatsAvailable),this._updateQualityPresetsListener=this._eventBus.subscribe(g.EAbrControllerEvents.PRESETS_VARIANTS_AVAILABLE,this.updateQualityPresets),this._playingStateChangeListener=this._eventBus.subscribe(v.ECommonEvent.PLAYING_STATE_CHANGED,this._handlePlayingStateChange),this._websocketMessageSentListener=this._eventBus.subscribe(d.EWebsocketTransportEvents.MESSAGE_SENT,this._handleWebsocketMessageSent),this.config.qualityPresets&&this.updateQualityPresets({presets:this.config.qualityPresets}),this.config.abrOnClient&&(this._rulesController=new b.AbrRulesController(this._eventBus)),this._logger.info("Created")}toggleAbrStatus(e){this._logger.info("ABR status changed: ".concat(this._isAbrEnabled," -> ").concat(e)),this._isAbrEnabled=e}updateQualityPresets(e){var{presets:t}=e;this._logger.verbose("New presets passed to the controller: ",t),Array.isArray(t)?this._qualityPresets=t:this._qualityPresets=Object.values(t).reduce((e,t)=>t?[...e,i(i({},t),{},{priority:+t.priority})]:e,[])}updateCurrentPreset(e){var t,r;null===(t=this._rulesController)||void 0===t||t.reset();var n=null===(r=this._qualityPresets)||void 0===r?void 0:r.find(t=>(0,_.getPresetQuality)(t)===e);this._logger.info("ABR quality preset has been changed from ".concat((0,_.getPresetQuality)(this._currentQualityPreset)," to ").concat((0,_.getPresetQuality)(n))),n&&(this._currentQualityPreset=n)}destroy(){var e;this._eventBus.unsubscribe(this._peerConnectionStatsAvailableListener),this._eventBus.unsubscribe(this._updateQualityPresetsListener),this._eventBus.unsubscribe(this._playingStateChangeListener),this._eventBus.unsubscribe(this._websocketMessageSentListener),this._requireStatsInterval&&globalThis.clearInterval(this._requireStatsInterval),super.destroy(),null!==(e=this._rulesController)&&void 0!==e&&e.destroy(),this._rulesController=null,this._currentQualityPreset=null,this._logger.info("Destroyed")}_handlePeerConnectionStatsAvailable(e){var t;this._logger.verbose("Peer connection stats received");var r=(0,m.extractPeerStatsForAbr)(e.stats,this._prevPrevStats);this._prevPrevStats=r,null!==(t=this._rulesController)&&void 0!==t&&t.handleStats(r),this._checkRules()}_handleConfigUpdated(e){this._updateRequireStatsInterval(),e.abrOnClient&&!this._rulesController&&(this._rulesController=new b.AbrRulesController(this._eventBus)),!1===e.abrOnClient&&this._rulesController&&(this._rulesController.destroy(),this._rulesController=null),e.qualityPresets&&this.updateQualityPresets({presets:e.qualityPresets})}_handlePlayingStateChange(e){var{nextState:t,prevState:r}=e;this._logger.info("Playing state changed: ".concat(r," -> ").concat(t)),this._isStreamLive=t===f.EStreamStatus.LIVE,this._updateRequireStatsInterval()}_updateRequireStatsInterval(){this._requireStatsInterval&&globalThis.clearInterval(this._requireStatsInterval),this._isStreamLive&&this.config.abrOnClient&&this.config.checkingInterval&&(this._requireStatsInterval=globalThis.setInterval(()=>{this._eventBus.publish(h.EPeerConnectionEvents.RAW_STATS_REQUIRED,{})},this.config.checkingInterval))}_setLock(e){this._logger.debug("Lock status updated: ".concat(this._isLocked," -> ").concat(e)),this._lockTimerInterval&&clearTimeout(this._lockTimerInterval),this._isLocked=e,e&&(this._lockTimerInterval=globalThis.setTimeout(()=>{this._setLock(!1)},this.config.lockInterval))}_checkRules(){var e,t,r,n;if(this._isAbrEnabled&&this._rulesController&&!this._isLocked){this._logger.verbose("_checkRules; ABR is checking stream stats and maybe will decide to change the quality",{isStreamLive:this._isStreamLive});var i=(null===(e=this._rulesController)||void 0===e?void 0:e.getResult()).value,o=+("number"==typeof(null===(t=this._currentQualityPreset)||void 0===t?void 0:t.priority)?this._currentQualityPreset.priority:-1)+i,s=null===(r=this._qualityPresets)||void 0===r?void 0:r.find(e=>+e.priority===o),a=(0,_.getPresetQuality)(s);s&&a&&s!==this._currentQualityPreset&&(this._logger.debug("abr will change quality",{prevQuality:null===(n=this._currentQualityPreset)||void 0===n?void 0:n.presetQuality,nextQuality:a}),this._setLock(!0),this.updateCurrentPreset(a),this._setNewQuality(a))}}_setNewQuality(e){this._logger.debug("Quality change requested to ".concat(e)),this._eventBus.publish(u.EMetadataTransportEvents.SET_QUALITY,{quality:e}),this._currentQualityPreset&&this._eventBus.publish(l.ELifecycleEvent.RESOLUTION_SWITCH_AUTO,{prevResolution:this._currentQualityPreset.name,nextResolution:e})}_handleWebsocketMessageSent(e){var t;e.message===c.EOutgoingMessage.PLAY_STREAM&&(null===(t=e.data[0])||void 0===t?void 0:t.quality)&&this.updateCurrentPreset(e.data[0].quality.toString())}}t.AbrController=E,n([p.default],E.prototype,"updateQualityPresets",null),n([p.default],E.prototype,"updateCurrentPreset",null),n([p.default],E.prototype,"destroy",null),n([p.default],E.prototype,"_handlePeerConnectionStatsAvailable",null),n([p.default],E.prototype,"_handlePlayingStateChange",null),n([p.default],E.prototype,"_updateRequireStatsInterval",null),n([p.default],E.prototype,"_setLock",null),n([p.default],E.prototype,"_checkRules",null),n([p.default],E.prototype,"_setNewQuality",null),n([p.default],E.prototype,"_handleWebsocketMessageSent",null)},5810:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MMP_VERSION=void 0,t.MMP_VERSION="v2.1.0"},5821:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectDeepDiff=void 0;var n=r(9234);t.ObjectDeepDiff=(e,r)=>{if(e===r)return{};if(!(0,n.isObject)(e)||!(0,n.isObject)(r)||(0,n.isHTMLElement)(e)||(0,n.isHTMLElement)(r))return r;var i=e,o=r,s=Object.keys(i).reduce((e,t)=>((0,n.hasOwnProperty)(o,t)||(e[t]=void 0),e),{});return(0,n.isDate)(i)||(0,n.isDate)(o)?i.valueOf()==o.valueOf()?{}:o:Object.keys(o).reduce((e,r)=>{if(!(0,n.hasOwnProperty)(i,r))return e[r]=o[r],e;var s=(0,t.ObjectDeepDiff)(i[r],o[r]);return!(0,n.isEmptyObject)(s)||(0,n.isDate)(s)||!(0,n.isEmptyObject)(i[r])&&(0,n.isEmptyObject)(o[r])?(e[r]=s,e):e},s)}},5851:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.extractCodecsFromSDP=t.KNOWN_CODECS=void 0,t.KNOWN_CODECS={H264:"H264/90000",VP8:"VP8/90000",VP9:"VP9/90000",OPUS:"opus/48000"};var r=/a=rtpmap:\d+\s/;t.extractCodecsFromSDP=e=>{var{sdp:t}=e;if(!t)return[];var n=t.split(/\r?\n/).filter(e=>e.match(r));return[...new Set(n.map(e=>e.replace(r,"")))]}},5921:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mergeUint8Arrays=void 0,t.mergeUint8Arrays=e=>{var t=e.reduce((e,t)=>e+t.length,0),r=new Uint8Array(t),n=0;return e.forEach(e=>{r.set(e,n),n+=e.length}),r}},5976:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPlayingTimeFraction=t.getTargetBuffer=void 0;var n=r(1421);t.getTargetBuffer=e=>new Promise(t=>{e.publish(n.GetSideMetricsAsyncEvents.getPlaybackSpeedControllerMetrics,{}),e.subscribeOnce(n.GetSideMetricsAsyncEvents.playbackSpeedControllerMetricsAvailable,e=>{t(e)})}),t.getPlayingTimeFraction=e=>new Promise(t=>{e.publish(n.GetSideMetricsAsyncEvents.getPlayingTimeFraction,{}),e.subscribeOnce(n.GetSideMetricsAsyncEvents.getPlayingTimeFractionAvailable,e=>{t(e)})})},5984:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableConfigValues=t.defaultConfig=void 0;var n=r(1111),i=r(8847),o=r(755),s=r(8323),a=r(1714),l=r(2862),u=r(2461),c=r(3703);t.defaultConfig={IInactivityReconnectConfig:a.defaultInactivityReconnectConfig,websocketTransportConfig:l.defaultWebsocketTransportConfig,peerConnectionConfig:u.defaultPeerConnectionConfig,streamDispatcherConfig:c.defaultStreamDispatcherConfig,broadcastDispatcherConfig:i.defaultBroadcastDispatcherConfig,debugger:o.defaultDebuggerConfig,abrControllerConfig:n.defaultAbrControllerConfig,latencyControllerConfig:s.defaultLatencyControllerConfig},t.availableConfigValues={IInactivityReconnectConfig:a.availableInactivityReconnectConfigValues,websocketTransportConfig:l.availableWebsocketTransportConfigValues,peerConnectionConfig:u.availablePeerConnectionConfigValues,streamDispatcherConfig:c.availableStreamDispatcherConfigValues,broadcastDispatcherConfig:i.availableBroadcastDispatcherConfigValues,debugger:o.availableDebuggerConfigValues,abrControllerConfig:n.availableAbrControllerConfigValues,latencyControllerConfig:s.availableLatencyControllerConfigValues}},6073:(e,t)=>{function r(e,t,r){if(!r||"function"!=typeof r.value)throw new TypeError("Only methods can be decorated with @bind. <".concat(t,"> is not a method!"));return{configurable:!0,get(){var e,n=null===(e=r.value)||void 0===e?void 0:e.bind(this);return Object.defineProperty(this,t,{value:n,configurable:!0,writable:!0}),n}}}Object.defineProperty(t,"__esModule",{value:!0}),t.bind=r,t.default=r},6084:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LadderIncreaseEstimator=void 0;var o=r(7833),s=r(180),l=i(r(6073));class u{constructor(e){a(this,"_eventBus",void 0),a(this,"status","Idle"),a(this,"state",s.EDebuggableModuleState.OK),a(this,"groups",["abr"]),a(this,"additionalInfo",{}),a(this,"_calculatedResolution",null),a(this,"_cachedResolution",null),a(this,"_startMsn",0),a(this,"_canIncrease",!1),a(this,"_startPn",-1),a(this,"_onFragmentLoadedListener",void 0),this._eventBus=e,this._onFragmentLoadedListener=this._eventBus.subscribe(o.FragmentLoaderEvents.fragments.fragmentLoadingStarted,this._onFragmentLoadingStarted)}destroy(){this._eventBus.unsubscribe(this._onFragmentLoadedListener)}getNextEstimatedResolution(e,t){if(!this._canIncrease)return t;var r=e.findIndex(e=>e.name===(null==t?void 0:t.name));return-1===r?t:(this._calculatedResolution=r>0?e[r-1]:e[0],this._canIncrease=!1,this._calculatedResolution)}reset(){this._startMsn=0}_onFragmentLoadingStarted(e){this._calculateInitStartMsn(e),this._canIncrease=e.msn>this._startMsn||e.pn<this._startPn,this._canIncrease&&(this._startMsn=e.msn)}_calculateInitStartMsn(e){this._startMsn<=0&&(this._startMsn=e.msn),this._startPn<0&&(this._startPn=e.pn)}}t.LadderIncreaseEstimator=u,n([l.default],u.prototype,"_onFragmentLoadingStarted",null)},6087:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.V1PreParseURLRestore=void 0;var n=r(9437);class i extends n.PlaylistPreParseDecryptStage{constructor(){super()}restorePlaylist(e){for(var t=e.split("\n"),r=null,n=0;n<t.length;n++){var i=t[n].trim();i.startsWith("#EXT-X-MOUFLON:FILE:")?r=i.substring(20).trim():null!==r&&i.includes("media.mp4")&&(t[n]=i.replace("media.mp4","xxx_".concat(r)),r=null)}return t.join("\n")}}t.V1PreParseURLRestore=i},6126:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EBroadcastStatus=void 0,function(e){e.UNKNOWN="unknown",e.CONNECTING="connecting",e.CONNECTED="connected",e.LIVE="live",e.FINISHED="finished",e.ERRORED="errored"}(r||(t.EBroadcastStatus=r={}))},6195:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SCHEME_MAP=void 0;var n=r(9313),i=r(6087);t.SCHEME_MAP={v1:[new n.V1PostParseURLRestore,new i.V1PreParseURLRestore]}},6252:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=void 0,t.getVideoPlaybackQuality=function(e){var r,o,s;if((0,t.isSupported)())return e.getVideoPlaybackQuality();if(n()){var a,l,u,c=e;return{corruptedVideoFrames:0,creationTime:null!==(a=null===(l=window.performance)||void 0===l||null===(u=l.now)||void 0===u?void 0:u.call(l))&&void 0!==a?a:Date.now(),droppedVideoFrames:c.webkitDroppedFrameCount||0,totalVideoFrames:c.webkitDecodedFrameCount||0}}if(i()){var d,h,f,p=e;return{corruptedVideoFrames:0,creationTime:null!==(d=null===(h=window.performance)||void 0===h||null===(f=h.now)||void 0===f?void 0:f.call(h))&&void 0!==d?d:Date.now(),droppedVideoFrames:0,totalVideoFrames:p.mozPaintedFrames||0}}return{corruptedVideoFrames:0,creationTime:null!==(r=null===(o=window.performance)||void 0===o||null===(s=o.now)||void 0===s?void 0:s.call(o))&&void 0!==r?r:Date.now(),droppedVideoFrames:0,totalVideoFrames:0}};var r=()=>"undefined"!=typeof window&&"HTMLVideoElement"in window;t.isSupported=()=>{var e;return r()&&"function"==typeof(null===(e=window.HTMLVideoElement)||void 0===e||null===(e=e.prototype)||void 0===e?void 0:e.getVideoPlaybackQuality)};var n=()=>r()&&"webkitDroppedFrameCount"in window.HTMLVideoElement.prototype,i=()=>r()&&"mozPaintedFrames"in window.HTMLVideoElement.prototype},6261:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackSpeedController=void 0;var n=r(4030),i=r(4526),o=r(28),s=r(6862),l=r(5182),u=r(180);t.PlaybackSpeedController=class{constructor(e){a(this,"_eventBus",void 0),a(this,"state",u.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["PlaybackSpeed"]),a(this,"additionalInfo",{}),a(this,"_playbackSpeedActuator",void 0),a(this,"_playbackSpeedWatcher",void 0),a(this,"_targetBufferDecreaser",void 0),a(this,"_targetBufferIncreaser",void 0),a(this,"_originalTargetBufferDecreaser",void 0),this._eventBus=e,this._playbackSpeedActuator=new i.PlaybackSpeedActuator(this._eventBus),this._playbackSpeedWatcher=new o.PlaybackSpeedWatcher(this._eventBus),this._targetBufferDecreaser=new s.TargetBufferDecreaser(this._eventBus),this._targetBufferIncreaser=new l.TargetBufferIncreaser(this._eventBus),this._originalTargetBufferDecreaser=new n.OriginalTargetBufferDecreaser(this._eventBus)}setVideoElement(e){this._playbackSpeedActuator.setVideoElement(e)}removeVideoElement(){this._playbackSpeedActuator.setVideoElement(null)}pause(){this._playbackSpeedWatcher.pause()}resume(){this._playbackSpeedWatcher.resume()}destroy(){this._playbackSpeedActuator.destroy(),this._playbackSpeedWatcher.destroy(),this._targetBufferDecreaser.destroy(),this._targetBufferIncreaser.destroy(),this._originalTargetBufferDecreaser.destroy()}get additionalModules(){return{playbackSpeedActuator:this._playbackSpeedActuator,playbackSpeedWatcher:this._playbackSpeedWatcher,targetBufferIncreaser:this._targetBufferIncreaser,targetBufferDecreaser:this._targetBufferDecreaser,originalTargetBufferDecreaser:this._originalTargetBufferDecreaser}}}},6304:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistDecryptHandler=void 0;var n=r(9858),i=r(6195),o=r(8188),s=r(3326),l=r(6847);class u{constructor(e){a(this,"_activeScheme",null),a(this,"_activeKey",null),a(this,"_knownKeys",o.KEYS_MAP),a(this,"_knownKeyIds",Object.keys(this._knownKeys)),a(this,"_knownSchemes",i.SCHEME_MAP),a(this,"_knownSchemesVersions",Object.keys(this._knownSchemes)),a(this,"_validatorsMap",o.VALIDATORS_MAP),a(this,"_logger",void 0),this._logger=(0,l.Logger)(e,"PlaylistDecryptHandler")}reset(){this._logger.info("Reset"),this._activeKey=null,this._activeScheme=null}handleAvailableSchemes(e){this._logger.info("Available schemes reported",e);var t=e.find(e=>{var{schemeVersion:t,keyId:r}=e;return this._knownKeyIds.includes(r)&&this._knownSchemesVersions.includes(t)});t?(this._logger.info("Selected scheme",t),this._activeScheme=t.schemeVersion,this._activeKey=t.keyId):(this._logger.info("No selected scheme found",t),this.reset())}handlePlaylist(e){if(!this.hasCorruptionInfo||!e.isCorruptRequested)return this._handleRawPlaylist(e.data);var t=this._activeScheme?this._validatorsMap[this._activeScheme]:[];if(t.filter(e=>{var{pipelinePosition:t}=e;return"preParse"===t}).some(t=>!t.validateScheme(e.data,this._activeScheme,this._activeKey)))return this._handleRawPlaylist(e.data);var r=this._activeScheme?this._knownSchemes[this._activeScheme].filter(e=>{var{pipelinePosition:t}=e;return"preParse"===t}).reduce((e,t)=>t.restorePlaylist(e,this._knownKeys[this._activeKey]),e.data):e.data,i=new n.Parser;i.addParser(u.CORRUPTION_SCHEME_PARSER),i.addParser({expression:/^#EXT-X-MOUFLON:EXT-REF/,customType:"encodeTimestampMap",dataParser:function(e){return(0,s.extractEncodeTimestampFromExtraData)(e.replace("#EXT-X-MOUFLON:EXT-REF:",""))}}),i.push(r),i.end();var{manifest:o}=i;return t.filter(e=>{var{pipelinePosition:t}=e;return"postParse"===t}).some(e=>!e.validateScheme(o,this._activeScheme,this._activeKey))?o:this._knownSchemes[this._activeScheme].filter(e=>{var{pipelinePosition:t}=e;return"postParse"===t}).reduce((e,t)=>t.restorePlaylist(e,this._knownKeys[this._activeKey]),o)}_handleRawPlaylist(e){var t=new n.Parser,r=e.matchAll(new RegExp("^#EXT-X-MOUFLON:PSCH:([^:\r\n]+):([^\r\n]+)","gm")),i=Array.from(r,e=>({schemeVersion:e[1],keyId:e[2]}));return t.addParser(u.CORRUPTION_SCHEME_PARSER),t.addParser({expression:/^#EXT-X-MOUFLON:EXT-REF/,customType:"encodeTimestampMap",dataParser:function(e){return(0,s.extractEncodeTimestampFromExtraData)(e.replace("#EXT-X-MOUFLON:EXT-REF:",""))}}),t.push(e),t.end(),i&&this.handleAvailableSchemes(i),t.manifest}get hasCorruptionInfo(){return!!this._activeScheme&&!!this._activeKey}get corruptionQueryParams(){var e=new URLSearchParams;return this.hasCorruptionInfo&&(e.set(u.SCHEME_QUERY_PARAMETER_NAME,this._activeScheme),e.set(u.KEY_QUERY_PARAMETER_NAME,this._activeKey)),e}}a(u,"SCHEME_QUERY_PARAMETER_NAME","psch"),a(u,"KEY_QUERY_PARAMETER_NAME","pkey"),a(u,"CORRUPTION_SCHEME_PARSER",{expression:new RegExp("^#EXT-X-MOUFLON:PSCH(.*)"),customType:"mmpCorruptionScheme",dataParser:e=>e.replace(new RegExp("^#EXT-X-MOUFLON:PSCH:"),"").trim().split(":")}),t.PlaylistDecryptHandler=u},6308:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getNetworkStats=t.getNetworkStatsFromPerformance=void 0,t.getNetworkStatsFromPerformance=(e,t,r)=>{if(!globalThis.performance||!globalThis.performance.getEntriesByName)return null;var n=globalThis.performance.getEntriesByName(e)[0];if(!n)return null;var{connectStart:i,connectEnd:o,domainLookupEnd:s,duration:a,domainLookupStart:l,encodedBodySize:u,responseStart:c,requestStart:d}=n,h=(u||t)/1024,f=a;return globalThis.performance.clearResourceTimings(),{connectDuration:o-i,domainLookupDuration:s-l,sizeInKb:h,ttfb:c-d,downloadDuration:f,calculatedSpeed:h/(f/1e3)*8,type:r,url:e}},t.getNetworkStats=(e,r,n,i)=>(0,t.getNetworkStatsFromPerformance)(e,n,i)||{connectDuration:0,domainLookupDuration:0,sizeInKb:n/1024,ttfb:0,url:e,downloadDuration:r,calculatedSpeed:n/1024/(r/1e3)*8,type:i}},6375:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebRTCCommonHelpers=t.getIsWebRTCApiSupported=t.resolveGetUserMedia=t.resolveRTCSessionDescription=t.resolveRTCIceCandidate=t.resolveRTCPeerConnection=void 0;var n,i,o=r(7465),a=r(9234);t.resolveRTCPeerConnection=()=>window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,t.resolveRTCIceCandidate=()=>window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate,t.resolveRTCSessionDescription=()=>window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,t.resolveGetUserMedia=()=>{var e=navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices)||navigator.getUserMedia&&(0,a.promisify)(navigator.getUserMedia.bind(navigator))||navigator.webkitGetUserMedia&&(0,a.promisify)(navigator.webkitGetUserMedia.bind(navigator))||navigator.mozGetUserMedia&&(0,a.promisify)(navigator.mozGetUserMedia.bind(navigator));return t=>e.call(navigator,t)},t.getIsWebRTCApiSupported=()=>Boolean((0,t.resolveRTCPeerConnection)()&&(0,t.resolveRTCIceCandidate)()&&(0,t.resolveRTCSessionDescription)()),t.WebRTCCommonHelpers={getIsWebRTCApiSupported:t.getIsWebRTCApiSupported,resolveGetUserMedia:t.resolveGetUserMedia,resolveRTCPeerConnection:t.resolveRTCPeerConnection,resolveRTCIceCandidate:t.resolveRTCIceCandidate,resolveRTCSessionDescription:t.resolveRTCSessionDescription,isH264BroadcastSupported:(i=s(function*(){return(yield(0,o.checkCodecsSupported)("broadcast",[o.KNOWN_CODECS.H264,o.KNOWN_CODECS.VP8])).some(e=>[o.KNOWN_CODECS.H264,o.KNOWN_CODECS.VP8].includes(e))}),function(){return i.apply(this,arguments)}),isH264PlayingSupported:(n=s(function*(){return(yield(0,o.checkCodecsSupported)("play",[o.KNOWN_CODECS.H264,o.KNOWN_CODECS.VP8])).some(e=>[o.KNOWN_CODECS.H264,o.KNOWN_CODECS.VP8].includes(e))}),function(){return n.apply(this,arguments)})}},6424:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StreamLoader=t.EPlaylistRotationControllerType=void 0;var o,s=r(355),l=r(8474),u=r(7148),c=r(5746),d=r(414),h=r(6701),f=r(9272),p=r(180),v=i(r(6073)),g=r(5395);!function(e){e.VOD="VOD",e.LOW_LATENCY="lowLatency",e.SIMPLE="simple"}(o||(t.EPlaylistRotationControllerType=o={}));class _{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o.SIMPLE,t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;a(this,"_eventBus",void 0),a(this,"state",p.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"groups",["loader"]),a(this,"_streamUrl",null),a(this,"_aclToken",null),a(this,"_playlistsRotator",null),a(this,"_fragmentsLoader",void 0),a(this,"_actualRenditionReport",null),a(this,"_lastAddedFragment",null),a(this,"_logger",void 0),a(this,"_simplePlaylistDetectedListener",void 0),a(this,"_llPlaylistDetectedListener",void 0),a(this,"_vodPlaylistDetectedListener",void 0),a(this,"_onSoftResetRequestedListener",void 0),a(this,"_onFragmentAddedListener",void 0),a(this,"_onBrowserRedirectDetectedListener",void 0),a(this,"_initialType",void 0),a(this,"_playlistDecryptHandler",void 0),this._eventBus=n,this._playlistDecryptHandler=r,this._logger=(0,l.Logger)(this._eventBus,"Doppio - StreamLoader"),this._logger.info("Created"),this._fragmentsLoader=new u.FragmentLoader(this._eventBus),this._initialType=e,this._simplePlaylistDetectedListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.playlistRotator.playlistType.simpleDetected,this._onSimplePlaylistDetected),this._llPlaylistDetectedListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.playlistRotator.playlistType.llDetected,this._onLLPlaylistDetected),this._vodPlaylistDetectedListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.playlistRotator.playlistType.vodDetected,this._onVODPlaylistDetected),this._onSoftResetRequestedListener=this._eventBus.subscribe(s.BufferControllerEvents.requestResetWithOverplay,this._resetPlaylistLoaders),this._onBrowserRedirectDetectedListener=this._eventBus.subscribe(g.NetworkLoaderEvent.events.browserRedirectDetected,this._onBrowserRedirectDetected),this._onFragmentAddedListener=this._eventBus.subscribe(s.BufferControllerEvents.fragmentAdded,this._onFragmentAdded),this._lastAddedFragment=t}startLoad(e){this._streamUrl=e,this._recreateLoaders()}destroy(){var e;this._logger.info("Destroying instance, ".concat(this._streamUrl)),this._fragmentsLoader.destroy(),null!==(e=this._playlistsRotator)&&void 0!==e&&e.destroy(),this._eventBus.unsubscribe(this._simplePlaylistDetectedListener),this._eventBus.unsubscribe(this._llPlaylistDetectedListener),this._eventBus.unsubscribe(this._vodPlaylistDetectedListener),this._eventBus.unsubscribe(this._onSoftResetRequestedListener),this._eventBus.unsubscribe(this._onFragmentAddedListener),this._eventBus.unsubscribe(this._onBrowserRedirectDetectedListener)}setActualRenditionReport(e){e&&(this._actualRenditionReport=e)}_recreateLoaders(){var e;this.status="Restarting";var t=this._buildUrl();this._logger.debug("Recreate loaders"),t&&(this._fragmentsLoader.destroy(),this._fragmentsLoader=new u.FragmentLoader(this._eventBus),this._playlistsRotator?null===(e=this._playlistsRotator)||void 0===e||e.setURL(t):this._recreateInitialLoader(),this.status="Working")}_recreateInitialLoader(){switch(this._initialType){case o.SIMPLE:this._onSimplePlaylistDetected();break;case o.VOD:this._onVODPlaylistDetected();break;case o.LOW_LATENCY:this._onLLPlaylistDetected();break;default:this._onSimplePlaylistDetected()}}_buildUrl(){return this._streamUrl?"".concat(this._streamUrl).concat(this._aclToken?"?aclToken="+this._aclToken:""):null}_onFragmentAdded(e){this._lastAddedFragment=e}_onSimplePlaylistDetected(e){var t;if(!(this._playlistsRotator instanceof d.SimplePlaylistRotationController)){this._eventBus.publish(h.StreamLoaderModuleEvents.streamLoader.playlistRotatorTypeChanged,o.SIMPLE),this._logger.info("Simple playlist detected, switching to simple loader");var r=this._buildUrl();r&&(null!==(t=this._playlistsRotator)&&void 0!==t&&t.destroy(),this._playlistsRotator=new d.SimplePlaylistRotationController(this._eventBus,r,this._playlistDecryptHandler,e),this.additionalInfo.playlistRotatorType="SimplePlaylistRotator")}}_onVODPlaylistDetected(e){var t;if(!(this._playlistsRotator instanceof f.VODPlaylistRotationController)){this._eventBus.publish(h.StreamLoaderModuleEvents.streamLoader.playlistRotatorTypeChanged,o.VOD),this._logger.info("VOD playlist detected, switching to VOD loader");var r=this._buildUrl();r&&(null!==(t=this._playlistsRotator)&&void 0!==t&&t.destroy(),this._playlistsRotator=new f.VODPlaylistRotationController(this._eventBus,r,this._playlistDecryptHandler,e),this.additionalInfo.playlistRotatorType="VODPlaylistRotator")}}_onLLPlaylistDetected(e){var t,r,n;if(!(this._playlistsRotator instanceof c.LLNewPlaylistRotationController)){this._eventBus.publish(h.StreamLoaderModuleEvents.streamLoader.playlistRotatorTypeChanged,o.LOW_LATENCY),this._logger.info("LL Playlist detected, switching to ll loader");var i=this._buildUrl();i&&(null!==(t=this._playlistsRotator)&&void 0!==t&&t.destroy(),this._playlistsRotator=new c.LLNewPlaylistRotationController(this._eventBus,{url:i,startManifest:e,initialMSN:null===(r=this._actualRenditionReport)||void 0===r?void 0:r.lastMsn,initialPN:null===(n=this._actualRenditionReport)||void 0===n?void 0:n.lastPart,lastLoadedFragment:this._lastAddedFragment},this._playlistDecryptHandler),this.additionalInfo.playlistRotatorType="LowLatencyPlaylistRotator")}}_resetPlaylistLoaders(){var e;null!==(e=this._playlistsRotator)&&void 0!==e&&e.abortCurrentPlaylistLoading(),this.status="Idle"}_onBrowserRedirectDetected(e){var t,{responseUrl:r}=e;this._streamUrl=r;var n=this._buildUrl();n&&(null===(t=this._playlistsRotator)||void 0===t||t.setURL(n,!0))}get additionalModules(){var e={};return this._playlistsRotator&&(e.playlistRotator=this._playlistsRotator),this._fragmentsLoader&&(e.fragmentLoader=this._fragmentsLoader),e}}t.StreamLoader=_,n([v.default],_.prototype,"_onFragmentAdded",null),n([v.default],_.prototype,"_onSimplePlaylistDetected",null),n([v.default],_.prototype,"_onVODPlaylistDetected",null),n([v.default],_.prototype,"_onLLPlaylistDetected",null),n([v.default],_.prototype,"_resetPlaylistLoaders",null),n([v.default],_.prototype,"_onBrowserRedirectDetected",null)},6510:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DummyModifier=void 0,t.DummyModifier=class{modify(e){return e}}},6523:(e,t,r)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.setConfig=t.ConfigConsumer=t.defaultVideoElementControllerConfig=void 0;var i=r(4389);t.defaultVideoElementControllerConfig={videoElementControllerConfig:{limitCheckingAutoplay:5,minimalPossibleVideoDimension:50,timeoutUpdateStatusPlaying:2e3,timeoutUpdateVideoDuration:500}},n=(0,i.createConfig)(t.defaultVideoElementControllerConfig),t.ConfigConsumer=n.ConfigConsumer,t.setConfig=n.setConfig},6671:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bind=function(e,t,r){if(!r||"function"!=typeof r.value)throw new TypeError("Only methods can be decorated with @bind. <".concat(t,"> is not a method!"));return{configurable:!0,get(){var e,n=null===(e=r.value)||void 0===e?void 0:e.bind(this);return Object.defineProperty(this,t,{value:n,configurable:!0,writable:!0}),n}}}},6701:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StreamLoaderModuleEvents=void 0;var n=r(2513),i=r(7833);t.StreamLoaderModuleEvents={fragmentLoader:i.FragmentLoaderEvents,playlistRotator:n.BasePlaylistRotationControllerEvents,streamLoader:{playlistRotatorTypeChanged:"streamLoader.playlistRotatorTypeChanged"}}},6733:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebuggerEvents=void 0,t.DebuggerEvents={lifecycleEvent:"debugger.lifecycleEvent",debuggerConnected:"debugger.connected"}},6768:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isTransceiverAvailableAndWorking=t.isFirefox=void 0;var n=r(9074),{name:i,version:o}=n.browserInfo.getOS(),[s]=(null==o?void 0:o.split("."))||["0"],a="iOS"===i&&Number(s)>=12;t.isFirefox=Boolean(n.browserInfo.satisfies({firefox:">0"})),t.isTransceiverAvailableAndWorking=e=>a||Boolean(null==e?void 0:e.addTransceiver)||!1},6791:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaybackSpeedEvents=t.TargetBufferEvents=void 0,t.TargetBufferEvents={targetBufferIncreaseRequested:"targetBuffer.targetBufferIncreaseRequested",targetBufferIncreased:"targetBuffer.targetBufferIncreased",targetBufferDecreaseRequested:"targetBuffer.targetBufferDecreaseRequested",originalTargetBufferDecreaseRequested:"targetBuffer.originalTargetBufferDecreaseRequested",originalTargetBufferDisable:"targetBuffer.originalTargetBufferDisable",targetBufferDecreased:"targetBuffer.targetBufferDecreased"},t.PlaybackSpeedEvents={setPlaybackSpeed:"playbackSpeed.setPlaybackSpeed"}},6805:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getVideoPlaybackQuality=t.AsyncGuarderDecorator=t.queued=t.parsePlaylistUrl=t.ObjectDeepDiff=t.CustomEventTarget=t.HLSCommon=t.WebRTCCommonHelpers=t.EUserMediaEvent=t.StateManager=t.UserMedia=t.EventBus=t.LoggerConsoleTransport=t.ELoggerEvents=t.ELogLevel=t.convertLogLevel=t.LogLevelTitlesMap=t.logLevels=t.Logger=t.addMediaAction=t.VideoElementController=t.EPlaybackStartType=t.EPlayerType=t.EPlaybackState=t.bind=t.createConfig=t.EVideoControllerCustomEvent=void 0,r(7480);var n=r(2085);Object.defineProperty(t,"EVideoControllerCustomEvent",{enumerable:!0,get:function(){return n.EVideoControllerCustomEvent}});var i=r(4389);Object.defineProperty(t,"createConfig",{enumerable:!0,get:function(){return i.createConfig}});var o=r(6671);Object.defineProperty(t,"bind",{enumerable:!0,get:function(){return o.bind}});var s=r(5458);Object.defineProperty(t,"EPlaybackState",{enumerable:!0,get:function(){return s.EPlaybackState}}),Object.defineProperty(t,"EPlayerType",{enumerable:!0,get:function(){return s.EPlayerType}}),Object.defineProperty(t,"EPlaybackStartType",{enumerable:!0,get:function(){return s.EPlaybackStartType}});var a=r(1125);Object.defineProperty(t,"VideoElementController",{enumerable:!0,get:function(){return a.VideoElementController}});var l=r(469);Object.defineProperty(t,"addMediaAction",{enumerable:!0,get:function(){return l.addMediaAction}});var u=r(6847);Object.defineProperty(t,"Logger",{enumerable:!0,get:function(){return u.Logger}});var c=r(4216);Object.defineProperty(t,"logLevels",{enumerable:!0,get:function(){return c.logLevels}}),Object.defineProperty(t,"LogLevelTitlesMap",{enumerable:!0,get:function(){return c.LogLevelTitlesMap}}),Object.defineProperty(t,"convertLogLevel",{enumerable:!0,get:function(){return c.convertLogLevel}}),Object.defineProperty(t,"ELogLevel",{enumerable:!0,get:function(){return c.ELogLevel}});var d=r(3952);Object.defineProperty(t,"ELoggerEvents",{enumerable:!0,get:function(){return d.ELoggerEvents}});var h=r(4989);Object.defineProperty(t,"LoggerConsoleTransport",{enumerable:!0,get:function(){return h.LoggerConsoleTransport}});var f=r(5361);Object.defineProperty(t,"EventBus",{enumerable:!0,get:function(){return f.EventBus}});var p=r(3325);Object.defineProperty(t,"UserMedia",{enumerable:!0,get:function(){return p.UserMedia}});var v=r(3599);Object.defineProperty(t,"StateManager",{enumerable:!0,get:function(){return v.StateManager}});var g=r(2346);Object.defineProperty(t,"EUserMediaEvent",{enumerable:!0,get:function(){return g.EUserMediaEvent}});var _=r(6375);Object.defineProperty(t,"WebRTCCommonHelpers",{enumerable:!0,get:function(){return _.WebRTCCommonHelpers}});var m=r(4937);Object.defineProperty(t,"HLSCommon",{enumerable:!0,get:function(){return m.HLSCommon}});var y=r(8349);Object.defineProperty(t,"CustomEventTarget",{enumerable:!0,get:function(){return y.CustomEventTarget}});var b=r(5821);Object.defineProperty(t,"ObjectDeepDiff",{enumerable:!0,get:function(){return b.ObjectDeepDiff}});var E=r(8690);Object.defineProperty(t,"parsePlaylistUrl",{enumerable:!0,get:function(){return E.parsePlaylistUrl}});var S=r(4040);Object.defineProperty(t,"queued",{enumerable:!0,get:function(){return S.queued}});var T=r(3205);Object.defineProperty(t,"AsyncGuarderDecorator",{enumerable:!0,get:function(){return T.AsyncGuarderDecorator}});var C=r(6252);Object.defineProperty(t,"getVideoPlaybackQuality",{enumerable:!0,get:function(){return C.getVideoPlaybackQuality}})},6847:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var n=r(3952),i=(e,t,r)=>(i,o)=>{e.publish(n.ELoggerEvents.LOG,{domain:t,timestamp:performance.now(),level:r,message:i,payload:o})};t.Logger=(e,t)=>{var r="".concat(t,"{").concat((Math.random()+1).toString(36).substring(2,6),"}");return{debug:i(e,r,"debug"),verbose:i(e,r,"verbose"),info:i(e,r,"info"),warn:i(e,r,"warn"),error:i(e,r,"error"),fatal:i(e,r,"fatal")}}},6857:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isStreamInactive=void 0;var n=r(2564);t.isStreamInactive=e=>!e.active||e.getTracks().every(n.isTrackEmpty)},6862:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TargetBufferDecreaser=void 0;var o=r(355),s=r(8548),l=r(6791),u=r(8169),c=r(180),d=r(1084),h=i(r(6073));class f extends u.ConfigConsumer{constructor(e){super("targetBufferDecreaser",e),a(this,"state",c.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["PlaybackSpeed"]),a(this,"additionalInfo",{}),a(this,"currentTargetBufferMultiplier",1),a(this,"_nextCheckTimestamp",0),a(this,"_currentPlaybackRateMode",s.EPlaybackRateMode.NORMAL),a(this,"_slowdownEventsCollector",new d.EventsInPeriodWindow),a(this,"_onPlaybackRateModeChangedListener",void 0),a(this,"_onBufferMetricsAvailableListener",void 0),a(this,"_onTargetBufferIncreasedListener",void 0),this._onPlaybackRateModeChangedListener=this._eventBus.subscribe(l.PlaybackSpeedEvents.setPlaybackSpeed,this._onPlaybackRateModeChanged),this._onBufferMetricsAvailableListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable),this._onTargetBufferIncreasedListener=this._eventBus.subscribe(l.TargetBufferEvents.targetBufferIncreased,this._onTargetBufferIncreased)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onPlaybackRateModeChangedListener),this._eventBus.unsubscribe(this._onBufferMetricsAvailableListener),this._eventBus.unsubscribe(this._onTargetBufferIncreasedListener)}_handleConfigUpdated(){}_onPlaybackRateModeChanged(e){e===this._currentPlaybackRateMode||e!==s.EPlaybackRateMode.SLOW&&this._currentPlaybackRateMode!==s.EPlaybackRateMode.SLOW||this._slowdownEventsCollector.registerEvent(),this._currentPlaybackRateMode=e}_onBufferMetricsAvailable(){0!==this._nextCheckTimestamp&&this._nextCheckTimestamp<Date.now()&&this.currentTargetBufferMultiplier>1&&this._currentPlaybackRateMode!==s.EPlaybackRateMode.SLOW&&0===this._slowdownEventsCollector.checkEventsInPeriod(this.config.periodOfEventsToCancelDecrease)&&(this._eventBus.publish(l.TargetBufferEvents.targetBufferDecreaseRequested,{}),this.currentTargetBufferMultiplier-=1,this._nextCheckTimestamp=this.currentTargetBufferMultiplier>1?Date.now()+this.config.periodOfEventsToCancelDecrease:0)}_onTargetBufferIncreased(){this.currentTargetBufferMultiplier+=1,this._nextCheckTimestamp=Date.now()+this.config.periodOfEventsToCancelDecrease}}t.TargetBufferDecreaser=f,n([h.default],f.prototype,"destroy",null),n([h.default],f.prototype,"_handleConfigUpdated",null),n([h.default],f.prototype,"_onPlaybackRateModeChanged",null),n([h.default],f.prototype,"_onBufferMetricsAvailable",null),n([h.default],f.prototype,"_onTargetBufferIncreased",null)},6868:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbortController=t.AbortSignal=void 0;class r{constructor(){Object.defineProperty(this,"listeners",{value:{},writable:!0,configurable:!0})}addEventListener(e,t,r){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push({callback:t,options:r})}removeEventListener(e,t){if(e in this.listeners)for(var r=this.listeners[e],n=0,i=r.length;n<i;n++)if(r[n].callback===t)return void r.splice(n,1)}dispatchEvent(e){var t=this;if(e.type in this.listeners){for(var r=this.listeners[e.type].slice(),n=function(){var n=r[i];try{n.callback.call(t,e)}catch(e){Promise.resolve().then(()=>{throw e})}n.options&&n.options.once&&t.removeEventListener(e.type,n.callback)},i=0,o=r.length;i<o;i++)n();return!e.defaultPrevented}}}class n extends r{constructor(){super(),this.listeners||r.call(this),Object.defineProperty(this,"aborted",{value:!1,writable:!0,configurable:!0}),Object.defineProperty(this,"onabort",{value:null,writable:!0,configurable:!0}),Object.defineProperty(this,"reason",{value:void 0,writable:!0,configurable:!0})}toString(){return"[object AbortSignal]"}dispatchEvent(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),super.dispatchEvent(e)}}t.AbortSignal=n;class i{constructor(){Object.defineProperty(this,"signal",{value:new n,writable:!0,configurable:!0})}abort(e){var t=new Event("abort"),r=e;void 0===r&&((r=new Error("This operation was aborted")).name="AbortError"),this.signal.reason=r,this.signal.dispatchEvent(t)}toString(){return"[object AbortController]"}}t.AbortController=i,function(e){(function(e){return"function"==typeof e.Request&&!Object.prototype.hasOwnProperty.call(e.Request.prototype,"signal")||!e.AbortController})(e)&&("undefined"!=typeof Symbol&&Symbol.toStringTag&&(i.prototype[Symbol.toStringTag]="AbortController",n.prototype[Symbol.toStringTag]="AbortSignal"),e.AbortController=i,e.AbortSignal=n)}("undefined"!=typeof self?self:globalThis)},6880:function(e){e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=90)}({17:function(e,t,r){t.__esModule=!0,t.default=void 0;var n=r(18),i=function(){function e(){}return e.getFirstMatch=function(e,t){var r=t.match(e);return r&&r.length>0&&r[1]||""},e.getSecondMatch=function(e,t){var r=t.match(e);return r&&r.length>1&&r[2]||""},e.matchAndReturnConst=function(e,t,r){if(e.test(t))return r},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map(function(e){return parseInt(e,10)||0});t.push(0);var r=t[0],n=t[1];if(10===r)switch(n){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}switch(r){case 11:return"Big Sur";case 12:return"Monterey";case 13:return"Ventura";case 14:return"Sonoma";case 15:return"Sequoia";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map(function(e){return parseInt(e,10)||0});if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,r,n){void 0===n&&(n=!1);var i=e.getVersionPrecision(t),o=e.getVersionPrecision(r),s=Math.max(i,o),a=0,l=e.map([t,r],function(t){var r=s-e.getVersionPrecision(t),n=t+new Array(r+1).join(".0");return e.map(n.split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});for(n&&(a=s-Math.min(i,o)),s-=1;s>=a;){if(l[0][s]>l[1][s])return 1;if(l[0][s]===l[1][s]){if(s===a)return 0;s-=1}else if(l[0][s]<l[1][s])return-1}},e.map=function(e,t){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r+=1)n.push(t(e[r]));return n},e.find=function(e,t){var r,n;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(r=0,n=e.length;r<n;r+=1){var i=e[r];if(t(i,r))return i}},e.assign=function(e){for(var t,r,n=e,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];if(Object.assign)return Object.assign.apply(Object,[e].concat(o));var a=function(){var e=o[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach(function(t){n[t]=e[t]})};for(t=0,r=o.length;t<r;t+=1)a();return e},e.getBrowserAlias=function(e){return n.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return n.BROWSER_MAP[e]||""},e}();t.default=i,e.exports=t.default},18:function(e,t,r){t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={AmazonBot:"amazonbot","Amazon Silk":"amazon_silk","Android Browser":"android",BaiduSpider:"baiduspider",Bada:"bada",BingCrawler:"bingcrawler",BlackBerry:"blackberry","ChatGPT-User":"chatgpt_user",Chrome:"chrome",ClaudeBot:"claudebot",Chromium:"chromium",Diffbot:"diffbot",DuckDuckBot:"duckduckbot",Electron:"electron",Epiphany:"epiphany",FacebookExternalHit:"facebookexternalhit",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot",GPTBot:"gptbot","Internet Explorer":"ie",InternetArchiveCrawler:"internetarchivecrawler","K-Meleon":"k_meleon",LibreWolf:"librewolf",Maxthon:"maxthon","Meta-ExternalAds":"meta_externalads","Meta-ExternalAgent":"meta_externalagent","Meta-ExternalFetcher":"meta_externalfetcher","Meta-WebIndexer":"meta_webindexer","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver","OAI-SearchBot":"oai_searchbot",Omgilibot:"omgilibot",Opera:"opera","Opera Coast":"opera_coast","Pale Moon":"pale_moon",PerplexityBot:"perplexitybot","Perplexity-User":"perplexity_user",PhantomJS:"phantomjs",PingdomBot:"pingdombot",Puffin:"puffin",QQ:"qq",QQLite:"qqlite",QupZilla:"qupzilla",Roku:"roku",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir","Sogou Browser":"sogou",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat",YahooSlurp:"yahooslurp","Yandex Browser":"yandex",YandexBot:"yandexbot",YouBot:"youbot"},t.BROWSER_MAP={amazonbot:"AmazonBot",amazon_silk:"Amazon Silk",android:"Android Browser",baiduspider:"BaiduSpider",bada:"Bada",bingcrawler:"BingCrawler",blackberry:"BlackBerry",chatgpt_user:"ChatGPT-User",chrome:"Chrome",claudebot:"ClaudeBot",chromium:"Chromium",diffbot:"Diffbot",duckduckbot:"DuckDuckBot",edge:"Microsoft Edge",electron:"Electron",epiphany:"Epiphany",facebookexternalhit:"FacebookExternalHit",firefox:"Firefox",focus:"Focus",generic:"Generic",google_search:"Google Search",googlebot:"Googlebot",gptbot:"GPTBot",ie:"Internet Explorer",internetarchivecrawler:"InternetArchiveCrawler",k_meleon:"K-Meleon",librewolf:"LibreWolf",maxthon:"Maxthon",meta_externalads:"Meta-ExternalAds",meta_externalagent:"Meta-ExternalAgent",meta_externalfetcher:"Meta-ExternalFetcher",meta_webindexer:"Meta-WebIndexer",mz:"MZ Browser",naver:"NAVER Whale Browser",oai_searchbot:"OAI-SearchBot",omgilibot:"Omgilibot",opera:"Opera",opera_coast:"Opera Coast",pale_moon:"Pale Moon",perplexitybot:"PerplexityBot",perplexity_user:"Perplexity-User",phantomjs:"PhantomJS",pingdombot:"PingdomBot",puffin:"Puffin",qq:"QQ Browser",qqlite:"QQ Browser Lite",qupzilla:"QupZilla",roku:"Roku",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",sogou:"Sogou Browser",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yahooslurp:"YahooSlurp",yandex:"Yandex Browser",yandexbot:"YandexBot",youbot:"YouBot"},t.PLATFORMS_MAP={bot:"bot",desktop:"desktop",mobile:"mobile",tablet:"tablet",tv:"tv"},t.OS_MAP={Android:"Android",Bada:"Bada",BlackBerry:"BlackBerry",ChromeOS:"Chrome OS",HarmonyOS:"HarmonyOS",iOS:"iOS",Linux:"Linux",MacOS:"macOS",PlayStation4:"PlayStation 4",Roku:"Roku",Tizen:"Tizen",WebOS:"WebOS",Windows:"Windows",WindowsPhone:"Windows Phone"},t.ENGINE_MAP={Blink:"Blink",EdgeHTML:"EdgeHTML",Gecko:"Gecko",Presto:"Presto",Trident:"Trident",WebKit:"WebKit"}},90:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(91))&&n.__esModule?n:{default:n},o=r(18);var s=function(){function e(){}var t;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new i.default(e,t)},e.parse=function(e){return new i.default(e).getResult()},(t=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e,t),e}();t.default=s,e.exports=t.default},91:function(e,t,r){t.__esModule=!0,t.default=void 0;var n=l(r(92)),i=l(r(93)),o=l(r(94)),s=l(r(95)),a=l(r(17));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=a.default.find(n.default,function(t){if("function"==typeof t.test)return t.test(e);if(Array.isArray(t.test))return t.test.some(function(t){return e.test(t)});throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=a.default.find(i.default,function(t){if("function"==typeof t.test)return t.test(e);if(Array.isArray(t.test))return t.test.some(function(t){return e.test(t)});throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=a.default.find(o.default,function(t){if("function"==typeof t.test)return t.test(e);if(Array.isArray(t.test))return t.test.some(function(t){return e.test(t)});throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=a.default.find(s.default,function(t){if("function"==typeof t.test)return t.test(e);if(Array.isArray(t.test))return t.test.some(function(t){return e.test(t)});throw new Error("Browser's test function is not valid")});return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return a.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,r={},n=0,i={},o=0;if(Object.keys(e).forEach(function(t){var s=e[t];"string"==typeof s?(i[t]=s,o+=1):"object"==typeof s&&(r[t]=s,n+=1)}),n>0){var s=Object.keys(r),l=a.default.find(s,function(e){return t.isOS(e)});if(l){var u=this.satisfies(r[l]);if(void 0!==u)return u}var c=a.default.find(s,function(e){return t.isPlatform(e)});if(c){var d=this.satisfies(r[c]);if(void 0!==d)return d}}if(o>0){var h=Object.keys(i),f=a.default.find(h,function(e){return t.isBrowser(e,!0)});if(void 0!==f)return this.compareVersion(i[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var r=this.getBrowserName().toLowerCase(),n=e.toLowerCase(),i=a.default.getBrowserTypeByAlias(n);return t&&i&&(n=i.toLowerCase()),n===r},t.compareVersion=function(e){var t=[0],r=e,n=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===e[0]||"<"===e[0]?(r=e.substr(1),"="===e[1]?(n=!0,r=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?r=e.substr(1):"~"===e[0]&&(n=!0,r=e.substr(1)),t.indexOf(a.default.compareVersions(i,r,n))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some(function(e){return t.is(e)})},e}();t.default=u,e.exports=t.default},92:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=/version\/(\d+(\.?_?\d+)+)/i,s=[{test:[/gptbot/i],describe:function(e){var t={name:"GPTBot"},r=i.default.getFirstMatch(/gptbot\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/chatgpt-user/i],describe:function(e){var t={name:"ChatGPT-User"},r=i.default.getFirstMatch(/chatgpt-user\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/oai-searchbot/i],describe:function(e){var t={name:"OAI-SearchBot"},r=i.default.getFirstMatch(/oai-searchbot\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/claudebot/i,/claude-web/i,/claude-user/i,/claude-searchbot/i],describe:function(e){var t={name:"ClaudeBot"},r=i.default.getFirstMatch(/(?:claudebot|claude-web|claude-user|claude-searchbot)\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/omgilibot/i,/webzio-extended/i],describe:function(e){var t={name:"Omgilibot"},r=i.default.getFirstMatch(/(?:omgilibot|webzio-extended)\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/diffbot/i],describe:function(e){var t={name:"Diffbot"},r=i.default.getFirstMatch(/diffbot\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/perplexitybot/i],describe:function(e){var t={name:"PerplexityBot"},r=i.default.getFirstMatch(/perplexitybot\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/perplexity-user/i],describe:function(e){var t={name:"Perplexity-User"},r=i.default.getFirstMatch(/perplexity-user\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/youbot/i],describe:function(e){var t={name:"YouBot"},r=i.default.getFirstMatch(/youbot\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/meta-webindexer/i],describe:function(e){var t={name:"Meta-WebIndexer"},r=i.default.getFirstMatch(/meta-webindexer\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/meta-externalads/i],describe:function(e){var t={name:"Meta-ExternalAds"},r=i.default.getFirstMatch(/meta-externalads\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/meta-externalagent/i],describe:function(e){var t={name:"Meta-ExternalAgent"},r=i.default.getFirstMatch(/meta-externalagent\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/meta-externalfetcher/i],describe:function(e){var t={name:"Meta-ExternalFetcher"},r=i.default.getFirstMatch(/meta-externalfetcher\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},r=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/amazonbot/i],describe:function(e){var t={name:"AmazonBot"},r=i.default.getFirstMatch(/amazonbot\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/bingbot/i],describe:function(e){var t={name:"BingCrawler"},r=i.default.getFirstMatch(/bingbot\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/baiduspider/i],describe:function(e){var t={name:"BaiduSpider"},r=i.default.getFirstMatch(/baiduspider\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/duckduckbot/i],describe:function(e){var t={name:"DuckDuckBot"},r=i.default.getFirstMatch(/duckduckbot\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/ia_archiver/i],describe:function(e){var t={name:"InternetArchiveCrawler"},r=i.default.getFirstMatch(/ia_archiver\/(\d+(\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/facebookexternalhit/i,/facebookcatalog/i],describe:function(){return{name:"FacebookExternalHit"}}},{test:[/yahoo!?[\s/]*slurp/i],describe:function(){return{name:"YahooSlurp"}}},{test:[/yandexbot/i,/yandexmobilebot/i],describe:function(){return{name:"YandexBot"}}},{test:[/pingdom/i],describe:function(){return{name:"PingdomBot"}}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},r=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/PaleMoon/i],describe:function(e){var t={name:"Pale Moon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:PaleMoon)[\s/](\d+(?:\.\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},r=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},r=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},r=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},r=i.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},r=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},r=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},r=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},r=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},r=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},r=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},r=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},r=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return r&&(t.version=r),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},r=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},r=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},r=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},r=i.default.getFirstMatch(o,e)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},r=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},r=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},r=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/librewolf/i],describe:function(e){var t={name:"LibreWolf"},r=i.default.getFirstMatch(/(?:librewolf)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},r=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},r=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/sogoumobilebrowser/i,/metasr/i,/se 2\.[x]/i],describe:function(e){var t={name:"Sogou Browser"},r=i.default.getFirstMatch(/(?:sogoumobilebrowser)[\s/](\d+(\.?_?\d+)+)/i,e),n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),o=i.default.getFirstMatch(/se ([\d.]+)x/i,e),s=r||n||o;return s&&(t.version=s),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},r=i.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},r=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},r=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},r=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t={name:"Android Browser"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},r=i.default.getFirstMatch(o,e);return r&&(t.version=r),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(t,e),version:i.default.getSecondMatch(t,e)}}}];t.default=s,e.exports=t.default},93:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/Roku\/DVP/],describe:function(e){var t=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:o.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),r=i.default.getWindowsVersionName(t);return{name:o.OS_MAP.Windows,version:t,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:o.OS_MAP.iOS},r=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return r&&(t.version=r),t}},{test:[/macintosh/i],describe:function(e){var t=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),r=i.default.getMacOSVersionName(t),n={name:o.OS_MAP.MacOS,version:t};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:t}}},{test:[/OpenHarmony/i],describe:function(e){var t=i.default.getFirstMatch(/OpenHarmony\s+(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.HarmonyOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),r=e.test(/android/i);return t&&r},describe:function(e){var t=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),r=i.default.getAndroidVersionName(t),n={name:o.OS_MAP.Android,version:t};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),r={name:o.OS_MAP.WebOS};return t&&t.length&&(r.version=t),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||i.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:o.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:o.OS_MAP.PlayStation4,version:t}}}];t.default=s,e.exports=t.default},94:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:[/googlebot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Google"}}},{test:[/amazonbot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Amazon"}}},{test:[/gptbot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"OpenAI"}}},{test:[/chatgpt-user/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"OpenAI"}}},{test:[/oai-searchbot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"OpenAI"}}},{test:[/baiduspider/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Baidu"}}},{test:[/bingbot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Bing"}}},{test:[/duckduckbot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"DuckDuckGo"}}},{test:[/claudebot/i,/claude-web/i,/claude-user/i,/claude-searchbot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Anthropic"}}},{test:[/omgilibot/i,/webzio-extended/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Webz.io"}}},{test:[/diffbot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Diffbot"}}},{test:[/perplexitybot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Perplexity AI"}}},{test:[/perplexity-user/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Perplexity AI"}}},{test:[/youbot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"You.com"}}},{test:[/ia_archiver/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Internet Archive"}}},{test:[/meta-webindexer/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Meta"}}},{test:[/meta-externalads/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Meta"}}},{test:[/meta-externalagent/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Meta"}}},{test:[/meta-externalfetcher/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Meta"}}},{test:[/facebookexternalhit/i,/facebookcatalog/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Meta"}}},{test:[/yahoo/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Yahoo"}}},{test:[/yandexbot/i,/yandexmobilebot/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Yandex"}}},{test:[/pingdom/i],describe:function(){return{type:o.PLATFORMS_MAP.bot,vendor:"Pingdom"}}},{test:[/huawei/i],describe:function(e){var t=i.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",r={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(r.model=t),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),r=e.test(/like (ipod|iphone)/i);return t&&!r},describe:function(e){var t=i.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/Nokia/i],describe:function(e){var t=i.default.getFirstMatch(/Nokia\s+([0-9]+(\.[0-9]+)?)/i,e),r={type:o.PLATFORMS_MAP.mobile,vendor:"Nokia"};return t&&(r.model=t),r}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];t.default=s,e.exports=t.default},95:function(e,t,r){t.__esModule=!0,t.default=void 0;var n,i=(n=r(17))&&n.__esModule?n:{default:n},o=r(18),s=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:o.ENGINE_MAP.Blink};var t=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:o.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:o.ENGINE_MAP.Trident},r=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:o.ENGINE_MAP.Presto},r=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:function(e){var t=e.test(/gecko/i),r=e.test(/like gecko/i);return t&&!r},describe:function(e){var t={name:o.ENGINE_MAP.Gecko},r=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:o.ENGINE_MAP.WebKit},r=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return r&&(t.version=r),t}}];t.default=s,e.exports=t.default}})},6882:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EStreamStatus=void 0,function(e){e.UNKNOWN="unknown",e.CONNECTING="connecting",e.LIVE="live",e.FINISHED="finished",e.ERRORED="errored"}(r||(t.EStreamStatus=r={}))},6912:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},6914:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EMediaStreamTrackState=void 0,function(e){e.LIVE="live",e.ENDED="ended"}(r||(t.EMediaStreamTrackState=r={}))},6967:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ELoadingState=void 0,function(e){e.UNKNOWN="unknown",e.LOADING="loading",e.LOADED="loaded",e.ABORTED="aborted",e.ERROR="error",e.DESTROYED="destroyed"}(r||(t.ELoadingState=r={}))},6972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBitratesToSDPLines=t.bitrateTypeToSDPParamMap=void 0,t.bitrateTypeToSDPParamMap={startBitrate:"x-google-start-bitrate",minBitrate:"x-google-min-bitrate",maxBitrate:"x-google-max-bitrate"},t.convertBitratesToSDPLines=e=>Object.entries(e).map(e=>{var[r,n]=e;return"".concat(t.bitrateTypeToSDPParamMap[r],"=").concat(n)}).join("; ")},6982:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableFragmentParserConfigValues=t.defaultFragmentParserConfig=void 0,t.defaultFragmentParserConfig={workerMode:!1},t.availableFragmentParserConfigValues={}},6984:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e,t){return e===t||e!=e&&t!=t}},6987:e=>{function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=6987,e.exports=t},6996:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r(4130),i=function(e,t){return(0,n.A)(e,t)}},7011:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LatencyController=void 0;var o=r(3518),s=r(2973),l=r(1649),u=i(r(5354)),c=r(426),d=r(8748),h=i(r(9372)),f="bypass",p="setCodec",v="setTimeSyncServer",g="h264",_="h265";class m extends o.ConfigConsumer{constructor(e,t){super("latencyControllerConfig",e),a(this,"_lastKnownDecodeBufferAmount",0),a(this,"_lastEstimationEmitTimeout",0),a(this,"_videoModifierWorker",null),a(this,"_workers",[]),a(this,"_timeSyncServerCache",""),a(this,"_cachedCodec",""),a(this,"_latencyEstimationEWMA",void 0),a(this,"_latencyEstimationMedian",new l.Median),a(this,"_timeSyncResyncInterval",-1),this._timeSyncResyncInterval=t,this._latencyEstimationEWMA=new s.EWMA(this.config.estimationFastAlpha,this.config.estimationSlowAlpha)}destroy(){super.destroy(),this._workers.forEach(e=>{e.terminate()}),this._workers=[]}_handleConfigUpdated(){}transformVideoSender(e){var t=(0,c.createInplaceWorker)(h.default,this._timeSyncResyncInterval);this._workers.push(t),this._createTransformer(t,e,"inprintTS"),this._videoModifierWorker=t}transformAudioSender(e){var t=(0,c.createInplaceWorker)(h.default,this._timeSyncResyncInterval);this._workers.push(t),this._createTransformer(t,e,f)}transformVideoReceiver(e){var t=(0,c.createInplaceWorker)(h.default,this._timeSyncResyncInterval);this._workers.push(t),this._createTransformer(t,e,"parseTS"),t.addEventListener("message",this._onWorkerMessage),this._videoModifierWorker=t}transformAudioReceiver(e){var t=(0,c.createInplaceWorker)(h.default,this._timeSyncResyncInterval);this._workers.push(t),this._createTransformer(t,e,f)}onRTCStatsReady(e){var{totalAssemblyTime:t,totalProcessingDelay:r,jitterBufferEmittedCount:n}=e;this._lastKnownDecodeBufferAmount=(r-t)/n*1e3}setVideoCodecs(e){var t;this._cachedCodec=e,null===(t=this._videoModifierWorker)||void 0===t||t.postMessage({operation:p,codec:e.toLowerCase().includes("265")?_:g})}setTimeSyncServer(e){var t;this._timeSyncServerCache=e,null===(t=this._videoModifierWorker)||void 0===t||t.postMessage({operation:v,url:e})}_onWorkerMessage(e){var t=e.data,r=t.receiveTimestamp-t.encodeTimestamp+this._lastKnownDecodeBufferAmount;this._latencyEstimationEWMA.addValue(r),this._latencyEstimationMedian.addValue(r),performance.now()-this._lastEstimationEmitTimeout>this.config.latencyEmitInterval&&(this._eventBus.publish(d.ELatencyControllerEvents.LATENCY_ESTIMATION_AVAILABLE,{latencyEstimationEWMA:this._latencyEstimationEWMA.getCurrentValue(),latencyEstimationMedian:this._latencyEstimationMedian.median}),this._lastEstimationEmitTimeout=performance.now(),this._latencyEstimationEWMA.reset(),this._latencyEstimationMedian.reset())}_createTransformer(e,t,r){if(this._timeSyncServerCache&&e.postMessage({operation:v,url:this._timeSyncServerCache}),this._cachedCodec&&e.postMessage({operation:p,codec:this._cachedCodec.toLowerCase().includes("265")?_:g}),window.RTCRtpScriptTransform)t.transform=new RTCRtpScriptTransform(e,{operation:r});else{var{readable:n,writable:i}=t.createEncodedStreams();e.postMessage({operation:r,source:n,sink:i},[n,i])}}}t.LatencyController=m,n([u.default],m.prototype,"_onWorkerMessage",null)},7028:(t,r,n)=>{n.d(r,{add:()=>f,after:()=>m,ary:()=>Oe,assign:()=>Ge,assignIn:()=>Ke,assignInWith:()=>Je,assignWith:()=>$e,at:()=>Tt,attempt:()=>Nt,before:()=>Bt,bind:()=>kt,bindAll:()=>xt,bindKey:()=>Ut,camelCase:()=>Ur,capitalize:()=>sr,castArray:()=>Vr,ceil:()=>Hr,chain:()=>qr,chunk:()=>Kr,clamp:()=>Jr,clone:()=>Dn,cloneDeep:()=>Nn,cloneDeepWith:()=>Bn,cloneWith:()=>jn,commit:()=>kn,compact:()=>xn,concat:()=>Fn,cond:()=>ei,conforms:()=>ri,conformsTo:()=>ni,constant:()=>ie,countBy:()=>fi,create:()=>pi,curry:()=>gi,curryRight:()=>mi,debounce:()=>yi.A,deburr:()=>hr,default:()=>Bh,defaultTo:()=>bi,defaults:()=>Ci,defaultsDeep:()=>Bi,defer:()=>xi,delay:()=>Ui,difference:()=>Hi,differenceBy:()=>Yi,differenceWith:()=>Qi,divide:()=>Ki,drop:()=>Xi,dropRight:()=>Ji,dropRightWhile:()=>$i,dropWhile:()=>eo,each:()=>ro,eachRight:()=>ao,endsWith:()=>lo,entries:()=>ho,entriesIn:()=>fo,eq:()=>Me.A,escape:()=>_o,escapeRegExp:()=>bo,every:()=>To,extend:()=>Ke,extendWith:()=>Je,fill:()=>Ao,filter:()=>Oo,find:()=>Io,findIndex:()=>wo,findKey:()=>No,findLast:()=>xo,findLastIndex:()=>ko,findLastKey:()=>Fo,first:()=>Uo,flatMap:()=>zo,flatMapDeep:()=>Ho,flatMapDepth:()=>qo,flatten:()=>Et,flattenDeep:()=>Qo,flattenDepth:()=>Ko,flip:()=>Xo,floor:()=>Jo,flow:()=>$o,flowRight:()=>es,forEach:()=>ro,forEachRight:()=>ao,forIn:()=>ts,forInRight:()=>rs,forOwn:()=>ns,forOwnRight:()=>is,fromPairs:()=>os,functions:()=>as,functionsIn:()=>ls,get:()=>pt,groupBy:()=>cs,gt:()=>fs,gte:()=>ps,has:()=>_s,hasIn:()=>Kn,head:()=>Uo,identity:()=>y,inRange:()=>bs,includes:()=>As,indexOf:()=>Rs,initial:()=>Os,intersection:()=>Is,intersectionBy:()=>Ds,intersectionWith:()=>Ns,invert:()=>ks,invertBy:()=>Vs,invoke:()=>Gs,invokeMap:()=>Hs,isArguments:()=>_t.A,isArray:()=>l.A,isArrayBuffer:()=>Ys,isArrayLike:()=>ke.A,isArrayLikeObject:()=>Pi,isBoolean:()=>Qs,isBuffer:()=>En.A,isDate:()=>Xs,isElement:()=>Js,isEmpty:()=>ea,isEqual:()=>ta.default,isEqualWith:()=>ra,isError:()=>It,isFinite:()=>ia,isFunction:()=>Ri.A,isInteger:()=>oa,isLength:()=>Yn.A,isMap:()=>An,isMatch:()=>sa,isMatchWith:()=>aa,isNaN:()=>ua,isNative:()=>pa,isNil:()=>va,isNull:()=>ga,isNumber:()=>la,isObject:()=>C.A,isObjectLike:()=>H.A,isPlainObject:()=>wt,isRegExp:()=>ma,isSafeInteger:()=>ya,isSet:()=>Rn,isString:()=>Es,isSymbol:()=>i.A,isTypedArray:()=>Oi.A,isUndefined:()=>ba,isWeakMap:()=>Ea,isWeakSet:()=>Sa,iteratee:()=>Ta,join:()=>Aa,kebabCase:()=>Pa,keyBy:()=>Ra,keys:()=>Ve.A,keysIn:()=>Ye,last:()=>qi,lastIndexOf:()=>Ma,lodash:()=>X,lowerCase:()=>wa,lowerFirst:()=>Ia,lt:()=>Na,lte:()=>Ba,map:()=>Wo,mapKeys:()=>ja,mapValues:()=>ka,matches:()=>xa,matchesProperty:()=>Fa,max:()=>Va,maxBy:()=>Wa,mean:()=>Ha,meanBy:()=>qa,memoize:()=>ot,merge:()=>Qa,mergeWith:()=>Ni,method:()=>Ka,methodOf:()=>Xa,min:()=>Ja,minBy:()=>Za,mixin:()=>$a,multiply:()=>el,negate:()=>tl,next:()=>ol,noop:()=>k,now:()=>sl.A,nth:()=>ll,nthArg:()=>ul,omit:()=>hl,omitBy:()=>gl,once:()=>_l,orderBy:()=>bl,over:()=>Sl,overArgs:()=>Pl,overEvery:()=>Rl,overSome:()=>Ll,pad:()=>Xl,padEnd:()=>Jl,padStart:()=>Zl,parseInt:()=>tu,partial:()=>nu,partialRight:()=>au,partition:()=>lu,pick:()=>uu,pickBy:()=>vl,plant:()=>cu,property:()=>Zn,propertyOf:()=>du,pull:()=>gu,pullAll:()=>vu,pullAllBy:()=>_u,pullAllWith:()=>mu,pullAt:()=>Eu,random:()=>Ou,range:()=>Iu,rangeRight:()=>Du,rearg:()=>Bu,reduce:()=>ku,reduceRight:()=>Fu,reject:()=>Uu,remove:()=>Vu,repeat:()=>Wu,replace:()=>zu,rest:()=>Gu,result:()=>Hu,reverse:()=>Yu,round:()=>Qu,sample:()=>Ju,sampleSize:()=>tc,set:()=>rc,setWith:()=>nc,shuffle:()=>sc,size:()=>ac,slice:()=>lc,snakeCase:()=>uc,some:()=>dc,sortBy:()=>hc,sortedIndex:()=>_c,sortedIndexBy:()=>mc,sortedIndexOf:()=>yc,sortedLastIndex:()=>bc,sortedLastIndexBy:()=>Ec,sortedLastIndexOf:()=>Sc,sortedUniq:()=>Cc,sortedUniqBy:()=>Ac,split:()=>Pc,spread:()=>Oc,startCase:()=>Lc,startsWith:()=>Mc,stubArray:()=>an.A,stubFalse:()=>ha.A,stubObject:()=>wc,stubString:()=>Ic,stubTrue:()=>Dc,subtract:()=>Nc,sum:()=>Bc,sumBy:()=>jc,tail:()=>kc,take:()=>xc,takeRight:()=>Fc,takeRightWhile:()=>Uc,takeWhile:()=>Vc,tap:()=>Wc,template:()=>id,templateSettings:()=>Kc,throttle:()=>od.default,thru:()=>sd,times:()=>cd,toArray:()=>il,toFinite:()=>g,toInteger:()=>_,toIterator:()=>dd,toJSON:()=>fd,toLength:()=>Co,toLower:()=>pd,toNumber:()=>p.A,toPairs:()=>ho,toPairsIn:()=>fo,toPath:()=>vd,toPlainObject:()=>Mi,toSafeInteger:()=>gd,toString:()=>ct,toUpper:()=>_d,transform:()=>md,trim:()=>Sd,trimEnd:()=>Cd,trimStart:()=>Pd,truncate:()=>Od,unary:()=>Ld,unescape:()=>Dd,union:()=>kd,unionBy:()=>xd,unionWith:()=>Fd,uniq:()=>Ud,uniqBy:()=>Vd,uniqWith:()=>Wd,uniqueId:()=>Gd,unset:()=>Hd,unzip:()=>Yd,unzipWith:()=>Qd,update:()=>Xd,updateWith:()=>Jd,upperCase:()=>Zd,upperFirst:()=>or,value:()=>fd,valueOf:()=>fd,values:()=>Ts,valuesIn:()=>$d,without:()=>eh,words:()=>kr,wrap:()=>th,wrapperAt:()=>rh,wrapperChain:()=>nh,wrapperCommit:()=>kn,wrapperLodash:()=>X,wrapperNext:()=>ol,wrapperPlant:()=>cu,wrapperReverse:()=>ih,wrapperToIterator:()=>dd,wrapperValue:()=>fd,xor:()=>sh,xorBy:()=>ah,xorWith:()=>lh,zip:()=>uh,zipObject:()=>dh,zipObjectDeep:()=>hh,zipWith:()=>fh}),n.r(r);var i=n(1882),o=function(e){return"number"==typeof e?e:(0,i.A)(e)?NaN:+e},s=n(241),a=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},l=n(2049),u=s.A?s.A.prototype:void 0,c=u?u.toString:void 0,d=function e(t){if("string"==typeof t)return t;if((0,l.A)(t))return a(t,e)+"";if((0,i.A)(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r},h=function(e,t){return function(r,n){var i;if(void 0===r&&void 0===n)return t;if(void 0!==r&&(i=r),void 0!==n){if(void 0===i)return n;"string"==typeof r||"string"==typeof n?(r=d(r),n=d(n)):(r=o(r),n=o(n)),i=e(r,n)}return i}},f=h(function(e,t){return e+t},0),p=n(1694),v=1/0,g=function(e){return e?(e=(0,p.A)(e))===v||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0},_=function(e){var t=g(e),r=t%1;return t==t?r?t-r:t:0},m=function(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=_(e),function(){if(--e<1)return t.apply(this,arguments)}},y=function(e){return e},b=n(3631),E=b.A&&new b.A,S=E?function(e,t){return E.set(e,t),e}:y,T=S,C=n(3149),A=Object.create,P=function(){function e(){}return function(t){if(!(0,C.A)(t))return{};if(A)return A(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),R=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=P(e.prototype),n=e.apply(r,t);return(0,C.A)(n)?n:r}},O=n(1917),L=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},M=Math.max,w=function(e,t,r,n){for(var i=-1,o=e.length,s=r.length,a=-1,l=t.length,u=M(o-s,0),c=Array(l+u),d=!n;++a<l;)c[a]=t[a];for(;++i<s;)(d||i<o)&&(c[r[i]]=e[i]);for(;u--;)c[a++]=e[i++];return c},I=Math.max,D=function(e,t,r,n){for(var i=-1,o=e.length,s=-1,a=r.length,l=-1,u=t.length,c=I(o-a,0),d=Array(c+u),h=!n;++i<c;)d[i]=e[i];for(var f=i;++l<u;)d[f+l]=t[l];for(;++s<a;)(h||i<o)&&(d[f+r[s]]=e[i++]);return d},N=function(){};function B(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}B.prototype=P(N.prototype),B.prototype.constructor=B;var j=B,k=function(){},x=E?function(e){return E.get(e)}:k,F=x,U={},V=Object.prototype.hasOwnProperty,W=function(e){for(var t=e.name+"",r=U[t],n=V.call(U,t)?r.length:0;n--;){var i=r[n],o=i.func;if(null==o||o==e)return i.name}return t};function z(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}z.prototype=P(N.prototype),z.prototype.constructor=z;var G=z,H=n(3098),q=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t},Y=function(e){if(e instanceof j)return e.clone();var t=new G(e.__wrapped__,e.__chain__);return t.__actions__=q(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t},Q=Object.prototype.hasOwnProperty;function K(e){if((0,H.A)(e)&&!(0,l.A)(e)&&!(e instanceof j)){if(e instanceof G)return e;if(Q.call(e,"__wrapped__"))return Y(e)}return new G(e)}K.prototype=N.prototype,K.prototype.constructor=K;var X=K,J=function(e){var t=W(e),r=X[t];if("function"!=typeof r||!(t in j.prototype))return!1;if(e===r)return!0;var n=F(r);return!!n&&e===n[0]},Z=Date.now,$=function(e){var t=0,r=0;return function(){var n=Z(),i=16-(n-r);if(r=n,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}},ee=$(T),te=/\{\n\/\* \[wrapped with (.+)\] \*/,re=/,? & /,ne=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ie=function(e){return function(){return e}},oe=n(124),se=function(){try{var e=(0,oe.A)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),ae=se,le=ae?function(e,t){return ae(e,"toString",{configurable:!0,enumerable:!1,value:ie(t),writable:!0})}:y,ue=$(le),ce=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},de=function(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1},he=function(e){return e!=e},fe=function(e,t,r){return t==t?function(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}(e,t,r):de(e,he,r)},pe=function(e,t){return!(null==e||!e.length)&&fe(e,t,0)>-1},ve=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],ge=function(e,t,r){var n=t+"";return ue(e,function(e,t){var r=t.length;if(!r)return e;var n=r-1;return t[n]=(r>1?"& ":"")+t[n],t=t.join(r>2?", ":" "),e.replace(ne,"{\n/* [wrapped with "+t+"] */\n")}(n,function(e,t){return ce(ve,function(r){var n="_."+r[0];t&r[1]&&!pe(e,n)&&e.push(n)}),e.sort()}(function(e){var t=e.match(te);return t?t[1].split(re):[]}(n),r)))},_e=function(e,t,r,n,i,o,s,a,l,u){var c=8&t;t|=c?32:64,4&(t&=~(c?64:32))||(t&=-4);var d=[e,t,i,c?o:void 0,c?s:void 0,c?void 0:o,c?void 0:s,a,l,u],h=r.apply(void 0,d);return J(e)&&ee(h,d),h.placeholder=n,ge(h,e,t)},me=function(e){return e.placeholder},ye=n(5353),be=Math.min,Ee="__lodash_placeholder__",Se=function(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var s=e[r];s!==t&&s!==Ee||(e[r]=Ee,o[i++]=r)}return o},Te=function e(t,r,n,i,o,s,a,l,u,c){var d=128&r,h=1&r,f=2&r,p=24&r,v=512&r,g=f?void 0:R(t);return function _(){for(var m=arguments.length,y=Array(m),b=m;b--;)y[b]=arguments[b];if(p)var E=me(_),S=function(e,t){for(var r=e.length,n=0;r--;)e[r]===t&&++n;return n}(y,E);if(i&&(y=w(y,i,o,p)),s&&(y=D(y,s,a,p)),m-=S,p&&m<c){var T=Se(y,E);return _e(t,r,e,_.placeholder,n,y,T,l,u,c-m)}var C=h?n:this,A=f?C[t]:t;return m=y.length,l?y=function(e,t){for(var r=e.length,n=be(t.length,r),i=q(e);n--;){var o=t[n];e[n]=(0,ye.A)(o,r)?i[o]:void 0}return e}(y,l):v&&m>1&&y.reverse(),d&&u<m&&(y.length=u),this&&this!==O.A&&this instanceof _&&(A=g||R(A)),A.apply(C,y)}},Ce="__lodash_placeholder__",Ae=Math.min,Pe=Math.max,Re=function(e,t,r,n,i,o,s,a){var l=2&t;if(!l&&"function"!=typeof e)throw new TypeError("Expected a function");var u=n?n.length:0;if(u||(t&=-97,n=i=void 0),s=void 0===s?s:Pe(_(s),0),a=void 0===a?a:_(a),u-=i?i.length:0,64&t){var c=n,d=i;n=i=void 0}var h=l?void 0:F(e),f=[e,t,r,n,i,c,d,o,s,a];if(h&&function(e,t){var r=e[1],n=t[1],i=r|n,o=i<131,s=128==n&&8==r||128==n&&256==r&&e[7].length<=t[8]||384==n&&t[7].length<=t[8]&&8==r;if(!o&&!s)return e;1&n&&(e[2]=t[2],i|=1&r?0:4);var a=t[3];if(a){var l=e[3];e[3]=l?w(l,a,t[4]):a,e[4]=l?Se(e[3],Ce):t[4]}(a=t[5])&&(l=e[5],e[5]=l?D(l,a,t[6]):a,e[6]=l?Se(e[5],Ce):t[6]),(a=t[7])&&(e[7]=a),128&n&&(e[8]=null==e[8]?t[8]:Ae(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(f,h),e=f[0],t=f[1],r=f[2],n=f[3],i=f[4],!(a=f[9]=void 0===f[9]?l?0:e.length:Pe(f[9]-u,0))&&24&t&&(t&=-25),t&&1!=t)p=8==t||16==t?function(e,t,r){var n=R(e);return function i(){for(var o=arguments.length,s=Array(o),a=o,l=me(i);a--;)s[a]=arguments[a];var u=o<3&&s[0]!==l&&s[o-1]!==l?[]:Se(s,l);if((o-=u.length)<r)return _e(e,t,Te,i.placeholder,void 0,s,u,void 0,void 0,r-o);var c=this&&this!==O.A&&this instanceof i?n:e;return L(c,this,s)}}(e,t,a):32!=t&&33!=t||i.length?Te.apply(void 0,f):function(e,t,r,n){var i=1&t,o=R(e);return function t(){for(var s=-1,a=arguments.length,l=-1,u=n.length,c=Array(u+a),d=this&&this!==O.A&&this instanceof t?o:e;++l<u;)c[l]=n[l];for(;a--;)c[l++]=arguments[++s];return L(d,i?r:this,c)}}(e,t,r,n);else var p=function(e,t,r){var n=1&t,i=R(e);return function t(){return(this&&this!==O.A&&this instanceof t?i:e).apply(n?r:this,arguments)}}(e,t,r);return ge((h?T:ee)(p,f),e,t)},Oe=function(e,t,r){return t=r?void 0:t,t=e&&null==t?e.length:t,Re(e,128,void 0,void 0,void 0,void 0,t)},Le=function(e,t,r){"__proto__"==t&&ae?ae(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Me=n(6984),we=Object.prototype.hasOwnProperty,Ie=function(e,t,r){var n=e[t];we.call(e,t)&&(0,Me.A)(n,r)&&(void 0!==r||t in e)||Le(e,t,r)},De=function(e,t,r,n){var i=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=n?n(r[a],e[a],a,r,e):void 0;void 0===l&&(l=e[a]),i?Le(r,a,l):Ie(r,a,l)}return r},Ne=Math.max,Be=function(e,t,r){return t=Ne(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=Ne(n.length-t,0),s=Array(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),L(e,this,a)}},je=function(e,t){return ue(Be(e,t,y),e+"")},ke=n(8446),xe=function(e,t,r){if(!(0,C.A)(r))return!1;var n=typeof t;return!!("number"==n?(0,ke.A)(r)&&(0,ye.A)(t,r.length):"string"==n&&t in r)&&(0,Me.A)(r[t],e)},Fe=function(e){return je(function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&xe(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var a=r[n];a&&e(t,a,n,o)}return t})},Ue=n(7271),Ve=n(7422),We=Object.prototype.hasOwnProperty,ze=Fe(function(e,t){if((0,Ue.A)(t)||(0,ke.A)(t))De(t,(0,Ve.A)(t),e);else for(var r in t)We.call(t,r)&&Ie(e,r,t[r])}),Ge=ze,He=n(423),qe=Object.prototype.hasOwnProperty,Ye=function(e){return(0,ke.A)(e)?(0,He.A)(e,!0):function(e){if(!(0,C.A)(e))return function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}(e);var t=(0,Ue.A)(e),r=[];for(var n in e)("constructor"!=n||!t&&qe.call(e,n))&&r.push(n);return r}(e)},Qe=Fe(function(e,t){De(t,Ye(t),e)}),Ke=Qe,Xe=Fe(function(e,t,r,n){De(t,Ye(t),e,n)}),Je=Xe,Ze=Fe(function(e,t,r,n){De(t,(0,Ve.A)(t),e,n)}),$e=Ze,et=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,tt=/^\w*$/,rt=function(e,t){if((0,l.A)(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!(0,i.A)(e))||tt.test(e)||!et.test(e)||null!=t&&e in Object(t)},nt=n(2050);function it(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(it.Cache||nt.A),r}it.Cache=nt.A;var ot=it,st=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,at=/\\(\\)?/g,lt=function(){var e=ot(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(st,function(e,r,n,i){t.push(n?i.replace(at,"$1"):r||e)}),t},function(e){return 500===t.size&&t.clear(),e}),t=e.cache;return e}(),ut=lt,ct=function(e){return null==e?"":d(e)},dt=function(e,t){return(0,l.A)(e)?e:rt(e,t)?[e]:ut(ct(e))},ht=function(e){if("string"==typeof e||(0,i.A)(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},ft=function(e,t){for(var r=0,n=(t=dt(t,e)).length;null!=e&&r<n;)e=e[ht(t[r++])];return r&&r==n?e:void 0},pt=function(e,t,r){var n=null==e?void 0:ft(e,t);return void 0===n?r:n},vt=function(e,t){for(var r=-1,n=t.length,i=Array(n),o=null==e;++r<n;)i[r]=o?void 0:pt(e,t[r]);return i},gt=n(6912),_t=n(5175),mt=s.A?s.A.isConcatSpreadable:void 0,yt=function(e){return(0,l.A)(e)||(0,_t.A)(e)||!!(mt&&e&&e[mt])},bt=function e(t,r,n,i,o){var s=-1,a=t.length;for(n||(n=yt),o||(o=[]);++s<a;){var l=t[s];r>0&&n(l)?r>1?e(l,r-1,n,i,o):(0,gt.A)(o,l):i||(o[o.length]=l)}return o},Et=function(e){return null!=e&&e.length?bt(e,1):[]},St=function(e){return ue(Be(e,void 0,Et),e+"")},Tt=St(vt),Ct=n(2383),At=(0,n(367).A)(Object.getPrototypeOf,Object),Pt=Function.prototype,Rt=Object.prototype,Ot=Pt.toString,Lt=Rt.hasOwnProperty,Mt=Ot.call(Object),wt=function(e){if(!(0,H.A)(e)||"[object Object]"!=(0,Ct.A)(e))return!1;var t=At(e);if(null===t)return!0;var r=Lt.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&Ot.call(r)==Mt},It=function(e){if(!(0,H.A)(e))return!1;var t=(0,Ct.A)(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!wt(e)},Dt=je(function(e,t){try{return L(e,void 0,t)}catch(e){return It(e)?e:new Error(e)}}),Nt=Dt,Bt=function(e,t){var r;if("function"!=typeof t)throw new TypeError("Expected a function");return e=_(e),function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}},jt=je(function(e,t,r){var n=1;if(r.length){var i=Se(r,me(jt));n|=32}return Re(e,n,t,r,i)});jt.placeholder={};var kt=jt,xt=St(function(e,t){return ce(t,function(t){t=ht(t),Le(e,t,kt(e[t],e))}),e}),Ft=je(function(e,t,r){var n=3;if(r.length){var i=Se(r,me(Ft));n|=32}return Re(t,n,e,r,i)});Ft.placeholder={};var Ut=Ft,Vt=function(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(r=r>i?i:r)<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o},Wt=function(e,t,r){var n=e.length;return r=void 0===r?n:r,!t&&r>=n?e:Vt(e,t,r)},zt=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]"),Gt=function(e){return zt.test(e)},Ht="\\ud800-\\udfff",qt="["+Ht+"]",Yt="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Qt="\\ud83c[\\udffb-\\udfff]",Kt="[^"+Ht+"]",Xt="(?:\\ud83c[\\udde6-\\uddff]){2}",Jt="[\\ud800-\\udbff][\\udc00-\\udfff]",Zt="(?:"+Yt+"|"+Qt+")?",$t="[\\ufe0e\\ufe0f]?",er=$t+Zt+"(?:\\u200d(?:"+[Kt,Xt,Jt].join("|")+")"+$t+Zt+")*",tr="(?:"+[Kt+Yt+"?",Yt,Xt,Jt,qt].join("|")+")",rr=RegExp(Qt+"(?="+Qt+")|"+tr+er,"g"),nr=function(e){return Gt(e)?function(e){return e.match(rr)||[]}(e):function(e){return e.split("")}(e)},ir=function(e){return function(t){t=ct(t);var r=Gt(t)?nr(t):void 0,n=r?r[0]:t.charAt(0),i=r?Wt(r,1).join(""):t.slice(1);return n[e]()+i}},or=ir("toUpperCase"),sr=function(e){return or(ct(e).toLowerCase())},ar=function(e,t,r,n){var i=-1,o=null==e?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r},lr=function(e){return function(t){return null==e?void 0:e[t]}},ur=lr({"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss","":"A","":"A","":"A","":"a","":"a","":"a","":"C","":"C","":"C","":"C","":"c","":"c","":"c","":"c","":"D","":"D","":"d","":"d","":"E","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"e","":"G","":"G","":"G","":"G","":"g","":"g","":"g","":"g","":"H","":"H","":"h","":"h","":"I","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"i","":"J","":"j","":"K","":"k","":"k","":"L","":"L","":"L","":"L","":"L","":"l","":"l","":"l","":"l","":"l","":"N","":"N","":"N","":"N","":"n","":"n","":"n","":"n","":"O","":"O","":"O","":"o","":"o","":"o","":"R","":"R","":"R","":"r","":"r","":"r","":"S","":"S","":"S","":"S","":"s","":"s","":"s","":"s","":"T","":"T","":"T","":"t","":"t","":"t","":"U","":"U","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"u","":"u","":"W","":"w","":"Y","":"y","":"Y","":"Z","":"Z","":"Z","":"z","":"z","":"z","":"IJ","":"ij","":"Oe","":"oe","":"'n","":"s"}),cr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,dr=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g"),hr=function(e){return(e=ct(e))&&e.replace(cr,ur).replace(dr,"")},fr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,pr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,vr="\\ud800-\\udfff",gr="\\u2700-\\u27bf",_r="a-z\\xdf-\\xf6\\xf8-\\xff",mr="A-Z\\xc0-\\xd6\\xd8-\\xde",yr="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",br="["+yr+"]",Er="\\d+",Sr="["+gr+"]",Tr="["+_r+"]",Cr="[^"+vr+yr+Er+gr+_r+mr+"]",Ar="(?:\\ud83c[\\udde6-\\uddff]){2}",Pr="[\\ud800-\\udbff][\\udc00-\\udfff]",Rr="["+mr+"]",Or="(?:"+Tr+"|"+Cr+")",Lr="(?:"+Rr+"|"+Cr+")",Mr="(?:['](?:d|ll|m|re|s|t|ve))?",wr="(?:['](?:D|LL|M|RE|S|T|VE))?",Ir="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Dr="[\\ufe0e\\ufe0f]?",Nr=Dr+Ir+"(?:\\u200d(?:"+["[^"+vr+"]",Ar,Pr].join("|")+")"+Dr+Ir+")*",Br="(?:"+[Sr,Ar,Pr].join("|")+")"+Nr,jr=RegExp([Rr+"?"+Tr+"+"+Mr+"(?="+[br,Rr,"$"].join("|")+")",Lr+"+"+wr+"(?="+[br,Rr+Or,"$"].join("|")+")",Rr+"?"+Or+"+"+Mr,Rr+"+"+wr,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Er,Br].join("|"),"g"),kr=function(e,t,r){return e=ct(e),void 0===(t=r?void 0:t)?function(e){return pr.test(e)}(e)?function(e){return e.match(jr)||[]}(e):function(e){return e.match(fr)||[]}(e):e.match(t)||[]},xr=RegExp("[']","g"),Fr=function(e){return function(t){return ar(kr(hr(t).replace(xr,"")),e,"")}},Ur=Fr(function(e,t,r){return t=t.toLowerCase(),e+(r?sr(t):t)}),Vr=function(){if(!arguments.length)return[];var e=arguments[0];return(0,l.A)(e)?e:[e]},Wr=O.A.isFinite,zr=Math.min,Gr=function(e){var t=Math[e];return function(e,r){if(e=(0,p.A)(e),(r=null==r?0:zr(_(r),292))&&Wr(e)){var n=(ct(e)+"e").split("e"),i=t(n[0]+"e"+(+n[1]+r));return+((n=(ct(i)+"e").split("e"))[0]+"e"+(+n[1]-r))}return t(e)}},Hr=Gr("ceil"),qr=function(e){var t=X(e);return t.__chain__=!0,t},Yr=Math.ceil,Qr=Math.max,Kr=function(e,t,r){t=(r?xe(e,t,r):void 0===t)?1:Qr(_(t),0);var n=null==e?0:e.length;if(!n||t<1)return[];for(var i=0,o=0,s=Array(Yr(n/t));i<n;)s[o++]=Vt(e,i,i+=t);return s},Xr=function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e},Jr=function(e,t,r){return void 0===r&&(r=t,t=void 0),void 0!==r&&(r=(r=(0,p.A)(r))==r?r:0),void 0!==t&&(t=(t=(0,p.A)(t))==t?t:0),Xr((0,p.A)(e),t,r)},Zr=n(2080),$r=function(e,t){return e&&De(t,(0,Ve.A)(t),e)},en="object"==typeof exports&&exports&&!exports.nodeType&&exports,tn=en&&e&&!e.nodeType&&e,rn=tn&&tn.exports===en?O.A.Buffer:void 0,nn=rn?rn.allocUnsafe:void 0,on=function(e,t){if(t)return e.slice();var r=e.length,n=nn?nn(r):new e.constructor(r);return e.copy(n),n},sn=n(4792),an=n(3153),ln=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)(0,gt.A)(t,(0,sn.A)(e)),e=At(e);return t}:an.A,un=n(9042),cn=n(3831),dn=function(e){return(0,cn.A)(e,Ye,ln)},hn=n(7803),fn=Object.prototype.hasOwnProperty,pn=n(3988),vn=function(e){var t=new e.constructor(e.byteLength);return new pn.A(t).set(new pn.A(e)),t},gn=/\w*$/,_n=s.A?s.A.prototype:void 0,mn=_n?_n.valueOf:void 0,yn=function(e,t){var r=t?vn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},bn=function(e){return"function"!=typeof e.constructor||(0,Ue.A)(e)?{}:P(At(e))},En=n(4616),Sn=n(2789),Tn=n(4841),Cn=Tn.A&&Tn.A.isMap,An=Cn?(0,Sn.A)(Cn):function(e){return(0,H.A)(e)&&"[object Map]"==(0,hn.A)(e)},Pn=Tn.A&&Tn.A.isSet,Rn=Pn?(0,Sn.A)(Pn):function(e){return(0,H.A)(e)&&"[object Set]"==(0,hn.A)(e)},On="[object Arguments]",Ln="[object Function]",Mn="[object Object]",wn={};wn[On]=wn["[object Array]"]=wn["[object ArrayBuffer]"]=wn["[object DataView]"]=wn["[object Boolean]"]=wn["[object Date]"]=wn["[object Float32Array]"]=wn["[object Float64Array]"]=wn["[object Int8Array]"]=wn["[object Int16Array]"]=wn["[object Int32Array]"]=wn["[object Map]"]=wn["[object Number]"]=wn[Mn]=wn["[object RegExp]"]=wn["[object Set]"]=wn["[object String]"]=wn["[object Symbol]"]=wn["[object Uint8Array]"]=wn["[object Uint8ClampedArray]"]=wn["[object Uint16Array]"]=wn["[object Uint32Array]"]=!0,wn["[object Error]"]=wn[Ln]=wn["[object WeakMap]"]=!1;var In=function e(t,r,n,i,o,s){var a,u=1&r,c=2&r,d=4&r;if(n&&(a=o?n(t,i,o,s):n(t)),void 0!==a)return a;if(!(0,C.A)(t))return t;var h=(0,l.A)(t);if(h){if(a=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&fn.call(e,"index")&&(r.index=e.index,r.input=e.input),r}(t),!u)return q(t,a)}else{var f=(0,hn.A)(t),p=f==Ln||"[object GeneratorFunction]"==f;if((0,En.A)(t))return on(t,u);if(f==Mn||f==On||p&&!o){if(a=c||p?{}:bn(t),!u)return c?function(e,t){return De(e,ln(e),t)}(t,function(e,t){return e&&De(t,Ye(t),e)}(a,t)):function(e,t){return De(e,(0,sn.A)(e),t)}(t,$r(a,t))}else{if(!wn[f])return o?t:{};a=function(e,t,r){var n,i,o,s=e.constructor;switch(t){case"[object ArrayBuffer]":return vn(e);case"[object Boolean]":case"[object Date]":return new s(+e);case"[object DataView]":return function(e,t){var r=t?vn(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return yn(e,r);case"[object Map]":case"[object Set]":return new s;case"[object Number]":case"[object String]":return new s(e);case"[object RegExp]":return(o=new(i=e).constructor(i.source,gn.exec(i))).lastIndex=i.lastIndex,o;case"[object Symbol]":return n=e,mn?Object(mn.call(n)):{}}}(t,f,u)}}s||(s=new Zr.A);var v=s.get(t);if(v)return v;s.set(t,a),Rn(t)?t.forEach(function(i){a.add(e(i,r,n,i,t,s))}):An(t)&&t.forEach(function(i,o){a.set(o,e(i,r,n,o,t,s))});var g=d?c?dn:un.A:c?Ye:Ve.A,_=h?void 0:g(t);return ce(_||t,function(i,o){_&&(i=t[o=i]),Ie(a,o,e(i,r,n,o,t,s))}),a},Dn=function(e){return In(e,4)},Nn=function(e){return In(e,5)},Bn=function(e,t){return In(e,5,t="function"==typeof t?t:void 0)},jn=function(e,t){return In(e,4,t="function"==typeof t?t:void 0)},kn=function(){return new G(this.value(),this.__chain__)},xn=function(e){for(var t=-1,r=null==e?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i},Fn=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),r=arguments[0],n=e;n--;)t[n-1]=arguments[n];return(0,gt.A)((0,l.A)(r)?q(r):[r],bt(t,1))},Un=n(4130),Vn=function(e,t,r,n){var i=r.length,o=i,s=!n;if(null==e)return!o;for(e=Object(e);i--;){var a=r[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var l=(a=r[i])[0],u=e[l],c=a[1];if(s&&a[2]){if(void 0===u&&!(l in e))return!1}else{var d=new Zr.A;if(n)var h=n(u,c,l,e,t,d);if(!(void 0===h?(0,Un.A)(c,u,3,n,d):h))return!1}}return!0},Wn=function(e){return e==e&&!(0,C.A)(e)},zn=function(e){for(var t=(0,Ve.A)(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,Wn(i)]}return t},Gn=function(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}},Hn=function(e){var t=zn(e);return 1==t.length&&t[0][2]?Gn(t[0][0],t[0][1]):function(r){return r===e||Vn(r,e,t)}},qn=function(e,t){return null!=e&&t in Object(e)},Yn=n(5254),Qn=function(e,t,r){for(var n=-1,i=(t=dt(t,e)).length,o=!1;++n<i;){var s=ht(t[n]);if(!(o=null!=e&&r(e,s)))break;e=e[s]}return o||++n!=i?o:!!(i=null==e?0:e.length)&&(0,Yn.A)(i)&&(0,ye.A)(s,i)&&((0,l.A)(e)||(0,_t.A)(e))},Kn=function(e,t){return null!=e&&Qn(e,t,qn)},Xn=function(e,t){return rt(e)&&Wn(t)?Gn(ht(e),t):function(r){var n=pt(r,e);return void 0===n&&n===t?Kn(r,e):(0,Un.A)(t,n,3)}},Jn=function(e){return function(t){return null==t?void 0:t[e]}},Zn=function(e){return rt(e)?Jn(ht(e)):function(e){return function(t){return ft(t,e)}}(e)},$n=function(e){return"function"==typeof e?e:null==e?y:"object"==typeof e?(0,l.A)(e)?Xn(e[0],e[1]):Hn(e):Zn(e)},ei=function(e){var t=null==e?0:e.length,r=$n;return e=t?a(e,function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return[r(e[0]),e[1]]}):[],je(function(r){for(var n=-1;++n<t;){var i=e[n];if(L(i[0],this,r))return L(i[1],this,r)}})},ti=function(e,t,r){var n=r.length;if(null==e)return!n;for(e=Object(e);n--;){var i=r[n],o=t[i],s=e[i];if(void 0===s&&!(i in e)||!o(s))return!1}return!0},ri=function(e){return function(e){var t=(0,Ve.A)(e);return function(r){return ti(r,e,t)}}(In(e,1))},ni=function(e,t){return null==t||ti(e,t,(0,Ve.A)(t))},ii=function(e,t,r,n){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(n,s,r(s),e)}return n},oi=function(e){return function(t,r,n){for(var i=-1,o=Object(t),s=n(t),a=s.length;a--;){var l=s[e?a:++i];if(!1===r(o[l],l,o))break}return t}},si=oi(),ai=function(e,t){return e&&si(e,t,Ve.A)},li=function(e,t){return function(r,n){if(null==r)return r;if(!(0,ke.A)(r))return e(r,n);for(var i=r.length,o=t?i:-1,s=Object(r);(t?o--:++o<i)&&!1!==n(s[o],o,s););return r}},ui=li(ai),ci=function(e,t,r,n){return ui(e,function(e,i,o){t(n,e,r(e),o)}),n},di=function(e,t){return function(r,n){var i=(0,l.A)(r)?ii:ci,o=t?t():{};return i(r,e,$n(n),o)}},hi=Object.prototype.hasOwnProperty,fi=di(function(e,t,r){hi.call(e,r)?++e[r]:Le(e,r,1)}),pi=function(e,t){var r=P(e);return null==t?r:$r(r,t)};function vi(e,t,r){var n=Re(e,8,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=vi.placeholder,n}vi.placeholder={};var gi=vi;function _i(e,t,r){var n=Re(e,16,void 0,void 0,void 0,void 0,void 0,t=r?void 0:t);return n.placeholder=_i.placeholder,n}_i.placeholder={};var mi=_i,yi=n(3549),bi=function(e,t){return null==e||e!=e?t:e},Ei=Object.prototype,Si=Ei.hasOwnProperty,Ti=je(function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&xe(t[0],t[1],i)&&(n=1);++r<n;)for(var o=t[r],s=Ye(o),a=-1,l=s.length;++a<l;){var u=s[a],c=e[u];(void 0===c||(0,Me.A)(c,Ei[u])&&!Si.call(e,u))&&(e[u]=o[u])}return e}),Ci=Ti,Ai=function(e,t,r){(void 0!==r&&!(0,Me.A)(e[t],r)||void 0===r&&!(t in e))&&Le(e,t,r)},Pi=function(e){return(0,H.A)(e)&&(0,ke.A)(e)},Ri=n(9610),Oi=n(4749),Li=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},Mi=function(e){return De(e,Ye(e))},wi=function e(t,r,n,i,o){t!==r&&si(r,function(s,a){if(o||(o=new Zr.A),(0,C.A)(s))!function(e,t,r,n,i,o,s){var a=Li(e,r),u=Li(t,r),c=s.get(u);if(c)Ai(e,r,c);else{var d=o?o(a,u,r+"",e,t,s):void 0,h=void 0===d;if(h){var f=(0,l.A)(u),p=!f&&(0,En.A)(u),v=!f&&!p&&(0,Oi.A)(u);d=u,f||p||v?(0,l.A)(a)?d=a:Pi(a)?d=q(a):p?(h=!1,d=on(u,!0)):v?(h=!1,d=yn(u,!0)):d=[]:wt(u)||(0,_t.A)(u)?(d=a,(0,_t.A)(a)?d=Mi(a):(0,C.A)(a)&&!(0,Ri.A)(a)||(d=bn(u))):h=!1}h&&(s.set(u,d),i(d,u,n,o,s),s.delete(u)),Ai(e,r,d)}}(t,r,a,n,e,i,o);else{var u=i?i(Li(t,a),s,a+"",t,r,o):void 0;void 0===u&&(u=s),Ai(t,a,u)}},Ye)},Ii=function e(t,r,n,i,o,s){return(0,C.A)(t)&&(0,C.A)(r)&&(s.set(r,t),wi(t,r,void 0,e,s),s.delete(r)),t},Di=Fe(function(e,t,r,n){wi(e,t,r,n)}),Ni=Di,Bi=je(function(e){return e.push(void 0,Ii),L(Ni,void 0,e)}),ji=function(e,t,r){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout(function(){e.apply(void 0,r)},t)},ki=je(function(e,t){return ji(e,1,t)}),xi=ki,Fi=je(function(e,t,r){return ji(e,(0,p.A)(t)||0,r)}),Ui=Fi,Vi=n(8300),Wi=function(e,t,r){for(var n=-1,i=null==e?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1},zi=n(4099),Gi=function(e,t,r,n){var i=-1,o=pe,s=!0,l=e.length,u=[],c=t.length;if(!l)return u;r&&(t=a(t,(0,Sn.A)(r))),n?(o=Wi,s=!1):t.length>=200&&(o=zi.A,s=!1,t=new Vi.A(t));e:for(;++i<l;){var d=e[i],h=null==r?d:r(d);if(d=n||0!==d?d:0,s&&h==h){for(var f=c;f--;)if(t[f]===h)continue e;u.push(d)}else o(t,h,n)||u.push(d)}return u},Hi=je(function(e,t){return Pi(e)?Gi(e,bt(t,1,Pi,!0)):[]}),qi=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},Yi=je(function(e,t){var r=qi(t);return Pi(r)&&(r=void 0),Pi(e)?Gi(e,bt(t,1,Pi,!0),$n(r)):[]}),Qi=je(function(e,t){var r=qi(t);return Pi(r)&&(r=void 0),Pi(e)?Gi(e,bt(t,1,Pi,!0),void 0,r):[]}),Ki=h(function(e,t){return e/t},1),Xi=function(e,t,r){var n=null==e?0:e.length;return n?(t=r||void 0===t?1:_(t),Vt(e,t<0?0:t,n)):[]},Ji=function(e,t,r){var n=null==e?0:e.length;return n?(t=r||void 0===t?1:_(t),Vt(e,0,(t=n-t)<0?0:t)):[]},Zi=function(e,t,r,n){for(var i=e.length,o=n?i:-1;(n?o--:++o<i)&&t(e[o],o,e););return r?Vt(e,n?0:o,n?o+1:i):Vt(e,n?o+1:0,n?i:o)},$i=function(e,t){return e&&e.length?Zi(e,$n(t),!0,!0):[]},eo=function(e,t){return e&&e.length?Zi(e,$n(t),!0):[]},to=function(e){return"function"==typeof e?e:y},ro=function(e,t){return((0,l.A)(e)?ce:ui)(e,to(t))},no=function(e,t){for(var r=null==e?0:e.length;r--&&!1!==t(e[r],r,e););return e},io=oi(!0),oo=function(e,t){return e&&io(e,t,Ve.A)},so=li(oo,!0),ao=function(e,t){return((0,l.A)(e)?no:so)(e,to(t))},lo=function(e,t,r){e=ct(e),t=d(t);var n=e.length,i=r=void 0===r?n:Xr(_(r),0,n);return(r-=t.length)>=0&&e.slice(r,i)==t},uo=n(4877),co=function(e){return function(t){var r,n,i,o=(0,hn.A)(t);return"[object Map]"==o?(0,uo.A)(t):"[object Set]"==o?(r=t,n=-1,i=Array(r.size),r.forEach(function(e){i[++n]=[e,e]}),i):function(e,t){return a(t,function(t){return[t,e[t]]})}(t,e(t))}},ho=co(Ve.A),fo=co(Ye),po=lr({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),vo=/[&<>"']/g,go=RegExp(vo.source),_o=function(e){return(e=ct(e))&&go.test(e)?e.replace(vo,po):e},mo=/[\\^$.*+?()[\]{}|]/g,yo=RegExp(mo.source),bo=function(e){return(e=ct(e))&&yo.test(e)?e.replace(mo,"\\$&"):e},Eo=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0},So=function(e,t){var r=!0;return ui(e,function(e,n,i){return r=!!t(e,n,i)}),r},To=function(e,t,r){var n=(0,l.A)(e)?Eo:So;return r&&xe(e,t,r)&&(t=void 0),n(e,$n(t))},Co=function(e){return e?Xr(_(e),0,4294967295):0},Ao=function(e,t,r,n){var i=null==e?0:e.length;return i?(r&&"number"!=typeof r&&xe(e,t,r)&&(r=0,n=i),function(e,t,r,n){var i=e.length;for((r=_(r))<0&&(r=-r>i?0:i+r),(n=void 0===n||n>i?i:_(n))<0&&(n+=i),n=r>n?0:Co(n);r<n;)e[r++]=t;return e}(e,t,r,n)):[]},Po=n(2634),Ro=function(e,t){var r=[];return ui(e,function(e,n,i){t(e,n,i)&&r.push(e)}),r},Oo=function(e,t){return((0,l.A)(e)?Po.A:Ro)(e,$n(t))},Lo=function(e){return function(t,r,n){var i=Object(t);if(!(0,ke.A)(t)){var o=$n(r);t=(0,Ve.A)(t),r=function(e){return o(i[e],e,i)}}var s=e(t,r,n);return s>-1?i[o?t[s]:s]:void 0}},Mo=Math.max,wo=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:_(r);return i<0&&(i=Mo(n+i,0)),de(e,$n(t),i)},Io=Lo(wo),Do=function(e,t,r){var n;return r(e,function(e,r,i){if(t(e,r,i))return n=r,!1}),n},No=function(e,t){return Do(e,$n(t),ai)},Bo=Math.max,jo=Math.min,ko=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n-1;return void 0!==r&&(i=_(r),i=r<0?Bo(n+i,0):jo(i,n-1)),de(e,$n(t),i,!0)},xo=Lo(ko),Fo=function(e,t){return Do(e,$n(t),oo)},Uo=function(e){return e&&e.length?e[0]:void 0},Vo=function(e,t){var r=-1,n=(0,ke.A)(e)?Array(e.length):[];return ui(e,function(e,i,o){n[++r]=t(e,i,o)}),n},Wo=function(e,t){return((0,l.A)(e)?a:Vo)(e,$n(t))},zo=function(e,t){return bt(Wo(e,t),1)},Go=1/0,Ho=function(e,t){return bt(Wo(e,t),Go)},qo=function(e,t,r){return r=void 0===r?1:_(r),bt(Wo(e,t),r)},Yo=1/0,Qo=function(e){return null!=e&&e.length?bt(e,Yo):[]},Ko=function(e,t){return null!=e&&e.length?(t=void 0===t?1:_(t),bt(e,t)):[]},Xo=function(e){return Re(e,512)},Jo=Gr("floor"),Zo=function(e){return St(function(t){var r=t.length,n=r,i=G.prototype.thru;for(e&&t.reverse();n--;){var o=t[n];if("function"!=typeof o)throw new TypeError("Expected a function");if(i&&!s&&"wrapper"==W(o))var s=new G([],!0)}for(n=s?n:r;++n<r;){o=t[n];var a=W(o),u="wrapper"==a?F(o):void 0;s=u&&J(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?s[W(u[0])].apply(s,u[3]):1==o.length&&J(o)?s[a]():s.thru(o)}return function(){var e=arguments,n=e[0];if(s&&1==e.length&&(0,l.A)(n))return s.plant(n).value();for(var i=0,o=r?t[i].apply(this,e):n;++i<r;)o=t[i].call(this,o);return o}})},$o=Zo(),es=Zo(!0),ts=function(e,t){return null==e?e:si(e,to(t),Ye)},rs=function(e,t){return null==e?e:io(e,to(t),Ye)},ns=function(e,t){return e&&ai(e,to(t))},is=function(e,t){return e&&oo(e,to(t))},os=function(e){for(var t=-1,r=null==e?0:e.length,n={};++t<r;){var i=e[t];n[i[0]]=i[1]}return n},ss=function(e,t){return(0,Po.A)(t,function(t){return(0,Ri.A)(e[t])})},as=function(e){return null==e?[]:ss(e,(0,Ve.A)(e))},ls=function(e){return null==e?[]:ss(e,Ye(e))},us=Object.prototype.hasOwnProperty,cs=di(function(e,t,r){us.call(e,r)?e[r].push(t):Le(e,r,[t])}),ds=function(e,t){return e>t},hs=function(e){return function(t,r){return"string"==typeof t&&"string"==typeof r||(t=(0,p.A)(t),r=(0,p.A)(r)),e(t,r)}},fs=hs(ds),ps=hs(function(e,t){return e>=t}),vs=Object.prototype.hasOwnProperty,gs=function(e,t){return null!=e&&vs.call(e,t)},_s=function(e,t){return null!=e&&Qn(e,t,gs)},ms=Math.max,ys=Math.min,bs=function(e,t,r){return t=g(t),void 0===r?(r=t,t=0):r=g(r),function(e,t,r){return e>=ys(t,r)&&e<ms(t,r)}(e=(0,p.A)(e),t,r)},Es=function(e){return"string"==typeof e||!(0,l.A)(e)&&(0,H.A)(e)&&"[object String]"==(0,Ct.A)(e)},Ss=function(e,t){return a(t,function(t){return e[t]})},Ts=function(e){return null==e?[]:Ss(e,(0,Ve.A)(e))},Cs=Math.max,As=function(e,t,r,n){e=(0,ke.A)(e)?e:Ts(e),r=r&&!n?_(r):0;var i=e.length;return r<0&&(r=Cs(i+r,0)),Es(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&fe(e,t,r)>-1},Ps=Math.max,Rs=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=null==r?0:_(r);return i<0&&(i=Ps(n+i,0)),fe(e,t,i)},Os=function(e){return null!=e&&e.length?Vt(e,0,-1):[]},Ls=Math.min,Ms=function(e,t,r){for(var n=r?Wi:pe,i=e[0].length,o=e.length,s=o,l=Array(o),u=1/0,c=[];s--;){var d=e[s];s&&t&&(d=a(d,(0,Sn.A)(t))),u=Ls(d.length,u),l[s]=!r&&(t||i>=120&&d.length>=120)?new Vi.A(s&&d):void 0}d=e[0];var h=-1,f=l[0];e:for(;++h<i&&c.length<u;){var p=d[h],v=t?t(p):p;if(p=r||0!==p?p:0,!(f?(0,zi.A)(f,v):n(c,v,r))){for(s=o;--s;){var g=l[s];if(!(g?(0,zi.A)(g,v):n(e[s],v,r)))continue e}f&&f.push(v),c.push(p)}}return c},ws=function(e){return Pi(e)?e:[]},Is=je(function(e){var t=a(e,ws);return t.length&&t[0]===e[0]?Ms(t):[]}),Ds=je(function(e){var t=qi(e),r=a(e,ws);return t===qi(r)?t=void 0:r.pop(),r.length&&r[0]===e[0]?Ms(r,$n(t)):[]}),Ns=je(function(e){var t=qi(e),r=a(e,ws);return(t="function"==typeof t?t:void 0)&&r.pop(),r.length&&r[0]===e[0]?Ms(r,void 0,t):[]}),Bs=function(e,t){return function(r,n){return function(e,t,r,n){return ai(e,function(e,i,o){t(n,r(e),i,o)}),n}(r,e,t(n),{})}},js=Object.prototype.toString,ks=Bs(function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=js.call(t)),e[t]=r},ie(y)),xs=Object.prototype,Fs=xs.hasOwnProperty,Us=xs.toString,Vs=Bs(function(e,t,r){null!=t&&"function"!=typeof t.toString&&(t=Us.call(t)),Fs.call(e,t)?e[t].push(r):e[t]=[r]},$n),Ws=function(e,t){return t.length<2?e:ft(e,Vt(t,0,-1))},zs=function(e,t,r){t=dt(t,e);var n=null==(e=Ws(e,t))?e:e[ht(qi(t))];return null==n?void 0:L(n,e,r)},Gs=je(zs),Hs=je(function(e,t,r){var n=-1,i="function"==typeof t,o=(0,ke.A)(e)?Array(e.length):[];return ui(e,function(e){o[++n]=i?L(t,e,r):zs(e,t,r)}),o}),qs=Tn.A&&Tn.A.isArrayBuffer,Ys=qs?(0,Sn.A)(qs):function(e){return(0,H.A)(e)&&"[object ArrayBuffer]"==(0,Ct.A)(e)},Qs=function(e){return!0===e||!1===e||(0,H.A)(e)&&"[object Boolean]"==(0,Ct.A)(e)},Ks=Tn.A&&Tn.A.isDate,Xs=Ks?(0,Sn.A)(Ks):function(e){return(0,H.A)(e)&&"[object Date]"==(0,Ct.A)(e)},Js=function(e){return(0,H.A)(e)&&1===e.nodeType&&!wt(e)},Zs=n(4453),$s=Object.prototype.hasOwnProperty,ea=function(e){if(null==e)return!0;if((0,ke.A)(e)&&((0,l.A)(e)||"string"==typeof e||"function"==typeof e.splice||(0,En.A)(e)||(0,Oi.A)(e)||(0,_t.A)(e)))return!e.length;var t=(0,hn.A)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if((0,Ue.A)(e))return!(0,Zs.A)(e).length;for(var r in e)if($s.call(e,r))return!1;return!0},ta=n(6996),ra=function(e,t,r){var n=(r="function"==typeof r?r:void 0)?r(e,t):void 0;return void 0===n?(0,Un.A)(e,t,void 0,r):!!n},na=O.A.isFinite,ia=function(e){return"number"==typeof e&&na(e)},oa=function(e){return"number"==typeof e&&e==_(e)},sa=function(e,t){return e===t||Vn(e,t,zn(t))},aa=function(e,t,r){return r="function"==typeof r?r:void 0,Vn(e,t,zn(t),r)},la=function(e){return"number"==typeof e||(0,H.A)(e)&&"[object Number]"==(0,Ct.A)(e)},ua=function(e){return la(e)&&e!=+e},ca=n(7949),da=n(3161),ha=n(4639),fa=da.A?Ri.A:ha.A,pa=function(e){if(fa(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return(0,ca.A)(e)},va=function(e){return null==e},ga=function(e){return null===e},_a=Tn.A&&Tn.A.isRegExp,ma=_a?(0,Sn.A)(_a):function(e){return(0,H.A)(e)&&"[object RegExp]"==(0,Ct.A)(e)},ya=function(e){return oa(e)&&e>=-9007199254740991&&e<=9007199254740991},ba=function(e){return void 0===e},Ea=function(e){return(0,H.A)(e)&&"[object WeakMap]"==(0,hn.A)(e)},Sa=function(e){return(0,H.A)(e)&&"[object WeakSet]"==(0,Ct.A)(e)},Ta=function(e){return $n("function"==typeof e?e:In(e,1))},Ca=Array.prototype.join,Aa=function(e,t){return null==e?"":Ca.call(e,t)},Pa=Fr(function(e,t,r){return e+(r?"-":"")+t.toLowerCase()}),Ra=di(function(e,t,r){Le(e,r,t)}),Oa=Math.max,La=Math.min,Ma=function(e,t,r){var n=null==e?0:e.length;if(!n)return-1;var i=n;return void 0!==r&&(i=(i=_(r))<0?Oa(n+i,0):La(i,n-1)),t==t?function(e,t,r){for(var n=r+1;n--;)if(e[n]===t)return n;return n}(e,t,i):de(e,he,i,!0)},wa=Fr(function(e,t,r){return e+(r?" ":"")+t.toLowerCase()}),Ia=ir("toLowerCase"),Da=function(e,t){return e<t},Na=hs(Da),Ba=hs(function(e,t){return e<=t}),ja=function(e,t){var r={};return t=$n(t),ai(e,function(e,n,i){Le(r,t(e,n,i),e)}),r},ka=function(e,t){var r={};return t=$n(t),ai(e,function(e,n,i){Le(r,n,t(e,n,i))}),r},xa=function(e){return Hn(In(e,1))},Fa=function(e,t){return Xn(e,In(t,1))},Ua=function(e,t,r){for(var n=-1,o=e.length;++n<o;){var s=e[n],a=t(s);if(null!=a&&(void 0===l?a==a&&!(0,i.A)(a):r(a,l)))var l=a,u=s}return u},Va=function(e){return e&&e.length?Ua(e,y,ds):void 0},Wa=function(e,t){return e&&e.length?Ua(e,$n(t),ds):void 0},za=function(e,t){for(var r,n=-1,i=e.length;++n<i;){var o=t(e[n]);void 0!==o&&(r=void 0===r?o:r+o)}return r},Ga=function(e,t){var r=null==e?0:e.length;return r?za(e,t)/r:NaN},Ha=function(e){return Ga(e,y)},qa=function(e,t){return Ga(e,$n(t))},Ya=Fe(function(e,t,r){wi(e,t,r)}),Qa=Ya,Ka=je(function(e,t){return function(r){return zs(r,e,t)}}),Xa=je(function(e,t){return function(r){return zs(e,r,t)}}),Ja=function(e){return e&&e.length?Ua(e,y,Da):void 0},Za=function(e,t){return e&&e.length?Ua(e,$n(t),Da):void 0},$a=function(e,t,r){var n=(0,Ve.A)(t),i=ss(t,n),o=!((0,C.A)(r)&&"chain"in r&&!r.chain),s=(0,Ri.A)(e);return ce(i,function(r){var n=t[r];e[r]=n,s&&(e.prototype[r]=function(){var t=this.__chain__;if(o||t){var r=e(this.__wrapped__);return(r.__actions__=q(this.__actions__)).push({func:n,args:arguments,thisArg:e}),r.__chain__=t,r}return n.apply(e,(0,gt.A)([this.value()],arguments))})}),e},el=h(function(e,t){return e*t},1),tl=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},rl=n(9959),nl=s.A?s.A.iterator:void 0,il=function(e){if(!e)return[];if((0,ke.A)(e))return Es(e)?nr(e):q(e);if(nl&&e[nl])return function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r}(e[nl]());var t=(0,hn.A)(e);return("[object Map]"==t?uo.A:"[object Set]"==t?rl.A:Ts)(e)},ol=function(){void 0===this.__values__&&(this.__values__=il(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},sl=n(1052),al=function(e,t){var r=e.length;if(r)return t+=t<0?r:0,(0,ye.A)(t,r)?e[t]:void 0},ll=function(e,t){return e&&e.length?al(e,_(t)):void 0},ul=function(e){return e=_(e),je(function(t){return al(t,e)})},cl=function(e,t){return t=dt(t,e),null==(e=Ws(e,t))||delete e[ht(qi(t))]},dl=function(e){return wt(e)?void 0:e},hl=St(function(e,t){var r={};if(null==e)return r;var n=!1;t=a(t,function(t){return t=dt(t,e),n||(n=t.length>1),t}),De(e,dn(e),r),n&&(r=In(r,7,dl));for(var i=t.length;i--;)cl(r,t[i]);return r}),fl=function(e,t,r,n){if(!(0,C.A)(e))return e;for(var i=-1,o=(t=dt(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var l=ht(t[i]),u=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=s){var c=a[l];void 0===(u=n?n(c,l,a):void 0)&&(u=(0,C.A)(c)?c:(0,ye.A)(t[i+1])?[]:{})}Ie(a,l,u),a=a[l]}return e},pl=function(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var s=t[n],a=ft(e,s);r(a,s)&&fl(o,dt(s,e),a)}return o},vl=function(e,t){if(null==e)return{};var r=a(dn(e),function(e){return[e]});return t=$n(t),pl(e,r,function(e,r){return t(e,r[0])})},gl=function(e,t){return vl(e,tl($n(t)))},_l=function(e){return Bt(2,e)},ml=function(e,t){if(e!==t){var r=void 0!==e,n=null===e,o=e==e,s=(0,i.A)(e),a=void 0!==t,l=null===t,u=t==t,c=(0,i.A)(t);if(!l&&!c&&!s&&e>t||s&&a&&u&&!l&&!c||n&&a&&u||!r&&u||!o)return 1;if(!n&&!s&&!c&&e<t||c&&r&&o&&!n&&!s||l&&r&&o||!a&&o||!u)return-1}return 0},yl=function(e,t,r){t=t.length?a(t,function(e){return(0,l.A)(e)?function(t){return ft(t,1===e.length?e[0]:e)}:e}):[y];var n=-1;return t=a(t,(0,Sn.A)($n)),function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}(Vo(e,function(e,r,i){return{criteria:a(t,function(t){return t(e)}),index:++n,value:e}}),function(e,t){return function(e,t,r){for(var n=-1,i=e.criteria,o=t.criteria,s=i.length,a=r.length;++n<s;){var l=ml(i[n],o[n]);if(l)return n>=a?l:l*("desc"==r[n]?-1:1)}return e.index-t.index}(e,t,r)})},bl=function(e,t,r,n){return null==e?[]:((0,l.A)(t)||(t=null==t?[]:[t]),r=n?void 0:r,(0,l.A)(r)||(r=null==r?[]:[r]),yl(e,t,r))},El=function(e){return St(function(t){return t=a(t,(0,Sn.A)($n)),je(function(r){var n=this;return e(t,function(e){return L(e,n,r)})})})},Sl=El(a),Tl=je,Cl=Math.min,Al=Tl(function(e,t){var r=(t=1==t.length&&(0,l.A)(t[0])?a(t[0],(0,Sn.A)($n)):a(bt(t,1),(0,Sn.A)($n))).length;return je(function(n){for(var i=-1,o=Cl(n.length,r);++i<o;)n[i]=t[i].call(this,n[i]);return L(e,this,n)})}),Pl=Al,Rl=El(Eo),Ol=n(3736),Ll=El(Ol.A),Ml=Math.floor,wl=function(e,t){var r="";if(!e||t<1||t>9007199254740991)return r;do{t%2&&(r+=e),(t=Ml(t/2))&&(e+=e)}while(t);return r},Il=Jn("length"),Dl="\\ud800-\\udfff",Nl="["+Dl+"]",Bl="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",jl="\\ud83c[\\udffb-\\udfff]",kl="[^"+Dl+"]",xl="(?:\\ud83c[\\udde6-\\uddff]){2}",Fl="[\\ud800-\\udbff][\\udc00-\\udfff]",Ul="(?:"+Bl+"|"+jl+")?",Vl="[\\ufe0e\\ufe0f]?",Wl=Vl+Ul+"(?:\\u200d(?:"+[kl,xl,Fl].join("|")+")"+Vl+Ul+")*",zl="(?:"+[kl+Bl+"?",Bl,xl,Fl,Nl].join("|")+")",Gl=RegExp(jl+"(?="+jl+")|"+zl+Wl,"g"),Hl=function(e){return Gt(e)?function(e){for(var t=Gl.lastIndex=0;Gl.test(e);)++t;return t}(e):Il(e)},ql=Math.ceil,Yl=function(e,t){var r=(t=void 0===t?" ":d(t)).length;if(r<2)return r?wl(t,e):t;var n=wl(t,ql(e/Hl(t)));return Gt(t)?Wt(nr(n),0,e).join(""):n.slice(0,e)},Ql=Math.ceil,Kl=Math.floor,Xl=function(e,t,r){e=ct(e);var n=(t=_(t))?Hl(e):0;if(!t||n>=t)return e;var i=(t-n)/2;return Yl(Kl(i),r)+e+Yl(Ql(i),r)},Jl=function(e,t,r){e=ct(e);var n=(t=_(t))?Hl(e):0;return t&&n<t?e+Yl(t-n,r):e},Zl=function(e,t,r){e=ct(e);var n=(t=_(t))?Hl(e):0;return t&&n<t?Yl(t-n,r)+e:e},$l=/^\s+/,eu=O.A.parseInt,tu=function(e,t,r){return r||null==t?t=0:t&&(t=+t),eu(ct(e).replace($l,""),t||0)},ru=je(function(e,t){var r=Se(t,me(ru));return Re(e,32,void 0,t,r)});ru.placeholder={};var nu=ru,iu=je(function(e,t){var r=Se(t,me(iu));return Re(e,64,void 0,t,r)});iu.placeholder={};var ou,su,au=iu,lu=di(function(e,t,r){e[r?0:1].push(t)},function(){return[[],[]]}),uu=St(function(e,t){return null==e?{}:function(e,t){return pl(e,t,function(t,r){return Kn(e,r)})}(e,t)}),cu=function(e){for(var t,r=this;r instanceof N;){var n=Y(r);n.__index__=0,n.__values__=void 0,t?i.__wrapped__=n:t=n;var i=n;r=r.__wrapped__}return i.__wrapped__=e,t},du=function(e){return function(t){return null==e?void 0:ft(e,t)}},hu=function(e,t,r,n){for(var i=r-1,o=e.length;++i<o;)if(n(e[i],t))return i;return-1},fu=Array.prototype.splice,pu=function(e,t,r,n){var i=n?hu:fe,o=-1,s=t.length,l=e;for(e===t&&(t=q(t)),r&&(l=a(e,(0,Sn.A)(r)));++o<s;)for(var u=0,c=t[o],d=r?r(c):c;(u=i(l,d,u,n))>-1;)l!==e&&fu.call(l,u,1),fu.call(e,u,1);return e},vu=function(e,t){return e&&e.length&&t&&t.length?pu(e,t):e},gu=je(vu),_u=function(e,t,r){return e&&e.length&&t&&t.length?pu(e,t,$n(r)):e},mu=function(e,t,r){return e&&e.length&&t&&t.length?pu(e,t,void 0,r):e},yu=Array.prototype.splice,bu=function(e,t){for(var r=e?t.length:0,n=r-1;r--;){var i=t[r];if(r==n||i!==o){var o=i;(0,ye.A)(i)?yu.call(e,i,1):cl(e,i)}}return e},Eu=St(function(e,t){var r=null==e?0:e.length,n=vt(e,t);return bu(e,a(t,function(e){return(0,ye.A)(e,r)?+e:e}).sort(ml)),n}),Su=Math.floor,Tu=Math.random,Cu=function(e,t){return e+Su(Tu()*(t-e+1))},Au=parseFloat,Pu=Math.min,Ru=Math.random,Ou=function(e,t,r){if(r&&"boolean"!=typeof r&&xe(e,t,r)&&(t=r=void 0),void 0===r&&("boolean"==typeof t?(r=t,t=void 0):"boolean"==typeof e&&(r=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=g(e),void 0===t?(t=e,e=0):t=g(t)),e>t){var n=e;e=t,t=n}if(r||e%1||t%1){var i=Ru();return Pu(e+i*(t-e+Au("1e-"+((i+"").length-1))),t)}return Cu(e,t)},Lu=Math.ceil,Mu=Math.max,wu=function(e){return function(t,r,n){return n&&"number"!=typeof n&&xe(t,r,n)&&(r=n=void 0),t=g(t),void 0===r?(r=t,t=0):r=g(r),function(e,t,r,n){for(var i=-1,o=Mu(Lu((t-e)/(r||1)),0),s=Array(o);o--;)s[n?o:++i]=e,e+=r;return s}(t,r,n=void 0===n?t<r?1:-1:g(n),e)}},Iu=wu(),Du=wu(!0),Nu=St(function(e,t){return Re(e,256,void 0,void 0,void 0,t)}),Bu=Nu,ju=function(e,t,r,n,i){return i(e,function(e,i,o){r=n?(n=!1,e):t(r,e,i,o)}),r},ku=function(e,t,r){var n=(0,l.A)(e)?ar:ju,i=arguments.length<3;return n(e,$n(t),r,i,ui)},xu=function(e,t,r,n){var i=null==e?0:e.length;for(n&&i&&(r=e[--i]);i--;)r=t(r,e[i],i,e);return r},Fu=function(e,t,r){var n=(0,l.A)(e)?xu:ju,i=arguments.length<3;return n(e,$n(t),r,i,so)},Uu=function(e,t){return((0,l.A)(e)?Po.A:Ro)(e,tl($n(t)))},Vu=function(e,t){var r=[];if(!e||!e.length)return r;var n=-1,i=[],o=e.length;for(t=$n(t);++n<o;){var s=e[n];t(s,n,e)&&(r.push(s),i.push(n))}return bu(e,i),r},Wu=function(e,t,r){return t=(r?xe(e,t,r):void 0===t)?1:_(t),wl(ct(e),t)},zu=function(){var e=arguments,t=ct(e[0]);return e.length<3?t:t.replace(e[1],e[2])},Gu=function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=void 0===t?t:_(t),je(e,t)},Hu=function(e,t,r){var n=-1,i=(t=dt(t,e)).length;for(i||(i=1,e=void 0);++n<i;){var o=null==e?void 0:e[ht(t[n])];void 0===o&&(n=i,o=r),e=(0,Ri.A)(o)?o.call(e):o}return e},qu=Array.prototype.reverse,Yu=function(e){return null==e?e:qu.call(e)},Qu=Gr("round"),Ku=function(e){var t=e.length;return t?e[Cu(0,t-1)]:void 0},Xu=function(e){return Ku(Ts(e))},Ju=function(e){return((0,l.A)(e)?Ku:Xu)(e)},Zu=function(e,t){var r=-1,n=e.length,i=n-1;for(t=void 0===t?n:t;++r<t;){var o=Cu(r,i),s=e[o];e[o]=e[r],e[r]=s}return e.length=t,e},$u=function(e,t){return Zu(q(e),Xr(t,0,e.length))},ec=function(e,t){var r=Ts(e);return Zu(r,Xr(t,0,r.length))},tc=function(e,t,r){return t=(r?xe(e,t,r):void 0===t)?1:_(t),((0,l.A)(e)?$u:ec)(e,t)},rc=function(e,t,r){return null==e?e:fl(e,t,r)},nc=function(e,t,r,n){return n="function"==typeof n?n:void 0,null==e?e:fl(e,t,r,n)},ic=function(e){return Zu(q(e))},oc=function(e){return Zu(Ts(e))},sc=function(e){return((0,l.A)(e)?ic:oc)(e)},ac=function(e){if(null==e)return 0;if((0,ke.A)(e))return Es(e)?Hl(e):e.length;var t=(0,hn.A)(e);return"[object Map]"==t||"[object Set]"==t?e.size:(0,Zs.A)(e).length},lc=function(e,t,r){var n=null==e?0:e.length;return n?(r&&"number"!=typeof r&&xe(e,t,r)?(t=0,r=n):(t=null==t?0:_(t),r=void 0===r?n:_(r)),Vt(e,t,r)):[]},uc=Fr(function(e,t,r){return e+(r?"_":"")+t.toLowerCase()}),cc=function(e,t){var r;return ui(e,function(e,n,i){return!(r=t(e,n,i))}),!!r},dc=function(e,t,r){var n=(0,l.A)(e)?Ol.A:cc;return r&&xe(e,t,r)&&(t=void 0),n(e,$n(t))},hc=je(function(e,t){if(null==e)return[];var r=t.length;return r>1&&xe(e,t[0],t[1])?t=[]:r>2&&xe(t[0],t[1],t[2])&&(t=[t[0]]),yl(e,bt(t,1),[])}),fc=Math.floor,pc=Math.min,vc=function(e,t,r,n){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=r(t))!=t,l=null===t,u=(0,i.A)(t),c=void 0===t;o<s;){var d=fc((o+s)/2),h=r(e[d]),f=void 0!==h,p=null===h,v=h==h,g=(0,i.A)(h);if(a)var _=n||v;else _=c?v&&(n||f):l?v&&f&&(n||!p):u?v&&f&&!p&&(n||!g):!p&&!g&&(n?h<=t:h<t);_?o=d+1:s=d}return pc(s,4294967294)},gc=function(e,t,r){var n=0,o=null==e?n:e.length;if("number"==typeof t&&t==t&&o<=2147483647){for(;n<o;){var s=n+o>>>1,a=e[s];null!==a&&!(0,i.A)(a)&&(r?a<=t:a<t)?n=s+1:o=s}return o}return vc(e,t,y,r)},_c=function(e,t){return gc(e,t)},mc=function(e,t,r){return vc(e,t,$n(r))},yc=function(e,t){var r=null==e?0:e.length;if(r){var n=gc(e,t);if(n<r&&(0,Me.A)(e[n],t))return n}return-1},bc=function(e,t){return gc(e,t,!0)},Ec=function(e,t,r){return vc(e,t,$n(r),!0)},Sc=function(e,t){if(null!=e&&e.length){var r=gc(e,t,!0)-1;if((0,Me.A)(e[r],t))return r}return-1},Tc=function(e,t){for(var r=-1,n=e.length,i=0,o=[];++r<n;){var s=e[r],a=t?t(s):s;if(!r||!(0,Me.A)(a,l)){var l=a;o[i++]=0===s?0:s}}return o},Cc=function(e){return e&&e.length?Tc(e):[]},Ac=function(e,t){return e&&e.length?Tc(e,$n(t)):[]},Pc=function(e,t,r){return r&&"number"!=typeof r&&xe(e,t,r)&&(t=r=void 0),(r=void 0===r?4294967295:r>>>0)?(e=ct(e))&&("string"==typeof t||null!=t&&!ma(t))&&!(t=d(t))&&Gt(e)?Wt(nr(e),0,r):e.split(t,r):[]},Rc=Math.max,Oc=function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:Rc(_(t),0),je(function(r){var n=r[t],i=Wt(r,0,t);return n&&(0,gt.A)(i,n),L(e,this,i)})},Lc=Fr(function(e,t,r){return e+(r?" ":"")+or(t)}),Mc=function(e,t,r){return e=ct(e),r=null==r?0:Xr(_(r),0,e.length),t=d(t),e.slice(r,r+t.length)==t},wc=function(){return{}},Ic=function(){return""},Dc=function(){return!0},Nc=h(function(e,t){return e-t},0),Bc=function(e){return e&&e.length?za(e,y):0},jc=function(e,t){return e&&e.length?za(e,$n(t)):0},kc=function(e){var t=null==e?0:e.length;return t?Vt(e,1,t):[]},xc=function(e,t,r){return e&&e.length?(t=r||void 0===t?1:_(t),Vt(e,0,t<0?0:t)):[]},Fc=function(e,t,r){var n=null==e?0:e.length;return n?(t=r||void 0===t?1:_(t),Vt(e,(t=n-t)<0?0:t,n)):[]},Uc=function(e,t){return e&&e.length?Zi(e,$n(t),!1,!0):[]},Vc=function(e,t){return e&&e.length?Zi(e,$n(t)):[]},Wc=function(e,t){return t(e),e},zc=Object.prototype,Gc=zc.hasOwnProperty,Hc=function(e,t,r,n){return void 0===e||(0,Me.A)(e,zc[r])&&!Gc.call(n,r)?t:e},qc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Yc=function(e){return"\\"+qc[e]},Qc=/<%=([\s\S]+?)%>/g,Kc={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:Qc,variable:"",imports:{_:{escape:_o}}},Xc=/\b__p \+= '';/g,Jc=/\b(__p \+=) '' \+/g,Zc=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$c=/[()=,{}\[\]\/\s]/,ed=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,td=/($^)/,rd=/['\n\r\u2028\u2029\\]/g,nd=Object.prototype.hasOwnProperty,id=function(e,t,r){var n=Kc.imports._.templateSettings||Kc;r&&xe(e,t,r)&&(t=void 0),e=ct(e),t=Je({},t,n,Hc);var i,o,s=Je({},t.imports,n.imports,Hc),a=(0,Ve.A)(s),l=Ss(s,a),u=0,c=t.interpolate||td,d="__p += '",h=RegExp((t.escape||td).source+"|"+c.source+"|"+(c===Qc?ed:td).source+"|"+(t.evaluate||td).source+"|$","g"),f=nd.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(h,function(t,r,n,s,a,l){return n||(n=s),d+=e.slice(u,l).replace(rd,Yc),r&&(i=!0,d+="' +\n__e("+r+") +\n'"),a&&(o=!0,d+="';\n"+a+";\n__p += '"),n&&(d+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),u=l+t.length,t}),d+="';\n";var p=nd.call(t,"variable")&&t.variable;if(p){if($c.test(p))throw new Error("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(o?d.replace(Xc,""):d).replace(Jc,"$1").replace(Zc,"$1;"),d="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var v=Nt(function(){return Function(a,f+"return "+d).apply(void 0,l)});if(v.source=d,It(v))throw v;return v},od=n(4022),sd=function(e,t){return t(e)},ad=n(9520),ld=4294967295,ud=Math.min,cd=function(e,t){if((e=_(e))<1||e>9007199254740991)return[];var r=ld,n=ud(e,ld);t=to(t),e-=ld;for(var i=(0,ad.A)(n,t);++r<e;)t(r);return i},dd=function(){return this},hd=function(e,t){var r=e;return r instanceof j&&(r=r.value()),ar(t,function(e,t){return t.func.apply(t.thisArg,(0,gt.A)([e],t.args))},r)},fd=function(){return hd(this.__wrapped__,this.__actions__)},pd=function(e){return ct(e).toLowerCase()},vd=function(e){return(0,l.A)(e)?a(e,ht):(0,i.A)(e)?[e]:q(ut(ct(e)))},gd=function(e){return e?Xr(_(e),-9007199254740991,9007199254740991):0===e?e:0},_d=function(e){return ct(e).toUpperCase()},md=function(e,t,r){var n=(0,l.A)(e),i=n||(0,En.A)(e)||(0,Oi.A)(e);if(t=$n(t),null==r){var o=e&&e.constructor;r=i?n?new o:[]:(0,C.A)(e)&&(0,Ri.A)(o)?P(At(e)):{}}return(i?ce:ai)(e,function(e,n,i){return t(r,e,n,i)}),r},yd=n(5488),bd=function(e,t){for(var r=e.length;r--&&fe(t,e[r],0)>-1;);return r},Ed=function(e,t){for(var r=-1,n=e.length;++r<n&&fe(t,e[r],0)>-1;);return r},Sd=function(e,t,r){if((e=ct(e))&&(r||void 0===t))return(0,yd.A)(e);if(!e||!(t=d(t)))return e;var n=nr(e),i=nr(t),o=Ed(n,i),s=bd(n,i)+1;return Wt(n,o,s).join("")},Td=n(7880),Cd=function(e,t,r){if((e=ct(e))&&(r||void 0===t))return e.slice(0,(0,Td.A)(e)+1);if(!e||!(t=d(t)))return e;var n=nr(e),i=bd(n,nr(t))+1;return Wt(n,0,i).join("")},Ad=/^\s+/,Pd=function(e,t,r){if((e=ct(e))&&(r||void 0===t))return e.replace(Ad,"");if(!e||!(t=d(t)))return e;var n=nr(e),i=Ed(n,nr(t));return Wt(n,i).join("")},Rd=/\w*$/,Od=function(e,t){var r=30,n="...";if((0,C.A)(t)){var i="separator"in t?t.separator:i;r="length"in t?_(t.length):r,n="omission"in t?d(t.omission):n}var o=(e=ct(e)).length;if(Gt(e)){var s=nr(e);o=s.length}if(r>=o)return e;var a=r-Hl(n);if(a<1)return n;var l=s?Wt(s,0,a).join(""):e.slice(0,a);if(void 0===i)return l+n;if(s&&(a+=l.length-a),ma(i)){if(e.slice(a).search(i)){var u,c=l;for(i.global||(i=RegExp(i.source,ct(Rd.exec(i))+"g")),i.lastIndex=0;u=i.exec(c);)var h=u.index;l=l.slice(0,void 0===h?a:h)}}else if(e.indexOf(d(i),a)!=a){var f=l.lastIndexOf(i);f>-1&&(l=l.slice(0,f))}return l+n},Ld=function(e){return Oe(e,1)},Md=lr({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),wd=/&(?:amp|lt|gt|quot|#39);/g,Id=RegExp(wd.source),Dd=function(e){return(e=ct(e))&&Id.test(e)?e.replace(wd,Md):e},Nd=n(9857),Bd=Nd.A&&1/(0,rl.A)(new Nd.A([,-0]))[1]==1/0?function(e){return new Nd.A(e)}:k,jd=function(e,t,r){var n=-1,i=pe,o=e.length,s=!0,a=[],l=a;if(r)s=!1,i=Wi;else if(o>=200){var u=t?null:Bd(e);if(u)return(0,rl.A)(u);s=!1,i=zi.A,l=new Vi.A}else l=t?[]:a;e:for(;++n<o;){var c=e[n],d=t?t(c):c;if(c=r||0!==c?c:0,s&&d==d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),a.push(c)}else i(l,d,r)||(l!==a&&l.push(d),a.push(c))}return a},kd=je(function(e){return jd(bt(e,1,Pi,!0))}),xd=je(function(e){var t=qi(e);return Pi(t)&&(t=void 0),jd(bt(e,1,Pi,!0),$n(t))}),Fd=je(function(e){var t=qi(e);return t="function"==typeof t?t:void 0,jd(bt(e,1,Pi,!0),void 0,t)}),Ud=function(e){return e&&e.length?jd(e):[]},Vd=function(e,t){return e&&e.length?jd(e,$n(t)):[]},Wd=function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?jd(e,void 0,t):[]},zd=0,Gd=function(e){var t=++zd;return ct(e)+t},Hd=function(e,t){return null==e||cl(e,t)},qd=Math.max,Yd=function(e){if(!e||!e.length)return[];var t=0;return e=(0,Po.A)(e,function(e){if(Pi(e))return t=qd(e.length,t),!0}),(0,ad.A)(t,function(t){return a(e,Jn(t))})},Qd=function(e,t){if(!e||!e.length)return[];var r=Yd(e);return null==t?r:a(r,function(e){return L(t,void 0,e)})},Kd=function(e,t,r,n){return fl(e,t,r(ft(e,t)),n)},Xd=function(e,t,r){return null==e?e:Kd(e,t,to(r))},Jd=function(e,t,r,n){return n="function"==typeof n?n:void 0,null==e?e:Kd(e,t,to(r),n)},Zd=Fr(function(e,t,r){return e+(r?" ":"")+t.toUpperCase()}),$d=function(e){return null==e?[]:Ss(e,Ye(e))},eh=je(function(e,t){return Pi(e)?Gi(e,t):[]}),th=function(e,t){return nu(to(t),e)},rh=St(function(e){var t=e.length,r=t?e[0]:0,n=this.__wrapped__,i=function(t){return vt(t,e)};return!(t>1||this.__actions__.length)&&n instanceof j&&(0,ye.A)(r)?((n=n.slice(r,+r+(t?1:0))).__actions__.push({func:sd,args:[i],thisArg:void 0}),new G(n,this.__chain__).thru(function(e){return t&&!e.length&&e.push(void 0),e})):this.thru(i)}),nh=function(){return qr(this)},ih=function(){var e=this.__wrapped__;if(e instanceof j){var t=e;return this.__actions__.length&&(t=new j(this)),(t=t.reverse()).__actions__.push({func:sd,args:[Yu],thisArg:void 0}),new G(t,this.__chain__)}return this.thru(Yu)},oh=function(e,t,r){var n=e.length;if(n<2)return n?jd(e[0]):[];for(var i=-1,o=Array(n);++i<n;)for(var s=e[i],a=-1;++a<n;)a!=i&&(o[i]=Gi(o[i]||s,e[a],t,r));return jd(bt(o,1),t,r)},sh=je(function(e){return oh((0,Po.A)(e,Pi))}),ah=je(function(e){var t=qi(e);return Pi(t)&&(t=void 0),oh((0,Po.A)(e,Pi),$n(t))}),lh=je(function(e){var t=qi(e);return t="function"==typeof t?t:void 0,oh((0,Po.A)(e,Pi),void 0,t)}),uh=je(Yd),ch=function(e,t,r){for(var n=-1,i=e.length,o=t.length,s={};++n<i;){var a=n<o?t[n]:void 0;r(s,e[n],a)}return s},dh=function(e,t){return ch(e||[],t||[],Ie)},hh=function(e,t){return ch(e||[],t||[],fl)},fh=je(function(e){var t=e.length,r=t>1?e[t-1]:void 0;return r="function"==typeof r?(e.pop(),r):void 0,Qd(e,r)}),ph={chunk:Kr,compact:xn,concat:Fn,difference:Hi,differenceBy:Yi,differenceWith:Qi,drop:Xi,dropRight:Ji,dropRightWhile:$i,dropWhile:eo,fill:Ao,findIndex:wo,findLastIndex:ko,first:Uo,flatten:Et,flattenDeep:Qo,flattenDepth:Ko,fromPairs:os,head:Uo,indexOf:Rs,initial:Os,intersection:Is,intersectionBy:Ds,intersectionWith:Ns,join:Aa,last:qi,lastIndexOf:Ma,nth:ll,pull:gu,pullAll:vu,pullAllBy:_u,pullAllWith:mu,pullAt:Eu,remove:Vu,reverse:Yu,slice:lc,sortedIndex:_c,sortedIndexBy:mc,sortedIndexOf:yc,sortedLastIndex:bc,sortedLastIndexBy:Ec,sortedLastIndexOf:Sc,sortedUniq:Cc,sortedUniqBy:Ac,tail:kc,take:xc,takeRight:Fc,takeRightWhile:Uc,takeWhile:Vc,union:kd,unionBy:xd,unionWith:Fd,uniq:Ud,uniqBy:Vd,uniqWith:Wd,unzip:Yd,unzipWith:Qd,without:eh,xor:sh,xorBy:ah,xorWith:lh,zip:uh,zipObject:dh,zipObjectDeep:hh,zipWith:fh},vh={countBy:fi,each:ro,eachRight:ao,every:To,filter:Oo,find:Io,findLast:xo,flatMap:zo,flatMapDeep:Ho,flatMapDepth:qo,forEach:ro,forEachRight:ao,groupBy:cs,includes:As,invokeMap:Hs,keyBy:Ra,map:Wo,orderBy:bl,partition:lu,reduce:ku,reduceRight:Fu,reject:Uu,sample:Ju,sampleSize:tc,shuffle:sc,size:ac,some:dc,sortBy:hc},gh={now:sl.A},_h={after:m,ary:Oe,before:Bt,bind:kt,bindKey:Ut,curry:gi,curryRight:mi,debounce:yi.A,defer:xi,delay:Ui,flip:Xo,memoize:ot,negate:tl,once:_l,overArgs:Pl,partial:nu,partialRight:au,rearg:Bu,rest:Gu,spread:Oc,throttle:od.default,unary:Ld,wrap:th},mh={castArray:Vr,clone:Dn,cloneDeep:Nn,cloneDeepWith:Bn,cloneWith:jn,conformsTo:ni,eq:Me.A,gt:fs,gte:ps,isArguments:_t.A,isArray:l.A,isArrayBuffer:Ys,isArrayLike:ke.A,isArrayLikeObject:Pi,isBoolean:Qs,isBuffer:En.A,isDate:Xs,isElement:Js,isEmpty:ea,isEqual:ta.default,isEqualWith:ra,isError:It,isFinite:ia,isFunction:Ri.A,isInteger:oa,isLength:Yn.A,isMap:An,isMatch:sa,isMatchWith:aa,isNaN:ua,isNative:pa,isNil:va,isNull:ga,isNumber:la,isObject:C.A,isObjectLike:H.A,isPlainObject:wt,isRegExp:ma,isSafeInteger:ya,isSet:Rn,isString:Es,isSymbol:i.A,isTypedArray:Oi.A,isUndefined:ba,isWeakMap:Ea,isWeakSet:Sa,lt:Na,lte:Ba,toArray:il,toFinite:g,toInteger:_,toLength:Co,toNumber:p.A,toPlainObject:Mi,toSafeInteger:gd,toString:ct},yh={add:f,ceil:Hr,divide:Ki,floor:Jo,max:Va,maxBy:Wa,mean:Ha,meanBy:qa,min:Ja,minBy:Za,multiply:el,round:Qu,subtract:Nc,sum:Bc,sumBy:jc},bh={clamp:Jr,inRange:bs,random:Ou},Eh={assign:Ge,assignIn:Ke,assignInWith:Je,assignWith:$e,at:Tt,create:pi,defaults:Ci,defaultsDeep:Bi,entries:ho,entriesIn:fo,extend:Ke,extendWith:Je,findKey:No,findLastKey:Fo,forIn:ts,forInRight:rs,forOwn:ns,forOwnRight:is,functions:as,functionsIn:ls,get:pt,has:_s,hasIn:Kn,invert:ks,invertBy:Vs,invoke:Gs,keys:Ve.A,keysIn:Ye,mapKeys:ja,mapValues:ka,merge:Qa,mergeWith:Ni,omit:hl,omitBy:gl,pick:uu,pickBy:vl,result:Hu,set:rc,setWith:nc,toPairs:ho,toPairsIn:fo,transform:md,unset:Hd,update:Xd,updateWith:Jd,values:Ts,valuesIn:$d},Sh={at:rh,chain:qr,commit:kn,lodash:X,next:ol,plant:cu,reverse:ih,tap:Wc,thru:sd,toIterator:dd,toJSON:fd,value:fd,valueOf:fd,wrapperChain:nh},Th={camelCase:Ur,capitalize:sr,deburr:hr,endsWith:lo,escape:_o,escapeRegExp:bo,kebabCase:Pa,lowerCase:wa,lowerFirst:Ia,pad:Xl,padEnd:Jl,padStart:Zl,parseInt:tu,repeat:Wu,replace:zu,snakeCase:uc,split:Pc,startCase:Lc,startsWith:Mc,template:id,templateSettings:Kc,toLower:pd,toUpper:_d,trim:Sd,trimEnd:Cd,trimStart:Pd,truncate:Od,unescape:Dd,upperCase:Zd,upperFirst:or,words:kr},Ch={attempt:Nt,bindAll:xt,cond:ei,conforms:ri,constant:ie,defaultTo:bi,flow:$o,flowRight:es,identity:y,iteratee:Ta,matches:xa,matchesProperty:Fa,method:Ka,methodOf:Xa,mixin:$a,noop:k,nthArg:ul,over:Sl,overEvery:Rl,overSome:Ll,property:Zn,propertyOf:du,range:Iu,rangeRight:Du,stubArray:an.A,stubFalse:ha.A,stubObject:wc,stubString:Ic,stubTrue:Dc,times:cd,toPath:vd,uniqueId:Gd},Ah=Math.max,Ph=Math.min,Rh=Math.min,Oh=4294967295,Lh=Array.prototype,Mh=Object.prototype.hasOwnProperty,wh=s.A?s.A.iterator:void 0,Ih=Math.max,Dh=Math.min,Nh=(ou=$a,function(e,t,r){if(null==r){var n=(0,C.A)(t),i=n&&(0,Ve.A)(t),o=i&&i.length&&ss(t,i);(o?o.length:n)||(r=t,t=e,e=this)}return ou(e,t,r)});X.after=_h.after,X.ary=_h.ary,X.assign=Eh.assign,X.assignIn=Eh.assignIn,X.assignInWith=Eh.assignInWith,X.assignWith=Eh.assignWith,X.at=Eh.at,X.before=_h.before,X.bind=_h.bind,X.bindAll=Ch.bindAll,X.bindKey=_h.bindKey,X.castArray=mh.castArray,X.chain=Sh.chain,X.chunk=ph.chunk,X.compact=ph.compact,X.concat=ph.concat,X.cond=Ch.cond,X.conforms=Ch.conforms,X.constant=Ch.constant,X.countBy=vh.countBy,X.create=Eh.create,X.curry=_h.curry,X.curryRight=_h.curryRight,X.debounce=_h.debounce,X.defaults=Eh.defaults,X.defaultsDeep=Eh.defaultsDeep,X.defer=_h.defer,X.delay=_h.delay,X.difference=ph.difference,X.differenceBy=ph.differenceBy,X.differenceWith=ph.differenceWith,X.drop=ph.drop,X.dropRight=ph.dropRight,X.dropRightWhile=ph.dropRightWhile,X.dropWhile=ph.dropWhile,X.fill=ph.fill,X.filter=vh.filter,X.flatMap=vh.flatMap,X.flatMapDeep=vh.flatMapDeep,X.flatMapDepth=vh.flatMapDepth,X.flatten=ph.flatten,X.flattenDeep=ph.flattenDeep,X.flattenDepth=ph.flattenDepth,X.flip=_h.flip,X.flow=Ch.flow,X.flowRight=Ch.flowRight,X.fromPairs=ph.fromPairs,X.functions=Eh.functions,X.functionsIn=Eh.functionsIn,X.groupBy=vh.groupBy,X.initial=ph.initial,X.intersection=ph.intersection,X.intersectionBy=ph.intersectionBy,X.intersectionWith=ph.intersectionWith,X.invert=Eh.invert,X.invertBy=Eh.invertBy,X.invokeMap=vh.invokeMap,X.iteratee=Ch.iteratee,X.keyBy=vh.keyBy,X.keys=Ve.A,X.keysIn=Eh.keysIn,X.map=vh.map,X.mapKeys=Eh.mapKeys,X.mapValues=Eh.mapValues,X.matches=Ch.matches,X.matchesProperty=Ch.matchesProperty,X.memoize=_h.memoize,X.merge=Eh.merge,X.mergeWith=Eh.mergeWith,X.method=Ch.method,X.methodOf=Ch.methodOf,X.mixin=Nh,X.negate=tl,X.nthArg=Ch.nthArg,X.omit=Eh.omit,X.omitBy=Eh.omitBy,X.once=_h.once,X.orderBy=vh.orderBy,X.over=Ch.over,X.overArgs=_h.overArgs,X.overEvery=Ch.overEvery,X.overSome=Ch.overSome,X.partial=_h.partial,X.partialRight=_h.partialRight,X.partition=vh.partition,X.pick=Eh.pick,X.pickBy=Eh.pickBy,X.property=Ch.property,X.propertyOf=Ch.propertyOf,X.pull=ph.pull,X.pullAll=ph.pullAll,X.pullAllBy=ph.pullAllBy,X.pullAllWith=ph.pullAllWith,X.pullAt=ph.pullAt,X.range=Ch.range,X.rangeRight=Ch.rangeRight,X.rearg=_h.rearg,X.reject=vh.reject,X.remove=ph.remove,X.rest=_h.rest,X.reverse=ph.reverse,X.sampleSize=vh.sampleSize,X.set=Eh.set,X.setWith=Eh.setWith,X.shuffle=vh.shuffle,X.slice=ph.slice,X.sortBy=vh.sortBy,X.sortedUniq=ph.sortedUniq,X.sortedUniqBy=ph.sortedUniqBy,X.split=Th.split,X.spread=_h.spread,X.tail=ph.tail,X.take=ph.take,X.takeRight=ph.takeRight,X.takeRightWhile=ph.takeRightWhile,X.takeWhile=ph.takeWhile,X.tap=Sh.tap,X.throttle=_h.throttle,X.thru=sd,X.toArray=mh.toArray,X.toPairs=Eh.toPairs,X.toPairsIn=Eh.toPairsIn,X.toPath=Ch.toPath,X.toPlainObject=mh.toPlainObject,X.transform=Eh.transform,X.unary=_h.unary,X.union=ph.union,X.unionBy=ph.unionBy,X.unionWith=ph.unionWith,X.uniq=ph.uniq,X.uniqBy=ph.uniqBy,X.uniqWith=ph.uniqWith,X.unset=Eh.unset,X.unzip=ph.unzip,X.unzipWith=ph.unzipWith,X.update=Eh.update,X.updateWith=Eh.updateWith,X.values=Eh.values,X.valuesIn=Eh.valuesIn,X.without=ph.without,X.words=Th.words,X.wrap=_h.wrap,X.xor=ph.xor,X.xorBy=ph.xorBy,X.xorWith=ph.xorWith,X.zip=ph.zip,X.zipObject=ph.zipObject,X.zipObjectDeep=ph.zipObjectDeep,X.zipWith=ph.zipWith,X.entries=Eh.toPairs,X.entriesIn=Eh.toPairsIn,X.extend=Eh.assignIn,X.extendWith=Eh.assignInWith,Nh(X,X),X.add=yh.add,X.attempt=Ch.attempt,X.camelCase=Th.camelCase,X.capitalize=Th.capitalize,X.ceil=yh.ceil,X.clamp=bh.clamp,X.clone=mh.clone,X.cloneDeep=mh.cloneDeep,X.cloneDeepWith=mh.cloneDeepWith,X.cloneWith=mh.cloneWith,X.conformsTo=mh.conformsTo,X.deburr=Th.deburr,X.defaultTo=Ch.defaultTo,X.divide=yh.divide,X.endsWith=Th.endsWith,X.eq=mh.eq,X.escape=Th.escape,X.escapeRegExp=Th.escapeRegExp,X.every=vh.every,X.find=vh.find,X.findIndex=ph.findIndex,X.findKey=Eh.findKey,X.findLast=vh.findLast,X.findLastIndex=ph.findLastIndex,X.findLastKey=Eh.findLastKey,X.floor=yh.floor,X.forEach=vh.forEach,X.forEachRight=vh.forEachRight,X.forIn=Eh.forIn,X.forInRight=Eh.forInRight,X.forOwn=Eh.forOwn,X.forOwnRight=Eh.forOwnRight,X.get=Eh.get,X.gt=mh.gt,X.gte=mh.gte,X.has=Eh.has,X.hasIn=Eh.hasIn,X.head=ph.head,X.identity=y,X.includes=vh.includes,X.indexOf=ph.indexOf,X.inRange=bh.inRange,X.invoke=Eh.invoke,X.isArguments=mh.isArguments,X.isArray=l.A,X.isArrayBuffer=mh.isArrayBuffer,X.isArrayLike=mh.isArrayLike,X.isArrayLikeObject=mh.isArrayLikeObject,X.isBoolean=mh.isBoolean,X.isBuffer=mh.isBuffer,X.isDate=mh.isDate,X.isElement=mh.isElement,X.isEmpty=mh.isEmpty,X.isEqual=mh.isEqual,X.isEqualWith=mh.isEqualWith,X.isError=mh.isError,X.isFinite=mh.isFinite,X.isFunction=mh.isFunction,X.isInteger=mh.isInteger,X.isLength=mh.isLength,X.isMap=mh.isMap,X.isMatch=mh.isMatch,X.isMatchWith=mh.isMatchWith,X.isNaN=mh.isNaN,X.isNative=mh.isNative,X.isNil=mh.isNil,X.isNull=mh.isNull,X.isNumber=mh.isNumber,X.isObject=C.A,X.isObjectLike=mh.isObjectLike,X.isPlainObject=mh.isPlainObject,X.isRegExp=mh.isRegExp,X.isSafeInteger=mh.isSafeInteger,X.isSet=mh.isSet,X.isString=mh.isString,X.isSymbol=mh.isSymbol,X.isTypedArray=mh.isTypedArray,X.isUndefined=mh.isUndefined,X.isWeakMap=mh.isWeakMap,X.isWeakSet=mh.isWeakSet,X.join=ph.join,X.kebabCase=Th.kebabCase,X.last=qi,X.lastIndexOf=ph.lastIndexOf,X.lowerCase=Th.lowerCase,X.lowerFirst=Th.lowerFirst,X.lt=mh.lt,X.lte=mh.lte,X.max=yh.max,X.maxBy=yh.maxBy,X.mean=yh.mean,X.meanBy=yh.meanBy,X.min=yh.min,X.minBy=yh.minBy,X.stubArray=Ch.stubArray,X.stubFalse=Ch.stubFalse,X.stubObject=Ch.stubObject,X.stubString=Ch.stubString,X.stubTrue=Ch.stubTrue,X.multiply=yh.multiply,X.nth=ph.nth,X.noop=Ch.noop,X.now=gh.now,X.pad=Th.pad,X.padEnd=Th.padEnd,X.padStart=Th.padStart,X.parseInt=Th.parseInt,X.random=bh.random,X.reduce=vh.reduce,X.reduceRight=vh.reduceRight,X.repeat=Th.repeat,X.replace=Th.replace,X.result=Eh.result,X.round=yh.round,X.sample=vh.sample,X.size=vh.size,X.snakeCase=Th.snakeCase,X.some=vh.some,X.sortedIndex=ph.sortedIndex,X.sortedIndexBy=ph.sortedIndexBy,X.sortedIndexOf=ph.sortedIndexOf,X.sortedLastIndex=ph.sortedLastIndex,X.sortedLastIndexBy=ph.sortedLastIndexBy,X.sortedLastIndexOf=ph.sortedLastIndexOf,X.startCase=Th.startCase,X.startsWith=Th.startsWith,X.subtract=yh.subtract,X.sum=yh.sum,X.sumBy=yh.sumBy,X.template=Th.template,X.times=Ch.times,X.toFinite=mh.toFinite,X.toInteger=_,X.toLength=mh.toLength,X.toLower=Th.toLower,X.toNumber=mh.toNumber,X.toSafeInteger=mh.toSafeInteger,X.toString=mh.toString,X.toUpper=Th.toUpper,X.trim=Th.trim,X.trimEnd=Th.trimEnd,X.trimStart=Th.trimStart,X.truncate=Th.truncate,X.unescape=Th.unescape,X.uniqueId=Ch.uniqueId,X.upperCase=Th.upperCase,X.upperFirst=Th.upperFirst,X.each=vh.forEach,X.eachRight=vh.forEachRight,X.first=ph.head,Nh(X,(su={},ai(X,function(e,t){Mh.call(X.prototype,t)||(su[t]=e)}),su),{chain:!1}),X.VERSION="4.17.21",(X.templateSettings=Th.templateSettings).imports._=X,ce(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){X[e].placeholder=X}),ce(["drop","take"],function(e,t){j.prototype[e]=function(r){r=void 0===r?1:Ih(_(r),0);var n=this.__filtered__&&!t?new j(this):this.clone();return n.__filtered__?n.__takeCount__=Dh(r,n.__takeCount__):n.__views__.push({size:Dh(r,Oh),type:e+(n.__dir__<0?"Right":"")}),n},j.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),ce(["filter","map","takeWhile"],function(e,t){var r=t+1,n=1==r||3==r;j.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:$n(e),type:r}),t.__filtered__=t.__filtered__||n,t}}),ce(["head","last"],function(e,t){var r="take"+(t?"Right":"");j.prototype[e]=function(){return this[r](1).value()[0]}}),ce(["initial","tail"],function(e,t){var r="drop"+(t?"":"Right");j.prototype[e]=function(){return this.__filtered__?new j(this):this[r](1)}}),j.prototype.compact=function(){return this.filter(y)},j.prototype.find=function(e){return this.filter(e).head()},j.prototype.findLast=function(e){return this.reverse().find(e)},j.prototype.invokeMap=je(function(e,t){return"function"==typeof e?new j(this):this.map(function(r){return zs(r,e,t)})}),j.prototype.reject=function(e){return this.filter(tl($n(e)))},j.prototype.slice=function(e,t){e=_(e);var r=this;return r.__filtered__&&(e>0||t<0)?new j(r):(e<0?r=r.takeRight(-e):e&&(r=r.drop(e)),void 0!==t&&(r=(t=_(t))<0?r.dropRight(-t):r.take(t-e)),r)},j.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},j.prototype.toArray=function(){return this.take(Oh)},ai(j.prototype,function(e,t){var r=/^(?:filter|find|map|reject)|While$/.test(t),n=/^(?:head|last)$/.test(t),i=X[n?"take"+("last"==t?"Right":""):t],o=n||/^find/.test(t);i&&(X.prototype[t]=function(){var t=this.__wrapped__,s=n?[1]:arguments,a=t instanceof j,u=s[0],c=a||(0,l.A)(t),d=function(e){var t=i.apply(X,(0,gt.A)([e],s));return n&&h?t[0]:t};c&&r&&"function"==typeof u&&1!=u.length&&(a=c=!1);var h=this.__chain__,f=!!this.__actions__.length,p=o&&!h,v=a&&!f;if(!o&&c){t=v?t:new j(this);var g=e.apply(t,s);return g.__actions__.push({func:sd,args:[d],thisArg:void 0}),new G(g,h)}return p&&v?e.apply(this,s):(g=this.thru(d),p?n?g.value()[0]:g.value():g)})}),ce(["pop","push","shift","sort","splice","unshift"],function(e){var t=Lh[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);X.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var i=this.value();return t.apply((0,l.A)(i)?i:[],e)}return this[r](function(r){return t.apply((0,l.A)(r)?r:[],e)})}}),ai(j.prototype,function(e,t){var r=X[t];if(r){var n=r.name+"";Mh.call(U,n)||(U[n]=[]),U[n].push({name:t,func:r})}}),U[Te(void 0,2).name]=[{name:"wrapper",func:void 0}],j.prototype.clone=function(){var e=new j(this.__wrapped__);return e.__actions__=q(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=q(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=q(this.__views__),e},j.prototype.reverse=function(){if(this.__filtered__){var e=new j(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},j.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,r=(0,l.A)(e),n=t<0,i=r?e.length:0,o=function(e,t,r){for(var n=-1,i=r.length;++n<i;){var o=r[n],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=Ph(t,e+s);break;case"takeRight":e=Ah(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,u=a-s,c=n?a:s-1,d=this.__iteratees__,h=d.length,f=0,p=Rh(u,this.__takeCount__);if(!r||!n&&i==u&&p==u)return hd(e,this.__actions__);var v=[];e:for(;u--&&f<p;){for(var g=-1,_=e[c+=t];++g<h;){var m=d[g],y=m.iteratee,b=m.type,E=y(_);if(2==b)_=E;else if(!E){if(1==b)continue e;break e}}v[f++]=_}return v},X.prototype.at=Sh.at,X.prototype.chain=Sh.wrapperChain,X.prototype.commit=Sh.commit,X.prototype.next=Sh.next,X.prototype.plant=Sh.plant,X.prototype.reverse=Sh.reverse,X.prototype.toJSON=X.prototype.valueOf=X.prototype.value=Sh.value,X.prototype.first=X.prototype.head,wh&&(X.prototype[wh]=Sh.toIterator);var Bh=X},7033:function(e,t,r){var n,o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},c=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&o(t,e,r[i]);return l(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.MouflonPlayer=t.parsePlaylistUrl=void 0;var d=r(7028),h=r(3241),f=r(3102),p=r(3814),v=r(7433),g=r(9678),_=r(3362),m=r(5307),y=r(9056),b=r(8313),E=r(9710),S=r(4971),T=r(8810),C=r(6805),A=r(4354),P=r(619),R=r(99),O=r(1245),L=r(5810);t.parsePlaylistUrl=e=>{if(!e)return{};try{var t,r=new URL(e).pathname.split("/");return{streamId:r[2],resolution:(null===(t=r[r.length-1].match(/\d+_(\w+)/))||void 0===t?void 0:t[1])||"source"}}catch(e){return{}}};var M=(0,C.queued)();class w{constructor(){a(this,"_doppioWrapperConstructor",null),a(this,"_videoElement",null),a(this,"_ristrettoPlayerWrapperConstructor",null),a(this,"_ristrettoBroadcasterWrapperConstructor",null),a(this,"_nativeWrapperConstructor",null),a(this,"_supportedPlayerTypeCache",null),a(this,"_currentPlayerType",null),a(this,"_currentPlayerWrapperInstance",null),a(this,"_currentStreamConfig",{}),a(this,"_isAbrEnabled",!1),a(this,"_isStartDelayed",!1),a(this,"_currentResolution",null),a(this,"_currentResolutionBitrate",null),a(this,"_metricsUserIdCache",null),a(this,"_metricsTimeOriginCache",null),a(this,"_abrResolutions",[]),a(this,"_config",i({},P.defaultMouflonPlayerConfig)),a(this,"_appKey",""),a(this,"_metricsCollector",null),a(this,"_videoElementMetrics",null),a(this,"_upscaleCalculationService",void 0),a(this,"_logLevels",[]),a(this,"_isDestroyed",!1),a(this,"_hasStarted",!1),a(this,"_abTestsCache",{}),a(this,"_abTestsSupportCache",{}),a(this,"_additionalFieldsCache",{}),a(this,"_playerInstancesMap",{}),a(this,"_videoElementController",void 0),a(this,"_userTypeCache","unknown"),a(this,"_resolutionsCache",[]),a(this,"_resolutionLimitsCache",null),a(this,"_watchDog",null),a(this,"_eventEmitter",void 0),a(this,"_eventBusInstance",new C.EventBus),a(this,"_playerWrapperResolversMap",{[C.EPlayerType.HLS]:this._resolveDoppioWrapper,[C.EPlayerType.WEBRTC]:this._resolveRistrettoWrapper,[C.EPlayerType.NATIVE]:this._resolveNativeWrapper,[C.EPlayerType.BROADCAST]:this._resolveRistrettoBroadcasterWrapper}),a(this,"_debugPanel",new O.DebugPanel(this._eventBusInstance)),a(this,"_playerTypeForcedListener",void 0),a(this,"_streamConfigUpdatedInternalListener",void 0),a(this,"_onResolutionsAvailableListener",void 0),a(this,"_onLatencyEstimationAvailableListener",void 0),a(this,"_videoElementDimensionsListener",void 0),a(this,"_onAnotherActivePlayerListener",void 0),a(this,"_onSessionIdRecreatedListener",void 0),this._eventEmitter=new R.PlayerEventEmitter(this._eventBusInstance),this._videoElementController=new C.VideoElementController,this._watchDog=new v.WatchDog(this._eventBusInstance),this._upscaleCalculationService=new b.UpscaleCalculationService(this._eventBusInstance),localStorage&&localStorage.getItem("__mmpLoggerLevel__")&&(this._logLevels=(localStorage.getItem("__mmpLoggerLevel__")||"").split(","),this._videoElementController.setLoggerLevels(this._logLevels)),this._config.videoControllerConfig&&this._videoElementController.updateConfig(this._config.videoControllerConfig),this._videoElementController.addEventListener(C.EVideoControllerCustomEvent.VIDEO_PLAYBACK_STATE_CHANGE,this._handleVideoPlaybackStateChange),this._videoElementController.addEventListener(C.EVideoControllerCustomEvent.UPDATE_PLAYER_RESOLUTION,this._handleUpdatePlayerResolution),this._videoElementController.addEventListener(C.EVideoControllerCustomEvent.NATIVE_EVENT,this._handleNativeEvent),this._videoElementController.addEventListener(C.EVideoControllerCustomEvent.TIME_UPDATE,this._handleTimeUpdate),this._videoElementController.addEventListener(C.EVideoControllerCustomEvent.PLAYING,this._handlePlaying),this._playerTypeForcedListener=this._eventBusInstance.subscribe(_.EPlayersEvents.FORCE_PLAYER_TYPE,this._onPlayerTypeForced),this._streamConfigUpdatedInternalListener=this._eventBusInstance.subscribe(_.EPlayersEvents.STREAM_CONFIG_UPDATED_INTERNAL,this._updateStreamConfigInternal),this._onLatencyEstimationAvailableListener=this._eventBusInstance.subscribe(_.EPlayersEvents.LATENCY_ESTIMATION_AVAILABLE,this._onLatencyEstimationAvailable),this._onResolutionsAvailableListener=this._eventBusInstance.subscribe(_.EPlayersEvents.RESOLUTIONS_AVAILABLE,this._onResolutionsAvailable),this._videoElementDimensionsListener=this._eventBusInstance.subscribe(f.EMetricsEvents.VIDEO_ELEMENT_DIMENSIONS_CALCULATED,this._onVideoElementDimensionsCalculated),this._onAnotherActivePlayerListener=this._eventBusInstance.subscribe(g.EWatchDogEvent.ANOTHER_ACTIVE_PLAYER,this._onAnotherActivePlayer),this._onSessionIdRecreatedListener=this._eventBusInstance.subscribe(f.EMetricsEvents.SESSION_ID_RECREATED,this._onSessionIdRecreated)}get instanceVersion(){var e;return"".concat(this._currentPlayerType," ").concat(null===(e=this._currentPlayerWrapperInstance)||void 0===e?void 0:e.version)}get version(){return L.MMP_VERSION}on(e,t,r){this._eventEmitter.addEventListener(e,t,r)}off(e,t,r){this._eventEmitter.removeEventListener(e,t,r)}once(e,t,r){var n="boolean"==typeof r&&r,o="object"==typeof r?i(i({},r),{},{once:!0}):{once:!0,capture:n};this._eventEmitter.addEventListener(e,t,o)}sendCustomEvent(e){var t;null===(t=this._metricsCollector)||void 0===t||t.registerEvent("CustomEvent",{customEventName:e})}destroy(){var e,t,r,n;this._isDestroyed=!0,this._hasStarted=!1,this._isStartDelayed=!1,null!==(e=this._currentPlayerWrapperInstance)&&void 0!==e&&e.destroy(),this._eventEmitter.destroy(),this._debugPanel.destroy(),null!==(t=this._metricsCollector)&&void 0!==t&&t.destroy(),null!==(r=this._videoElementMetrics)&&void 0!==r&&r.destroy(),this._videoElementController.removeEventListener(C.EVideoControllerCustomEvent.VIDEO_PLAYBACK_STATE_CHANGE,this._handleVideoPlaybackStateChange),this._videoElementController.removeEventListener(C.EVideoControllerCustomEvent.UPDATE_PLAYER_RESOLUTION,this._handleUpdatePlayerResolution),this._videoElementController.removeEventListener(C.EVideoControllerCustomEvent.NATIVE_EVENT,this._handleNativeEvent),this._videoElementController.removeEventListener(C.EVideoControllerCustomEvent.TIME_UPDATE,this._handleTimeUpdate),this._videoElementController.destroy(),null!==(n=this._watchDog)&&void 0!==n&&n.destroy(),this._eventBusInstance.unsubscribe(this._playerTypeForcedListener),this._eventBusInstance.unsubscribe(this._streamConfigUpdatedInternalListener),this._eventBusInstance.unsubscribe(this._onResolutionsAvailableListener),this._eventBusInstance.unsubscribe(this._onLatencyEstimationAvailableListener),this._eventBusInstance.unsubscribe(this._videoElementDimensionsListener),this._eventBusInstance.unsubscribe(this._onAnotherActivePlayerListener),this._eventBusInstance.unsubscribe(this._onSessionIdRecreatedListener)}enableAbr(){var e,t;this._isAbrEnabled=!0,null!==(e=this._currentPlayerWrapperInstance)&&void 0!==e&&e.enableAbr(),null!==(t=this._metricsCollector)&&void 0!==t&&t.setRenditionSwitchMode("auto"),this._upscaleCalculationService.setUserSelectedResolution(null)}disableAbr(){var e,t;this._isAbrEnabled=!1,null!==(e=this._currentPlayerWrapperInstance)&&void 0!==e&&e.disableAbr(),null===(t=this._metricsCollector)||void 0===t||t.setRenditionSwitchMode("manual")}setMetricsUserId(e){var t;null!==(t=this._metricsCollector)&&void 0!==t&&t.setUserId(e),this._metricsUserIdCache=e}setMetricsProjectId(e){var t;null===(t=this._metricsCollector)||void 0===t||t.setProjectId(e)}setMetricsTimeOrigin(e){var t;this._metricsTimeOriginCache=e,null===(t=this._metricsCollector)||void 0===t||t.setTimeOrigin(e)}deconfigureMetrics(){var e,t;null!==(e=this._videoElementMetrics)&&void 0!==e&&e.destroy(),this._videoElementMetrics=null,null!==(t=this._metricsCollector)&&void 0!==t&&t.destroy(),this._metricsCollector=null}configureMetrics(e,t){var r;if(this._metricsCollector){var n;if(this._metricsCollector.baseUrl===e&&this._metricsCollector.projectId===t)return;null!==(n=this._videoElementMetrics)&&void 0!==n&&n.destroy(),this._videoElementMetrics=null,this._metricsCollector.destroy(),this._metricsCollector=null}this._metricsCollector=new h.MetricsCollector(e,t,this._eventBusInstance),this._metricsCollector.setAbTests(this._abTestsCache),this._currentPlayerType&&this._metricsCollector.setPlayerType(this._currentPlayerType),this._metricsCollector.setAdditionalFields(this._additionalFieldsCache),this._videoElementMetrics=new p.VideoElementMetrics(this._metricsCollector,this._eventBusInstance,this._upscaleCalculationService),this._videoElementMetrics.setIsPaused(this._currentPlayerType===C.EPlayerType.BROADCAST),null!==(r=this._currentPlayerWrapperInstance)&&void 0!==r&&r.setMetricsCollector(this._metricsCollector),this._videoElement&&this._videoElementMetrics.setVideoElement(this._videoElement),this._videoElementMetrics.setResolutions(this._resolutionsCache),this._upscaleCalculationService.setResolutions(this._resolutionsCache),this._currentResolution&&!this._isAbrEnabled?this._upscaleCalculationService.setUserSelectedResolution(this._currentResolution):this._upscaleCalculationService.setUserSelectedResolution(null),this._metricsTimeOriginCache&&this._metricsCollector.setTimeOrigin(this._metricsTimeOriginCache),this._metricsUserIdCache&&this._metricsCollector.setUserId(this._metricsUserIdCache),"unknown"!==this._userTypeCache&&this._metricsCollector.setUserType(this._userTypeCache),this._reemitCDNDomain()}setConfig(e){var t=(0,d.merge)({},this._config,e);if(!(0,d.isEqual)(t,this._config)){var r=(0,C.ObjectDeepDiff)(this._config,t);this._config=i({},t),(r.hlsConfig||r.webRTCConfig||r.nativeConfig)&&this._reapplyPlayerConfig(),r.videoControllerConfig&&this._config.videoControllerConfig&&this._videoElementController.updateConfig(this._config.videoControllerConfig),r.persistent?this._prepareDependencies():!1===r.persistent&&this._clearDependencies(),void 0!==r.minUpscaleFactor&&this._updateResolutionLimits()}}setVideoElement(e){var t,r;this._videoElement=e,this._upscaleCalculationService.setVideoElement(e),this._eventBusInstance.publish(_.EPlayersEvents.VIDEO_ELEMENT_UPDATED,{videoElement:e}),this._videoElementController&&e&&this._videoElementController.setVideoElement(e),null!==(t=this._videoElementMetrics)&&void 0!==t&&t.setVideoElement(e),null!==(r=this._currentPlayerWrapperInstance)&&void 0!==r&&r.setVideoElement(this._videoElement),this._currentPlayerType===C.EPlayerType.BROADCAST&&this.setVolume(0)}setStreamConfig(e){var t=i(i({},this._currentStreamConfig),e);this._updateStreamConfigInternal({streamConfig:t})}validateConfig(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,T.validateConfig)({playerType:e,streamConfig:this._currentStreamConfig,appKey:this._appKey,isTokenRequired:t})}setShouldStopPlayer(e){var t;null===(t=this._watchDog)||void 0===t||t.updateConfig({shouldStopPlayer:e})}setAbTests(e){var t;this._abTestsCache=e||{},null===(t=this._metricsCollector)||void 0===t||t.setAbTests(e||{})}setAbTestsSupport(e){var t;this._abTestsSupportCache=e||{},null===(t=this._metricsCollector)||void 0===t||t.setAbTestsSupport(this._abTestsSupportCache)}setAdditionalMetricsFields(e){var t;this._additionalFieldsCache=e||{},null===(t=this._metricsCollector)||void 0===t||t.setAdditionalFields(e)}setUserType(e){var t;this._userTypeCache=e,null===(t=this._metricsCollector)||void 0===t||t.setUserType(e)}setResolutionByName(e){var t,r;this._currentResolutionBitrate=null,this._currentResolution=e,null!==(t=this._currentPlayerWrapperInstance)&&void 0!==t&&t.setResolutionByName(e),"manual"===(null===(r=this._metricsCollector)||void 0===r?void 0:r.currentRenditionSelectMode)&&(this._metricsCollector.setManualResolution(e),this._upscaleCalculationService.setUserSelectedResolution(e))}setResolutionByBitrate(e){var t;this._currentResolution=null,this._currentResolutionBitrate=e,null===(t=this._currentPlayerWrapperInstance)||void 0===t||t.setResolutionByBitrate(e)}setAbrResolutions(e){var t;this._abrResolutions=e,null===(t=this._currentPlayerWrapperInstance)||void 0===t||t.setAbrResolutions(e)}setAppKey(e){this._appKey=e,this._currentPlayerWrapperInstance&&this._currentPlayerWrapperInstance.setAppKey(e)}getSupportedPlayerTypes(){var e=this;return s(function*(){return e._supportedPlayerTypeCache?e._supportedPlayerTypeCache:(e._supportedPlayerTypeCache=(yield Promise.all(m.AVAILABLE_PLAYER_TYPES.map(function(){var e=s(function*(e){return{playerType:e,isSupported:yield y.playerTypeChecker[e]()}});return function(t){return e.apply(this,arguments)}}()))).filter(e=>e.isSupported).map(e=>{var{playerType:t}=e;return t}),e._supportedPlayerTypeCache||[])})()}setPlayerType(e){var t=this;return s(function*(){var r,n,i;if(e!==t._currentPlayerType){null!==(r=t._videoElementMetrics)&&void 0!==r&&r.setIsPaused(e===C.EPlayerType.BROADCAST),t._videoElement&&t._currentPlayerType&&t._videoElement.load();var o=t._currentPlayerType;if(t._currentPlayerType=e,!(yield t.getSupportedPlayerTypes()).includes(e))throw t._currentPlayerType=o,new Error("Player type ".concat(e," is unsupported"));null!==(n=t._metricsCollector)&&void 0!==n&&n.setPlayerType(e),t._videoElement&&e===C.EPlayerType.BROADCAST&&t.setVolume(0),t._reemitStreamId(),t._reemitCDNDomain(),yield t.recreatePlayer(),null!==(i=t._watchDog)&&void 0!==i&&i.changePlayerType(e),t._eventBusInstance.publish(_.EPlayersEvents.PLAYER_TYPE_CHANGED,{playerType:e})}})()}recreatePlayer(){var e=this;return s(function*(){if(e._currentPlayerType){e._currentPlayerWrapperInstance&&(e._config.persistent?e._currentPlayerWrapperInstance.stop():e._currentPlayerWrapperInstance.destroy()),e._currentPlayerWrapperInstance=null,e._eventEmitter.reemitEvent(A.EMouflonPlayerEvent.MODULE_LOADING_STATE_CHANGED,{newState:A.EModuleLoadingState.LOADING});var[t]=yield Promise.all([e._playerWrapperResolversMap[e._currentPlayerType](),new Promise(e=>{setTimeout(()=>{e()},50)})]);e._isDestroyed||(e._eventEmitter.reemitEvent(A.EMouflonPlayerEvent.MODULE_LOADING_STATE_CHANGED,{newState:A.EModuleLoadingState.LOADED}),e._playerInstancesMap[e._currentPlayerType]?e._currentPlayerWrapperInstance=e._playerInstancesMap[e._currentPlayerType]:(e._currentPlayerWrapperInstance=new t(e._eventBusInstance,{persistent:e._config.persistent}),e._config.persistent&&(e._playerInstancesMap[e._currentPlayerType]=e._currentPlayerWrapperInstance)),yield e._retuneNewPlayerInstance())}})()}renderDebugPanelIntoContainer(e){e.appendChild(this._debugPanel.rootContainer)}start(){(arguments.length>0&&void 0!==arguments[0]&&arguments[0]||!this._hasStarted&&!this._isStartDelayed)&&(this._isCurrentConfigValid()&&this._currentPlayerWrapperInstance?(this._isStartDelayed=!1,this._hasStarted=!0,this._config.persistent||this._currentPlayerWrapperInstance.stop(),this._currentPlayerWrapperInstance.start(),this._reemitStreamId()):this._isStartDelayed=!0)}stop(){var e,t;this._hasStarted=!1,this._isStartDelayed=!1,null!==(e=this._currentPlayerWrapperInstance)&&void 0!==e&&e.stop(),this.recreatePlayer(),null===(t=this._metricsCollector)||void 0===t||t.stop()}setVolume(e){var t;null===(t=this._videoElementController)||void 0===t||t.setVolume(e)}setLoggerLevel(e){var t,r,n;null!==(t=this._currentPlayerWrapperInstance)&&void 0!==t&&null!==(r=t.setLoggerLevel)&&void 0!==r&&r.call(t,e),null!==(n=this._videoElementController)&&void 0!==n&&n.setLoggerLevels(this._logLevels),this._logLevels=e}setResolutionLimits(e){var t;this._resolutionLimitsCache=e,null===(t=this._currentPlayerWrapperInstance)||void 0===t||t.setResolutionLimits(e)}setRegularBroadcastStopReason(e){var t,r,n;null!==(t=this._metricsCollector)&&void 0!==t&&t.setRegularBroadcastStopReason(e),this._currentPlayerWrapperInstance&&"setRegularBroadcastStopReason"in this._currentPlayerWrapperInstance&&"function"==typeof this._currentPlayerWrapperInstance.setRegularBroadcastStopReason&&(null===(r=this._currentPlayerWrapperInstance)||void 0===r||null===(n=r.setRegularBroadcastStopReason)||void 0===n||n.call(r,e))}_retuneNewPlayerInstance(){var e=this;return s(function*(){if(e._currentPlayerType){var t,r,n,i,o,s;switch(e._currentPlayerType){case C.EPlayerType.HLS:yield e._currentPlayerWrapperInstance.setVideoElement(e._videoElement).setPlayerConfig(e._config.hlsConfig||{}).setStreamConfig(e._currentStreamConfig).recreatePlayerInstance();break;case C.EPlayerType.WEBRTC:case C.EPlayerType.BROADCAST:yield e._currentPlayerWrapperInstance.setVideoElement(e._videoElement).setAbrResolutions(e._abrResolutions).setPlayerConfig(e._config.webRTCConfig||{}).setStreamConfig(e._currentStreamConfig).setAppKey(e._appKey).recreatePlayerInstance();break;case C.EPlayerType.NATIVE:yield e._currentPlayerWrapperInstance.setVideoElement(e._videoElement).setStreamConfig(e._currentStreamConfig).recreatePlayerInstance()}e._isAbrEnabled?e.enableAbr():e.disableAbr(),e._logLevels&&(null!==(t=e._currentPlayerWrapperInstance)&&void 0!==t&&t.setLoggerLevel(e._logLevels),null!==(r=e._videoElementController)&&void 0!==r&&r.setLoggerLevels(e._logLevels)),e._currentResolution&&![C.EPlayerType.BROADCAST,C.EPlayerType.NATIVE].includes(e._currentPlayerType)&&null!==(n=e._currentPlayerWrapperInstance)&&void 0!==n&&n.setResolutionByName(e._currentResolution),e._currentResolutionBitrate&&![C.EPlayerType.BROADCAST,C.EPlayerType.NATIVE].includes(e._currentPlayerType)&&null!==(i=e._currentPlayerWrapperInstance)&&void 0!==i&&i.setResolutionByBitrate(e._currentResolutionBitrate),e._metricsCollector&&null!==(o=e._currentPlayerWrapperInstance)&&void 0!==o&&o.setMetricsCollector(e._metricsCollector),null!==(s=e._currentPlayerWrapperInstance)&&void 0!==s&&s.setResolutionLimits(e._resolutionLimitsCache),(e._isStartDelayed||e._hasStarted)&&e.start(!0)}})()}_prepareDependencies(){var e=this;return s(function*(){var t,r;for(var n of[C.EPlayerType.HLS,C.EPlayerType.WEBRTC])if(!e._playerInstancesMap[n])if(n===e._currentPlayerType&&e._currentPlayerWrapperInstance)e._playerInstancesMap[n]=e._currentPlayerWrapperInstance;else{var o=yield e._playerWrapperResolversMap[n]();e._playerInstancesMap[n]=new o(e._eventBusInstance,{persistent:!0})}e._config.establishWSOnStart&&(null!==(t=e._playerInstancesMap[C.EPlayerType.WEBRTC])&&void 0!==t&&t.setStreamConfig(i({WebRTCSignallingUrl:e._currentStreamConfig.WebRTCSignallingUrl},e._currentPlayerType===C.EPlayerType.WEBRTC?e._currentStreamConfig:{})),null===(r=e._playerInstancesMap[C.EPlayerType.WEBRTC])||void 0===r||r.start())})()}_clearDependencies(){Object.values(this._playerInstancesMap).forEach(e=>{e!==this._currentPlayerWrapperInstance&&e.destroy()}),this._playerInstancesMap={}}_reapplyPlayerConfig(){if(this._currentPlayerWrapperInstance)switch(this._currentPlayerType){case C.EPlayerType.HLS:this._config.hlsConfig&&this._currentPlayerWrapperInstance.setPlayerConfig(this._config.hlsConfig);break;case C.EPlayerType.BROADCAST:case C.EPlayerType.WEBRTC:this._config.webRTCConfig&&this._currentPlayerWrapperInstance.setPlayerConfig(this._config.webRTCConfig);break;case C.EPlayerType.NATIVE:this._config.nativeConfig&&this._currentPlayerWrapperInstance.setPlayerConfig(this._config.nativeConfig)}}_resolveDoppioWrapper(){var e=this;return s(function*(){return e._doppioWrapperConstructor||(e._doppioWrapperConstructor=(yield Promise.resolve().then(()=>c(r(666)))).DoppioWrapper),e._doppioWrapperConstructor})()}_resolveRistrettoWrapper(){var e=this;return s(function*(){return e._ristrettoPlayerWrapperConstructor||(e._ristrettoPlayerWrapperConstructor=(yield Promise.resolve().then(()=>c(r(7469)))).RistrettoPlayerWrapper),e._ristrettoPlayerWrapperConstructor})()}_resolveRistrettoBroadcasterWrapper(){var e=this;return s(function*(){return e._ristrettoBroadcasterWrapperConstructor||(e._ristrettoBroadcasterWrapperConstructor=(yield Promise.resolve().then(()=>c(r(9932)))).RistrettoBroadcastWrapper),e._ristrettoBroadcasterWrapperConstructor})()}_resolveNativeWrapper(){var e=this;return s(function*(){return e._nativeWrapperConstructor||(e._nativeWrapperConstructor=(yield Promise.resolve().then(()=>c(r(683)))).NativeWrapper),e._nativeWrapperConstructor})()}_emitAvailablePlayerTypes(){var e=this;return s(function*(){var t=yield e.getSupportedPlayerTypes(),r=(0,S.getPlayerTypesByStreamConfig)(e._currentStreamConfig),n=t.filter(e=>r.includes(e));e._eventEmitter.reemitEvent(A.EMouflonPlayerEvent.AVAILABLE_PLAYER_TYPES_UPDATED,{availablePlayerTypes:n.filter(e=>e!==C.EPlayerType.UNKNOWN)}),e._eventBusInstance.publish(_.EPlayersEvents.PLAYER_TYPES_AVAILABLE,{availablePlayerTypes:n})})()}_handleVideoPlaybackStateChange(e){this._eventEmitter.reemitEvent(A.EMouflonPlayerEvent.VIDEO_PLAYBACK_STATE_CHANGED,e.detail)}_handleUpdatePlayerResolution(e){this._eventEmitter.reemitEvent(A.EMouflonPlayerEvent.UPDATE_PLAYER_RESOLUTION,e.detail)}_handleNativeEvent(e){var{detail:{event:t,eventName:r}}=e;this._eventEmitter.reemitEvent(A.EMouflonPlayerEvent.NATIVE_EVENT,{event:t,eventName:r})}_handleTimeUpdate(){this._eventEmitter.reemitEvent(A.EMouflonPlayerEvent.TIME_UPDATE,{})}_handlePlaying(e){this._eventEmitter.reemitEvent(A.EMouflonPlayerEvent.PLAYING,e.detail)}_isCurrentConfigValid(){return Boolean(this._currentPlayerType===C.EPlayerType.HLS&&this._currentStreamConfig.HLSStreamUrl)||Boolean(this._currentPlayerType===C.EPlayerType.WEBRTC&&this._currentStreamConfig.WebRTCSignallingUrl)||Boolean(this._currentPlayerType===C.EPlayerType.BROADCAST&&this._currentStreamConfig.WebRTCStreamId&&this._currentStreamConfig.WebRTCSignallingUrl)}_reemitStreamId(){if(this._hasStarted){var e;if(this._currentPlayerType===C.EPlayerType.HLS&&this._currentStreamConfig.HLSStreamUrl){var r,{streamId:n}=(0,t.parsePlaylistUrl)(this._currentStreamConfig.HLSStreamUrl);null===(r=this._metricsCollector)||void 0===r||r.setStreamId(n||"")}this._currentPlayerType!==C.EPlayerType.BROADCAST&&this._currentPlayerType!==C.EPlayerType.WEBRTC||!this._currentStreamConfig.WebRTCStreamId||null!==(e=this._metricsCollector)&&void 0!==e&&e.setStreamId(this._currentStreamConfig.WebRTCStreamId),this._reeemitRenditionSwitchMode()}}_reeemitRenditionSwitchMode(){var e;if(this._currentPlayerType===C.EPlayerType.HLS&&this._currentStreamConfig.HLSStreamUrl){var r,{resolution:n}=(0,t.parsePlaylistUrl)(this._currentStreamConfig.HLSStreamUrl);"auto"!==n&&(null===(r=this._metricsCollector)||void 0===r||r.setRenditionSwitchMode("manual"))}"manual"===(null===(e=this._metricsCollector)||void 0===e?void 0:e.currentRenditionSelectMode)&&this._reemitManualRendition()}_reemitManualRendition(){if(this._currentPlayerType===C.EPlayerType.HLS&&this._currentStreamConfig.HLSStreamUrl){var e,{resolution:r}=(0,t.parsePlaylistUrl)(this._currentStreamConfig.HLSStreamUrl);r&&"auto"!==r&&(null!==(e=this._metricsCollector)&&void 0!==e&&e.setManualResolution(r),this._upscaleCalculationService.setUserSelectedResolution(r))}}_reemitCDNDomain(){var e,t,r;this._currentPlayerType===C.EPlayerType.HLS&&this._currentStreamConfig.HLSStreamUrl&&null!==(e=this._metricsCollector)&&void 0!==e&&e.updateCDNUrl(this._currentStreamConfig.HLSStreamUrl),this._currentPlayerType===C.EPlayerType.NATIVE&&this._currentStreamConfig.NativeStreamURL&&null!==(t=this._metricsCollector)&&void 0!==t&&t.updateCDNUrl(this._currentStreamConfig.NativeStreamURL),this._currentPlayerType===C.EPlayerType.WEBRTC&&this._currentStreamConfig.WebRTCSignallingUrl&&(null===(r=this._metricsCollector)||void 0===r||r.updateCDNUrl(this._currentStreamConfig.WebRTCSignallingUrl))}_onPlayerTypeForced(e){var{playerType:t}=e;this.setPlayerType(t)}_onResolutionsAvailable(e){var t,{resolutions:r}=e;this._resolutionsCache=r,null!==(t=this._videoElementMetrics)&&void 0!==t&&t.setResolutions(r),this._upscaleCalculationService.setResolutions(r),this._updateResolutionLimits()}_onAnotherActivePlayer(e){var t,r,{wrongPlayer:n}=e;this._config.isShouldWatchDogStopStream&&null!==(t=this._playerInstancesMap[n])&&void 0!==t&&t.stop(),null===(r=this._metricsCollector)||void 0===r||r.registerEvent("WrongPlayerActive",{wrongPlayerType:n,activePlayerType:this._currentPlayerType})}_onSessionIdRecreated(){this._checkAndReportMediaApiTampering()}_checkAndReportMediaApiTampering(){if(this._config.reportModifiedMSE||this._config.forbidModifiedMSE){var e=(0,E.checkMediaApiTampering)();if(e.hasTampering){var t,r,n=performance.now(),o={MediaStream:e.MediaStream,MediaSource:e.MediaSource,detectionTimestamp:n};this._config.forbidModifiedMSE?(null!==(t=this._metricsCollector)&&void 0!==t&&t.registerEvent("MediaApiTamperingForbidden",i({customEventName:"MediaApiTamperingForbidden"},o)),this.destroy()):this._config.reportModifiedMSE&&(null===(r=this._metricsCollector)||void 0===r||r.registerEvent("MediaApiTamperingReported",i({customEventName:"MediaApiTamperingReported"},o)))}}}_updateStreamConfigInternal(e){var t,r,n,i,{streamConfig:o}=e,s=(0,C.ObjectDeepDiff)(this._currentStreamConfig,o),a=!!o.MediaStream!=!!this._currentStreamConfig.MediaStream||(null===(t=o.MediaStream)||void 0===t?void 0:t.id)!==(null===(r=this._currentStreamConfig.MediaStream)||void 0===r?void 0:r.id);(Object.keys(s).length||a)&&(this._currentStreamConfig=o,this._eventBusInstance.publish(_.EPlayersEvents.STREAM_CONFIG_UPDATED,{streamConfig:this._currentStreamConfig}),this._config.establishWSOnStart&&this._currentPlayerType!==C.EPlayerType.WEBRTC&&null!==(n=this._playerInstancesMap[C.EPlayerType.WEBRTC])&&void 0!==n&&n.setStreamConfig({WebRTCSignallingUrl:this._currentStreamConfig.WebRTCSignallingUrl}),null!==(i=this._currentPlayerWrapperInstance)&&void 0!==i&&i.setStreamConfig(this._currentStreamConfig),this._emitAvailablePlayerTypes(),this._isStartDelayed&&this.start(!0),this._reemitStreamId(),this._reemitCDNDomain())}_onLatencyEstimationAvailable(e){var t,{medianLatency:r}=e;r>0&&(null===(t=this._metricsCollector)||void 0===t||t.registerMetrics({latency:r}))}_onVideoElementDimensionsCalculated(){this._updateResolutionLimits()}_updateResolutionLimits(){var e,t=null!==(e=this._config.minUpscaleFactor)&&void 0!==e?e:null;if(null===t||t<0)this.setResolutionLimits(null);else{var r=this._upscaleCalculationService.getMaxAllowedResolution(t);r&&this.setResolutionLimits(r)}}get debugPanelRootContainer(){return this._debugPanel.rootContainer}get isStarted(){return this._hasStarted||this._isStartDelayed}get sessionId(){var e;return null===(e=this._metricsCollector)||void 0===e?void 0:e.sessionId}}t.MouflonPlayer=w,u([M],w.prototype,"setPlayerType",null),u([M],w.prototype,"start",null),u([M],w.prototype,"stop",null),u([C.bind],w.prototype,"_handleVideoPlaybackStateChange",null),u([C.bind],w.prototype,"_handleUpdatePlayerResolution",null),u([C.bind],w.prototype,"_handleNativeEvent",null),u([C.bind],w.prototype,"_handleTimeUpdate",null),u([C.bind],w.prototype,"_handlePlaying",null),u([C.bind],w.prototype,"_onPlayerTypeForced",null),u([C.bind],w.prototype,"_onResolutionsAvailable",null),u([C.bind],w.prototype,"_onAnotherActivePlayer",null),u([C.bind],w.prototype,"_onSessionIdRecreated",null),u([C.bind],w.prototype,"_updateStreamConfigInternal",null),u([C.bind],w.prototype,"_onLatencyEstimationAvailable",null),u([C.bind],w.prototype,"_onVideoElementDimensionsCalculated",null)},7104:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistPostParseValidatorStage=void 0;var n=r(954);class i extends n.PlaylistValidatorDecryptStage{constructor(){super(...arguments),a(this,"pipelinePosition","postParse")}}t.PlaylistPostParseValidatorStage=i},7109:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=function(e,t){var r,n=function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];r&&clearTimeout(r),r=setTimeout(()=>{e.apply(this,i)},t)};return n.cancel=()=>{r&&(clearTimeout(r),r=void 0)},n}},7114:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=(0,r(5221).getGlobalThis)();"function"!=typeof n.queueMicrotask&&(n.queueMicrotask=function(e){Promise.resolve().then(e).catch(e=>setTimeout(()=>{throw e}))})},7141:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createWorker=void 0,t.createWorker=function(){var e=s(function*(e,t){var r=e instanceof URL?e.href:e;try{var n=yield fetch(r,{mode:"cors"}),i=yield n.text(),o=new Blob([i],{type:"text/javascript"}),s=URL.createObjectURL(o);return new Worker(s,t)}catch(e){throw console.error("Failed to load worker",e),e}});return function(t,r){return e.apply(this,arguments)}}()},7148:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentLoader=void 0;var o=r(355),s=r(8169),l=r(8474),u=r(2513),c=r(7833),d=r(6967),h=r(450),f=i(r(6073)),p=r(180);class v extends s.ConfigConsumer{constructor(e){super("fragmentLoader",e),a(this,"state",p.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["loader"]),a(this,"additionalInfo",{loadingFragments:{}}),a(this,"_lastRequestedFragments",[]),a(this,"_pendingFragments",[]),a(this,"_loaders",[]),a(this,"_fragmentsWaitingQueue",[]),a(this,"_isFragmentLoading",!1),a(this,"_nextStateHandler",{[d.ELoadingState.LOADED]:this._onSuccessLoadingState,[d.ELoadingState.ABORTED]:this._onErrorLoadingState,[d.ELoadingState.ERROR]:this._onErrorLoadingState}),a(this,"_logger",void 0),a(this,"_fragmentsDetectedSubscription",void 0),a(this,"_fragmentAddedToBufferSubscription",void 0),a(this,"_fragmentHistoryReadyToPrintSubscription",void 0),this._logger=(0,l.Logger)(this._eventBus,"Doppio - FragmentLoader"),this._fragmentsDetectedSubscription=this._eventBus.subscribe(u.BasePlaylistRotationControllerEvents.fragments.fragmentsDetected,this._onFragmentsDetected),this._fragmentAddedToBufferSubscription=this._eventBus.subscribe(o.BufferControllerEvents.fragmentAdded,this._onFragmentAddedToBuffer),this._fragmentHistoryReadyToPrintSubscription=this._eventBus.subscribe(c.FragmentLoaderEvents.fragments.fragmentHistoryReadyForPrint,this._onFragmentHistoryReadyToPrint),this._logger.info("Instance created")}destroy(){super.destroy(),this._loaders.forEach(e=>{e.destroy()}),this._eventBus.unsubscribe(this._fragmentsDetectedSubscription),this._eventBus.unsubscribe(this._fragmentAddedToBufferSubscription),this._eventBus.unsubscribe(this._fragmentHistoryReadyToPrintSubscription),this._logger.info("Destroyed")}_handleConfigUpdated(e){void 0!==e.sequentialMode&&this.config.sequentialMode&&!e.sequentialMode&&(this._fragmentsWaitingQueue.forEach(e=>{this._requestFragment(e)}),this._fragmentsWaitingQueue=[])}_onFragmentsDetected(e){this.status="Handling new fragments",this._logger.debug("Fragments was requested to load",e.map(e=>e.getMsnPn()));var t=e.filter(e=>!this._lastRequestedFragments.find(t=>t.url===e.url));this._logger.verbose("Actual fragments is",t.map(e=>e.getMsnPn())),this._pendingFragments=this._pendingFragments.concat(t),t.forEach(e=>{this._scheduleFragmentRequest(e)}),this._lastRequestedFragments=e}_onFragmentAddedToBuffer(e){e.goToLifecycleStage("addedToBuffer")}_onFragmentLoadAborted(e){e.goToLifecycleStage("loadDataAborted")}_onFragmentHistoryReadyToPrint(e){this._logger.info(e.historyString)}_scheduleFragmentRequest(e){this.config.sequentialMode&&this._isFragmentLoading?this._fragmentsWaitingQueue.push(e):this._requestFragment(e)}_nextSequentialRequest(){var e=this._fragmentsWaitingQueue.shift();e?this._requestFragment(e):this._isFragmentLoading=!1}_requestFragment(e){this._eventBus.publish(c.FragmentLoaderEvents.fragments.fragmentLoadingStarted,e),this.additionalInfo.loadingFragments.url=d.ELoadingState.UNKNOWN,this._addFragmentToQueue(e.url,e.requestedLoadingTimeout,e),this._isFragmentLoading=!0}_addFragmentToQueue(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===(t=this.config)||void 0===t?void 0:t.fragmentLoadingTimeout,n=arguments.length>2?arguments[2]:void 0;this._logger.verbose("Requesting ".concat(e," to load; Fragment ").concat(n.getMsnPn())),n.goToLifecycleStage("loadDataStart");var i=new h.NetworkLoader({url:new URL(e),autoLoad:!0,mode:"arrayBuffer",onStateChanged:this._onLoaderStateChanged,loadingTimeout:r,workerMode:this.config.workerMode},this._eventBus);this._loaders.push(i)}_onLoaderStateChanged(e,t,r){if(this.additionalInfo.loadingFragments[r.url]=t,[d.ELoadingState.LOADED,d.ELoadingState.ERROR,d.ELoadingState.ABORTED].includes(t)){this._logger.verbose("Loader state changed: ".concat(e," -> ").concat(t));var n=this._pendingFragments.find(e=>e.url===r.url);if(n&&(n.stats=r.stats,n.data=r.data),n){r.error&&(n.error=r.error);var i=this._nextStateHandler[t];i&&i(n,r.url),this._nextSequentialRequest(),this._pendingFragments=this._pendingFragments.filter(e=>e!==n),this._loaders=this._loaders.filter(e=>e!==r),this.status=this._loaders.length?"Loading fragments":"Idle"}else this._logger.warn("Downloaded fragment was not even planned. Ignoring it",{url:r.url})}}_onSuccessLoadingState(e,t){this._logger.debug("".concat(t," fragment downloaded (").concat(e.getMsnPn(),")")),e.goToLifecycleStage("loadDataEnd"),delete this.additionalInfo.loadingFragments[t],this._eventBus.publish(c.FragmentLoaderEvents.fragments.fragmentLoaded,e)}_onErrorLoadingState(e,t){this._lastRequestedFragments=this._lastRequestedFragments.filter(e=>e.url!==t),this._logger.debug("".concat(t," fragment loading aborted (").concat(e.getMsnPn(),")")),this._onFragmentLoadAborted(e),this._eventBus.publish(c.FragmentLoaderEvents.fragments.fragmentLoadingError,e)}}t.FragmentLoader=v,n([f.default],v.prototype,"_handleConfigUpdated",null),n([f.default],v.prototype,"_onFragmentsDetected",null),n([f.default],v.prototype,"_onFragmentAddedToBuffer",null),n([f.default],v.prototype,"_onFragmentLoadAborted",null),n([f.default],v.prototype,"_onFragmentHistoryReadyToPrint",null),n([f.default],v.prototype,"_onLoaderStateChanged",null),n([f.default],v.prototype,"_onSuccessLoadingState",null),n([f.default],v.prototype,"_onErrorLoadingState",null)},7216:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableOriginalTargetBufferDecreaserConfigValues=t.defaultOriginalTargetBufferDecreaserConfig=void 0,t.defaultOriginalTargetBufferDecreaserConfig={periodOfEventsToCancelDecrease:1e4,allowTargetBufferDecrease:!1,targetBufferDecreaseTimeout:1e4,maxTargetBufferMultiplier:4},t.availableOriginalTargetBufferDecreaserConfigValues={}},7271:(e,t,r)=>{r.d(t,{A:()=>i});var n=Object.prototype,i=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},7370:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BandwidthNoiseController=void 0;var n=r(6805),i=r(1192),o=r(4181),s=r(3518),l=[{timeFraction:.6,bitrateFraction:.5},{timeFraction:.3,bitrateFraction:.7},{timeFraction:.8,bitrateFraction:1}];class u extends s.ConfigConsumer{constructor(e){super("abrControllerConfig",e),a(this,"_targetBitrate",0),a(this,"_stepTimeout",null),a(this,"_currentResolutionBitrate",0),a(this,"_logger",void 0),this._logger=(0,n.Logger)(this._eventBus,"Ristretto - ABR - BandwidthNoiseController")}startEstimation(e){this._logger.info("Start estimation of bandwidth with target bitrate ".concat((0,o.humanSize)(e),"/s")),this._targetBitrate=e*this.config.noiseTotalBitrate,this._handleNextStep(0)}setCurrentResolutionBitrate(e){this._currentResolutionBitrate=e}hasNoise(){return 0!==this._targetBitrate}reset(){this._logger.info("Resetting noise"),this._stepTimeout&&clearTimeout(this._stepTimeout),this.hasNoise()&&(this._emitNoiseLevel(0),this._targetBitrate=0)}_handleNextStep(e){if(e>=l.length)return this._logger.info("Estimation done successfully"),this._eventBus.publish(i.EAbrControllerEvents.BANDWIDTH_NOISE_TARGET_BITRATE_REACHED,{}),void this.reset();var{timeFraction:t,bitrateFraction:r}=l[e],n=Math.abs(this._targetBitrate-this._currentResolutionBitrate),s=this._currentResolutionBitrate+r*n;this._logger.info("Setting next expected bitrate to ".concat((0,o.humanSize)(s),"/s and waiting ").concat(t*this.config.noiseDecisionDuration,"ms")),this._emitNoiseLevel(s),this._stepTimeout=setTimeout(()=>{this._handleNextStep(e+1)},t*this.config.noiseDecisionDuration)}_emitNoiseLevel(e){this._logger.verbose("Sending noise level",{value:(0,o.humanSize)(e)}),this._eventBus.publishSync(i.EAbrControllerEvents.BANDWIDTH_NOISE_CHANGE,{value:"".concat(e)})}}t.BandwidthNoiseController=u},7422:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(423),i=r(4453),o=r(8446),s=function(e){return(0,o.A)(e)?(0,n.A)(e):(0,i.A)(e)}},7430:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AbrControllerEvents=void 0,t.AbrControllerEvents={resolutionsConstraintsAvailable:"AbrController.resolutionsConstraintsAvailable"}},7433:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.WatchDog=void 0;var o=r(6805),s=r(3309),l=r(9678);class u{constructor(e){a(this,"_eventBusInstance",void 0),a(this,"_playerType",null),a(this,"_lastPlayerTypeSwitchTimestamp",-1),a(this,"_config",i({},s.defaultWatchDogConfig)),a(this,"_onAlivePlayerListener",void 0),this._eventBusInstance=e,this._onAlivePlayerListener=this._eventBusInstance.subscribe(l.EWatchDogEvent.ALIVE_PLAYER,this._onAlivePlayer)}destroy(){this._eventBusInstance.unsubscribe(this._onAlivePlayerListener)}updateConfig(e){void 0!==e.shouldStopPlayer&&(this._config.shouldStopPlayer=e.shouldStopPlayer),void 0!==e.ignoreDurationMs&&(this._config.ignoreDurationMs=e.ignoreDurationMs)}changePlayerType(e){this._playerType=e,this._lastPlayerTypeSwitchTimestamp=performance.now()}_onAlivePlayer(e){var{playerType:t}=e;performance.now()-this._lastPlayerTypeSwitchTimestamp<this._config.ignoreDurationMs||this._playerType===t||!this._config.shouldStopPlayer||this._eventBusInstance.publish(l.EWatchDogEvent.ANOTHER_ACTIVE_PLAYER,{wrongPlayer:t})}}t.WatchDog=u,n([o.bind],u.prototype,"_onAlivePlayer",null)},7465:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.checkCodecsSupported=t.extractCodecsFromSDP=t.KNOWN_CODECS=void 0;var n=r(6375);t.KNOWN_CODECS={H264:"H264/90000",VP8:"VP8/90000",VP9:"VP9/90000",OPUS:"opus/48000"};var i=/a=rtpmap:\d+\s/;t.extractCodecsFromSDP=e=>{var{sdp:t}=e;if(!t)return[];var r=t.split(/\r?\n/).filter(e=>e.match(i));return[...new Set(r.map(e=>e.replace(i,"")))]},t.checkCodecsSupported=function(){var e=s(function*(e,r){try{var i="play"===e?"recvonly":"sendonly",o=new((0,n.resolveRTCPeerConnection)())({iceServers:[]});o.addTransceiver&&(o.addTransceiver("audio",{direction:i}),o.addTransceiver("video",{direction:i}));var s=yield o.createOffer({}),a=(0,t.extractCodecsFromSDP)(s);return o.close(),r.filter(e=>a.includes(e))}catch(e){return[]}});return function(t,r){return e.apply(this,arguments)}}()},7469:function(e,t,r){var n,o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},c=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&o(t,e,r[i]);return l(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.RistrettoPlayerWrapper=void 0;var d=r(9678),h=r(2502),f=r(3362),p=r(6805),v={framesDecoded:{originalPath:"inbound-rtp:video.framesDecoded",modifier:"raw",reducer:"sum",filter:"number"},nackCount:{originalPath:"inbound-rtp:video.nackCount",modifier:"raw",reducer:"sum",filter:"number"},totalFreezesDuration:{originalPath:"inbound-rtp:video.totalFreezesDuration",modifier:"raw",reducer:"sum",filter:"number"},totalPausesDuration:{originalPath:"inbound-rtp:video.totalPausesDuration",modifier:"raw",reducer:"sum",filter:"number"},fecPacketsReceived:{originalPath:"inbound-rtp.fecPacketsReceived",modifier:"raw",reducer:"sum",filter:"number"},fecPacketsDiscarded:{originalPath:"inbound-rtp.fecPacketsDiscarded",modifier:"raw",reducer:"sum",filter:"number"},framesReceived:{originalPath:"inbound-rtp:video.framesReceived",modifier:"raw",reducer:"sum",filter:"number"},packetsLost:{originalPath:"inbound-rtp.packetsLost",modifier:"raw",reducer:"sum",filter:"number"},packetsDiscarded:{originalPath:"inbound-rtp.packetsDiscarded",modifier:"raw",reducer:"sum",filter:"number"},packetsReceived:{originalPath:"inbound-rtp.packetsReceived",modifier:"raw",reducer:"sum",filter:"number"},totalRoundTripTime:{originalPath:"candidate-pair.totalRoundTripTime",modifier:"raw",reducer:"sum",filter:"nonzero"},responsesReceived:{originalPath:"candidate-pair.responsesReceived",modifier:"raw",reducer:"sum",filter:"nonzero"},audioJitter:{originalPath:"inbound-rtp:audio.jitter",modifier:"raw",reducer:"sum",filter:"number"},videoJitter:{originalPath:"inbound-rtp:video.jitter",modifier:"raw",reducer:"sum",filter:"number"}},g=Object.keys(v);class _ extends h.AbstractWrapper{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),a(this,"_ristrettoModuleCache",null),a(this,"_abrResolutions",[]),a(this,"_isABREnabled",!1),a(this,"_isLoadingPlayerModule",!1),a(this,"_logLevels",[]),a(this,"_ristrettoPlaybackStateToMMPStateMap",null),a(this,"_toggleTurnServersListener",void 0),this._toggleTurnServersListener=e.subscribe(f.EPlayersEvents.TOGGLE_TURN_SERVERS,this._toggleTURNServers)}destroy(){return this._eventBusInstance.unsubscribe(this._toggleTurnServersListener),super.destroy()}setStreamConfig(e){return null!=e&&e.WebRTCSignallingUrl?(this._lastKnownStreamConfig={WebRTCStreamId:e.WebRTCStreamId,WebRTCACLToken:null==e?void 0:e.WebRTCACLToken,WebRTCSignallingUrl:null==e?void 0:e.WebRTCSignallingUrl},this._setStreamConfig(),this):(this._lastKnownStreamConfig=null,this)}enableAbr(){var e;return this._isABREnabled=!0,null!==(e=this._playerInstance)&&void 0!==e&&e.enableABR(),this}disableAbr(){var e;return this._isABREnabled=!1,null!==(e=this._playerInstance)&&void 0!==e&&e.disableABR(),this}setAbrResolutions(e){var t;return this._abrResolutions=e,null!==(t=this._playerInstance)&&void 0!==t&&t.setAbrResolutionsVariants(e),this}setLoggerLevel(e){var t;null!==(t=this._playerInstance)&&void 0!==t&&t.setLoggerLevels(e),this._logLevels=e}setResolutionByName(e){var t;return null!==(t=this._playerInstance)&&void 0!==t&&t.setQualityByName(e),this}setResolutionByBitrate(e){var t;return null!==(t=this._playerInstance)&&void 0!==t&&t.setQualityByBitrate(e),this}recreatePlayerInstance(){var e=this;return s(function*(){e._playerInstance&&!e._persistent&&(e.destroy(),e._playerInstance=null),yield e._createPlayerInstance()})()}setPlayerConfig(e){var t,r;return this._lastKnownConfig=e,this._lastKnownConfig.peerConnectionConfig||(this._lastKnownConfig.peerConnectionConfig={}),null!==(t=this._lastKnownConfig.peerConnectionConfig)&&void 0!==t&&t.statsCollectionScheme?this._lastKnownConfig.peerConnectionConfig.statsCollectionScheme=i(i({},this._lastKnownConfig.peerConnectionConfig.statsCollectionScheme),v):this._lastKnownConfig.peerConnectionConfig.statsCollectionScheme=v,null!==(r=this._playerInstance)&&void 0!==r&&r.setConfig(e,!0),this}setResolutionLimits(){return this}get version(){var e;return null===(e=this._playerInstance)||void 0===e?void 0:e.version}_attachEventListeners(){this._ristrettoModuleCache&&this._playerInstance&&(this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.DEBUGGER_CONNECTED,this._onDebuggerConnected),this._playerInstance.addEventListener(this._ristrettoModuleCache.EPlayerEvent.PLAY_STATE_CHANGED,this._onPlaybackStateChanged),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.ERROR,this._onRistrettoError),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.PEER_METRICS_AVAILABLE,this._onPeerMetricsAvailable),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.LIFECYCLE_EVENT,this._onLifecycleEventReported),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.LIFECYCLE_ERROR,this._onLifecycleErrorReported),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.RESOLUTION_SWITCH_AUTO,this._onRenditionSwitchAuto),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.RESOLUTIONS_AVAILABLE,this._onResolutionsAvailable),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.QUALITY_CHANGED,this._onQualityChanged),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.LATENCY_ESTIMATION_AVAILABLE,this._onLatencyEstimationAvailable),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.WEBSOCKET_ALIVE_MESSAGE,this._onWebSocketAliveMessage))}_detachEventListeners(){this._ristrettoModuleCache&&this._playerInstance&&(this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.DEBUGGER_CONNECTED,this._onDebuggerConnected),this._playerInstance.removeEventListener(this._ristrettoModuleCache.EPlayerEvent.PLAY_STATE_CHANGED,this._onPlaybackStateChanged),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.ERROR,this._onRistrettoError),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.PEER_METRICS_AVAILABLE,this._onPeerMetricsAvailable),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.RESOLUTION_SWITCH_AUTO,this._onRenditionSwitchAuto),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.RESOLUTIONS_AVAILABLE,this._onResolutionsAvailable),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.QUALITY_CHANGED,this._onQualityChanged),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.LATENCY_ESTIMATION_AVAILABLE,this._onLatencyEstimationAvailable),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.WEBSOCKET_ALIVE_MESSAGE,this._onWebSocketAliveMessage))}_createPlayerInstance(){var e=this;return s(function*(){var t,r,n,i,o,s,a;e._ristrettoModuleCache?(e._persistent&&e._playerInstance||(e._destroyPlayerInstance(),e._playerInstance=new e._ristrettoModuleCache.Player),e._lastKnownConfig&&e._playerInstance.setConfig(e._lastKnownConfig,!0),null!==(t=e._playerInstance)&&void 0!==t&&t.setConfig({peerConnectionConfig:{statsCollectionScheme:v,statsGatheringPeriod:500}}),e._setStreamConfig(),e._playerInstance.setAppKey(e._appKey),e._videoElement&&e._playerInstance.setVideoElement(e._videoElement),e._attachEventListeners(),null!==(r=e._playerInstance)&&void 0!==r&&r.setAppKey("callbackApp"),e._isStarted&&null!==(n=e._playerInstance)&&void 0!==n&&n.start(),e._isABREnabled?null===(i=e._playerInstance)||void 0===i||i.enableABR():null===(o=e._playerInstance)||void 0===o||o.disableABR(),null!==(s=e._playerInstance)&&void 0!==s&&s.setAbrResolutionsVariants(e._abrResolutions),null===(a=e._playerInstance)||void 0===a||a.setLoggerLevels(e._logLevels)):yield e._loadRistrettoModule()})()}_setStreamConfig(){var e;this._playerInstance&&this._lastKnownStreamConfig&&(null===(e=this._playerInstance)||void 0===e||e.setStreamConfig({aclToken:this._lastKnownStreamConfig.WebRTCACLToken,streamId:this._lastKnownStreamConfig.WebRTCStreamId,wsUrl:this._lastKnownStreamConfig.WebRTCSignallingUrl},!0))}_loadRistrettoModule(){var e=this;return s(function*(){if(!e._isLoadingPlayerModule){e._isLoadingPlayerModule=!0;var{EStreamStatus:t,Player:n,ECommonEvents:i,EPlayerEvent:o}=yield Promise.resolve().then(()=>c(r(5544)));e._ristrettoModuleCache={EStreamStatus:t,Player:n,ECommonEvents:i,EPlayerEvent:o},e._ristrettoPlaybackStateToMMPStateMap={[t.UNKNOWN]:p.EPlaybackState.IDLE,[t.CONNECTING]:p.EPlaybackState.LOADING,[t.LIVE]:p.EPlaybackState.PLAYING,[t.FINISHED]:p.EPlaybackState.PAUSED,[t.ERRORED]:p.EPlaybackState.ERROR},e._isLoadingPlayerModule=!1,e._createPlayerInstance()}})()}_onDebuggerConnected(e){var{detail:{debuggerUrl:t}}=e;this._eventBusInstance.publish(f.EPlayersEvents.DEBUGGER_CONNECTED,{debuggerUrl:t})}_onPlaybackStateChanged(e){var{detail:{prevState:t,nextState:r}}=e;this._ristrettoPlaybackStateToMMPStateMap&&this._eventBusInstance.publish(f.EPlayersEvents.PLAYBACK_STATE_CHANGED,{nextState:this._ristrettoPlaybackStateToMMPStateMap[r],prevState:this._ristrettoPlaybackStateToMMPStateMap[t]})}_onRistrettoError(e){var{detail:t}=e;this._eventBusInstance.publish(f.EPlayersEvents.ERROR,{error:new Error("Ristretto player error: ".concat(t.info)),isFatal:t.isFatal,playerType:p.EPlayerType.WEBRTC})}_onPeerMetricsAvailable(e){var t,{detail:{metrics:r}}=e,n=g.reduce((e,t)=>(Object.hasOwn(r,t)&&(e[t]=r[t]),e),{});null!==(t=this._metricsCollector)&&void 0!==t&&t.registerMetrics(n),this._eventBusInstance.publish(d.EWatchDogEvent.ALIVE_PLAYER,{playerType:p.EPlayerType.WEBRTC})}_onLifecycleEventReported(e){var t,{detail:{eventType:r}}=e;null===(t=this._metricsCollector)||void 0===t||t.registerEvent(r)}_onLifecycleErrorReported(e){var t,{detail:{errorType:r,nativeError:n}}=e;null===(t=this._metricsCollector)||void 0===t||t.registerEvent(r,{errorMessage:(null==n?void 0:n.message)||""})}_onResolutionsAvailable(e){var{detail:{resolutions:t}}=e,r=t.map(e=>({name:e.name,bitrate:e.bitrate,width:e.width||0,height:e.height||0,url:""}));this._eventBusInstance.publish(f.EPlayersEvents.RESOLUTIONS_AVAILABLE,{resolutions:r})}_onRenditionSwitchAuto(e){var t,{detail:{prevResolution:r,nextResolution:n}}=e;null!==(t=this._metricsCollector)&&void 0!==t&&t.registerEvent("RenditionSwitchedAuto",{prevResolution:r,nextResolution:n}),this._eventBusInstance.publish(f.EPlayersEvents.AUTO_RESOLUTION_SWITCHED,{name:n})}_toggleTURNServers(e){var t,{shouldUseTURNServers:r}=e;null===(t=this._playerInstance)||void 0===t||t.toggleTURNServersUsage(r)}_onQualityChanged(e){var{detail:{name:t}}=e;this._eventBusInstance.publish(f.EPlayersEvents.RESOLUTION_SWITCHED,{name:t})}_onLatencyEstimationAvailable(e){var{detail:{latencyEstimationEWMA:t,latencyEstimationMedian:r}}=e;this._eventBusInstance.publish(f.EPlayersEvents.LATENCY_ESTIMATION_AVAILABLE,{medianLatency:r,EWMALatency:t})}_onWebSocketAliveMessage(){this._eventBusInstance.publish(d.EWatchDogEvent.ALIVE_PLAYER,{playerType:p.EPlayerType.WEBRTC})}}t.RistrettoPlayerWrapper=_,u([p.bind],_.prototype,"_onDebuggerConnected",null),u([p.bind],_.prototype,"_onPlaybackStateChanged",null),u([p.bind],_.prototype,"_onRistrettoError",null),u([p.bind],_.prototype,"_onPeerMetricsAvailable",null),u([p.bind],_.prototype,"_onLifecycleEventReported",null),u([p.bind],_.prototype,"_onLifecycleErrorReported",null),u([p.bind],_.prototype,"_onResolutionsAvailable",null),u([p.bind],_.prototype,"_onRenditionSwitchAuto",null),u([p.bind],_.prototype,"_toggleTURNServers",null),u([p.bind],_.prototype,"_onQualityChanged",null),u([p.bind],_.prototype,"_onLatencyEstimationAvailable",null),u([p.bind],_.prototype,"_onWebSocketAliveMessage",null)},7480:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),r(5221),r(1661),r(5170),r(7114),r(4507)},7485:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availablePlaybackStateControllerConfig=t.defaultPlaybackStateControllerConfig=void 0,t.defaultPlaybackStateControllerConfig={autoPlay:!1,syncToLiveEdge:!1,syncToLiveDelta:1,playingTimeFractionCollectionWindow:1e5,stallDurationToDisableTargetBufferDecrease:1e4},t.availablePlaybackStateControllerConfig={}},7590:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableFragmentsFilterConfigValues=t.defaultFragmentsFilterConfig=void 0,t.defaultFragmentsFilterConfig={reportInconsistentTracks:!0,filterOutInconsistentTracks:!1},t.availableFragmentsFilterConfigValues={}},7647:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RISTRETTO_VERSION=void 0,t.RISTRETTO_VERSION="v2.1.0"},7691:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.exponentialAwait=void 0,t.exponentialAwait=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return new Promise(r=>{var n=Math.pow(2,e)*t,i=.2*n*Math.random();setTimeout(()=>{r()},n+i)})}},7742:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DroppedFramesEstimator=void 0;var o=r(8473),s=r(355),l=r(8169),u=r(180),c=i(r(6073));class d extends l.ConfigConsumer{constructor(e){super("droppedFramesEstimator",e),a(this,"state",u.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{droppedFramesByResolution:{}}),a(this,"groups",["abr"]),a(this,"_lastClearTs",0),a(this,"_onMetricsReadyListener",void 0),a(this,"_droppedFramesHistory",new o.DroppedFramesHistory(this._eventBus)),this._onMetricsReadyListener=this._eventBus.subscribe(s.BufferControllerEvents.bufferMetricsAvailable,this._onMetricsReady)}destroy(){super.destroy(),this._droppedFramesHistory.destroy(),this._eventBus.unsubscribe(this._onMetricsReadyListener)}reset(){this._droppedFramesHistory.reset()}getNextEstimatedResolution(e){var{minimalFramesPlayed:t}=this.config;return e.find(e=>{var{name:r}=e,n=this._droppedFramesHistory.getResolutionHistoryByName(r);return this.additionalInfo.droppedFramesByResolution[r]=n,!n||n.totalFramesNumber<t||n.droppedFramesNumber/n.totalFramesNumber<this.config.optimalDroppedFramesFraction})||null}_handleConfigUpdated(){}_onMetricsReady(e){e.currentTimestamp-this._lastClearTs>this.config.resetHistoryTimeout&&(this._droppedFramesHistory.reset(),this._lastClearTs=e.currentTimestamp)}}t.DroppedFramesEstimator=d,n([c.default],d.prototype,"_onMetricsReady",null)},7803:(e,t,r)=>{r.d(t,{A:()=>T});var n=r(124),i=r(1917),o=(0,n.A)(i.A,"DataView"),s=r(8335),a=(0,n.A)(i.A,"Promise"),l=r(9857),u=r(3631),c=r(2383),d=r(1121),h="[object Map]",f="[object Promise]",p="[object Set]",v="[object WeakMap]",g="[object DataView]",_=(0,d.A)(o),m=(0,d.A)(s.A),y=(0,d.A)(a),b=(0,d.A)(l.A),E=(0,d.A)(u.A),S=c.A;(o&&S(new o(new ArrayBuffer(1)))!=g||s.A&&S(new s.A)!=h||a&&S(a.resolve())!=f||l.A&&S(new l.A)!=p||u.A&&S(new u.A)!=v)&&(S=function(e){var t=(0,c.A)(e),r="[object Object]"==t?e.constructor:void 0,n=r?(0,d.A)(r):"";if(n)switch(n){case _:return g;case m:return h;case y:return f;case b:return p;case E:return v}return t});var T=S},7813:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CommonEntrypoint=t.ECommonEvents=void 0;var o,s=r(6805),l=r(3518),u=r(2512),c=r(5148),d=r(1675),h=r(2456),f=r(641),p=r(9476),v=r(942),g=i(r(5354)),_=r(1222),m=r(8748),y=r(7647);!function(e){e.ERROR="error",e.DEBUGGER_CONNECTED="debuggerConnected",e.PEER_METRICS_AVAILABLE="peerMetricsAvailable",e.LIFECYCLE_EVENT="lifecycleEvent",e.LIFECYCLE_ERROR="lifecycleError",e.RESOLUTION_SWITCH_AUTO="resolutionSwitchAuto",e.RESOLUTIONS_AVAILABLE="resolutionsAvailable",e.QUALITY_CHANGED="qualityChanged",e.LATENCY_ESTIMATION_AVAILABLE="latencyEstimationAvailable",e.WEBSOCKET_ALIVE_MESSAGE="websocketMessage"}(o||(t.ECommonEvents=o={}));class b extends s.CustomEventTarget{constructor(){super(),a(this,"_logger",void 0),a(this,"_isStarted",!1),a(this,"_loggerTransport",void 0),a(this,"_debugger",void 0),a(this,"_loggerSideTransport",null),a(this,"_loggerOOTransport",null),a(this,"_eventBus",void 0),a(this,"_onCommonErrorReportedListener",void 0),a(this,"_onDebuggerConnectedListener",void 0),a(this,"_onPeerMetricsAvailableListener",void 0),a(this,"_onLifecycleEventListener",void 0),a(this,"_onLifecycleErrorListener",void 0),a(this,"_onResolutionSwitchedAutoListener",void 0),a(this,"_onStreamInfoAvailableListener",void 0),a(this,"_onQualityChangedListener",void 0),a(this,"_onStreamPlayingListener",void 0),a(this,"_onLatencyEstimationAvailableListener",void 0),a(this,"_onStreamRelatedMessageReceivedListener",void 0),this._eventBus=new s.EventBus,this._debugger=new u.Debugger(this._eventBus),this._loggerTransport=new s.LoggerConsoleTransport(this._eventBus),this._logger=(0,s.Logger)(this._eventBus,"Ristretto - core"),this._onCommonErrorReportedListener=this._eventBus.subscribe(_.ECommonEvent.COMMON_ERROR,this._onCommonErrorReported),this._onDebuggerConnectedListener=this._eventBus.subscribe(c.EDebuggerEvent.DEBUGGER_CONNECTED,this._onDebuggerConnected),this._onPeerMetricsAvailableListener=this._eventBus.subscribe(v.EPeerConnectionEvents.STATS_AVAILABLE,this._onPeerMetricsAvailable),this._onLifecycleEventListener=this._eventBus.subscribe(d.ELifecycleEvent.LIFECYCLE_EVENT,this._onLifecycleEventReported),this._onLifecycleErrorListener=this._eventBus.subscribe(d.ELifecycleEvent.LIFECYCLE_ERROR,this._onLifecycleErrorReported),this._onResolutionSwitchedAutoListener=this._eventBus.subscribe(d.ELifecycleEvent.RESOLUTION_SWITCH_AUTO,this._onResolutionSwitchedAuto),this._onStreamInfoAvailableListener=this._eventBus.subscribe(p.EMetadataTransportEvents.STREAM_INFO_AVAILABLE,this._onStreamInfoAvailable),this._onQualityChangedListener=this._eventBus.subscribe(p.EMetadataTransportEvents.CHANGE_QUALITY_STATUS,this._onQualityChanged),this._onStreamPlayingListener=this._eventBus.subscribe(p.EMetadataTransportEvents.STREAM_PLAYING,this._onStreamPlaying),this._onLatencyEstimationAvailableListener=this._eventBus.subscribe(m.ELatencyControllerEvents.LATENCY_ESTIMATION_AVAILABLE,this._onLatencyEstimationAvailable),this._onStreamRelatedMessageReceivedListener=this._eventBus.subscribe(p.EMetadataTransportEvents.STREAM_RELATED_MESSAGE_RECEIVED,this._onStreamRelatedMessageReceived)}destroy(){var e,t,r;this._logger.info("Destroyed"),this.stop(),this._eventBus.unsubscribe(this._onCommonErrorReportedListener),this._eventBus.unsubscribe(this._onDebuggerConnectedListener),this._eventBus.unsubscribe(this._onPeerMetricsAvailableListener),this._eventBus.unsubscribe(this._onLifecycleEventListener),this._eventBus.unsubscribe(this._onLifecycleErrorListener),this._eventBus.unsubscribe(this._onResolutionSwitchedAutoListener),this._eventBus.unsubscribe(this._onStreamInfoAvailableListener),this._eventBus.unsubscribe(this._onQualityChangedListener),this._eventBus.unsubscribe(this._onStreamPlayingListener),this._eventBus.unsubscribe(this._onLatencyEstimationAvailableListener),this._eventBus.unsubscribe(this._onStreamRelatedMessageReceivedListener),null!==(e=this._loggerTransport)&&void 0!==e&&e.destroy(),null!==(t=this._loggerSideTransport)&&void 0!==t&&t.destroy(),null===(r=this._loggerOOTransport)||void 0===r||r.destroy()}get version(){return y.RISTRETTO_VERSION}enableOOLogCollector(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug";null!==(t=this._loggerOOTransport)&&void 0!==t&&t.destroy(),this._loggerOOTransport=new h.LoggerOpenObserveTransport(this._eventBus,e,r),this._retuneOOLogger()}setConfig(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,l.setConfig)(e,this._eventBus,t)}isStarted(){return this._isStarted}sendRawWSMessage(e){this._eventBus.publish(p.EMetadataTransportEvents.SEND_RAW_MESSAGE,{msg:e})}setLoggerLevels(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this._logger.info("Logger level updated, new level is ".concat(e)),this._loggerTransport&&(this._loggerTransport.destroy(),this._loggerTransport=null),e.length&&(this._loggerTransport=new s.LoggerConsoleTransport(this._eventBus,e,t,r))}registerLoggerCallback(e){this._loggerSideTransport||(this._loggerSideTransport=new f.LoggerSideTransport(this._eventBus)),this._loggerSideTransport.registerSideLoggerCallback(e)}_onCommonErrorReported(e){var{error:t}=e;this._logger.info("Error reported",t),t.isFatal&&(this._logger.fatal("Reported error is fatal. Stopping"),this.stop()),this.emitEvent(o.ERROR,t)}_onDebuggerConnected(e){this.emitEvent(o.DEBUGGER_CONNECTED,{debuggerUrl:e})}_onLifecycleEventReported(e){var{eventType:t}=e;this.emitEvent(o.LIFECYCLE_EVENT,{eventType:t})}_onLifecycleErrorReported(e){var{errorType:t,nativeError:r}=e;this.emitEvent(o.LIFECYCLE_ERROR,{errorType:t,nativeError:r})}_onStreamInfoAvailable(e){this.emitEvent(o.RESOLUTIONS_AVAILABLE,{resolutions:e.presets})}_onResolutionSwitchedAuto(e){var{prevResolution:t,nextResolution:r}=e;this.emitEvent(o.RESOLUTION_SWITCH_AUTO,{prevResolution:t,nextResolution:r})}_onPeerMetricsAvailable(e){var{stats:t}=e;this.emitEvent(o.PEER_METRICS_AVAILABLE,{metrics:t})}_onQualityChanged(e){var{payload:t}=e;"success"===t.status&&t.currentQuality&&this.emitEvent(o.QUALITY_CHANGED,{name:t.currentQuality})}_onStreamPlaying(e){var{quality:t}=e;this.emitEvent(o.QUALITY_CHANGED,{name:t})}_onLatencyEstimationAvailable(e){var{latencyEstimationEWMA:t,latencyEstimationMedian:r}=e;this.emitEvent(o.LATENCY_ESTIMATION_AVAILABLE,{latencyEstimationMedian:r,latencyEstimationEWMA:t})}_onStreamRelatedMessageReceived(){this.emitEvent(o.WEBSOCKET_ALIVE_MESSAGE,{})}}t.CommonEntrypoint=b,n([g.default],b.prototype,"_onCommonErrorReported",null),n([g.default],b.prototype,"_onDebuggerConnected",null),n([g.default],b.prototype,"_onLifecycleEventReported",null),n([g.default],b.prototype,"_onLifecycleErrorReported",null),n([g.default],b.prototype,"_onStreamInfoAvailable",null),n([g.default],b.prototype,"_onResolutionSwitchedAuto",null),n([g.default],b.prototype,"_onPeerMetricsAvailable",null),n([g.default],b.prototype,"_onQualityChanged",null),n([g.default],b.prototype,"_onStreamPlaying",null),n([g.default],b.prototype,"_onLatencyEstimationAvailable",null),n([g.default],b.prototype,"_onStreamRelatedMessageReceived",null)},7833:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentLoaderEvents=void 0,t.FragmentLoaderEvents={fragments:{fragmentLoaded:"fragmentLoader.fragments.fragmentLoaded",fragmentLoadingStarted:"fragmentLoader.fragments.fragmentLoadingStarted",fragmentLoadingAborted:"fragmentLoader.fragments.fragmentLoadingAborted",fragmentLoadingError:"fragmentLoader.fragments.fragmentLoadingError",fragmentHistoryReadyForPrint:"fragmentLoader.fragments.fragmentHistoryReadyForPrint"}}},7838:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatsAnalyzer=void 0;var n=r(6805),i=r(1192),o=r(4181),s=r(3518),l=r(2973);class u extends s.ConfigConsumer{constructor(e,t){super("abrControllerConfig",e),a(this,"_targetBitrate",0),a(this,"_lastBytesReceived",0),a(this,"_lastStatTimestamp",0),a(this,"_lastBitrateCollectionTimestamp",0),a(this,"_fpsAfterFailCooldownTimestamp",0),a(this,"_lastNackCount",0),a(this,"_storedResults",0),a(this,"_violationsAmountBitrate",0),a(this,"_violationsAmountFreeze",0),a(this,"_violationsAmountFPS",0),a(this,"_lastTotalFreezeDuration",0),a(this,"_bandwidthNoiseController",void 0),a(this,"_ewma",void 0),a(this,"_logger",void 0),this._logger=(0,n.Logger)(this._eventBus,"Ristretto - ABR - StatsAnalyzer"),this._ewma=new l.EWMA(this.config.bitrateEWMAFastAlpha,this.config.bitrateEWMASlowAlpha),this._bandwidthNoiseController=t}reset(){this._ewma.reset(),this._targetBitrate=0,this._lastBytesReceived=0,this._lastStatTimestamp=0,this._storedResults=0,this._violationsAmountBitrate=0,this._violationsAmountFreeze=0,this._violationsAmountFPS=0,this._lastBitrateCollectionTimestamp=0,this._lastTotalFreezeDuration=0}updateStats(e){if(!this._lastStatTimestamp)return this._logger.verbose("No last timestamp defined. Skipping"),void(this._lastStatTimestamp=performance.now());var t=(performance.now()-this._lastStatTimestamp)/1e3;this._lastStatTimestamp=performance.now();var r=this._analyzeStreamBitrateStats(e),n=this._analyzeStreamFreezesStats(e,t),o=this._analyzeStreamFPSStats(e),s=this._bandwidthNoiseController.hasNoise();r&&n&&(o||!s&&!1!==this.config.ignoreFPSViolationsWithoutNoise)||(this._logger.verbose("Problems with the stream stats detected",{isBitrateOk:r,isFreezesOk:n,isFPSOk:o,hasNoise:s}),this._eventBus.publish(i.EAbrControllerEvents.NOT_ENOUGH_BANDWIDTH_DETECTED,{}))}setTargetBitrate(e){this._logger.debug("Set target bitrate",{bitrate:(0,o.humanSize)(Number(e))}),this._targetBitrate=Number(e)}_analyzeStreamBitrateStats(e){var t=(performance.now()-this._lastBitrateCollectionTimestamp)/1e3;if(t<this.config.bitrateCollectionTimeout/1e3)return!0;this._lastBitrateCollectionTimestamp=performance.now();var r=this._getBitrate(e,t);if(!r||r<0)return this._logger.verbose("No current bitrate known. Return"),!0;var n=Math.abs(r-this._targetBitrate)/this._targetBitrate;return this._logger.debug("Bitrate stats",{diff:n,thisViolationsAmount:this._violationsAmountBitrate,configViolationsAmount:this.config.violationsToReportBitrate,currentBitrate:(0,o.humanSize)(r||0),thisTargetBitrate:(0,o.humanSize)(this._targetBitrate||0),bitrateThreshold:this.config.bitrateThreshold}),r>this._targetBitrate?(this._logger.verbose("Current bitrate (".concat((0,o.humanSize)(r),"/s) > (").concat((0,o.humanSize)(this._targetBitrate),"/s). Skipping")),this._violationsAmountBitrate=0,!0):n>this.config.bitrateThreshold?(this._logger.verbose("Current bitrate (".concat((0,o.humanSize)(r),"/s) < target (").concat((0,o.humanSize)(this._targetBitrate),"/s); diff (").concat(n.toFixed(2),") > (").concat(this.config.bitrateThreshold,"). Saving")),this._violationsAmountBitrate<this.config.violationsToReportBitrate?(this._violationsAmountBitrate++,!0):(this._logger.verbose("Detected more than ".concat(this.config.violationsToReportBitrate," violations. Report bad bandwidth")),this._violationsAmountBitrate=0,!1)):(this._logger.verbose("Bitrates diff (".concat(n.toFixed(2),") < threshold (").concat(this.config.bitrateThreshold,"). OK")),this._violationsAmountBitrate=0,!0)}_getBitrate(e,t){var r,n,i=!this._bandwidthNoiseController.hasNoise(),s=1===e.length?e[0]["candidate-pair"]:null===(r=e.find(e=>{var t,r;return"succeeded"===(null===(t=e["candidate-pair"])||void 0===t?void 0:t.state)&&(null===(r=e["candidate-pair"])||void 0===r?void 0:r.bytesReceived)}))||void 0===r?void 0:r["candidate-pair"],a=1===e.length?e[0]["inbound-rtp"]:null===(n=e.find(e=>{var t;return void 0!==(null===(t=e["inbound-rtp"])||void 0===t?void 0:t.nackCount)}))||void 0===n?void 0:n["inbound-rtp"];if(null==s||!s.bytesReceived||void 0===(null==a?void 0:a.nackCount)||!a.packetsReceived||!a.bytesReceived)return null;if(!this._lastBytesReceived||!this._lastStatTimestamp)return this._logger.verbose("No lastBytesReceived or lastStatTimestamp defined"),this._lastBytesReceived=i?a.bytesReceived:s.bytesReceived,this._lastNackCount=a.nackCount,null;var l,u=a.bytesReceived/a.packetsReceived*8;l=i?8*(a.bytesReceived-this._lastBytesReceived):8*(s.bytesReceived-this._lastBytesReceived);var c=(a.nackCount-this._lastNackCount)*u,d=l/t-c;return this._logger.verbose("Actual bitrate is ".concat((0,o.humanSize)(l/t),"/s, nack bitrate is ").concat((0,o.humanSize)(c),"/s (").concat((100*c/(l/t)).toFixed(2),"%)")),this._lastStatTimestamp=performance.now(),this._lastBytesReceived=i?a.bytesReceived:s.bytesReceived,this._lastNackCount=a.nackCount,this._ewma.addValue(d),this._storedResults<this.config.resultsToBecomeConfident?(this._logger.verbose("Collecting results to become confident"),this._storedResults++,null):this._bandwidthNoiseController.hasNoise()?Math.max(this._ewma.getCurrentMaximalValue(),d):this._ewma.getCurrentValue()}_analyzeStreamFreezesStats(e,t){var r,n=1===e.length?e[0]["inbound-rtp"]:null===(r=e.find(e=>{var t;return void 0!==(null===(t=e["inbound-rtp"])||void 0===t?void 0:t.nackCount)}))||void 0===r?void 0:r["inbound-rtp"],i=null==n?void 0:n.totalFreezesDuration;if(void 0===i||0===t)return!0;var o=i-this._lastTotalFreezeDuration;this._lastTotalFreezeDuration=i;var s=o/t;return this._bandwidthNoiseController.hasNoise()&&this._logger.verbose("Freezes duration ratio is ".concat((100*s).toFixed(2),"%")),s>=this.config.freezeDurationToReport?this._violationsAmountFreeze<this.config.violationsToReportFreeze?(this._violationsAmountFreeze++,!0):(this._violationsAmountFreeze=0,!1):(this._violationsAmountFreeze=0,!0)}_analyzeStreamFPSStats(e){var t=performance.now();if(this._fpsAfterFailCooldownTimestamp&&t-this._fpsAfterFailCooldownTimestamp<this.config.fpsAfterFailCooldownTimeout)return!0;var r=e[0]["inbound-rtp"];return((null==r?void 0:r.framesPerSecond)||0)<this.config.maxFPSToAssumeZero?this._violationsAmountFPS<this.config.violationsToReportFPS?(this._violationsAmountFPS++,!0):(this._violationsAmountFPS=0,this._fpsAfterFailCooldownTimestamp=t,!1):(this._violationsAmountFPS=0,!0)}}t.StatsAnalyzer=u},7880:(e,t,r)=>{r.d(t,{A:()=>i});var n=/\s/,i=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},7882:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderController=void 0;var i=r(6847),o=r(4578),s=r(2886),l=r(6671),u=r(9208);class c{constructor(e){a(this,"_canvasVideoRenderer",null),a(this,"_logger",void 0),a(this,"_config",{}),a(this,"_isLocalVideo",!1),a(this,"_eventsMap",{[o.EVideoElementControllerBusEvent.SET_VOLUME]:this._setVolume,[o.EVideoElementControllerBusEvent.DESTROY]:this._destroy}),a(this,"_state",void 0),a(this,"_eventBus",void 0),this._state=e.state,this._eventBus=e.eventBus,this._logger=(0,i.Logger)(this._eventBus,"VideoElementController - RenderController"),this._logger.info("Created"),this._logger.debug("Initial config",this._config),this._logger.debug("Initial state",this._state),this.init()}setConfig(e){this._logger.debug("Config update received, the new one:",e),this._config=e,this.applyConfigToVideoElement()}init(){this._logger.info("Initialization requested, attaching eventBus listeners"),this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}getElements(){var{videoElement:e,canvasElement:t,ownContainer:r}=this._state.getState();return{videoElement:e,canvasElement:t,ownContainer:r}}getVideoElement(){return this.getElements().videoElement}getCanvasElement(){return this.getElements().canvasElement}renderVideoInto(e){var{ownContainer:t,videoElement:r}=this.getElements();this._logger.debug("renderVideoInto method was called");var n=!1;if(e&&r){var i,o=t||e;r.parentElement!==o&&(n=!0,o.appendChild(r));var s=null===(i=this._canvasVideoRenderer)||void 0===i?void 0:i.getCanvasElement();this._canvasVideoRenderer&&(null==s?void 0:s.parentElement)!==o&&(n=!0,o.appendChild(s),this._logger.info("Canvas element has been rendered to DOM")),o===t&&t.parentElement!==e&&(n=!0,e.appendChild(t)),n?this._logger.info("Video element has been rendered to DOM"):this._logger.verbose("Skipping video element render: video element is already mounted to the DOM.")}}setVideoElement(e,t){this._logger.debug("Video element updated",{videoElement:e}),e!==this.getVideoElement()?(this._isLocalVideo&&(this._logger.verbose("Removing video element and container from document"),(0,s.removeElementFromDocument)(this.getElements().videoElement),(0,s.removeElementFromDocument)(this.getElements().ownContainer)),this._state.setState({videoElement:e,ownContainer:t}),this.applyConfigToVideoElement()):this._logger.verbose("Received video element is equal to the previous one. Skipping")}applyConfigToVideoElement(){if(this._logger.debug("Applying config to the video element"),this.getVideoElement()){var e=this.getVideoElement();if(e){var{isNonAnonymous:t,isMuted:r,nativeControls:n,videoElementClassName:i,canvasElementClassName:s,shouldUseCanvas:a,rootElement:l,autoplay:u}=this._config;this._logger.verbose("Applied config",this._config),u&&(e.autoplay=!0),e.playsInline=!0,void 0!==n&&(e.controls=!!n),void 0!==r&&(e.muted=!!r),void 0!==t&&(t?e.removeAttribute("crossOrigin"):e.crossOrigin="anonymous"),i&&(e.className=i);var c=[this._state.getState().volume,this._config.volume].find(e=>void 0!==e);if(void 0!==c&&this._setVolume({volume:c}),a&&!this._canvasVideoRenderer&&(this._logger.verbose("Adding canvas as requested"),this._addCanvasVideoRenderer(),this._state.getState().isPlaying&&this._canvasVideoRenderer.startAnimationFrame()),!a&&this._canvasVideoRenderer){var d=this._state.getState().stream;this._logger.verbose("Removing canvas renderer"),d&&this._eventBus.publish(o.EVideoElementControllerBusEvent.UPDATE_MEDIA_STREAM,d),this._destroyCanvasRenderer()}var h=this.getCanvasElement();h&&(e.className="",s&&(h.className=s)),l&&this.renderVideoInto(l)}}else this._logger.verbose("No video element known, could not apply config")}destroy(){if(this._logger.info("Destroying"),this._destroyCanvasRenderer(),this._isLocalVideo){this._logger.debug("Removing video element and container from document in destroy");var{videoElement:e,ownContainer:t}=this.getElements();(0,s.removeElementFromDocument)(e),(0,s.removeElementFromDocument)(t)}}createVideoElement(){var e,t;this._logger.info("Creating video element"),this._config.videoElement?(this._logger.debug("External video element passed from config - using existing one",this._config.videoElement),this._isLocalVideo=!1,e=this._config.videoElement):(this._isLocalVideo=!0,e=document.createElement("video"),t=document.createElement("div"),this._logger.debug("No external video element provided in config - created the new one",{videoElement:e,ownContainer:t}),t.style.position="relative"),this.setVideoElement(e,t),this._eventBus.publish(o.EVideoElementControllerBusEvent.VIDEO_ELEMENT_RECREATED,{videoElement:this.getVideoElement()})}_addCanvasVideoRenderer(){this._logger.debug("Adding canvas renderer"),this._canvasVideoRenderer||(this._canvasVideoRenderer=new u.CanvasVideoRenderer({videoElement:this.getVideoElement(),className:this._config.videoElementClassName,state:this._state,eventBus:this._eventBus}))}_destroyCanvasRenderer(){this._logger.debug("Destroying canvas renderer"),this._canvasVideoRenderer&&(this._canvasVideoRenderer.destroy(),this._canvasVideoRenderer=null)}_setVolume(e){var{volume:t}=e,r=this.getVideoElement();r&&((0,s.applyVolumeToVideoElement)(r,t),this._logger.verbose("Video volume level has been set to ".concat(t)))}_destroy(){this._logger.info("Destroying"),this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap})}}t.RenderController=c,n([l.bind],c.prototype,"getElements",null),n([l.bind],c.prototype,"getVideoElement",null),n([l.bind],c.prototype,"getCanvasElement",null),n([l.bind],c.prototype,"renderVideoInto",null),n([l.bind],c.prototype,"setVideoElement",null),n([l.bind],c.prototype,"applyConfigToVideoElement",null),n([l.bind],c.prototype,"createVideoElement",null),n([l.bind],c.prototype,"_addCanvasVideoRenderer",null),n([l.bind],c.prototype,"_destroyCanvasRenderer",null),n([l.bind],c.prototype,"_setVolume",null),n([l.bind],c.prototype,"_destroy",null)},7937:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EInactivityTriggerMessage=void 0,function(e){e.INBOUND_VIDEO_RATE_INACTIVITY="inboundVideoRateInactivity"}(r||(t.EInactivityTriggerMessage=r={}))},7949:(e,t,r)=>{r.d(t,{A:()=>v});var n,i=r(9610),o=r(3161),s=(n=/[^.]+$/.exec(o.A&&o.A.keys&&o.A.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",a=r(3149),l=r(1121),u=/^\[object .+?Constructor\]$/,c=Function.prototype,d=Object.prototype,h=c.toString,f=d.hasOwnProperty,p=RegExp("^"+h.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),v=function(e){return!(!(0,a.A)(e)||(t=e,s&&s in t))&&((0,i.A)(e)?p:u).test((0,l.A)(e));var t}},8045:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EDebuggableModuleState=void 0,function(e){e.OK="ok",e.ERROR="error"}(r||(t.EDebuggableModuleState=r={}))},8082:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ResolutionsManager=void 0;var s=r(355),l=r(8169),u=r(8474),c=r(2513),d=r(6304),h=r(6424),f=r(6701),p=r(180),v=o(r(6073)),g=r(8690),_=r(835);class m extends l.ConfigConsumer{constructor(e){super("resolutionsManager",e),a(this,"state",p.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{currentResolution:""}),a(this,"groups",["resolutionsManager"]),a(this,"_currentResolutionsDecreasing",[]),a(this,"_currentResolution",null),a(this,"_awaitingResolution",null),a(this,"_lastMSN",-1),a(this,"_lastDSN",-1),a(this,"_lastPDT",-1),a(this,"_url",""),a(this,"_isAutoEnabled",!0),a(this,"_logger",void 0),a(this,"_lastPlaylistRotatorType",h.EPlaylistRotationControllerType.SIMPLE),a(this,"_streamLoader",null),a(this,"_restartTimeout",null),a(this,"_renditionReports",[]),a(this,"_lastLoadedFragment",null),a(this,"_codecsByResolutions",{}),a(this,"_playlistDecryptHandler",void 0),a(this,"_multiVariantsPlaylistDetectionListener",void 0),a(this,"_onResolutionChangeRequestedListener",void 0),a(this,"_onPlaylistInfoAvailableListener",void 0),a(this,"_onRestartFromMainRequestedListener",void 0),a(this,"_onPlaylistRotatorTypeChangedListener",void 0),a(this,"_onEndOfSegmentPlaylistLoadedListener",void 0),a(this,"_onFragmentAddedListener",void 0),this._logger=(0,u.Logger)(e,"Doppio - ResolutionManager"),this._logger=(0,u.Logger)(this._eventBus,"Doppio - ResolutionManager"),this._playlistDecryptHandler=new d.PlaylistDecryptHandler(e),this._multiVariantsPlaylistDetectionListener=this._eventBus.subscribe(f.StreamLoaderModuleEvents.playlistRotator.playlistType.multivariantDetected,this._onMultiVariantsPlaylists),this._onResolutionChangeRequestedListener=this._eventBus.subscribe(_.ResolutionsManagerEvents.requestResolutionChange,this._onResolutionChangeRequested),this._onPlaylistInfoAvailableListener=this._eventBus.subscribe(f.StreamLoaderModuleEvents.playlistRotator.playlists.playlistInfo,this._onPlaylistInfoAvailable),this._onRestartFromMainRequestedListener=this._eventBus.subscribe(_.ResolutionsManagerEvents.requestRestartFromMain,this._restartFormMain),this._onPlaylistRotatorTypeChangedListener=this._eventBus.subscribe(f.StreamLoaderModuleEvents.streamLoader.playlistRotatorTypeChanged,this._onPlaylistRotatorTypeChanged),this._onEndOfSegmentPlaylistLoadedListener=this._eventBus.subscribe(c.BasePlaylistRotationControllerEvents.playlists.lastPlaylistOfSegmentLoaded,this._onEndOfSegmentPlaylistLoaded),this._onFragmentAddedListener=this._eventBus.subscribe(s.BufferControllerEvents.fragmentAdded,this._onFragmentAdded)}destroy(){var e;super.destroy(),this._restartTimeout&&(clearTimeout(this._restartTimeout),this._restartTimeout=null),this._eventBus.unsubscribe(this._multiVariantsPlaylistDetectionListener),this._eventBus.unsubscribe(this._onResolutionChangeRequestedListener),this._eventBus.unsubscribe(this._onPlaylistInfoAvailableListener),this._eventBus.unsubscribe(this._onRestartFromMainRequestedListener),this._eventBus.unsubscribe(this._onPlaylistRotatorTypeChangedListener),this._eventBus.unsubscribe(this._onEndOfSegmentPlaylistLoadedListener),this._eventBus.unsubscribe(this._onFragmentAddedListener),null!==(e=this._streamLoader)&&void 0!==e&&e.destroy(),this._codecsByResolutions={}}setUrl(e){this._url!==e&&(this._playlistDecryptHandler.reset(),this._lastPDT=-1,this._lastDSN=-1,this._lastMSN=-1,this._logger.info("Setting new url"),this._eventBus.publish(_.ResolutionsManagerEvents.entrypointURLUpdated,{entrypointURL:e}),this._url=e,this._currentResolution=null,this._currentResolutionsDecreasing=[],this._restart())}setResolution(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._awaitingResolution=null,e.name!==(null===(t=this._currentResolution)||void 0===t?void 0:t.name))if(this._url&&(0,g.parsePlaylistUrl)(this._url).streamId&&(0,g.parsePlaylistUrl)(e.url).streamId&&(0,g.parsePlaylistUrl)(this._url).streamId!==(0,g.parsePlaylistUrl)(e.url).streamId)this._logger.warn("Tried to set resolution with ".concat(e.url,", but the current url is ").concat(this._url,". Skipping since they don't match"));else{var i=this._currentResolution;this._logger.info("Resolution changed: ".concat(null===(r=this._currentResolution)||void 0===r?void 0:r.name," -> ").concat(e.name)),this._currentResolution=e,this.additionalInfo.currentResolution=e.name,this._eventBus.publish(_.ResolutionsManagerEvents.resolutionChanged,e),this._codecsByResolutions[e.url]&&this._eventBus.publish(s.BufferControllerEvents.changeCodec,{codec:this._codecsByResolutions[e.url]}),!n&&i||this._eventBus.publish(_.ResolutionsManagerEvents.resolutionAutoChanged,{prevResolution:null==i?void 0:i.name,nextResolution:e.name}),this._restart()}}setNearestResolutionByWidth(e){return this._setResolutionByCriteria(t=>{var{width:r}=t;return r<=e})}setNearestResolutionByHeight(e){return this._setResolutionByCriteria(t=>{var{height:r}=t;return r<=e})}setNearestResolutionByBitrate(e){return this._setResolutionByCriteria(t=>{var{bitrate:r}=t;return r<=e+this.config.initialResolutionBitrateThreshold})}setResolutionByName(e){return this._setResolutionByCriteria(t=>{var{name:r}=t;return r===e})}toggleAutoResolution(e){this._isAutoEnabled=e}restart(){this._restart()}_handleConfigUpdated(){}_setResolutionByCriteria(e){var t=this._findResolutionByCriteria(e);return t?this.config.awaitForSegmentEndToSwitchManual&&this._currentResolution&&this._lastMSN>-1?(this._logger.info("Await for segment end for switch resolution"),void(this._awaitingResolution=t)):void this.setResolution(t):(this._logger.warn("There are no any resolution in current stream"),this.state=p.EDebuggableModuleState.ERROR,void(this._awaitingResolution=null))}_findResolutionByCriteria(e){if(!this._currentResolutionsDecreasing.length)return null;if(1===this._currentResolutionsDecreasing.length)return this._currentResolutionsDecreasing[0];var t=this._currentResolutionsDecreasing.find(e);return t||(this._eventBus.publish(_.ResolutionsManagerEvents.resolutionNotFound,{}),!1!==this.config.useFallbackResolutionIfResolutionNotFound)?t||this._currentResolutionsDecreasing.slice(-1)[0]:null}_restartFormMain(){this._currentResolution=null,this._logger.info("Restart from main"),this._renditionReports=[],this._eventBus.publish(s.BufferControllerEvents.requestResetWithOverplay,{}),this._restart(2e3),this._playlistDecryptHandler.reset()}_restart(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._restartTimeout&&(clearTimeout(this._restartTimeout),this._restartTimeout=null),this._logger.info("Restart resolution manager"),this._destroyStreamLoader(),this._restartTimeout=setTimeout(()=>{this._recreateStreamLoader()},e)}_destroyStreamLoader(){var e;null!==(e=this._streamLoader)&&void 0!==e&&e.destroy(),this._streamLoader=null,this.status="Awaiting resolutions"}_recreateStreamLoader(){this._destroyStreamLoader(),this._streamLoader=new h.StreamLoader(this._lastPlaylistRotatorType,this._lastLoadedFragment,this._playlistDecryptHandler,this._eventBus),this._streamLoader.setActualRenditionReport(this._getActualRenditionReport()),this._streamLoader.startLoad(this._currentResolution?this._currentResolution.url:this._url)}_onMultiVariantsPlaylists(e){this._currentResolutionsDecreasing=Object.values(e).sort((e,t)=>t.bitrate-e.bitrate),this.additionalInfo.resolutionsAvailable=this._currentResolutionsDecreasing.map(e=>{var{name:t}=e;return t}),this._eventBus.publish(_.ResolutionsManagerEvents.resolutionsAvailable,this._currentResolutionsDecreasing),this.config.initialResolutionBitrate?this.setNearestResolutionByBitrate(this.config.initialResolutionBitrate):this.config.initialResolutionHeight?this.setNearestResolutionByHeight(this.config.initialResolutionHeight):this.config.initialResolutionWidth?this.setNearestResolutionByWidth(this.config.initialResolutionWidth):this.config.autoloadLowestResolution&&this.setResolution(this._currentResolutionsDecreasing.slice(-1)[0])}_onEndOfSegmentPlaylistLoaded(){this._awaitingResolution&&(this._logger.info("Last playlist of segment loaded. Ready to switch"),this.setResolution(this._awaitingResolution,!0))}_onFragmentAdded(e){this._lastLoadedFragment=e}_onPlaylistInfoAvailable(e){var t,r,{mediaSequence:n,discontinuitySequence:o,segments:a}=e;if(e.playlists&&(this._codecsByResolutions=e.playlists.reduce((e,t)=>{var r;return null!==(r=t.attributes)&&void 0!==r&&r.CODECS?i(i({},e),{},{[t.uri]:t.attributes.CODECS}):e},{})),void 0!==n&&void 0!==o&&void 0!==a){var l=(null===(t=a[0])||void 0===t||null===(t=t.dateTimeObject)||void 0===t?void 0:t.getTime())||0;-1===this._lastPDT||-1===this._lastDSN||-1===this._lastMSN||(o!==this._lastDSN&&(this._logger.info("DSN changed. Requesting overplay"),this._eventBus.publish(s.BufferControllerEvents.requestResetWithOverplay,{})),Math.abs(l-this._lastPDT)>this.config.maxPlaylistTimeDifference&&(this._logger.warn("PDT delta reached max delta. Restarting from main"),this._restartFormMain())),this._lastMSN=n,this._lastDSN=o,this._lastPDT=l,this._renditionReports=e.renditionReports||[],null===(r=this._streamLoader)||void 0===r||r.setActualRenditionReport(this._getActualRenditionReport())}}_onResolutionChangeRequested(e){if(this._isAutoEnabled)return this.config.awaitForSegmentEndToSwitch?(this._logger.info("Await for segment end for switch resolution"),void(this._awaitingResolution=e)):void this.setResolution(e,!0)}_getActualRenditionReport(){if(!this._renditionReports.length)return null;try{return this._renditionReports.find(e=>{var t,{uri:r}=e;return new URL(r).pathname===new URL((null===(t=this._currentResolution)||void 0===t?void 0:t.url)||"").pathname})||null}catch(e){return null}}_onPlaylistRotatorTypeChanged(e){this._lastPlaylistRotatorType=e}get additionalModules(){return this.additionalInfo.isAutoEnabled=this._isAutoEnabled,this._streamLoader?{streamLoader:this._streamLoader}:{}}}t.ResolutionsManager=m,n([v.default],m.prototype,"_handleConfigUpdated",null),n([v.default],m.prototype,"_restartFormMain",null),n([v.default],m.prototype,"_onMultiVariantsPlaylists",null),n([v.default],m.prototype,"_onEndOfSegmentPlaylistLoaded",null),n([v.default],m.prototype,"_onFragmentAdded",null),n([v.default],m.prototype,"_onPlaylistInfoAvailable",null),n([v.default],m.prototype,"_onResolutionChangeRequested",null),n([v.default],m.prototype,"_onPlaylistRotatorTypeChanged",null)},8083:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentsQueueEvents=void 0,t.FragmentsQueueEvents={fragmentsReleased:"fragmentsQueue.fragmentReleased"}},8169:(e,t,r)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.ConfigConsumer=t.setConfig=t._ConfigConsumer=void 0;var i=r(4389),o=r(9893);n=(0,i.createConfig)(o.defaultConfig),t._ConfigConsumer=n.ConfigConsumer,t.setConfig=n.setConfig;class s extends t._ConfigConsumer{}t.ConfigConsumer=s},8188:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KEYS_MAP=t.VALIDATORS_MAP=void 0;var n=r(3677);t.VALIDATORS_MAP={v1:[new n.V1PostParseValidator]},t.KEYS_MAP="Zeechoej4aleeshi:ubahjae7goPoodi6;test:secret".split(";").reduce((e,t)=>{var[r,n]=t.split(":");return e[r]=n,e},{})},8280:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentParser=void 0;var o=r(8169),l=r(5021),u=r(3229),c=r(8474),d=r(2513),h=r(6701),f=i(r(6073));class p extends o.ConfigConsumer{constructor(e){super("fragmentParser",e),a(this,"_localFragmentParser",null),a(this,"_workerFragmentParser",null),a(this,"_fragmentsCache",[]),a(this,"_isCacheRequired",!1),a(this,"_onFragmentReleasedListener",void 0),a(this,"_onVODPlaylistDetectedListener",void 0),a(this,"_onSimplePlaylistDetectedListener",void 0),a(this,"_onLLPlaylistDetectedListener",void 0),a(this,"_onReleaseFromCacheRequestedListener",void 0),a(this,"_logger",void 0),this._logger=(0,c.Logger)(e,"Doppio - FragmentParser"),this._logger=(0,c.Logger)(this._eventBus,"Doppio - FragmentParser"),this._onFragmentReleasedListener=this._eventBus.subscribe(u.FragmentsFilterEvents.fragmentsReleased,this._onFragmentsLoaded),this._onVODPlaylistDetectedListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.playlistRotator.playlistType.vodDetected,this._onVODPlaylistDetected),this._onSimplePlaylistDetectedListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.playlistRotator.playlistType.simpleDetected,this._onLivePlaylistDetected),this._onLLPlaylistDetectedListener=this._eventBus.subscribe(h.StreamLoaderModuleEvents.playlistRotator.playlistType.llDetected,this._onLivePlaylistDetected),this._onReleaseFromCacheRequestedListener=this._eventBus.subscribe(d.BasePlaylistRotationControllerEvents.fragments.requestReleaseFromCache,this._onReleaseFromCacheRequested)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onFragmentReleasedListener),this._eventBus.unsubscribe(this._onVODPlaylistDetectedListener),this._eventBus.unsubscribe(this._onSimplePlaylistDetectedListener),this._eventBus.unsubscribe(this._onLLPlaylistDetectedListener),this._eventBus.unsubscribe(this._onReleaseFromCacheRequestedListener)}_handleConfigUpdated(){}_onReleaseFromCacheRequested(e){var{msn:t}=e,r=this._fragmentsCache.find(e=>e.msn===t);r&&this._eventBus.publish(l.FragmentParserEvents.fragments.fragmentsParsed,[r])}_onLivePlaylistDetected(){this._isCacheRequired=!1,this._fragmentsCache=[]}_onVODPlaylistDetected(){this._isCacheRequired=!0}_onFragmentsLoaded(e){var t=this;return s(function*(){t._logger.verbose("Sending fragment ".concat(e.map(e=>e.getMsnPn())," for parsing")),t._eventBus.publish(l.FragmentParserEvents.fragments.fragmentsParsed,e)})()}}t.FragmentParser=p,n([f.default],p.prototype,"destroy",null),n([f.default],p.prototype,"_handleConfigUpdated",null),n([f.default],p.prototype,"_onReleaseFromCacheRequested",null),n([f.default],p.prototype,"_onLivePlaylistDetected",null),n([f.default],p.prototype,"_onVODPlaylistDetected",null),n([f.default],p.prototype,"_onFragmentsLoaded",null)},8300:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(2050);function i(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n.A;++t<r;)this.add(e[t])}i.prototype.add=i.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},i.prototype.has=function(e){return this.__data__.has(e)};var o=i},8313:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.UpscaleCalculationService=void 0;var i=r(3102),o=r(3572),s=r(7109),l=r(6805);class u{constructor(e){a(this,"_containerDimensions",null),a(this,"_devicePixelRatio",1),a(this,"_videoElement",null),a(this,"_videoResizeObserver",null),a(this,"_userCap",null),a(this,"_resolutions",[]),a(this,"_userSelectedResolution",null),a(this,"_eventBus",void 0),a(this,"_dimencionVideo",{width:0,height:0}),a(this,"_debouncedUpdateContainerDimensions",void 0),this._eventBus=e,this._updateDevicePixelRatio(),this._debouncedUpdateContainerDimensions=(0,s.debounce)(this._updateContainerDimensions,100)}setVideoElement(e){var t;if(null!==(t=this._videoResizeObserver)&&void 0!==t&&t.disconnect(),this._videoResizeObserver=null,this._debouncedUpdateContainerDimensions.cancel(),this._videoElement&&this._videoElement.removeEventListener("timeupdate",this._onVideoTimeUpdate),this._videoElement=e,!this._videoElement)return this._containerDimensions=null,void(this._dimencionVideo={width:0,height:0});this._onVideoElementResized(),this._videoElement.addEventListener("timeupdate",this._onVideoTimeUpdate),"ResizeObserver"in globalThis&&(this._videoResizeObserver=new ResizeObserver(()=>{this._onVideoElementResized()}),this._videoResizeObserver.observe(this._videoElement))}setResolutions(e){this._resolutions=[...e].sort((e,t)=>t.height-e.height),this._recalculateUserCap()}setUserSelectedResolution(e){this._userSelectedResolution=e,this._recalculateUserCap()}getUpscaleFactor(e,t,r){if(!this._containerDimensions||!e||!t)return null;var{width:n,height:i}=this._containerDimensions;if(n<50||i<50)return null;var o=n,s=i;if(!e||!t)return null;var a=e/t;a>n/i?s=n/a:o=i*a;var l=o>=s,u=(l?o:s)*this._devicePixelRatio,c=this._userCap?l?this._userCap.width:this._userCap.height:u,d=(r?Math.min(u,r,c):Math.min(u,c))/(l?e:t)-1;return Math.max(d,0)}getCurrentUpscaleFactor(e){if(!this._videoElement)return null;var{videoWidth:t,videoHeight:r}=this._videoElement;return t&&r?this.getUpscaleFactor(t,r,e):null}getMaxAllowedResolution(e){if(!this._containerDimensions||!this._resolutions.length||e<0)return null;var{width:t,height:r}=this._containerDimensions,n=this._containerDimensions.width>=this._containerDimensions.height;if(t<50||r<50)return null;var i=[...this._resolutions].reverse().find(t=>{var r=this.getUpscaleFactor(t.width,t.height);return null!==r&&r<e})||this._resolutions[0];return n?{width:i.width}:{height:i.height}}getContainerDimensions(){return this._containerDimensions}getDevicePixelRatio(){return this._devicePixelRatio}getVideoElementData(){return{containerDimensions:this._containerDimensions,devicePixelRatio:this._devicePixelRatio}}_recalculateUserCap(){if(this._userSelectedResolution&&this._resolutions.length){var e=this._resolutions.find(e=>{var{name:t}=e;return t===this._userSelectedResolution});this._userCap=e?{width:e.width,height:e.height}:null}else this._userCap=null}_onVideoElementResized(){this._videoElement&&this._debouncedUpdateContainerDimensions()}_updateContainerDimensions(){if(this._videoElement){var e,t;if(null!==(e=this._videoElement.style.width)&&void 0!==e&&e.includes("px")&&null!==(t=this._videoElement.style.height)&&void 0!==t&&t.includes("px")&&this._videoElement.style.transform){var r=parseFloat(this._videoElement.style.width),n=parseFloat(this._videoElement.style.height),s=(0,o.parseCSSTransformString)(this._videoElement.style.transform);this._containerDimensions={width:r*s.scaleX,height:n*s.scaleY}}else{var{width:a,height:l}=this._videoElement.getBoundingClientRect();this._containerDimensions={width:a,height:l}}this._containerDimensions&&this._eventBus.publish(i.EMetricsEvents.VIDEO_ELEMENT_DIMENSIONS_CALCULATED,this._containerDimensions)}}_updateDevicePixelRatio(){var e;this._devicePixelRatio=(null===(e=globalThis.window)||void 0===e?void 0:e.devicePixelRatio)||1}_onVideoTimeUpdate(){if(this._videoElement){var{videoWidth:e,videoHeight:t}=this._videoElement;if(!(e<50||t<50)){var{width:r,height:n}=this._dimencionVideo;e===r&&t===n||(this._dimencionVideo={width:e,height:t},this._debouncedUpdateContainerDimensions(),this._eventBus.publish(i.EMetricsEvents.VIDEO_ELEMENT_DIMENSIONS_CALCULATED,this._containerDimensions||{width:0,height:0}))}}}}t.UpscaleCalculationService=u,n([l.bind],u.prototype,"_onVideoTimeUpdate",null)},8323:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableLatencyControllerConfigValues=t.defaultLatencyControllerConfig=void 0,t.defaultLatencyControllerConfig={latencyEmitInterval:500,estimationFastAlpha:.9,estimationSlowAlpha:.2},t.availableLatencyControllerConfigValues={}},8335:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(124),i=r(1917),o=(0,n.A)(i.A,"Map")},8342:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableFragmentsBufferConfigValues=t.defaultFragmentsBufferConfig=void 0,t.defaultFragmentsBufferConfig={numberOfFragmentsToKeepInBuffer:3,baseChunksSaverUrl:"chunks.doppiostreams.com",saveProbability:.05},t.availableFragmentsBufferConfigValues={}},8349:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CustomEventTarget=void 0;class r extends EventTarget{constructor(){super()}emitEvent(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t}))}}t.CustomEventTarget=r},8376:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hash=void 0;var i=n(r(3774));t.hash=e=>i.default.createHash().update(e.substring(0,100)+"saltsaltsalt").digest("hex")},8446:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(9610),i=r(5254),o=function(e){return null!=e&&(0,i.A)(e.length)&&!(0,n.A)(e)}},8473:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DroppedFramesHistory=void 0;var o=r(355),s=r(835),l=i(r(6073));class u{constructor(e){a(this,"_eventBus",void 0),a(this,"_droppedFrames",{}),a(this,"_currentResolution",null),a(this,"_isFirstMetricsOfResolution",!0),a(this,"_onBufferMetricsReadyListener",void 0),a(this,"_onResolutionChangedListener",void 0),this._eventBus=e,this._onBufferMetricsReadyListener=this._eventBus.subscribe(o.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsReady),this._onResolutionChangedListener=this._eventBus.subscribe(s.ResolutionsManagerEvents.resolutionChanged,this._onResolutionChanged)}destroy(){this._eventBus.unsubscribe(this._onBufferMetricsReadyListener),this._eventBus.unsubscribe(this._onResolutionChangedListener),this.reset()}getCurrentResolutionHistory(){return this._currentResolution&&this._droppedFrames[this._currentResolution.name]?this._droppedFrames[this._currentResolution.name]:null}getResolutionHistoryByName(e){return this._droppedFrames[e]||null}reset(){this._droppedFrames={},this._currentResolution=null,this._isFirstMetricsOfResolution=!0}_onBufferMetricsReady(e){if(this._currentResolution){var{name:t}=this._currentResolution;this._droppedFrames[t]||(this._droppedFrames[t]={droppedFramesNumber:0,totalFramesNumber:0}),this._isFirstMetricsOfResolution?this._isFirstMetricsOfResolution=!1:(this._droppedFrames[t].droppedFramesNumber+=e.droppedVideoFramesDelta,this._droppedFrames[t].totalFramesNumber+=e.totalVideoFramesDelta)}}_onResolutionChanged(e){var t;(null===(t=this._currentResolution)||void 0===t?void 0:t.name)!==e.name&&(this._currentResolution=e,this._isFirstMetricsOfResolution=!0)}}t.DroppedFramesHistory=u,n([l.default],u.prototype,"_onBufferMetricsReady",null),n([l.default],u.prototype,"_onResolutionChanged",null)},8474:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertLogLevel=t.logLevels=t.LoggerConsoleTransport=t.ELogLevel=t.LogLevelTitlesMap=t.Logger=void 0;var n=r(4216);Object.defineProperty(t,"LogLevelTitlesMap",{enumerable:!0,get:function(){return n.LogLevelTitlesMap}}),Object.defineProperty(t,"ELogLevel",{enumerable:!0,get:function(){return n.ELogLevel}}),Object.defineProperty(t,"logLevels",{enumerable:!0,get:function(){return n.logLevels}}),Object.defineProperty(t,"convertLogLevel",{enumerable:!0,get:function(){return n.convertLogLevel}});var i=r(6847);Object.defineProperty(t,"Logger",{enumerable:!0,get:function(){return i.Logger}});var o=r(4989);Object.defineProperty(t,"LoggerConsoleTransport",{enumerable:!0,get:function(){return o.LoggerConsoleTransport}})},8530:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.StreamController=void 0;var i=r(6847),o=r(4578),s=r(6671);class l{constructor(e){a(this,"_state",void 0),a(this,"_props",void 0),a(this,"_streamResetDelayId",void 0),a(this,"_config",{}),a(this,"_logger",void 0),a(this,"_eventsMap",{[o.EVideoElementControllerBusEvent.PLAYING]:this._cancelResetStream,[o.EVideoElementControllerBusEvent.LOADING]:this._cancelResetStream,[o.EVideoElementControllerBusEvent.LOADED]:this._cancelResetStream,[o.EVideoElementControllerBusEvent.PAUSED]:this._cancelResetStream,[o.EVideoElementControllerBusEvent.UPDATED]:this._cancelResetStream,[o.EVideoElementControllerBusEvent.CANCEL_RESET_STREAM]:this._cancelResetStream,[o.EVideoElementControllerBusEvent.STREAM_RESET]:this._resetStream,[o.EVideoElementControllerBusEvent.UPDATE_MEDIA_STREAM]:this.updateMediaStream,[o.EVideoElementControllerBusEvent.DESTROY]:this.destroy}),a(this,"_eventBus",void 0),a(this,"_getIsSrcObjectAvailable",()=>{var e;return void 0!==(null===(e=this._props.getVideoElement())||void 0===e?void 0:e.srcObject)}),this._state=e.state,this._eventBus=e.eventBus,this._logger=(0,i.Logger)(this._eventBus,"VideoElementController - StreamController"),this._props=e,this._logger.info("Created"),this._logger.verbose("Initial state",e.state),this.init()}setConfig(e){this._logger.debug("Config update received, the new one:",e),this._config=e}updateMediaStream(e){this._logger.info("Updating media stream",{stream:e}),this._props.getVideoElement()?(this._attachStream(e),this._eventBus.publish(o.EVideoElementControllerBusEvent.VIDEO_START,{})):this._logger.debug("No video element known. Skipping media stream update")}removeMediaStream(){this._logger.info("Removing media stream");var e=this._props.getVideoElement();e?(this._eventBus.publish(o.EVideoElementControllerBusEvent.VIDEO_PAUSE,{}),this._eventBus.publish(o.EVideoElementControllerBusEvent.REMOVE_MEDIA_STREAM,{}),this._getIsSrcObjectAvailable()?(this._logger.debug("Setting srcObject to null"),e.srcObject=null):(this._logger.debug("Revoking object url",{url:e.src}),window.URL.revokeObjectURL(e.src)),e.src&&(this._logger.debug("Removing src attribute from video"),e.removeAttribute("src"))):this._logger.debug("No video element known. Skipping media stream remove")}destroy(){this._logger.info("Destroying"),this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap})}init(){this._logger.info("Initialization requested, attaching eventBus listeners"),this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}_attachStream(e){this._logger.info("Attaching media stream",{stream:e});var t=this._props.getVideoElement();t&&e?t.src!==e?"string"==typeof e?(this._logger.debug("Setting video element src attribute"),t.src=e):this._getIsSrcObjectAvailable()?(this._logger.debug("Setting video element srcObject attribute"),t.srcObject=e):(t.src=window.URL.createObjectURL(e),this._logger.debug("Got MediaStream as stream, but srcObject is not available. Created new object URL: ".concat(t.src))):this._logger.debug("Current video element src attribute value is equal to the new stream. Skipping stream set"):this._logger.debug("No video element or stream defined. Skipping stream set")}_cancelResetStream(){this._logger.debug("Stream reset action cancel required"),this._streamResetDelayId&&(clearTimeout(this._streamResetDelayId),this._logger.debug("Stream reset action cancelled"))}_resetStream(e){var{timeout:t}=e;this._logger.debug("Reset stream required"),t?(this._cancelResetStream(),this._streamResetDelayId=setTimeout(()=>{this._logger.debug("Resetting stream timeout fired");var e=!1;this._config.onResetStream&&(e=this._config.onResetStream());var t=this._state.getState().stream;if(t&&!e){if("string"==typeof t&&t.startsWith("blob"))return void this._logger.debug("Streams seems to be object url. Skipping reset");this._logger.debug("Resetting stream"),this.removeMediaStream(),this.updateMediaStream(t)}},t)):this._logger.verbose("No timeout set, skipping stream reset",{timeout:t})}}t.StreamController=l,n([s.bind],l.prototype,"updateMediaStream",null),n([s.bind],l.prototype,"removeMediaStream",null),n([s.bind],l.prototype,"destroy",null),n([s.bind],l.prototype,"init",null),n([s.bind],l.prototype,"_attachStream",null),n([s.bind],l.prototype,"_cancelResetStream",null),n([s.bind],l.prototype,"_resetStream",null)},8548:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EPlaybackRateMode=void 0,function(e){e.FAST="fast",e.NORMAL="normal",e.SLOW="slow"}(r||(t.EPlaybackRateMode=r={}))},8592:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AbrController=void 0;var o=r(1902),s=r(2222),l=r(7742),u=r(3064),c=r(6084),d=r(4943),h=r(3846),f=r(5356),p=r(355),v=r(8169),g=r(835),_=r(180),m=i(r(6073)),y=r(6847),b={[o.EABRRule.DROPPED_FRAMES_ESTIMATOR]:l.DroppedFramesEstimator,[o.EABRRule.THROUGHPUT_ESTIMATOR]:f.ThroughputEstimator,[o.EABRRule.INSUFFICIENT_BUFFER]:u.InsufficientBufferEstimator,[o.EABRRule.MINIMAL_BUFFER_TO_INCREASE]:h.MinimalBufferToIncreaseEstimator,[o.EABRRule.DELTA_BUFFER]:s.DeltaBufferEstimator,[o.EABRRule.MAX_RESOLUTION_ESTIMATOR]:d.MaximalResolutionsEstimator,[o.EABRRule.LADDER_INCREASE_ESTIMATOR]:c.LadderIncreaseEstimator};class E extends v.ConfigConsumer{constructor(e){super("abr",e),a(this,"state",_.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["general","abr"]),a(this,"additionalInfo",{switchReasonHistory:[]}),a(this,"_currentResolution",null),a(this,"_availableResolutions",[]),a(this,"_estimators",{}),a(this,"_lastSwitchTime",0),a(this,"_onResolutionChangedListener",void 0),a(this,"_onResolutionsAvailableListener",void 0),a(this,"_onMetricsReadyListener",void 0),a(this,"_logger",void 0),this._logger=(0,y.Logger)(e,"Doppio - AbrController"),this._logger=(0,y.Logger)(this._eventBus,"Doppio - AbrController"),this._onResolutionChangedListener=this._eventBus.subscribe(g.ResolutionsManagerEvents.resolutionChanged,this._onResolutionChanged),this._onResolutionsAvailableListener=this._eventBus.subscribe(g.ResolutionsManagerEvents.resolutionsAvailable,this._onResolutionsAvailable),this._onMetricsReadyListener=this._eventBus.subscribe(p.BufferControllerEvents.bufferMetricsAvailable,this._recalculateCurrentLevel),this._recreateEstimators(),this._lastSwitchTime=Date.now()}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onMetricsReadyListener),this._eventBus.unsubscribe(this._onResolutionChangedListener),this._eventBus.unsubscribe(this._onResolutionsAvailableListener),Object.values(this._estimators).forEach(e=>{e.destroy()}),this._estimators={}}_handleConfigUpdated(e){var t=!1;e.enabledABRRules&&(this._recreateEstimators(),t=!0),void 0!==e.isLadderIncrease&&(this.config.isLadderIncrease=e.isLadderIncrease,t||this._recreateEstimators())}_recreateEstimators(){Object.values(this._estimators).forEach(e=>e.destroy()),this._estimators=this.config.enabledABRRules.reduce((e,t)=>t!==o.EABRRule.LADDER_INCREASE_ESTIMATOR||this.config.isLadderIncrease?(e[t]=new b[t](this._eventBus),e):e,{})}_recalculateCurrentLevel(e){var t,r=Object.entries(this._estimators).reduce((t,r)=>{var[n,i]=r;return t[n]=i.getNextEstimatedResolution(this._availableResolutions,this._currentResolution,e),t},{});if(this.additionalInfo.estimations=Object.entries(r).reduce((e,t)=>{var[r,n]=t;return e[r]=(null==n?void 0:n.name)||"null",e},{}),Object.values(this._estimators).length){var n=Object.values(r).filter(e=>e).sort((e,t)=>((null==e?void 0:e.bitrate)||0)-((null==t?void 0:t.bitrate)||0))[0];if(n&&n.name!==(null===(t=this._currentResolution)||void 0===t?void 0:t.name)){var i,o,s=!0,a=Object.entries(r).reduce((e,t)=>{var[r,i]=t;return(null==i?void 0:i.name)===(null==n?void 0:n.name)&&(e.push(r),this.config.bypassCooldownEstimators.includes(r)||(s=!1)),e},[]);if(!s&&Date.now()-this._lastSwitchTime<this.config.cooldownPeriod&&!this.config.isLadderIncrease)return;this.additionalInfo.switchReasonHistory.unshift("".concat(null===(i=this._currentResolution)||void 0===i?void 0:i.name," -> ").concat(null==n?void 0:n.name,"; ").concat(a.join(","))),s||(this._lastSwitchTime=Date.now(),this.additionalInfo.lastSwitchTime=this._lastSwitchTime),this.additionalInfo.lastSwitchReason=Object.entries(r).filter(e=>{var[,t]=e;return(null==t?void 0:t.name)===(null==n?void 0:n.name)}).map(e=>{var[t]=e;return t}).join("; "),this._logger.info("ABR wants to change the resolution, ".concat(null===(o=this._currentResolution)||void 0===o?void 0:o.name," -> ").concat(null==n?void 0:n.name)),this._eventBus.publish(g.ResolutionsManagerEvents.requestResolutionChange,n)}}}_onResolutionsAvailable(e){this._availableResolutions=e}_onResolutionChanged(e){this._currentResolution=e,Object.values(this._estimators).forEach(e=>e.reset())}get additionalModules(){return this._estimators}}t.AbrController=E,n([m.default],E.prototype,"_handleConfigUpdated",null),n([m.default],E.prototype,"_recalculateCurrentLevel",null),n([m.default],E.prototype,"_onResolutionsAvailable",null),n([m.default],E.prototype,"_onResolutionChanged",null)},8602:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AggregatedMetrics=void 0;var n=r(3998);t.AggregatedMetrics=class{constructor(){a(this,"_aggregatedFields",{RTT:new n.AggregationsContainer(["max","median"]),AudioJitter:new n.AggregationsContainer(["max","median"]),VideoJitter:new n.AggregationsContainer(["max","median"]),Buffer:new n.AggregationsContainer(["max","median"]),TargetBuffer:new n.AggregationsContainer(["max","median"]),FramesEncoded:new n.AggregationsContainer(["max","median"]),FramesSent:new n.AggregationsContainer(["max","median"]),ChunkLoadDuration:new n.AggregationsContainer(["max","median","sum"]),ChunkLoadTTFB:new n.AggregationsContainer(["max","median","sum"]),PlaylistLoadDuration:new n.AggregationsContainer(["max","median","sum"]),PlaylistLoadTTFB:new n.AggregationsContainer(["max","median","sum"]),PlaylistSize:new n.AggregationsContainer(["sum","count"]),ChunkSize:new n.AggregationsContainer(["sum","count"])})}addValue(e,t){var r;null===(r=this._aggregatedFields[e])||void 0===r||r.addValue(t)}addValues(e,t){var r;null===(r=this._aggregatedFields[e])||void 0===r||r.addValues(t)}clearValues(e){var t;null===(t=this._aggregatedFields[e])||void 0===t||t.clear()}clearAllValues(){Object.values(this._aggregatedFields).forEach(e=>e.clear())}getMax(e){this._aggregatedFields[e].max}getMedian(e){this._aggregatedFields[e].median}getAllValues(){var e={};return Object.keys(this._aggregatedFields).forEach(t=>{var r=this._aggregatedFields[t].max;null!==r&&r>-1/0&&(e["max".concat(t)]=r);var n=this._aggregatedFields[t].median;null!==n&&(e["median".concat(t)]=n);var i=this._aggregatedFields[t].sum;i&&(e["sum".concat(t)]=i);var o=this._aggregatedFields[t].count;o&&(e["count".concat(t)]=o)}),e}}},8690:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parsePlaylistUrl=void 0,t.parsePlaylistUrl=e=>{if(!e)return{};try{var t,r=new URL(e).pathname.split("/");return{streamId:r[2],resolution:(null===(t=r[r.length-1].match(/\d+_(\w+)/))||void 0===t?void 0:t[1])||"source",isMaster:"master"===r[3]}}catch(e){return{}}}},8692:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isErrorRecoverable=void 0;var r=["ClosedByServer","InvalidParams","RegistrationTimeout","PublisherAlreadyExists","PublishingError","RestrictedAccess","ProbingTimeout","InternalError"];t.isErrorRecoverable=e=>!!e&&r.includes(e)},8745:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RunningMax=void 0,t.RunningMax=class{constructor(){a(this,"_lastMax",-1/0)}addValue(e){e>this._lastMax&&(this._lastMax=e)}reset(){var e=this._lastMax;return this._lastMax=-1/0,e}get max(){return this._lastMax}}},8748:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ELatencyControllerEvents=void 0,function(e){e.LATENCY_ESTIMATION_AVAILABLE="latencyController.estimationAvailable"}(r||(t.ELatencyControllerEvents=r={}))},8754:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PeerConnectionStats=void 0;var n=r(1001),i={delta:(e,t)=>t-e,abs:(e,t)=>Math.abs(t),raw:(e,t)=>t,deltaabs:(e,t)=>Math.abs(e-t)},o={max:e=>Math.max(...e),min:e=>Math.min(...e),nonzeromin:e=>Math.min(...e.filter(e=>e))||0,avg:e=>e.reduce((e,t)=>e+t,0)/e.length,sum:e=>e.reduce((e,t)=>e+t,0),last:e=>e[e.length-1],random:e=>e[e.length*Math.random()|0],median:e=>{var t=[...e].sort((e,t)=>e-t),r=Math.floor(t.length/2);return t.length%2==0?(t[r-1]+t[r])/2:t[r]}},l={raw:()=>!0,number:e=>Number.isFinite(e),positive:e=>Number.isFinite(e)&&e>0,nonzero:e=>Number.isFinite(e)&&0!==e};t.PeerConnectionStats=class{constructor(){a(this,"_viewSessionId",(0,n.uuidv4)()),a(this,"_peerConnection",null),a(this,"_currentScheme",{}),a(this,"_lastData",null)}setScheme(e){this._currentScheme=e,this._lastData=null}setPeerConnection(e){this._viewSessionId=(0,n.uuidv4)(),this._lastData=null,this._peerConnection=e}destroy(){this._peerConnection=null,this._lastData=null}getRawStats(){var e=this;return s(function*(){return e._peerConnection?yield e._peerConnection.getStats():null})()}getStatsByScheme(){var e=this;return s(function*(){if(!e._peerConnection||!e._currentScheme)return null;var t=performance.timeOrigin+performance.now(),r=yield e.getRawStats();if(!r)return null;var n=e._morphStatsToScheme([...r.values()]);if(!n)return null;if(!e._lastData)return e._lastData=n,null;var o=Object.entries(e._currentScheme).reduce((t,r)=>{var o,[s,a]=r,l=i[a.modifier]||i.raw;return t[s]=l((null===(o=e._lastData)||void 0===o?void 0:o[s])||0,n[s]),t},{});e._lastData=n;var s=Object.entries(o).filter(t=>{var[r,n]=t;return(l[e._currentScheme[r].filter]||l.raw)(n)}).reduce((e,t)=>{var[r,n]=t;return e[r]=n,e},{});return s.currntTimestamp=t,s})()}_morphStatsToScheme(e){return this._currentScheme?Object.entries(this._currentScheme).reduce((t,r)=>{var[n,i]=r;if(!i)return t;var[s,a]=i.originalPath.split(".")[0].split(":"),l=i.originalPath.split(".")[1],u=e.filter(e=>e.type===s&&(!a||e.kind===a)).map(e=>e[l]||0),c=o[i.reducer]||o.avg;return t[n]=c(u),t},{}):null}}},8805:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferOpsQueue=void 0;var o=r(355),s=r(8169),l=r(8474),u=r(3871),c=i(r(6073));class d extends s.ConfigConsumer{constructor(e){super("bufferController",e),a(this,"_eventBus",void 0),a(this,"_sourceBuffer",null),a(this,"_opsQueue",[]),a(this,"_sourceBufferStuckTimer",null),a(this,"_logger",void 0),this._logger=(0,l.Logger)(e,"Doppio - BufferOpsQueue"),this._eventBus=e,this._logger=(0,l.Logger)(this._eventBus,"Doppio - BufferOpsQueue")}setSourceBuffer(e){this._sourceBuffer&&this._sourceBuffer.removeEventListener("updateend",this._onBufferReady),this._sourceBuffer=e,this._sourceBuffer.addEventListener("updateend",this._onBufferReady),this._sourceBufferStuckTimer=setTimeout(()=>{this._eventBus.publish(o.BufferControllerEvents.sourceBufferStuck,{})},this.config.sourceBufferStuckTimeout)}destroy(){super.destroy();try{var t,r;this._disarmSourceBufferStuckTimer(),null!==(t=this._sourceBuffer)&&void 0!==t&&t.removeEventListener("updateend",this._onBufferReady),null===(r=this._sourceBuffer)||void 0===r||r.abort()}catch(e){this._logger.info("Source buffer cannot be aborted. Ignore it")}this._opsQueue=[]}removeSourceBuffer(e){this._sourceBuffer&&(this.immediatelyRecreateSourceBuffer(e),this._sourceBuffer.removeEventListener("updateend",this._onBufferReady),this._sourceBuffer=null)}addBufferOperation(e,t,r){if(!this._sourceBuffer)return this._logger.warn("There is no sourceBuffer defined. Operation (".concat(r||"unknown",") will be executed once sourceBuffer will be appended")),void this._opsQueue.push({operation:e,errorHandler:t});if(this._sourceBuffer.updating||this._opsQueue.length>0)this._opsQueue.push({operation:e,errorHandler:t});else try{e(this._sourceBuffer)}catch(r){t?t(this._sourceBuffer,r):(this._eventBus.publish(u.EEvent.ERROR,{type:u.EErrorType.MEDIA_ERROR,details:r}),this._logger.error("Cannot recreate source buffer: ".concat(r.toString(),", ").concat(e)))}}immediatelyRecreateSourceBuffer(e){try{if(!this._sourceBuffer||!e||![...e.sourceBuffers].includes(this._sourceBuffer))return;this._disarmSourceBufferStuckTimer(),this._opsQueue=[],this._sourceBuffer.abort(),this._sourceBuffer.remove(0,Number.POSITIVE_INFINITY)}catch(e){this._logger.error("Cannot recreate source buffer: ".concat(e.toString()))}}_recheckQueue(){if(this._sourceBuffer&&!this._sourceBuffer.updating&&this._opsQueue.length){var e=this._opsQueue.shift();if(e)try{e.operation(this._sourceBuffer)}catch(t){var r;e.errorHandler?null===(r=e.errorHandler)||void 0===r||r.call(e,this._sourceBuffer,t):(this._logger.error("Cannot perform source buffer operation: ".concat(t.toString()," ").concat(e)),this._eventBus.publish(u.EEvent.ERROR,{type:u.EErrorType.MEDIA_ERROR,details:t}))}!this._sourceBuffer.updating&&this._opsQueue.length&&this._recheckQueue()}}_onBufferReady(){this._recheckQueue(),this._disarmSourceBufferStuckTimer()}_disarmSourceBufferStuckTimer(){this._sourceBufferStuckTimer&&clearTimeout(this._sourceBufferStuckTimer)}}t.BufferOpsQueue=d,n([c.default],d.prototype,"_onBufferReady",null),n([c.default],d.prototype,"_disarmSourceBufferStuckTimer",null)},8810:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateConfig=void 0;var n=r(5307),i={[n.EPlayerType.HLS]:["HLSStreamUrl"],[n.EPlayerType.WEBRTC]:["WebRTCSignallingUrl","WebRTCStreamId","appKey"],[n.EPlayerType.BROADCAST]:["WebRTCSignallingUrl","WebRTCStreamId","MediaStream","appKey"],[n.EPlayerType.NATIVE]:["NativeStreamURL"]},o=new Set([n.EPlayerType.WEBRTC,n.EPlayerType.BROADCAST]);t.validateConfig=e=>{var t,{playerType:r,streamConfig:n,appKey:s,isTokenRequired:a=!1}=e,l=null!=n?n:{},u=[],c=null!==(t=i[r])&&void 0!==t?t:[];for(var d of c)("appKey"===d?s:l[d])||u.push(d);return a&&o.has(r)&&!l.WebRTCACLToken&&u.push("WebRTCACLToken"),u.length?{canStart:!1,missingFields:u}:{canStart:!0}}},8839:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EWMA=void 0,t.EWMA=class{constructor(e,t,r){a(this,"_eventBus",void 0),a(this,"_previousFastValue",null),a(this,"_previousSlowValue",null),a(this,"_fastAlpha",void 0),a(this,"_slowAlpha",void 0),this._eventBus=r,this._fastAlpha=e,this._slowAlpha=t}addValue(e){var{_fastAlpha:t,_slowAlpha:r}=this;this._previousFastValue=t*e+(1-t)*(this._previousFastValue||e),this._previousSlowValue=r*e+(1-r)*(this._previousSlowValue||e),this._eventBus.publish("EWMAMetrics",{fast:this._previousFastValue,slow:this._previousSlowValue})}getCurrentValue(){return this._previousSlowValue&&this._previousFastValue?Math.min(this._previousFastValue,this._previousSlowValue):0}getCurrentMaximalValue(){return this._previousFastValue&&this._previousSlowValue?Math.max(this._previousSlowValue,this._previousFastValue):0}reset(){this._previousSlowValue=null,this._previousFastValue=null}}},8847:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableBroadcastDispatcherConfigValues=t.defaultBroadcastDispatcherConfig=void 0,t.defaultBroadcastDispatcherConfig={startBitrate:100,enableStereoAudio:!0,enableBackendStreamQualityRecognition:!1,publisherReportInterval:1e3,bitrateThreshold:50,bitrate:2500,metadataReconnectMaxAttempts:100,metadataReconnectBaseTimeout:1e3,broadcastingRestartBaseTimeout:1e3,broadcastingRestartMaxAttempts:100,broadcastingSoftRestartMaxAttempts:5},t.availableBroadcastDispatcherConfigValues={}},8923:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThroughputHistory=void 0;var o=r(8169),s=r(5395),l=i(r(6073)),u=r(8839);class c extends o.ConfigConsumer{constructor(e){super("throughputHistory",e),a(this,"_measuredSpeedEwmaInstance",void 0),a(this,"_realSpeedEwmaInstance",void 0),a(this,"_ttfbEwmaInstance",void 0),a(this,"_onNetMetricsReadyListener",void 0),this._measuredSpeedEwmaInstance=new u.EWMA(this.config.ewmaFastAlpha,this.config.ewmaSlowAlpha,this._eventBus),this._realSpeedEwmaInstance=new u.EWMA(this.config.ewmaFastAlpha,this.config.ewmaSlowAlpha,this._eventBus),this._ttfbEwmaInstance=new u.EWMA(this.config.ewmaFastAlpha,this.config.ewmaSlowAlpha,this._eventBus),this._onNetMetricsReadyListener=this._eventBus.subscribe(s.NetworkLoaderEvent.stats.statsReady,this._onNetworkMetricsReady)}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onNetMetricsReadyListener),this._measuredSpeedEwmaInstance.reset(),this._realSpeedEwmaInstance.reset()}getCurrentBitrateEstimate(){return{measuredSpeed:this._measuredSpeedEwmaInstance.getCurrentValue(),realSpeedWithoutTTFB:this._realSpeedEwmaInstance.getCurrentValue(),ttfb:this._ttfbEwmaInstance.getCurrentMaximalValue()}}reset(){this._measuredSpeedEwmaInstance=new u.EWMA(this.config.ewmaFastAlpha,this.config.ewmaSlowAlpha,this._eventBus),this._realSpeedEwmaInstance=new u.EWMA(this.config.ewmaFastAlpha,this.config.ewmaSlowAlpha,this._eventBus),this._ttfbEwmaInstance=new u.EWMA(this.config.ewmaFastAlpha,this.config.ewmaSlowAlpha,this._eventBus)}_handleConfigUpdated(e){(e.ewmaFastAlpha||e.ewmaSlowAlpha)&&this.reset()}_onNetworkMetricsReady(e){if(!this.config.ignorePlaylistsMetrics||"text"!==e.type){var t=8*e.sizeInKb/((e.downloadDuration-e.ttfb)/1e3);this._measuredSpeedEwmaInstance.addValue(e.calculatedSpeed),this._realSpeedEwmaInstance.addValue(t),this._ttfbEwmaInstance.addValue(e.ttfb/1e3)}}}t.ThroughputHistory=c,n([l.default],c.prototype,"_handleConfigUpdated",null),n([l.default],c.prototype,"_onNetworkMetricsReady",null)},9024:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableDroppedFramesEstimatorConfigValues=t.defaultDroppedFramesEstimatorConfig=void 0,t.defaultDroppedFramesEstimatorConfig={resetHistoryTimeout:3e5,optimalDroppedFramesFraction:.1,minimalFramesPlayed:200},t.availableDroppedFramesEstimatorConfigValues={}},9042:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(3831),i=r(4792),o=r(7422),s=function(e){return(0,n.A)(e,o.A,i.A)}},9056:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.playerTypeChecker=void 0;var n=r(5307),i=r(6805);t.playerTypeChecker={[n.EPlayerType.NATIVE]:()=>Promise.resolve(!0),[n.EPlayerType.WEBRTC]:s(function*(){return i.WebRTCCommonHelpers.getIsWebRTCApiSupported()&&(yield i.WebRTCCommonHelpers.isH264PlayingSupported())}),[n.EPlayerType.BROADCAST]:s(function*(){return i.WebRTCCommonHelpers.getIsWebRTCApiSupported()&&(yield i.WebRTCCommonHelpers.isH264BroadcastSupported())}),[n.EPlayerType.HLS]:s(function*(){return i.HLSCommon.isHLSSupported()}),[n.EPlayerType.UNKNOWN]:()=>Promise.resolve(!1)}},9074:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.browserInfo=void 0;var i=n(r(6880));t.browserInfo=i.default.getParser(window.navigator.userAgent)},9088:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPartHoldback=void 0,t.getPartHoldback=(e,t)=>{var r,n,i,o,s;return null!==(r=null!==(n=null!==(i=e.partHoldBack)&&void 0!==i?i:null===(o=e.serverControl)||void 0===o?void 0:o.partHoldBack)&&void 0!==n?n:null===(s=e.serverControl)||void 0===s?void 0:s.holdBack)&&void 0!==r?r:t}},9115:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getKBitsSpeedFromPlaylistBitrate=void 0,t.getKBitsSpeedFromPlaylistBitrate=e=>e/1024},9142:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EMediaPermissionsErrorType=void 0,function(e){e.SYSTEM_PERMISSION_DENIED="SystemPermissionDenied",e.USER_PERMISSION_DENIED="UserPermissionDenied",e.COULD_NOT_START_VIDEO_SOURCE="CouldNotStartVideoSource",e.GENERIC="Generic"}(r||(t.EMediaPermissionsErrorType=r={}))},9208:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s};Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasVideoRenderer=void 0;var i=r(6847),o=r(4578),s=r(6671),l="\n  width: 100%;\n";class u{constructor(e){a(this,"_canvasContext",void 0),a(this,"_canvasAnimationFrameId",void 0),a(this,"_logger",void 0),a(this,"_knownVideoElementStyles",""),a(this,"_eventsMap",{[o.EVideoElementControllerBusEvent.PLAYING]:this.startAnimationFrame,[o.EVideoElementControllerBusEvent.LOADING]:this.cancelAnimationFrame,[o.EVideoElementControllerBusEvent.REMOVE_MEDIA_STREAM]:this.cancelAnimationFrame}),a(this,"_state",void 0),a(this,"_eventBus",void 0),a(this,"_applyStyles",()=>{this._logger.debug("Apply styles for canvas and video elements");var{canvasElement:e,videoElement:t}=this._getElements();e&&t&&(this._knownVideoElementStyles=t.style.cssText,e.style.cssText=l,t.style.cssText="\n      ".concat(l,"\n      opacity: 0;\n      position: absolute;\n      left: 0;\n      top: 0;\n    "))}),this._state=e.state,this._eventBus=e.eventBus,this._logger=(0,i.Logger)(this._eventBus,"VideoElementController - CanvasVideoRenderer");var t=document.createElement("canvas");this._canvasContext=t.getContext("2d"),e.className&&(t.className=e.className),this.init(),this._state.setState({canvasElement:t}),this._applyStyles(),this._logger.verbose("Canvas renderer has been created")}startAnimationFrame(){var{canvasElement:e,videoElement:t}=this._getElements();if(this.cancelAnimationFrame(),e&&t){var{width:r,height:n}=e.getBoundingClientRect(),{videoWidth:i,videoHeight:o}=t;if(r/n<1&&i/o>1){var s,a=Math.max(r,i),l=o*(r/i),u=r>a?(r-a)/2:0,c=(n-l)/2;if(this._canvasContext){var d=devicePixelRatio;e.width=a*d,e.height=n*d,this._canvasContext.scale(d,d)}null===(s=this._canvasContext)||void 0===s||s.drawImage(t,u,c,a,l)}else{var h,f=Math.max(n,o),p=i*(n/o),v=n>f?(n-f)/2:0,g=(r-p)/2;if(this._canvasContext){var _=devicePixelRatio;e.width=r*_,e.height=f*_,this._canvasContext.scale(_,_)}null===(h=this._canvasContext)||void 0===h||h.drawImage(t,g,v,p,f)}this._state.getState().isLoading||(this._canvasAnimationFrameId=requestAnimationFrame(this.startAnimationFrame))}}getCanvasElement(){var e;return null!==(e=this._getElements().canvasElement)&&void 0!==e?e:null}destroy(){this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap});var{canvasElement:e,videoElement:t}=this._getElements();e&&e.parentNode&&e.parentNode.removeChild(e),t&&(t.style.cssText=this._knownVideoElementStyles,this._knownVideoElementStyles=""),this._state.setState({canvasElement:null}),this._logger.verbose("Canvas renderer was destroyed")}init(){this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}cancelAnimationFrame(){this._canvasAnimationFrameId&&(cancelAnimationFrame(this._canvasAnimationFrameId),this._canvasAnimationFrameId=null)}_getElements(){var{videoElement:e,canvasElement:t}=this._state.getState();return{videoElement:e,canvasElement:t}}}t.CanvasVideoRenderer=u,n([s.bind],u.prototype,"startAnimationFrame",null),n([s.bind],u.prototype,"destroy",null),n([s.bind],u.prototype,"init",null),n([s.bind],u.prototype,"cancelAnimationFrame",null),n([s.bind],u.prototype,"_getElements",null)},9234:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.promisify=t.isEmptyObject=t.hasOwnProperty=t.isObject=t.isEmpty=t.isHTMLElement=t.isDate=void 0,t.isDate=e=>e instanceof Date,t.isHTMLElement=e=>e instanceof Element||e instanceof Document,t.isEmpty=e=>0===Object.keys(e).length,t.isObject=e=>null!=e&&"object"==typeof e,t.hasOwnProperty=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Object.prototype.hasOwnProperty.call(e,...r)},t.isEmptyObject=e=>(0,t.isObject)(e)&&(0,t.isEmpty)(e),t.promisify=e=>t=>new Promise((r,n)=>{e(t,e=>{r(e)},e=>{n(e)})})},9243:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableThroughputHistoryConfigValues=t.defaultThroughputHistoryConfig=void 0,t.defaultThroughputHistoryConfig={ewmaFastAlpha:.9,ewmaSlowAlpha:.2,ignorePlaylistsMetrics:!0},t.availableThroughputHistoryConfigValues={}},9272:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.VODPlaylistRotationController=void 0;var s,l=r(355),u=r(2086),c=r(363),d=r(835),h=r(164),f=r(2513),p=r(6701),v=r(6967),g=r(450),_=r(180),m=o(r(6073));!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(s||(s={}));class y extends h.BasePlaylistRotationController{constructor(e,t,r,n){super("VODPlaylistRotationController","playlistLoader",r,e),a(this,"state",_.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"_fragments",[]),a(this,"_lastHandledFragments",[]),a(this,"_chunksRetryTimeout",null),a(this,"_isDurationPositive",!1),a(this,"_onFragmentLoadedListener",void 0),a(this,"_onFragmentAbortedListener",void 0),a(this,"_onFragmentErrorListener",void 0),a(this,"_onBufferMetricsAvailableListener",void 0),this._url=t,this._onFragmentLoadedListener=this._eventBus.subscribe(p.StreamLoaderModuleEvents.fragmentLoader.fragments.fragmentLoaded,this._onFragmentLoaded),this._onFragmentAbortedListener=this._eventBus.subscribe(p.StreamLoaderModuleEvents.fragmentLoader.fragments.fragmentLoadingAborted,this._onFragmentLoadingError),this._onFragmentErrorListener=this._eventBus.subscribe(p.StreamLoaderModuleEvents.fragmentLoader.fragments.fragmentLoadingError,this._onFragmentLoadingError),this._onBufferMetricsAvailableListener=this._eventBus.subscribe(l.BufferControllerEvents.bufferMetricsAvailable,this._onBufferMetricsAvailable),n?this._handleParsedPlaylist(n):this._loadNextPlaylist()}destroy(){super.destroy(),this._eventBus.unsubscribe(this._onFragmentLoadedListener),this._eventBus.unsubscribe(this._onBufferMetricsAvailableListener),this._eventBus.unsubscribe(this._onFragmentErrorListener),this._eventBus.unsubscribe(this._onFragmentAbortedListener)}setURL(e,t){var r;t?this._url=e:(this._logger.info("Setting new url ".concat(e)),null!==(r=this._currentPlaylistLoader)&&void 0!==r&&r.destroy(),this._url=e,this._loadNextPlaylist())}abortCurrentPlaylistLoading(){var e;this._logger.info("Aborting current loading playlist"),null===(e=this._currentPlaylistLoader)||void 0===e||e.destroy()}_handleConfigUpdated(){}_loadNextPlaylist(){var{playlistLoadingTimeout:e,baseVODPlaylistRetryTimeout:t,maxVODPlaylistLoadingRetries:r}=this.config;this._logger.debug("Loading VOD playlist"),this._currentPlaylistLoader&&this._currentPlaylistLoader.cancel("Another playlist with url ".concat(this._url," scheduled to load")),this._currentPlaylistLoader=new g.NetworkLoader({url:this._buildURL(),loadingTimeout:e,autoLoad:!0,mode:"text",onStateChanged:this._onPlaylistLoadingStateChanged,baseRetryTimeout:t,maxRetries:r,workerMode:this.config.workerMode},this._eventBus)}_onPlaylistLoadingStateChanged(e,t){var r,n,i;if(!this._currentPlaylistLoader||[v.ELoadingState.ABORTED,v.ELoadingState.ERROR].includes(t))return this.state=_.EDebuggableModuleState.ERROR,this.additionalInfo={playlistLoadError:null===(r=this._currentPlaylistLoader)||void 0===r?void 0:r.error},this._logger.warn("Playlist loader reported ".concat(t===v.ELoadingState.ERROR?"error":"as aborted"," (").concat((null===(n=this._currentPlaylistLoader)||void 0===n||null===(n=n.error)||void 0===n?void 0:n.statusText)||"no error"," with status ").concat((null===(i=this._currentPlaylistLoader)||void 0===i||null===(i=i.error)||void 0===i?void 0:i.statusText)||"no status","). Planning next load")),void(this._currentPlaylistLoader=null);if(t===v.ELoadingState.LOADED){var o=this._currentPlaylistLoader.data;this._currentPlaylistLoader=null;var s=this._parsePlaylist({data:o,isCorruptRequested:this._playlistDecryptHandler.hasCorruptionInfo});s?(this._eventBus.publish(f.BasePlaylistRotationControllerEvents.playlists.playlistInfo,s),this._handleParsedPlaylist(s)):this._eventBus.publish(d.ResolutionsManagerEvents.requestRestartFromMain,{})}}_handleParsedPlaylist(e){this._isMultiVariantPlaylist(e)?this._handleMultivariantManifestDetected(e):this._isLowLatencyPlaylist(e)&&this.config.lowLatencyMode?this._handleLLManifestDetected(e):this._isSimplePlaylist(e)?this._handleSimplePlaylistDetected(e):(this.status="Playlist loaded",this._populateVODFragments(e.segments))}_planNextLoad(){}_populateVODFragments(e){for(var t=0,r=0;r<e.length;r++){var n=e[r],i={url:n.uri,fragmentIndex:r,fragmentStartTS:t,fragmentEndTS:t+n.duration,readinessState:s.NONE,isLast:r===e.length-1};this._fragments.push(i),t=i.fragmentEndTS}this._isDurationPositive=t>0,this._eventBus.publish(f.BasePlaylistRotationControllerEvents.playlists.vodFragmentsInfo,this._fragments)}_loadFragment(e){var t=e.map(e=>{var{url:t}=e;return t});e.filter(e=>{var{readinessState:r,url:n}=e;return r===s.LOADED&&t.includes(n)}).forEach(e=>{this._logger.info("Some fragments already loaded, reemitting it: ".concat(e.fragmentIndex)),this._eventBus.publish(f.BasePlaylistRotationControllerEvents.fragments.requestReleaseFromCache,{msn:e.fragmentIndex})});var r=e.filter(e=>{var{readinessState:t}=e;return[s.NONE].includes(t)});r.forEach(e=>e.readinessState=s.LOADING),this._handleFragmentsDetected(r.map(e=>new u.Fragment({msn:e.fragmentIndex,playlistUrl:this._url||"",fragmentUrl:e.url,pn:0,independent:c.EIndependenceType.INDEPENDENT,duration:e.fragmentEndTS-e.fragmentStartTS,requestedLoadingTimeout:this.config.disableTimeoutsInVOD?-1:this.config.baseVODFragmentRetryTimeout,startTs:e.fragmentStartTS,endTs:e.fragmentEndTS,isTransmuxingBypassRequested:e.url.endsWith(".mp4")},this._eventBus,this.config.shouldLogFragmentsHistory))),this._lastHandledFragments=t}_onFragmentLoaded(e){this._logger.info("Fragment ".concat(e.msn," loaded"));var t=this._fragments.find(t=>{var{fragmentIndex:r}=t;return r===e.msn});t&&(t.readinessState=s.LOADED,t.data=e.data,this.additionalInfo.fragments=this._fragments.map(e=>i(i({},e),{},{data:void 0})))}_onFragmentLoadingError(e){var t=this._fragments.find(t=>{var{fragmentIndex:r}=t;return r===e.msn});t&&(t.readinessState=s.ERROR,this._chunksRetryTimeout||(this._chunksRetryTimeout=globalThis.setTimeout(this._retryFragments,this.config.baseVODFragmentRetryTimeout)))}_retryFragments(){this._chunksRetryTimeout=null,this._fragments.filter(e=>{var{readinessState:t}=e;return t===s.ERROR}).forEach(e=>e.readinessState=s.NONE)}_onBufferMetricsAvailable(e){if(!this._fragments.some(e=>{var{readinessState:t}=e;return t===s.LOADING})&&this._isDurationPositive){var t=[],{currentTimeRange:r,currentPlaybackPosition:n,isInLastBufferedRange:i,bufferedTimeRanges:o}=e,a=i||!!r&&!o.some(e=>{var{start:t,end:n}=e;return t<=r.end+1&&r.end+1<=n}),l=n+this.config.VODLoadNextSegmentThreshold/1e3;if(r&&r.end-n<this.config.VODLoadNextSegmentThreshold/1e3&&a&&l<e.knownDuration-.1&&(t=this._findNextFragmentsByTime(n,l).filter(e=>{var{fragmentStartTS:t,fragmentEndTS:r}=e;return!(t<=n&&n<=r)})),r||(t=this._findNextFragmentsByTime(n,n)),t.length){this._logger.info("Loading following fragments ".concat(t.map(e=>{var{fragmentIndex:t}=e;return t}).join(",")));var u=Math.min(...t.map(e=>{var{fragmentStartTS:t}=e;return t})),c=Math.max(...t.map(e=>{var{fragmentEndTS:t}=e;return t}));this._eventBus.publish(f.BasePlaylistRotationControllerEvents.fragments.periodFragmentsFound,{startTsOfPeriod:u,endTsOfPeriod:c}),this._loadFragment(t)}}}_findNextFragmentsByTime(e,t){return this._fragments.filter(r=>{var{fragmentEndTS:n,fragmentStartTS:i}=r;return i<=e&&e<=n||i>=e&&t>=n||i<=t&&t<=n})}_buildURL(){var e=new URL(this._url||"");return e.search=this._playlistDecryptHandler.corruptionQueryParams.toString(),e}}t.VODPlaylistRotationController=y,n([m.default],y.prototype,"destroy",null),n([m.default],y.prototype,"_handleConfigUpdated",null),n([m.default],y.prototype,"_onPlaylistLoadingStateChanged",null),n([m.default],y.prototype,"_planNextLoad",null),n([m.default],y.prototype,"_onFragmentLoaded",null),n([m.default],y.prototype,"_onFragmentLoadingError",null),n([m.default],y.prototype,"_retryFragments",null),n([m.default],y.prototype,"_onBufferMetricsAvailable",null)},9313:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.V1PostParseURLRestore=void 0;var n=r(1312),i=r(2621);class o extends i.PlaylistPostParseDecryptStage{constructor(){super(),a(this,"_cachedHash",{})}restorePlaylist(e,t){var r,n;return e.segments=e.segments.map(e=>this._restore(e,t)),null!==(r=e.preloadSegment)&&void 0!==r&&null!==(r=r.parts)&&void 0!==r&&r.length&&(e.preloadSegment.parts=null===(n=e.preloadSegment)||void 0===n?void 0:n.parts.map(e=>this._uriRestore(e,t))),e}_restore(e,t){return e.parts&&(e.parts=e.parts.map(e=>this._uriRestore(e,t))),this._uriRestore(e,t)}_uriRestore(e,t){var r=/xxx_(.+)$/,n=e.uri.match(r);if(!n)return e;var i=n[1],o=this._decode(i,t);return e.uri&&(e.uri=e.uri.replace(r,"".concat(o))),e}_decode(e,t){for(var r=new TextDecoder("utf-8"),n=this._computeHash(t),i=atob(e),o=new Uint8Array(i.length),s=0;s<i.length;s++)o[s]=i.charCodeAt(s)^n[s%n.length];return r.decode(o)}_computeHash(e){if(!this._cachedHash[e]){var t=n.sha256.arrayBuffer(e);this._cachedHash[e]=new Uint8Array(t)}return this._cachedHash[e]}}t.V1PostParseURLRestore=o},9372:e=>{e.exports="/// <reference lib=\"webworker\" />\n\nexport const createBaseWorker = (timeSyncResyncInterval) => {\n  const AVC_SEI_NALU_Type = 6;\n  const HEVC_SEI_NALU_Type = 39;\n  const USER_DATA_UNREGISETERD_SEI_PAYLOAD_TYPE = 5;\n\n  class NALUutils {\n    static ENCODE_TIMESTAMP_SEI_MESSAGE_UUID = new Uint8Array([\n      0x08, 0x2c, 0x96, 0x8f, 0x77, 0x5e, 0x49, 0xb4, 0x8d, 0x55, 0xa4, 0x29, 0xec, 0xd9, 0x89, 0xd5,\n    ]);\n\n    static ENCODE_TIMESTAMP_SEI_MESSAGE_UUID_STRING = String.fromCharCode(...NALUutils.ENCODE_TIMESTAMP_SEI_MESSAGE_UUID);\n\n    static buildNALU(naluBody, prefix = Uint8Array.from([])) {\n      const naluHeaderByte = (naluBody.refIDC << 5) | naluBody.type;\n      return Uint8Array.from([...prefix, naluHeaderByte, ...new Uint8Array(naluBody.payload), 0x80]);\n    }\n\n    static extractAnnexBNALUs(packet) {\n      let offset = 2;\n      const nalusStartIndex = [];\n      while (offset < packet.length) {\n        if (packet[offset - 2] === 0x00 && packet[offset - 1] === 0x00 && packet[offset] === 0x01) {\n          nalusStartIndex.push(offset + 1);\n        }\n        offset++;\n      }\n\n      return nalusStartIndex.map((startIndex, naluIndex) =>\n        packet.slice(startIndex, naluIndex < nalusStartIndex.length - 1 ? nalusStartIndex[naluIndex + 1] : packet.length - 1),\n      );\n    }\n\n    static buildSEIUserDataUnregisteredNALUPayload(uuid, payload) {\n      const seiPayloadByte = USER_DATA_UNREGISETERD_SEI_PAYLOAD_TYPE;\n      const totalLength = payload.length + 16;\n      const payloadSizeBytes = Array(Math.floor(totalLength / 256)).fill(0xff);\n      payloadSizeBytes.push(totalLength % 256);\n\n      return new Uint8Array([seiPayloadByte, ...payloadSizeBytes, ...uuid, ...payload]);\n    }\n\n    static timestampToUInt8Array(timestamp) {\n      return new Uint8Array(BigUint64Array.from([BigInt(timestamp)]).buffer);\n    }\n\n    static uInt8ArrayToTimestamp(array) {\n      let timestamp = 0;\n      for (let i = array.byteLength - 1; i >= 0; i--) {\n        timestamp += array[i] * 256 ** i;\n      }\n\n      return timestamp;\n    }\n\n    static isEncodeTimeSEI(sei) {\n      return String.fromCharCode(...new Uint8Array(sei.UUID)) === NALUutils.ENCODE_TIMESTAMP_SEI_MESSAGE_UUID_STRING;\n    }\n\n    static parseNALU(nalu) {\n      const naluDataView = new DataView(nalu);\n      const firstByte = naluDataView.getUint8(0);\n\n      const refIDC = (firstByte & 0x60) >> 5;\n      const type = firstByte & 0x1f;\n      const payload = nalu.slice(1);\n\n      return {\n        refIDC,\n        type: Math.min(type, 15),\n        payload,\n      };\n    }\n\n    static parseSEI(seiPayload) {\n      if (seiPayload.byteLength < 2) {\n        console.warn(`Malformed SEI message, it is too short: ${seiPayload.byteLength} bytes`);\n        return null;\n      }\n\n      const seiDataView = new DataView(seiPayload);\n      let offset = 0;\n\n      let payloadType = 0;\n\n      while (seiDataView.getUint8(offset) === 0xff) {\n        payloadType += 0xff;\n        offset++;\n      }\n\n      payloadType += seiDataView.getUint8(offset);\n      offset++;\n\n      let payloadSize = 0;\n\n      while (seiDataView.getUint8(offset) === 0xff) {\n        payloadSize += 0xff;\n        offset++;\n      }\n\n      payloadSize += seiDataView.getUint8(offset);\n      offset++;\n\n      if (seiPayload.byteLength - offset !== payloadSize) {\n        //console.warn(`Malformed SEI message, expected ${payloadSize} payload size, bot got ${seiPayload.byteLength - offset}`);\n        //return null;\n      }\n\n      return {\n        payloadType,\n        payloadSize,\n        payload: seiPayload.slice(offset, offset + payloadSize),\n      };\n    }\n\n    static parseSEIUserDataUnregistered(seiPayload) {\n      return {\n        UUID: seiPayload.slice(0, 16),\n        userDataPayload: seiPayload.slice(16),\n      };\n    }\n\n    static mergeUInt8Arrays(sourceArrays) {\n      const totalLength = sourceArrays.reduce((s, c) => s + c.byteLength, 0);\n      const resultBuffer = new Uint8Array(totalLength);\n\n      let offset = 0;\n\n      for (const sourceArray of sourceArrays) {\n        resultBuffer.set(sourceArray, offset);\n        offset += sourceArray.byteLength;\n      }\n\n      return resultBuffer;\n    }\n  }\n\n  const EWorkerOPS = {\n    INPRINT_TS: 'inprintTS',\n    PARSE_TS: 'parseTS',\n    BYPASS: 'bypass',\n    SET_CODEC: 'setCodec',\n    SET_TIME_SYNC_SERVER: 'setTimeSyncServer',\n  };\n\n  const ESupportedCodecs = {\n    H264: 'h264',\n    H265: 'h265',\n  };\n\n  class TimeSync {\n    _timeServerURL = null;\n    _retryTimeoutId = null;\n    _positionAtZero = 0;\n    _abortController = new AbortController();\n    _resyncInterval = -1;\n\n    constructor(resyncInterval) {\n      this._resyncInterval = resyncInterval;\n    }\n\n    destroy() {\n      this._abortController.abort();\n      if (this._retryTimeoutId) {\n        clearTimeout(this._retryTimeoutId);\n      }\n    }\n\n    setUrl(url) {\n      this._timeServerURL = url;\n\n      if (this._retryTimeoutId) {\n        clearTimeout(this._retryTimeoutId);\n      }\n      this._checkDrift();\n    }\n\n    async _checkDrift() {\n      if (!this._timeServerURL) {\n        return;\n      }\n      try {\n        const response = await fetch(`${this._timeServerURL}?orig=ristretto`, {\n          cache: 'no-cache',\n          signal: this._abortController.signal,\n        });\n        if (!response.ok) {\n          throw new Error(`Could not get time sync response: ${response.status}`);\n        }\n        const reqEndTs = performance.now();\n        let rtt = 0;\n        const detailedTimings = performance.getEntriesByName(`${this._timeServerURL}/time`)[0];\n        const { requestStart, responseStart, responseEnd } = detailedTimings || {};\n        if (requestStart && responseStart && responseEnd) {\n          rtt = (responseStart - requestStart) / 2 + (responseEnd - responseStart);\n          performance.clearResourceTimings();\n        }\n        const responseTime = Number(await response.text()) * 1000;\n        this._positionAtZero = responseTime + rtt - reqEndTs;\n\n        if (this._retryTimeoutId) {\n          clearTimeout(this._retryTimeoutId);\n        }\n\n        if (this._resyncInterval > -1) {\n          this._retryTimeoutId = setTimeout(() => this._checkDrift(), this._resyncInterval);\n        }\n      } catch (e) {\n        if (e.name === 'AbortController') {\n          return;\n        }\n        if (this._retryTimeoutId) {\n          clearTimeout(this._retryTimeoutId);\n        }\n        this._retryTimeoutId = setTimeout(() => this._checkDrift(), 1000);\n      }\n    }\n\n    get currentCorrectedTime() {\n      return this._positionAtZero > 0 ? Math.round(this._positionAtZero + performance.now()) : Date.now();\n    }\n  }\n\n  let timeSync = null;\n  let timeSyncServer = null;\n\n  let codec = null;\n\n  const parseTimestamp = (frame, controller) => {\n    if (!codec) {\n      controller.enqueue(frame);\n      return;\n    }\n\n    const receiveTimestamp = timeSync.currentCorrectedTime;\n\n    const rawNALUs = NALUutils.extractAnnexBNALUs(new Uint8Array(frame.data));\n    const NALUs = rawNALUs.map((nalu) => NALUutils.parseNALU(nalu.buffer));\n\n    const seiNALUs = NALUs.filter(({ type }) =>\n      codec === ESupportedCodecs.H264 ? type === AVC_SEI_NALU_Type : type === HEVC_SEI_NALU_Type,\n    );\n\n    for (const seiNALu of seiNALUs) {\n      const seiInfo = NALUutils.parseSEI(seiNALu.payload);\n\n      if (seiInfo?.payloadType === USER_DATA_UNREGISETERD_SEI_PAYLOAD_TYPE) {\n        const seiUserDataUnregisteredInfo = NALUutils.parseSEIUserDataUnregistered(seiInfo.payload);\n\n        if (NALUutils.isEncodeTimeSEI(seiUserDataUnregisteredInfo)) {\n          const message = {\n            encodeTimestamp: NALUutils.uInt8ArrayToTimestamp(new Uint8Array(seiUserDataUnregisteredInfo.userDataPayload)),\n            receiveTimestamp,\n            timestamp: frame.timestamp,\n          };\n          self.postMessage(message);\n        }\n      }\n    }\n\n    controller.enqueue(frame);\n  };\n\n  const imprintTimestamp = (frame, controller) => {\n    if (!codec) {\n      controller.enqueue(frame);\n      return;\n    }\n\n    const timestampBytes = NALUutils.timestampToUInt8Array(timeSync.currentCorrectedTime);\n    const seiMessage = NALUutils.buildSEIUserDataUnregisteredNALUPayload(NALUutils.ENCODE_TIMESTAMP_SEI_MESSAGE_UUID, timestampBytes);\n\n    const seiNALu = NALUutils.buildNALU(\n      {\n        type: codec === ESupportedCodecs.H265 ? HEVC_SEI_NALU_Type : AVC_SEI_NALU_Type,\n        payload: seiMessage,\n        refIDC: 0,\n      },\n      new Uint8Array(frame.data.slice(0, 4)),\n    );\n\n    frame.data = NALUutils.mergeUInt8Arrays([seiNALu, new Uint8Array(frame.data)]).buffer;\n\n    controller.enqueue(frame);\n  };\n\n  const handleOpRequest = (operation, source, sink, params) => {\n    switch (operation) {\n      case EWorkerOPS.PARSE_TS: {\n        timeSync = new TimeSync(timeSyncResyncInterval);\n        if (timeSyncServer) {\n          timeSync.setUrl(timeSyncServer);\n        }\n        const transformStream = new TransformStream({\n          transform: parseTimestamp,\n        });\n        source.pipeThrough(transformStream).pipeTo(sink);\n        break;\n      }\n\n      case EWorkerOPS.INPRINT_TS: {\n        timeSync = new TimeSync(timeSyncResyncInterval);\n        if (timeSyncServer) {\n          timeSync.setUrl(timeSyncServer);\n        }\n        const transformStream = new TransformStream({\n          transform: imprintTimestamp,\n        });\n        source.pipeThrough(transformStream).pipeTo(sink);\n        break;\n      }\n\n      case EWorkerOPS.BYPASS: {\n        source.pipeTo(sink);\n        break;\n      }\n\n      case EWorkerOPS.SET_CODEC: {\n        codec = params.codec;\n        break;\n      }\n\n      case EWorkerOPS.SET_TIME_SYNC_SERVER: {\n        timeSyncServer = params.url;\n        timeSync?.setUrl(params.url);\n        break;\n      }\n    }\n  };\n\n  self.onmessage = (event) => {\n    const { operation, source, sink, ...params } = event.data;\n\n    handleOpRequest(operation, source, sink, params);\n  };\n\n  if (self.RTCTransformEvent) {\n    self.addEventListener('rtctransform', (ev) => {\n      const transformer = ev.transformer;\n      const {\n        readable,\n        writable,\n        options: { operation },\n      } = transformer;\n      handleOpRequest(operation, readable, writable);\n    });\n  }\n};\n"},9408:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OpenObserveLogger=void 0,t.OpenObserveLogger=new class{constructor(){a(this,"_ooEndpoint","/api/front/v2/logs/streaming")}reportError(e,t){var r=this;return s(function*(){try{yield fetch(r._ooEndpoint,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({doppioLifecycleError:{errorType:e,context:t}})})}catch(e){}})()}}},9417:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.INITIAL_STATE=void 0;var n=r(5458);t.INITIAL_STATE={canPlay:!1,isLoading:!0,isError:!1,isAutoplayError:!1,isPaused:!1,isPlaying:!1,isRestarted:!1,isStalled:!1,isWaiting:!1,isDestroyed:!1,videoPlaybackState:n.EPlaybackState.IDLE,startedPlaying:!1}},9428:e=>{e.exports=r(8960)},9437:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PlaylistPreParseDecryptStage=void 0;var n=r(1854);class i extends n.PlaylistParserDecryptStage{constructor(){super(...arguments),a(this,"pipelinePosition","preParse")}}t.PlaylistPreParseDecryptStage=i},9442:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferController=void 0;var o=r(5121),s=r(8805),l=r(2733),u=r(5373),c=r(6261),d=r(4121),h=r(8169),f=r(5021),p=r(8474),v=r(835),g=r(6701),_=r(180),m=i(r(6073)),y=r(2345),b=r(355),E=r(2029),S=e=>'video/mp4; codecs="'.concat(e,'"');class T extends h.ConfigConsumer{constructor(e){super("bufferController",e),a(this,"_eventBus",void 0),a(this,"state",_.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"additionalInfo",{}),a(this,"groups",["buffer","general"]),a(this,"_sourceBuffer",null),a(this,"_isSourceBufferReady",!1),a(this,"_awaitingForNextSourceBuffer",!1),a(this,"_isVODMode",!1),a(this,"_closeOnNextSegment",!1),a(this,"_currentVideoDuration",Number.POSITIVE_INFINITY),a(this,"_videoElement",null),a(this,"_mediaSource",null),a(this,"_knownObjectURL",""),a(this,"_mimeType",'video/mp4; codecs="mp4a.40.2,avc1.64001f"'),a(this,"_shouldRecreateSourceBufferOnStall",!1),a(this,"_sourceBufferStuckTimer",null),a(this,"_onFragmentParsedListener",void 0),a(this,"_onSoftResetRequestedListener",void 0),a(this,"_onSourceBufferOperationRequestedListener",void 0),a(this,"_onVODPlaylistDetectedListener",void 0),a(this,"_onSimplePlaylistDetectedListener",void 0),a(this,"_onLLPlaylistDetectedListener",void 0),a(this,"_onPlaylistInfoAvailableListener",void 0),a(this,"_onResolutionCodecChangeRequestListener",void 0),a(this,"_onResolutionChangeListener",void 0),a(this,"_onPlaybackStallChangedListener",void 0),a(this,"_onSourceBufferStuckListener",void 0),a(this,"_bufferMetrics",void 0),a(this,"_gapController",void 0),a(this,"_bufferStallsDetector",void 0),a(this,"_bufferOpsQueue",void 0),a(this,"_bufferCleaner",void 0),a(this,"_playbackSpeedController",void 0),a(this,"_playbackStateController",void 0),a(this,"_bufferChunksCache",void 0),a(this,"_onEndOfStreamReachedListener",void 0),a(this,"_logger",void 0),this._logger=(0,p.Logger)(e,"Doppio - BufferController"),this._eventBus=e,this._logger=(0,p.Logger)(this._eventBus,"Doppio - BufferController"),this._logger.info("Created"),this._bufferCleaner=new o.BufferCleaner(this._eventBus),this._bufferMetrics=new E.BufferMetrics(this._eventBus),this._bufferStallsDetector=new l.BufferStallsDetector(this._eventBus),this._bufferOpsQueue=new s.BufferOpsQueue(this._eventBus),this._playbackSpeedController=new c.PlaybackSpeedController(this._eventBus),this._playbackStateController=new d.PlaybackStateController(this._eventBus),this._bufferChunksCache=new y.BufferChunksCache(this._eventBus),this._onFragmentParsedListener=this._eventBus.subscribe(f.FragmentParserEvents.fragments.fragmentsParsed,this._onFragmentsParsed),this._onSoftResetRequestedListener=this._eventBus.subscribe(b.BufferControllerEvents.requestResetWithOverplay,this._onSoftResetRequested),this._onVODPlaylistDetectedListener=this._eventBus.subscribe(g.StreamLoaderModuleEvents.playlistRotator.playlistType.vodDetected,this._onVODPlaylistDetected),this._onSimplePlaylistDetectedListener=this._eventBus.subscribe(g.StreamLoaderModuleEvents.playlistRotator.playlistType.simpleDetected,this._onLivePlaylistDetected),this._onLLPlaylistDetectedListener=this._eventBus.subscribe(g.StreamLoaderModuleEvents.playlistRotator.playlistType.llDetected,this._onLivePlaylistDetected),this._onSourceBufferOperationRequestedListener=this._eventBus.subscribe(b.BufferControllerEvents.requestSourceBufferOperation,this._onSourceBufferOperationRequested),this._onPlaylistInfoAvailableListener=this._eventBus.subscribe(g.StreamLoaderModuleEvents.playlistRotator.playlists.playlistInfo,this._onPlaylistInfoAvailable),this._onEndOfStreamReachedListener=this._eventBus.subscribe(b.BufferControllerEvents.endOfStreamReached,this._onEndOfStreamReached),this._onResolutionCodecChangeRequestListener=this._eventBus.subscribe(b.BufferControllerEvents.changeCodec,this._onResolutionCodecChangeRequest),this._onResolutionChangeListener=this._eventBus.subscribe(v.ResolutionsManagerEvents.resolutionChanged,this._onResolutionChange),this._onPlaybackStallChangedListener=this._eventBus.subscribe(b.BufferControllerEvents.playbackStallChanged,this._onPlaybackStallChanged),this._onSourceBufferStuckListener=this._eventBus.subscribe(b.BufferControllerEvents.sourceBufferStuck,this._onSourceBufferStuck),this._gapController=new u.GapController(this._eventBus)}attachVideoElement(e){this._logger.info("Attach video element",e),this._bufferMetrics.setVideoElement(e),this._playbackSpeedController.setVideoElement(e),this._gapController.setVideoElement(e),this._bufferCleaner.setVideoElement(e),this._playbackStateController.setVideoElement(e),this._videoElement=e,this._recreateMediaSource()}scheduleSourceBufferRecreation(){this._awaitingForNextSourceBuffer=!0}detachVideoElement(){var t;if(this._logger.info("Detaching video element"),this._eventBus.publish(b.BufferControllerEvents.requestResetWithOverplay,{}),this._bufferMetrics.removeVideoElement(),this._playbackSpeedController.removeVideoElement(),this._gapController.removeVideoElement(),this._bufferCleaner.removeVideoElement(),this._playbackStateController.setVideoElement(null),"open"===(null===(t=this._mediaSource)||void 0===t?void 0:t.readyState)&&this._videoElement&&this._videoElement.readyState>=this._videoElement.HAVE_METADATA)try{this._logger.verbose("Calling endOfStream of mediaSource"),this._mediaSource.endOfStream()}catch(e){this._logger.warn("Error occurred while detaching video element. Ignoring it ".concat(e.message))}try{this._mediaSource&&this._sourceBuffer&&([...this._mediaSource.sourceBuffers].includes(this._sourceBuffer)&&(this._logger.debug("Removing sourceBuffer from MediaSource"),this._mediaSource.removeSourceBuffer(this._sourceBuffer)),this._sourceBuffer=null)}catch(e){this._logger.error("Failed to reset source buffer ".concat(e.message))}if(this._mediaSource&&(this._mediaSource.removeEventListener("sourceopen",this._onSourceBufferOpened),this._mediaSource.removeEventListener("sourceclose",this._onSourceBufferClosed),this._mediaSource.removeEventListener("error",this._onSourceBufferError)),this._videoElement){if(this._knownObjectURL){var r=this._knownObjectURL;setTimeout(()=>{this._logger.debug("Revoking Object URL ".concat(r)),globalThis.URL.revokeObjectURL(r)},100)}this._videoElement.src===this._knownObjectURL&&(this._videoElement.removeAttribute("src"),this._videoElement.load())}this._mediaSource=null,this._videoElement=null,this._knownObjectURL="",this._isSourceBufferReady=!1}destroy(){super.destroy(),this._logger.info("Destroy"),this.detachVideoElement(),this._eventBus.unsubscribe(this._onFragmentParsedListener),this._eventBus.unsubscribe(this._onSoftResetRequestedListener),this._eventBus.unsubscribe(this._onSourceBufferOperationRequestedListener),this._eventBus.unsubscribe(this._onVODPlaylistDetectedListener),this._eventBus.unsubscribe(this._onSimplePlaylistDetectedListener),this._eventBus.unsubscribe(this._onLLPlaylistDetectedListener),this._eventBus.unsubscribe(this._onPlaylistInfoAvailableListener),this._eventBus.unsubscribe(this._onEndOfStreamReachedListener),this._eventBus.unsubscribe(this._onResolutionCodecChangeRequestListener),this._eventBus.unsubscribe(this._onResolutionChangeListener),this._eventBus.unsubscribe(this._onPlaybackStallChangedListener),this._eventBus.unsubscribe(this._onSourceBufferStuckListener),this._gapController.destroy(),this._bufferMetrics.destroy(),this._bufferOpsQueue.destroy(),this._bufferCleaner.destroy(),this._playbackSpeedController.destroy(),this._playbackStateController.destroy(),this._bufferChunksCache.destroy(),this._disarmSourceBufferStuckTimer()}reset(){this._disarmSourceBufferStuckTimer(),this._recreateSourceBuffer(),this._bufferChunksCache.reset()}_onFragmentsParsed(e){var t=this;this._awaitingForNextSourceBuffer&&(this._awaitingForNextSourceBuffer=!1,this._recreateSourceBuffer()),this._bufferOpsQueue.addBufferOperation(()=>{this._mediaSource&&"open"===this._mediaSource.readyState&&(this._mediaSource.duration=this._currentVideoDuration)},()=>{this._logger.warn("Could not set mediaSource duration")},"setMediaSourceDuration");var r=function(e){t._bufferOpsQueue.addBufferOperation(r=>{t._logger.debug("Adding ".concat(e.getMsnPn()," to buffer")),r.appendBuffer(e.data),e.msn>-1&&(t._logger.debug("".concat(e.startTs," -> ").concat(e.endTs," loaded (").concat(e.getMsnPn(),")")),t._eventBus.publish(b.BufferControllerEvents.fragmentAdded,e)),t._mediaSource&&e.endTs===t._mediaSource.duration&&t._eventBus.publish(b.BufferControllerEvents.endOfStreamReached,{})},(r,n)=>{t._logger.error("".concat(e.url," (").concat(e.getMsnPn(),") cannot be added to buffer: ").concat(n))},"appendBuffer")};for(var n of e)r(n);this._sourceBuffer||this._bufferChunksCache.append(e),this._bufferOpsQueue.addBufferOperation(()=>{this._mediaSource&&"open"===this._mediaSource.readyState&&(this._mediaSource.duration=this._currentVideoDuration,this._videoElement&&0===this._videoElement.currentTime&&this._videoElement.buffered.length>0&&this._videoElement.buffered.start(0)>0&&(this._videoElement.currentTime=this._videoElement.buffered.start(0)))},()=>{this._logger.warn("Could not change current time of video")},"setVideoElementStartPosition")}_onSourceBufferOpened(){if(this._logger.debug("Source buffer is open now"),this._disarmSourceBufferStuckTimer(),this._mediaSource){this._logger.debug("Media source known"),"open"===this._mediaSource.readyState&&(this._logger.debug("State of mediaSource is open. Setting duration"),this._mediaSource.duration=this._currentVideoDuration),this._isSourceBufferReady=!0,this._sourceBuffer=this._mediaSource.addSourceBuffer(this._mimeType),this._logger.debug("Source buffer is open with mimeType ".concat(this._mimeType)),this._bufferOpsQueue.setSourceBuffer(this._sourceBuffer);var e=this._bufferChunksCache.getAll();this._bufferChunksCache.destroy(),e.length&&this._onFragmentsParsed(e)}}_recreateSourceBuffer(){this._logger.info("Will recreate source buffer"),this._bufferOpsQueue.immediatelyRecreateSourceBuffer(this._mediaSource),this._videoElement&&(this._videoElement.currentTime=0)}_onResolutionCodecChangeRequest(e){var{codec:t}=e;if(t){var r=S(t);r!==this._mimeType&&(this._mimeType=r)}}_onSourceBufferClosed(){this._logger.debug("Source buffer closed"),this._isSourceBufferReady=!1}_onSourceBufferError(){this._logger.debug("Source buffer error"),this._isSourceBufferReady=!1}_onSoftResetRequested(){this._logger.debug("Soft reset requested"),this._shouldRecreateSourceBufferOnStall=!1,this._awaitingForNextSourceBuffer=!0,this._playbackStateController.resetPlayingTimeCollector()}_endOfStreamReached(){this._mediaSource&&(this._closeOnNextSegment=!0)}_onSourceBufferOperationRequested(e){this._bufferOpsQueue.addBufferOperation(e)}_onLivePlaylistDetected(){this._isVODMode=!1,this._bufferCleaner.setVODMode(!1),this._gapController.setIsVod(!1),this._currentVideoDuration=Number.POSITIVE_INFINITY,this._playbackSpeedController.resume(),this._mediaSource&&"open"===this._mediaSource.readyState&&(this._mediaSource.duration=this._currentVideoDuration)}_onVODPlaylistDetected(){this._isVODMode=!0,this._bufferCleaner.setVODMode(!0),this._playbackSpeedController.pause(),this._gapController.setIsVod(!0)}_onPlaybackStallChanged(e){e&&this._shouldRecreateSourceBufferOnStall&&(this._logger.info("Will recreate source buffer, because playback stall was detected"),this._onSoftResetRequested())}_onPlaylistInfoAvailable(e){e&&e.playlists&&e.playlists[0].attributes.CODECS&&(this._mimeType=S(e.playlists[0].attributes.CODECS),this._bufferOpsQueue.addBufferOperation(e=>{e.changeType(this._mimeType)},()=>{this._logger.warn("Could not change codecs")},"changeType")),("VOD"===e.playlistType||e.endList)&&(this._currentVideoDuration=e.segments.reduce((e,t)=>e+t.duration,0),this._mediaSource&&"open"===this._mediaSource.readyState&&(this._mediaSource.duration=this._currentVideoDuration,this._mediaSource.setLiveSeekableRange(0,this._currentVideoDuration)))}_onEndOfStreamReached(){this._bufferOpsQueue.addBufferOperation(()=>{var e;this._logger.info("Setting endOfStream"),null===(e=this._mediaSource)||void 0===e||e.endOfStream()})}_onResolutionChange(){this.config.recreateSourceBufferOnResolutionChange?(this._logger.info("Will recreate source buffer, because resolution was changed, and config.recreateSourceBufferOnResolutionChange is true"),this._onSoftResetRequested()):this._shouldRecreateSourceBufferOnStall=!0}_onSourceBufferStuck(){this._logger.info("Source buffer stuck. Schedule reset"),this._onSoftResetRequested()}_recreateMediaSource(){this._logger.info("Recreate media source"),this._mediaSource&&(this._logger.debug("Media source already known. Removing event listeners"),this._mediaSource.removeEventListener("sourceopen",this._onSourceBufferOpened),this._mediaSource.removeEventListener("sourceclose",this._onSourceBufferClosed),this._mediaSource.removeEventListener("error",this._onSourceBufferError)),this._mediaSource=new T.MediaSource,this._logger.debug("Media source created. Attaching event listeners"),this._mediaSource.addEventListener("sourceopen",this._onSourceBufferOpened,{once:!0}),this._mediaSource.addEventListener("sourceclose",this._onSourceBufferClosed),this._mediaSource.addEventListener("error",this._onSourceBufferError),this._videoElement&&(this._knownObjectURL=globalThis.URL.createObjectURL(this._mediaSource),this._videoElement.src=this._knownObjectURL,this._logger.debug("MSE URL: ".concat(this._videoElement.src))),this._sourceBufferStuckTimer=setTimeout(()=>{this._logger.debug("Source buffer stuck timeout set"),this._recreateMediaSource()},this.config.sourceBufferStuckTimeout)}_disarmSourceBufferStuckTimer(){this._sourceBufferStuckTimer&&(this._logger.debug("Source buffer stuck timer disarm"),clearTimeout(this._sourceBufferStuckTimer))}get additionalModules(){return{gapController:this._gapController,bufferMetrics:this._bufferMetrics,playbackSpeed:this._playbackSpeedController}}static get MediaSource(){var e,t;if(null!==(e=window)&&void 0!==e&&e.ManagedMediaSource)return window.ManagedMediaSource;if(null!==(t=window)&&void 0!==t&&t.MediaSource)return window.MediaSource;throw new Error("No Media Source candidates found")}}t.BufferController=T,n([m.default],T.prototype,"_onFragmentsParsed",null),n([m.default],T.prototype,"_onSourceBufferOpened",null),n([m.default],T.prototype,"_onResolutionCodecChangeRequest",null),n([m.default],T.prototype,"_onSourceBufferClosed",null),n([m.default],T.prototype,"_onSourceBufferError",null),n([m.default],T.prototype,"_onSoftResetRequested",null),n([m.default],T.prototype,"_endOfStreamReached",null),n([m.default],T.prototype,"_onSourceBufferOperationRequested",null),n([m.default],T.prototype,"_onLivePlaylistDetected",null),n([m.default],T.prototype,"_onVODPlaylistDetected",null),n([m.default],T.prototype,"_onPlaybackStallChanged",null),n([m.default],T.prototype,"_onPlaylistInfoAvailable",null),n([m.default],T.prototype,"_onEndOfStreamReached",null),n([m.default],T.prototype,"_onResolutionChange",null),n([m.default],T.prototype,"_onSourceBufferStuck",null),n([m.default],T.prototype,"_recreateMediaSource",null)},9444:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CommonPlayerDebugInfo=void 0;var n=r(180);t.CommonPlayerDebugInfo=class{constructor(){a(this,"state",n.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["general"]),a(this,"_lastMetrics",null)}get additionalInfo(){var e,t,r;return i({totalHeapSize:null===(e=performance.memory)||void 0===e?void 0:e.totalJSHeapSize,usedHeapSize:null===(t=performance.memory)||void 0===t?void 0:t.usedJSHeapSize,sizeLimit:null===(r=performance.memory)||void 0===r?void 0:r.jsHeapSizeLimit},this._lastMetrics||{})}}},9469:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(6984),i=function(e,t){for(var r=e.length;r--;)if((0,n.A)(e[r][0],t))return r;return-1},o=Array.prototype.splice;function s(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}s.prototype.clear=function(){this.__data__=[],this.size=0},s.prototype.delete=function(e){var t=this.__data__,r=i(t,e);return!(r<0||(r==t.length-1?t.pop():o.call(t,r,1),--this.size,0))},s.prototype.get=function(e){var t=this.__data__,r=i(t,e);return r<0?void 0:t[r][1]},s.prototype.has=function(e){return i(this.__data__,e)>-1},s.prototype.set=function(e,t){var r=this.__data__,n=i(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};var a=s},9476:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EMetadataTransportEvents=void 0,function(e){e.GET_STREAM_INFO="metadataTransport.getStreamInfo",e.GET_STREAM_INFO_REPLY="metadataTransport.getStreamInfoReply",e.STREAM_INFO_AVAILABLE="metadataTransport.streamInfoAvailable",e.STREAM_UNAVAILABLE="metadataTransport.streamUnavailable",e.SET_QUALITY="metadataTransport.setQuality",e.SEND_RECEIVE_SDP="metadataTransport.sendReceiveSdp",e.SEND_BROADCAST_SDP="metadataTransport.sendBroadcastSdp",e.REMOTE_SDP_RECEIVED="metadataTransport.remoteSdpReceived",e.TRANSPORT_STATE_CHANGED="metadataTransport.TransportStateChanged",e.MUTE_TRACK="metadataTransport.muteTrack",e.STOP_STREAM="metadataTransport.stopStream",e.STREAM_STOP_APPROVED="metadataTransport.streamStopApproved",e.UN_PUBLISH_STREAM="metadataTransport.unPublishStream",e.UN_PUBLISH_STREAM_APPROVED="metadataTransport.unPublishStreamApproved",e.PUBLISH_FAILED="metadataTransport.publishFailed",e.SEND_RAW_MESSAGE="metadataTransport.sendRawMessage",e.CHANGE_QUALITY_STATUS="metadataTransport.changeQualityStatus",e.SEND_PUBLISHER_REPORT="metadataTransport.sendPublisherReport",e.PEER_CONFIG_AVAILABLE="metadataTransport.peerConfigAvailable",e.SET_NOISE_LEVEL="metadataTransport.setNoiseLevel",e.STREAM_PLAYING="metadataTransport.streamPlaying",e.DIFFERENT_MEDIA_SESSION_DETECTED="metadataTransport.differentMediaSessionDetected",e.INBOUND_VIDEO_RATE_RECEIVED="metadataTransport.inboundVideoRateReceived",e.STREAM_RELATED_MESSAGE_RECEIVED="metadataTransport.streamRelatedMessageReceived"}(r||(t.EMetadataTransportEvents=r={}))},9507:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=r(2534),i=r(4947),o=new Map;self.addEventListener("message",e=>{var{data:t}=e;if(t.type)switch(t.type){case n.ENetworkLoadFetchNetworkEvent.ABORT:var r=o.get(t.payload.url);r&&r.abort();break;case n.ENetworkLoadFetchNetworkEvent.DESTROY:var s=o.get(t.payload.url);s&&s.abort(),o.delete(t.payload.url);break;case n.ENetworkLoadFetchNetworkEvent.FETCH:var a=new i.NetworkLoadFetch({requestCustomReferer:t.payload.requestCustomReferer,onDataReady:e=>{self.postMessage({type:n.ENetworkLoadFetchNetworkEvent.DATA_READY,payload:{binaryData:e,url:t.payload.url}})},onChangeState:(e,r)=>{self.postMessage({type:n.ENetworkLoadFetchNetworkEvent.CHANGE_STATE,payload:{newState:e,url:t.payload.url,metadata:r}})},onStatsReady:e=>{self.postMessage({type:n.ENetworkLoadFetchNetworkEvent.STATS_READY,payload:{stats:e,url:t.payload.url}})},onError:e=>{self.postMessage({type:n.ENetworkLoadFetchNetworkEvent.ERROR,payload:{error:e,url:t.payload.url}})},onRedirectDetected:(e,t)=>{self.postMessage({type:n.ENetworkLoadFetchNetworkEvent.REDIRECT_DETECTED,payload:{url:e,responseUrl:t}})}});a.fetch(t.payload.url,t.payload.mode),o.set(t.payload.url,a)}})},9519:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.availableResolutionManagerConfigValues=t.defaultResolutionManagerConfig=void 0,t.defaultResolutionManagerConfig={autoloadLowestResolution:!0,initialResolutionWidth:0,initialResolutionHeight:720,initialResolutionBitrate:0,initialResolutionBitrateThreshold:1e5,maxPlaylistTimeDifference:4e4,awaitForSegmentEndToSwitch:!0,awaitForSegmentEndToSwitchManual:!1,recreateSourceBufferOnResolutionChange:!1,useFallbackResolutionIfResolutionNotFound:!0},t.availableResolutionManagerConfigValues={}},9520:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},9602:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TimeUpdateController=void 0;var o=i(r(4022)),s=r(6847),l=r(4578),u=r(9661),c=r(6671),d="ristrettoWasRestarted",h=0,f=0;class p{constructor(e){a(this,"_shouldSetNextUpdateVideoDurationId",!0),a(this,"_props",void 0),a(this,"_updateVideoDurationId",void 0),a(this,"_config",{}),a(this,"_logger",void 0),a(this,"_onNativeTimeUpdateHandlerThrottled",(0,o.default)(this._onNativeTimeUpdateHandler,2e3,{trailing:!1})),a(this,"_eventsMap",{[l.EVideoElementControllerBusEvent.TIME_UPDATE_NATIVE]:this._onNativeTimeUpdateHandlerThrottled,[l.EVideoElementControllerBusEvent.DESTROY]:this._destroy}),a(this,"_state",void 0),a(this,"_eventBus",void 0),this._state=e.state,this._eventBus=e.eventBus,this._logger=(0,s.Logger)(this._eventBus,"VideoElementController - TimeUpdateController"),this._props=e,this._logger.info("Created"),this._logger.debug("Initial state",e.state),this._logger.debug("Initial props",e)}setConfig(e){this._logger.debug("Config update received, the new one:",e);var t=e.timeoutUpdateStatusPlaying!==this._config.timeoutUpdateStatusPlaying;this._config=e,t&&(this._eventsMap[l.EVideoElementControllerBusEvent.TIME_UPDATE_NATIVE]=(0,o.default)(this._onNativeTimeUpdateHandler,e.timeoutUpdateStatusPlaying,{trailing:!1}),this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap}),this.init())}init(){this._logger.info("Initialization requested, attaching eventBus listeners"),this._eventBus.toggleSubscriptionBulk({action:"subscribe",callbacks:this._eventsMap})}startTimeUpdate(){this._stopTimeUpdate(),this._shouldSetNextUpdateVideoDurationId&&this._config?(this._updateVideoDurationId=setTimeout(this._onTimeUpdate,this._config.timeoutUpdateVideoDuration),this._publishUpdatePlayerResolutionIfNeeded()):this._shouldSetNextUpdateVideoDurationId=!0}_onNativeTimeUpdateHandler(e){var t,r;if(this._logger.debug("Native video timeUpdate caught"),null==e||null===(t=e.originalEvent)||void 0===t||!t.defaultPrevented){var n=this._props.getVideoElement(),{canPlay:i,isPlaying:o,isLoading:s,isRestarted:a}=this._state.getState();if(this._publishUpdatePlayerResolutionIfNeeded(),i){this._eventBus.publish(l.EVideoElementControllerBusEvent.RESET_CHECKING_AUTOPLAY_COUNT,{});var c=h!==(null==n?void 0:n.currentTime);this._logger.verbose("Video current time is ".concat(c?"":"not"," changed")),c?(this._eventBus.publish(l.EVideoElementControllerBusEvent.CANCEL_RESET_STREAM,{}),!u.BROWSER_CAPABILITIES.safari15OrHigher||a||null!==(r=localStorage)&&void 0!==r&&r.getItem(d)||(localStorage.setItem(d,"1"),this._eventBus.publish(l.EVideoElementControllerBusEvent.RESTART,{})),n&&(h=n.currentTime),o&&!s||this._eventBus.publish(l.EVideoElementControllerBusEvent.PLAYING,{})):s?this._eventBus.publish(l.EVideoElementControllerBusEvent.VIDEO_RESET,{}):this._eventBus.publish(l.EVideoElementControllerBusEvent.LOADING,{})}else this._logger.verbose("CanPlay shared state is false. Skipping")}}_stopTimeUpdate(){clearTimeout(this._updateVideoDurationId)}_onTimeUpdate(){if(this._state.getState().canPlay){var e=this._props.getVideoElement();e&&f!==e.currentTime&&(f=e.currentTime),this.startTimeUpdate()}else this.startTimeUpdate()}_publishUpdatePlayerResolutionIfNeeded(){var e=this._props.getVideoElement();if(e){var{videoWidth:t,videoHeight:r}=e,{videoElementResolution:n}=this._state.getState();if((!n||n.height!==r||n.width!==t)&&this._config.minimalPossibleVideoDimension&&Math.min(r,t)>this._config.minimalPossibleVideoDimension){var i=e.getBoundingClientRect();this._logger.verbose("Stored resolution is ".concat(null==n?void 0:n.width,"x").concat(null==n?void 0:n.height,", current is ").concat(t,"x").concat(r)),this._eventBus.publish(l.EVideoElementControllerBusEvent.UPDATE_PLAYER_RESOLUTION,{width:t,height:r,containerHeight:i.height,containerWidth:i.width})}}}_destroy(){this._logger.info("Destroying"),this._eventBus.toggleSubscriptionBulk({action:"unsubscribe",callbacks:this._eventsMap}),this._shouldSetNextUpdateVideoDurationId=!1,this._stopTimeUpdate()}}t.TimeUpdateController=p,n([c.bind],p.prototype,"init",null),n([c.bind],p.prototype,"startTimeUpdate",null),n([c.bind],p.prototype,"_onNativeTimeUpdateHandler",null),n([c.bind],p.prototype,"_stopTimeUpdate",null),n([c.bind],p.prototype,"_onTimeUpdate",null),n([c.bind],p.prototype,"_publishUpdatePlayerResolutionIfNeeded",null),n([c.bind],p.prototype,"_destroy",null)},9610:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(2383),i=r(3149),o=function(e){if(!(0,i.A)(e))return!1;var t=(0,n.A)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},9622:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseABRController=void 0;var n=r(3518);class i extends n.ConfigConsumer{constructor(e){super("abrControllerConfig",e)}}t.BaseABRController=i},9661:function(e,t,r){var n,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BROWSER_CAPABILITIES=void 0;var o=i(r(6880)),s=null!==globalThis&&void 0!==globalThis&&null!==(n=globalThis.navigator)&&void 0!==n&&n.userAgent?o.default.getParser(globalThis.navigator.userAgent):null,a=e=>s&&s.satisfies(e)||!1;t.BROWSER_CAPABILITIES={safari15OrHigher:a({safari:">=15"}),firefox:a({firefox:">0"}),safari:a({safari:">0"}),chrome:a({chrome:">0"}),edge:a({edge:">0"})}},9678:(e,t)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.EWatchDogEvent=void 0,function(e){e.ALIVE_PLAYER="alivePlayer",e.ANOTHER_ACTIVE_PLAYER="anotherActivePlayer"}(r||(t.EWatchDogEvent=r={}))},9699:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FakeAudioTrack=void 0;var n=r(4780);t.FakeAudioTrack=class{constructor(){a(this,"_audioContext",null),a(this,"_audioStream",null),a(this,"_oscillator",null),a(this,"_dest",null)}get fakeTrack(){var e;return this._audioStream||this._initFakeStream(),this._statPlaying(),null===(e=this._audioStream)||void 0===e?void 0:e.getAudioTracks()[0]}stopFakeStream(){var e,t;this._audioStream&&(null!==(e=this._oscillator)&&void 0!==e&&e.stop(),this._oscillator=null,(0,n.stopStream)(this._audioStream),this._audioStream=null,null!==(t=this._audioContext)&&void 0!==t&&t.close(),this._audioContext=null)}_statPlaying(){var e,t=null===(e=this._audioContext)||void 0===e?void 0:e.createOscillator();this._dest&&(null!=t&&t.connect(this._dest),null==t||t.start())}_initFakeStream(){this._audioStream&&this.stopFakeStream(),this._audioContext=new AudioContext,this._dest=this._audioContext.createMediaStreamDestination(),this._audioStream=this._dest.stream}}},9710:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isClassTampered=o,t.checkMediaApiTampering=function(){var{MediaStream:e,MediaSource:t}=function(){try{var t=window,r=t.ManagedMediaSource||t.MediaSource,n=t.MediaStream;return{MediaStream:"function"==typeof n?n:void 0,MediaSource:"function"==typeof r?r:void 0}}catch(e){return{}}}(),{MediaStream:r,MediaSource:i}=function(){try{var t=document.createElement("iframe");t.style.display="none",t.style.position="absolute",t.style.left="-9999px",document.documentElement.appendChild(t);var r=t.contentWindow;if(!r)return t.remove(),{};var n=r,i={};"function"==typeof n.MediaStream&&(i.MediaStream=n.MediaStream);var o=n.ManagedMediaSource||n.MediaSource;return"function"==typeof o&&(i.MediaSource=o),t.remove(),i}catch(e){return{}}}(),s=n("MediaStream",e,r),a=n("MediaSource",t,i);return{MediaStream:s,MediaSource:a,hasTampering:o(s)||o(a)}};var r={MediaStream:["addTrack","removeTrack","getTracks","getVideoTracks","getAudioTracks","clone"],MediaSource:["addSourceBuffer","removeSourceBuffer","endOfStream","setLiveSeekableRange","clearLiveSeekableRange"]};function n(e,t,n){var o=Boolean(t),s=Boolean(n),a=!!o&&function(e){try{if("function"!=typeof e)return!1;var t=Function.prototype.toString.call(e);return/\[native code\]/.test(t)}catch(e){return!1}}(t);if(o&&s){var l=function(e,t,r){var n=[],i=[],o=[],s=Function.prototype.toString;try{var a=Object.getOwnPropertyNames(e.prototype),l=Object.getOwnPropertyNames(t.prototype),u=new Set(a),c=new Set(l);for(var d of a)c.has(d)||i.push(d);for(var h of l)u.has(h)||o.push(h);var f=r.filter(e=>!o.includes(e));for(var p of f){var v=e.prototype[p],g=t.prototype[p];v&&g?s.call(v)!==s.call(g)&&n.push(p):n.push(p)}return{methodsMatch:0===n.length&&0===i.length&&0===o.length,differentMethods:n,addedMethods:i,removedMethods:o}}catch(e){return{methodsMatch:!1,differentMethods:[],addedMethods:[],removedMethods:[]}}}(t,n,r[e]);return i(i({},l),{},{hasCleanConstructor:s,hasConstructorInWindow:o,isNative:a})}return{methodsMatch:!0,differentMethods:[],addedMethods:[],removedMethods:[],hasCleanConstructor:s,hasConstructorInWindow:o,isNative:a}}function o(e){return e.hasConstructorInWindow&&(!e.methodsMatch||!e.isNative)}},9715:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FALLBACK_KEY_QUERY_PARAMS=void 0,t.FALLBACK_KEY_QUERY_PARAMS={psch:"v1",pkey:"Iecohquahc5RieQu;ios"}},9840:e=>{var t;t="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},e.exports=t},9857:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(124),i=r(1917),o=(0,n.A)(i.A,"Set")},9858:(e,t,r)=>{r.d(t,{LineStream:()=>l,ParseStream:()=>f,Parser:()=>g}),r.r(t);var n=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var r=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(r,1),r>-1},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var r=t.length,n=0;n<r;++n)t[n].call(this,arguments[1]);else for(var i=Array.prototype.slice.call(arguments,1),o=t.length,s=0;s<o;++s)t[s].apply(this,i)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",function(t){e.push(t)})},e}();function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(null,arguments)}var o=r(9840),s=r.n(o);function a(e){for(var t,r=(t=e,s().atob?s().atob(t):Buffer.from(t,"base64").toString("binary")),n=new Uint8Array(r.length),i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}class l extends n{constructor(){super(),this.buffer=""}push(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}var u=String.fromCharCode(9),c=function(e){var t=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),r={};return t[1]&&(r.length=parseInt(t[1],10)),t[2]&&(r.offset=parseInt(t[2],10)),r},d=function(e){var t={};if(!e)return t;for(var r,n=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),i=n.length;i--;)""!==n[i]&&((r=/([^=]*)=(.*)/.exec(n[i]).slice(1))[0]=r[0].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1"),t[r[0]]=r[1]);return t},h=e=>{var t=e.split("x"),r={};return t[0]&&(r.width=parseInt(t[0],10)),t[1]&&(r.height=parseInt(t[1],10)),r};class f extends n{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){var t,r;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce((t,r)=>{var n=r(e);return n===e?t:t.concat([n])},[e]).forEach(e=>{for(var n=0;n<this.customParsers.length;n++)if(this.customParsers[n].call(this,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))this.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(e))return r={type:"tag",tagType:"inf"},t[1]&&(r.duration=parseFloat(t[1])),t[2]&&(r.title=t[2]),void this.trigger("data",r);if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(e))return r={type:"tag",tagType:"targetduration"},t[1]&&(r.duration=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(e))return r={type:"tag",tagType:"version"},t[1]&&(r.version=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(e))return r={type:"tag",tagType:"media-sequence"},t[1]&&(r.number=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(e))return r={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(r.number=parseInt(t[1],10)),void this.trigger("data",r);if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(e))return r={type:"tag",tagType:"playlist-type"},t[1]&&(r.playlistType=t[1]),void this.trigger("data",r);if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(e))return r=i(c(t[1]),{type:"tag",tagType:"byterange"}),void this.trigger("data",r);if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(e))return r={type:"tag",tagType:"allow-cache"},t[1]&&(r.allowed=!/NO/.test(t[1])),void this.trigger("data",r);if(t=/^#EXT-X-MAP:(.*)$/.exec(e)){if(r={type:"tag",tagType:"map"},t[1]){var o=d(t[1]);o.URI&&(r.uri=o.URI),o.BYTERANGE&&(r.byterange=c(o.BYTERANGE))}this.trigger("data",r)}else{if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(e))return r={type:"tag",tagType:"stream-inf"},t[1]&&(r.attributes=d(t[1]),r.attributes.RESOLUTION&&(r.attributes.RESOLUTION=h(r.attributes.RESOLUTION)),r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),r.attributes["PROGRAM-ID"]&&(r.attributes["PROGRAM-ID"]=parseInt(r.attributes["PROGRAM-ID"],10))),void this.trigger("data",r);if(t=/^#EXT-X-MEDIA:(.*)$/.exec(e))return r={type:"tag",tagType:"media"},t[1]&&(r.attributes=d(t[1])),void this.trigger("data",r);if(t=/^#EXT-X-ENDLIST/.exec(e))this.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))this.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(e))return r={type:"tag",tagType:"program-date-time"},t[1]&&(r.dateTimeString=t[1],r.dateTimeObject=new Date(t[1])),void this.trigger("data",r);if(t=/^#EXT-X-KEY:(.*)$/.exec(e))return r={type:"tag",tagType:"key"},t[1]&&(r.attributes=d(t[1]),r.attributes.IV&&("0x"===r.attributes.IV.substring(0,2).toLowerCase()&&(r.attributes.IV=r.attributes.IV.substring(2)),r.attributes.IV=r.attributes.IV.match(/.{8}/g),r.attributes.IV[0]=parseInt(r.attributes.IV[0],16),r.attributes.IV[1]=parseInt(r.attributes.IV[1],16),r.attributes.IV[2]=parseInt(r.attributes.IV[2],16),r.attributes.IV[3]=parseInt(r.attributes.IV[3],16),r.attributes.IV=new Uint32Array(r.attributes.IV))),void this.trigger("data",r);if(t=/^#EXT-X-START:(.*)$/.exec(e))return r={type:"tag",tagType:"start"},t[1]&&(r.attributes=d(t[1]),r.attributes["TIME-OFFSET"]=parseFloat(r.attributes["TIME-OFFSET"]),r.attributes.PRECISE=/YES/.test(r.attributes.PRECISE)),void this.trigger("data",r);if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(e))return r={type:"tag",tagType:"cue-out-cont"},t[1]?r.data=t[1]:r.data="",void this.trigger("data",r);if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(e))return r={type:"tag",tagType:"cue-out"},t[1]?r.data=t[1]:r.data="",void this.trigger("data",r);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return r={type:"tag",tagType:"cue-in"},t[1]?r.data=t[1]:r.data="",void this.trigger("data",r);if((t=/^#EXT-X-SKIP:(.*)$/.exec(e))&&t[1])return(r={type:"tag",tagType:"skip"}).attributes=d(t[1]),r.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(r.attributes["SKIPPED-SEGMENTS"]=parseInt(r.attributes["SKIPPED-SEGMENTS"],10)),r.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(r.attributes["RECENTLY-REMOVED-DATERANGES"]=r.attributes["RECENTLY-REMOVED-DATERANGES"].split(u)),void this.trigger("data",r);if((t=/^#EXT-X-PART:(.*)$/.exec(e))&&t[1])return(r={type:"tag",tagType:"part"}).attributes=d(t[1]),["DURATION"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseFloat(r.attributes[e]))}),["INDEPENDENT","GAP"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=/YES/.test(r.attributes[e]))}),r.attributes.hasOwnProperty("BYTERANGE")&&(r.attributes.byterange=c(r.attributes.BYTERANGE)),void this.trigger("data",r);if((t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e))&&t[1])return(r={type:"tag",tagType:"server-control"}).attributes=d(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseFloat(r.attributes[e]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=/YES/.test(r.attributes[e]))}),void this.trigger("data",r);if((t=/^#EXT-X-PART-INF:(.*)$/.exec(e))&&t[1])return(r={type:"tag",tagType:"part-inf"}).attributes=d(t[1]),["PART-TARGET"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseFloat(r.attributes[e]))}),void this.trigger("data",r);if((t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e))&&t[1])return(r={type:"tag",tagType:"preload-hint"}).attributes=d(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(e){if(r.attributes.hasOwnProperty(e)){r.attributes[e]=parseInt(r.attributes[e],10);var t="BYTERANGE-LENGTH"===e?"length":"offset";r.attributes.byterange=r.attributes.byterange||{},r.attributes.byterange[t]=r.attributes[e],delete r.attributes[e]}}),void this.trigger("data",r);if((t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e))&&t[1])return(r={type:"tag",tagType:"rendition-report"}).attributes=d(t[1]),["LAST-MSN","LAST-PART"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseInt(r.attributes[e],10))}),void this.trigger("data",r);if((t=/^#EXT-X-DATERANGE:(.*)$/.exec(e))&&t[1]){(r={type:"tag",tagType:"daterange"}).attributes=d(t[1]),["ID","CLASS"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=String(r.attributes[e]))}),["START-DATE","END-DATE"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=new Date(r.attributes[e]))}),["DURATION","PLANNED-DURATION"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=parseFloat(r.attributes[e]))}),["END-ON-NEXT"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=/YES/i.test(r.attributes[e]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(e){r.attributes.hasOwnProperty(e)&&(r.attributes[e]=r.attributes[e].toString(16))});var s=/^X-([A-Z]+-)+[A-Z]+$/;for(var a in r.attributes)if(s.test(a)){var l=/[0-9A-Fa-f]{6}/g.test(r.attributes[a]),f=/^\d+(\.\d+)?$/.test(r.attributes[a]);r.attributes[a]=l?r.attributes[a].toString(16):f?parseFloat(r.attributes[a]):String(r.attributes[a])}return void this.trigger("data",r)}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(e))this.trigger("data",{type:"tag",tagType:"independent-segments"});else if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(e))this.trigger("data",{type:"tag",tagType:"i-frames-only"});else{if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(e))return(r={type:"tag",tagType:"content-steering"}).attributes=d(t[1]),void this.trigger("data",r);if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(e))return(r={type:"tag",tagType:"i-frame-playlist"}).attributes=d(t[1]),r.attributes.URI&&(r.uri=r.attributes.URI),r.attributes.BANDWIDTH&&(r.attributes.BANDWIDTH=parseInt(r.attributes.BANDWIDTH,10)),r.attributes.RESOLUTION&&(r.attributes.RESOLUTION=h(r.attributes.RESOLUTION)),r.attributes["AVERAGE-BANDWIDTH"]&&(r.attributes["AVERAGE-BANDWIDTH"]=parseInt(r.attributes["AVERAGE-BANDWIDTH"],10)),r.attributes["FRAME-RATE"]&&(r.attributes["FRAME-RATE"]=parseFloat(r.attributes["FRAME-RATE"])),void this.trigger("data",r);if(t=/^#EXT-X-DEFINE:(.*)$/.exec(e))return(r={type:"tag",tagType:"define"}).attributes=d(t[1]),void this.trigger("data",r);this.trigger("data",{type:"tag",data:e.slice(4)})}}}}else this.trigger("data",{type:"comment",text:e.slice(1)})}):this.trigger("data",{type:"uri",uri:e}))}addParser(e){var{expression:t,customType:r,dataParser:n,segment:i}=e;"function"!=typeof n&&(n=e=>e),this.customParsers.push(e=>{if(t.exec(e))return this.trigger("data",{type:"custom",data:n(e),customType:r,segment:i}),!0})}addTagMapper(e){var{expression:t,map:r}=e;this.tagMappers.push(e=>t.test(e)?r(e):e)}}var p=function(e){var t={};return Object.keys(e).forEach(function(r){var n;t[(n=r,n.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()))]=e[r]}),t},v=function(e){var{serverControl:t,targetDuration:r,partTargetDuration:n}=e;if(t){var i="#EXT-X-SERVER-CONTROL",o="holdBack",s="partHoldBack",a=r&&3*r,l=n&&2*n;r&&!t.hasOwnProperty(o)&&(t[o]=a,this.trigger("info",{message:"".concat(i," defaulting HOLD-BACK to targetDuration * 3 (").concat(a,").")})),a&&t[o]<a&&(this.trigger("warn",{message:"".concat(i," clamping HOLD-BACK (").concat(t[o],") to targetDuration * 3 (").concat(a,")")}),t[o]=a),n&&!t.hasOwnProperty(s)&&(t[s]=3*n,this.trigger("info",{message:"".concat(i," defaulting PART-HOLD-BACK to partTargetDuration * 3 (").concat(t[s],").")})),n&&t[s]<l&&(this.trigger("warn",{message:"".concat(i," clamping PART-HOLD-BACK (").concat(t[s],") to partTargetDuration * 2 (").concat(l,").")}),t[s]=l)}};class g extends n{constructor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.lineStream=new l,this.parseStream=new f,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;var t,r,n=this,o=[],s={},u=!1,c=function(){},d={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},h=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};var g=0,_=0,m={};this.on("end",()=>{s.uri||!s.parts&&!s.preloadHints||(!s.map&&t&&(s.map=t),!s.key&&r&&(s.key=r),s.timeline||"number"!=typeof h||(s.timeline=h),this.manifest.preloadSegment=s)}),this.parseStream.on("data",function(e){var l,f;if(n.manifest.definitions)for(var y in n.manifest.definitions)if(e.uri&&(e.uri=e.uri.replace("{$".concat(y,"}"),n.manifest.definitions[y])),e.attributes)for(var b in e.attributes)"string"==typeof e.attributes[b]&&(e.attributes[b]=e.attributes[b].replace("{$".concat(y,"}"),n.manifest.definitions[y]));({tag(){({version(){e.version&&(this.manifest.version=e.version)},"allow-cache"(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){var t={};"length"in e&&(s.byterange=t,t.length=e.length,"offset"in e||(e.offset=g)),"offset"in e&&(s.byterange=t,t.offset=e.offset),g=t.offset+t.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.title&&(s.title=e.title),e.duration>0&&(s.duration=e.duration),0===e.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=o},key(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("com.apple.streamingkeydelivery"===e.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:e.attributes});if("com.microsoft.playready"===e.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.microsoft.playready"]={uri:e.attributes.URI});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT)return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:a(e.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}));e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),r={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(r.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else r=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence"(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence"(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,h=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type"(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map(){t={},e.uri&&(t.uri=e.uri),e.byterange&&(t.byterange=e.byterange),r&&(t.key=r)},"stream-inf"(){this.manifest.playlists=o,this.manifest.mediaGroups=this.manifest.mediaGroups||d,e.attributes?(s.attributes||(s.attributes={}),i(s.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||d,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var t=this.manifest.mediaGroups[e.attributes.TYPE];t[e.attributes["GROUP-ID"]]=t[e.attributes["GROUP-ID"]]||{},l=t[e.attributes["GROUP-ID"]],(f={default:/yes/i.test(e.attributes.DEFAULT)}).default?f.autoselect=!0:f.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(f.language=e.attributes.LANGUAGE),e.attributes.URI&&(f.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(f.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(f.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(f.forced=/yes/i.test(e.attributes.FORCED)),l[e.attributes.NAME]=f}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity(){h+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(o.length)},"program-date-time"(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),s.dateTimeString=e.dateTimeString,s.dateTimeObject=e.dateTimeObject;var{lastProgramDateTime:t}=this;this.lastProgramDateTime=new Date(e.dateTimeString).getTime(),null===t&&this.manifest.segments.reduceRight((e,t)=>(t.programDateTime=e-1e3*t.duration,t.programDateTime),this.lastProgramDateTime)},targetduration(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):(this.manifest.targetDuration=e.duration,v.call(this,this.manifest))},start(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out"(){s.cueOut=e.data},"cue-out-cont"(){s.cueOutCont=e.data},"cue-in"(){s.cueIn=e.data},skip(){this.manifest.skip=p(e.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",e.attributes,["SKIPPED-SEGMENTS"])},part(){u=!0;var t=this.manifest.segments.length,r=p(e.attributes);s.parts=s.parts||[],s.parts.push(r),r.byterange&&(r.byterange.hasOwnProperty("offset")||(r.byterange.offset=_),_=r.byterange.offset+r.byterange.length);var n=s.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #".concat(n," for segment #").concat(t),e.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((e,t)=>{e.hasOwnProperty("lastPart")||this.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #".concat(t," lacks required attribute(s): LAST-PART")})})},"server-control"(){var t=this.manifest.serverControl=p(e.attributes);t.hasOwnProperty("canBlockReload")||(t.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),v.call(this,this.manifest),t.canSkipDateranges&&!t.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){var t=this.manifest.segments.length,r=p(e.attributes),n=r.type&&"PART"===r.type;s.preloadHints=s.preloadHints||[],s.preloadHints.push(r),r.byterange&&(r.byterange.hasOwnProperty("offset")||(r.byterange.offset=n?_:0,n&&(_=r.byterange.offset+r.byterange.length)));var i=s.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #".concat(i," for segment #").concat(t),e.attributes,["TYPE","URI"]),r.type)for(var o=0;o<s.preloadHints.length-1;o++){var a=s.preloadHints[o];a.type&&a.type===r.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #".concat(i," for segment #").concat(t," has the same TYPE ").concat(r.type," as preload hint #").concat(o)})}},"rendition-report"(){var t=p(e.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(t);var r=this.manifest.renditionReports.length-1,n=["LAST-MSN","URI"];u&&n.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #".concat(r),e.attributes,n)},"part-inf"(){this.manifest.partInf=p(e.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",e.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),v.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(p(e.attributes));var t=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_("#EXT-X-DATERANGE #".concat(t),e.attributes,["ID","START-DATE"]);var r=this.manifest.dateRanges[t];r.endDate&&r.startDate&&new Date(r.endDate)<new Date(r.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),r.duration&&r.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),r.plannedDuration&&r.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});var n=!!r.endOnNext;if(n&&!r.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),n&&(r.duration||r.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),r.duration&&r.endDate){var o=r.startDate.getTime()+1e3*r.duration;this.manifest.dateRanges[t].endDate=new Date(o)}if(m[r.id]){for(var s in m[r.id])if(r[s]&&JSON.stringify(m[r.id][s])!==JSON.stringify(r[s])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}var a=this.manifest.dateRanges.findIndex(e=>e.id===r.id);this.manifest.dateRanges[a]=i(this.manifest.dateRanges[a],r),m[r.id]=i(m[r.id],r),this.manifest.dateRanges.pop()}else m[r.id]=r},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=p(e.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",e.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};var t=(e,t)=>{e in this.manifest.definitions?this.trigger("error",{message:"EXT-X-DEFINE: Duplicate name ".concat(e)}):this.manifest.definitions[e]=t};if("QUERYPARAM"in e.attributes){if("NAME"in e.attributes||"IMPORT"in e.attributes)return void this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});var r=this.params.get(e.attributes.QUERYPARAM);return r?void t(e.attributes.QUERYPARAM,decodeURIComponent(r)):void this.trigger("error",{message:"EXT-X-DEFINE: No query param ".concat(e.attributes.QUERYPARAM)})}return"NAME"in e.attributes?"IMPORT"in e.attributes?void this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"}):"VALUE"in e.attributes&&"string"==typeof e.attributes.VALUE?void t(e.attributes.NAME,e.attributes.VALUE):void this.trigger("error",{message:"EXT-X-DEFINE: No value for ".concat(e.attributes.NAME)}):"IMPORT"in e.attributes?this.mainDefinitions[e.attributes.IMPORT]?void t(e.attributes.IMPORT,this.mainDefinitions[e.attributes.IMPORT]):void this.trigger("error",{message:"EXT-X-DEFINE: No value ".concat(e.attributes.IMPORT," to import, or IMPORT used on main playlist")}):void this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:e.attributes,uri:e.uri,timeline:h}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",e.attributes,["BANDWIDTH","URI"])}}[e.tagType]||c).call(n)},uri(){s.uri=e.uri,o.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),r&&(s.key=r),s.timeline=h,t&&(s.map=t),_=0,null!==this.lastProgramDateTime&&(s.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=1e3*s.duration),s={}},comment(){},custom(){e.segment?(s.custom=s.custom||{},s.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(n)})}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:"manifest must be at least version ".concat(t)})}warnOnMissingAttributes_(e,t,r){var n=[];r.forEach(function(e){t.hasOwnProperty(e)||n.push(e)}),n.length&&this.trigger("warn",{message:"".concat(e," lacks required attribute(s): ").concat(n.join(", "))})}push(e){this.lineStream.push(e)}end(){this.lineStream.push("\n"),this.manifest.dateRanges.length&&null===this.lastProgramDateTime&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}},9893:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_LOG_LEVELS=t.availableConfigValues=t.defaultConfig=void 0;var n=r(1902),i=r(4859),o=r(9243),s=r(2750),a=r(9024),l=r(5030),u=r(872),c=r(3050),d=r(452),h=r(3601),f=r(7216),p=r(5264),v=r(1370),g=r(2464),_=r(4480),m=r(7485),y=r(6982),b=r(7590),E=r(9519),S=r(786),T=r(4266),C=r(5238),A=r(8342);t.defaultConfig={playlistLoader:S.defaultBasePlaylistRotationControllerConfig,fragmentLoader:T.defaultFragmentLoaderConfig,resolutionsManager:E.defaultResolutionManagerConfig,bufferController:d.defaultBufferControllerConfig,throughputHistory:o.defaultThroughputHistoryConfig,abr:n.defaultAbrControllerConfig,switchHistory:i.defaultSwitchHistoryConfig,throughputEstimator:c.defaultThroughputEstimatorConfig,droppedFramesEstimator:a.defaultDroppedFramesEstimatorConfig,fragmentParser:y.defaultFragmentParserConfig,debugger:C.defaultDebuggerConfig,insufficientBufferEstimator:l.defaultInsufficientBufferEstimatorConfig,minimalBufferToIncreaseEstimator:u.defaultMinimalBufferToIncreaseEstimatorConfig,deltaBufferEstimator:s.defaultDeltaBufferEstimatorConfig,playbackStateController:m.defaultPlaybackStateControllerConfig,targetBufferIncreaser:_.defaultTargetBufferIncreaserConfig,targetBufferDecreaser:g.defaultTargetBufferDecreaserConfig,originalTargetBufferDecreaser:f.defaultOriginalTargetBufferDecreaserConfig,playbackSpeedActuator:p.defaultPlaybackSpeedActuatorConfig,playbackSpeedWatcher:v.defaultPlaybackSpeedWatcherConfig,bufferStallsDetector:h.defaultBufferStallsDetectorConfig,fragmentsFilter:b.defaultFragmentsFilterConfig,fragmentBuffer:A.defaultFragmentsBufferConfig},t.availableConfigValues={playlistLoader:S.availableBasePlaylistRotationControllerConfigValues,fragmentLoader:T.availableFragmentLoaderConfigValues,resolutionsManager:E.availableResolutionManagerConfigValues,bufferController:d.availableBufferControllerConfigValues,throughputHistory:o.availableThroughputHistoryConfigValues,abr:n.availableAbrControllerConfigValues,switchHistory:i.availableSwitchHistoryConfigValues,throughputEstimator:c.availableThroughputEstimatorValues,droppedFramesEstimator:a.availableDroppedFramesEstimatorConfigValues,fragmentParser:y.availableFragmentParserConfigValues,debugger:C.availableDebuggerConfigValues,insufficientBufferEstimator:l.availableInsufficientBufferEstimatorConfigValues,minimalBufferToIncreaseEstimator:u.availableMinimalBufferToIncreaseEstimatorConfigValues,deltaBufferEstimator:s.availableDeltaBufferEstimatorConfigValues,playbackStateController:m.availablePlaybackStateControllerConfig,targetBufferIncreaser:_.availableTargetBufferIncreaserConfigValues,targetBufferDecreaser:g.availableTargetBufferDecreaserConfigValues,originalTargetBufferDecreaser:f.availableOriginalTargetBufferDecreaserConfigValues,playbackSpeedActuator:p.availablePlaybackSpeedActuatorConfigValues,playbackSpeedWatcher:v.availablePlaybackSpeedWatcherConfigValues,bufferStallsDetector:h.availableBufferStallsDetectorConfigValues,fragmentsFilter:b.availableFragmentsFilterConfigValues,fragmentBuffer:A.availableFragmentsBufferConfigValues},t.DEFAULT_LOG_LEVELS=["error","fatal"]},9922:function(e,t,r){var n=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FragmentsQueue=void 0;var s=r(355),l=r(8474),u=r(835),c=r(2513),d=r(6701),h=r(180),f=o(r(6073)),p=r(8083),v=r(363);class g{constructor(e){a(this,"_eventBus",void 0),a(this,"state",h.EDebuggableModuleState.OK),a(this,"status","Idle"),a(this,"groups",["queue"]),a(this,"_queuedFragments",[]),a(this,"_additionalInfo",{}),a(this,"_fragmentRequestedListenerToken",void 0),a(this,"_fragmentLoadedListenerToken",void 0),a(this,"_fragmentAbortedListenerToken",void 0),a(this,"_fragmentErrorListenerToken",void 0),a(this,"_softResetRequestedListenerToken",void 0),a(this,"_onFragmentsDetectedListenerToken",void 0),a(this,"_onFragmentReleaseFromCacheRequestedToken",void 0),a(this,"_onResolutionChangedListenerToken",void 0),a(this,"_logger",void 0),this._eventBus=e,this._logger=(0,l.Logger)(this._eventBus,"Doppio - FragmentsQueue"),this._fragmentRequestedListenerToken=this._eventBus.subscribe(d.StreamLoaderModuleEvents.fragmentLoader.fragments.fragmentLoadingStarted,this._onFragmentRequested),this._onFragmentsDetectedListenerToken=this._eventBus.subscribe(c.BasePlaylistRotationControllerEvents.fragments.fragmentsDetected,this._onFragmentsDetected),this._softResetRequestedListenerToken=this._eventBus.subscribe(s.BufferControllerEvents.requestResetWithOverplay,this._onSoftResetRequested),this._fragmentLoadedListenerToken=this._eventBus.subscribe(d.StreamLoaderModuleEvents.fragmentLoader.fragments.fragmentLoaded,this._onFragmentLoaded),this._fragmentAbortedListenerToken=this._eventBus.subscribe(d.StreamLoaderModuleEvents.fragmentLoader.fragments.fragmentLoadingAborted,this._onFragmentAborted),this._fragmentErrorListenerToken=this._eventBus.subscribe(d.StreamLoaderModuleEvents.fragmentLoader.fragments.fragmentLoadingError,this._onFragmentAborted),this._onFragmentReleaseFromCacheRequestedToken=this._eventBus.subscribe(c.BasePlaylistRotationControllerEvents.fragments.requestReleaseFromCache,this._onFragmentReleasedFromCache),this._onResolutionChangedListenerToken=this._eventBus.subscribe(u.ResolutionsManagerEvents.resolutionChanged,this._onSoftResetRequested)}getCurrentQueue(){return this._queuedFragments}destroy(){this._eventBus.unsubscribe(this._onFragmentsDetectedListenerToken),this._eventBus.unsubscribe(this._fragmentLoadedListenerToken),this._eventBus.unsubscribe(this._fragmentRequestedListenerToken),this._eventBus.unsubscribe(this._softResetRequestedListenerToken),this._eventBus.unsubscribe(this._onResolutionChangedListenerToken),this._eventBus.unsubscribe(this._fragmentErrorListenerToken),this._eventBus.unsubscribe(this._fragmentAbortedListenerToken),this._eventBus.unsubscribe(this._onFragmentReleaseFromCacheRequestedToken),this.reset()}reset(){this._queuedFragments=[],this.status="Idle"}_onSoftResetRequested(){this.reset()}_onFragmentRequested(e){this._queuedFragments.find(t=>{var{url:r}=t;return e.url===r})?this._logger.warn("Same fragment (".concat(e.getMsnPn(),") was already in queue! Ignoring it")):(this._logger.verbose("Add fragment ".concat(e.getMsnPn()," to queue")),e.goToLifecycleStage("addedToQueue"),this._queuedFragments.push(e),this._queuedFragments.sort((e,t)=>e.msn-t.msn||e.pn-t.pn),this.status="Awaiting fragments")}_onFragmentLoaded(e){var t=this._queuedFragments.find(t=>{var{msn:r,pn:n}=t;return r===e.msn&&n===e.pn});t?(this._logger.debug("Fragment ".concat(e.getMsnPn()," was resolved finally")),t.data=e.data,this._checkQueue()):this._logger.warn("Received fragment ".concat(e.getMsnPn()," was not in queue. Pls check it"))}_onFragmentReleasedFromCache(e){var{msn:t}=e;this._queuedFragments=this._queuedFragments.filter(e=>e.msn===t),this._checkQueue()}_onFragmentsDetected(e){e.forEach(e=>{var t=this._queuedFragments.find(t=>{var{msn:r,pn:n}=t;return r===e.msn&&n===e.pn});t&&(t.independent=e.independent)}),this._checkQueue()}_onFragmentAborted(e){if(!e.isInitSection){var t=this._queuedFragments.filter(t=>{var{msn:r}=t;return r<=e.msn});this._queuedFragments=this._queuedFragments.filter(e=>!t.includes(e)),this._checkQueue()}}_checkQueue(){if(this._logger.verbose("Checking queue"),this._queuedFragments.length)if(this._queuedFragments[0].data&&this._queuedFragments[0].independent!==v.EIndependenceType.UNKNOWN){var e=this._queuedFragments.findIndex(e=>!e.data||e.independent===v.EIndependenceType.UNKNOWN);if(-1===e)return this._logger.verbose("Looks like whole queue was resolved"),void this._releaseFragmentsFromQueue(this._queuedFragments);this._logger.verbose("".concat(e," fragments ready. Releasing them"));var t=this._queuedFragments.slice(0,e);this._releaseFragmentsFromQueue(t)}else this._logger.verbose("First queued fragment is empty. Skipping");else this._logger.verbose("Queue is empty. Skipping")}_releaseFragmentsFromQueue(e){this._logger.verbose("Release fragment  ".concat(e.map(e=>e.getMsnPn()),"from queue")),e.forEach(e=>e.goToLifecycleStage("releasedFromQueue")),this._queuedFragments=this._queuedFragments.filter(t=>!e.includes(t)),this._eventBus.publish(p.FragmentsQueueEvents.fragmentsReleased,e),this.status=this._queuedFragments.length>0?this.status:"Idle"}get additionalInfo(){return i(i({},this._additionalInfo),{},{awaitingFragments:this.getCurrentQueue().map(e=>i(i({},e),{},{data:void 0}))})}}t.FragmentsQueue=g,n([f.default],g.prototype,"_onSoftResetRequested",null),n([f.default],g.prototype,"_onFragmentRequested",null),n([f.default],g.prototype,"_onFragmentLoaded",null),n([f.default],g.prototype,"_onFragmentReleasedFromCache",null),n([f.default],g.prototype,"_onFragmentsDetected",null),n([f.default],g.prototype,"_onFragmentAborted",null),n([f.default],g.prototype,"_releaseFragmentsFromQueue",null)},9932:function(e,t,r){var n,o=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),u=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s},c=this&&this.__importStar||(n=function(e){return n=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},n(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r=n(e),i=0;i<r.length;i++)"default"!==r[i]&&o(t,e,r[i]);return l(t,e),t});Object.defineProperty(t,"__esModule",{value:!0}),t.RistrettoBroadcastWrapper=void 0;var d=r(2502),h=r(3362),f=r(5307),p=r(6805),v=r(6805),g={framesEncoded:{originalPath:"outbound-rtp:video.framesEncoded",modifier:"delta",reducer:"sum",filter:"number"},framesSent:{originalPath:"outbound-rtp:video.framesSent",modifier:"delta",reducer:"sum",filter:"number"}},_=Object.keys(g);class m extends d.AbstractWrapper{constructor(e){super(e),a(this,"_logLevels",[]),a(this,"_isLoadingPlayerModule",!1),a(this,"_ristrettoModuleCache",null),a(this,"_isBroadcastSupportedByBrowser",null),a(this,"_ristrettoPlaybackStateToMMPStateMap",null)}setStreamConfig(e){return this._lastKnownStreamConfig={WebRTCStreamId:null==e?void 0:e.WebRTCStreamId,WebRTCPublishCustomData:null==e?void 0:e.WebRTCPublishCustomData,WebRTCACLToken:null==e?void 0:e.WebRTCACLToken,WebRTCSignallingUrl:null==e?void 0:e.WebRTCSignallingUrl,MediaStream:null==e?void 0:e.MediaStream,ProbingCacheKey:null==e?void 0:e.ProbingCacheKey},this._setStreamConfig(),this}setRegularBroadcastStopReason(e){var t,r;null===(t=this._playerInstance)||void 0===t||null===(r=t.setRegularBroadcastStopReason)||void 0===r||r.call(t,e)}setAbrResolutions(){return this}enableAbr(){return this}disableAbr(){return this}setResolutionByName(e){throw new Error("Cannot change resolution to ".concat(e," for broadcaster, this action is not defined"))}setResolutionByBitrate(){throw new Error("Cannot change resolution bitrate for broadcaster, this action is not defined")}setLoggerLevel(e){var t;null!==(t=this._playerInstance)&&void 0!==t&&t.setLoggerLevels(e),this._logLevels=e}setResolutionLimits(){return this}get version(){var e;return null===(e=this._playerInstance)||void 0===e?void 0:e.version}_attachEventListeners(){this._playerInstance&&this._ristrettoModuleCache&&(this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.DEBUGGER_CONNECTED,this._onDebuggerConnected),this._playerInstance.addEventListener(this._ristrettoModuleCache.EBroadcasterEvent.BROADCAST_STATE_CHANGED,this._onBroadcastStateChanged),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.ERROR,this._onRistrettoError),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.LIFECYCLE_EVENT,this._onLifecycleEventReported),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.LIFECYCLE_ERROR,this._onLifecycleErrorReported),this._playerInstance.addEventListener(this._ristrettoModuleCache.ECommonEvents.PEER_METRICS_AVAILABLE,this._onPeerMetricsAvailable))}_detachEventListeners(){this._playerInstance&&this._ristrettoModuleCache&&(this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.DEBUGGER_CONNECTED,this._onDebuggerConnected),this._playerInstance.removeEventListener(this._ristrettoModuleCache.EBroadcasterEvent.BROADCAST_STATE_CHANGED,this._onBroadcastStateChanged),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.ERROR,this._onRistrettoError),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.LIFECYCLE_EVENT,this._onLifecycleEventReported),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.LIFECYCLE_ERROR,this._onLifecycleErrorReported),this._playerInstance.removeEventListener(this._ristrettoModuleCache.ECommonEvents.PEER_METRICS_AVAILABLE,this._onPeerMetricsAvailable))}_loadRistrettoModule(){var e=this;return s(function*(){if(!e._isLoadingPlayerModule){e._isLoadingPlayerModule=!0;var{Broadcaster:t,ECommonEvents:n,EStreamStatus:i,EPlayerEvent:o,EBroadcasterEvent:s,EBroadcastStatus:a}=yield Promise.resolve().then(()=>c(r(5544)));e._ristrettoModuleCache={Broadcaster:t,ECommonEvents:n,EStreamStatus:i,EPlayerEvent:o,EBroadcasterEvent:s,EBroadcastStatus:a},e._ristrettoPlaybackStateToMMPStateMap={[a.UNKNOWN]:p.EPlaybackState.IDLE,[a.CONNECTING]:p.EPlaybackState.LOADING,[a.CONNECTED]:p.EPlaybackState.LOADING,[a.LIVE]:p.EPlaybackState.PLAYING,[a.FINISHED]:p.EPlaybackState.PAUSED,[a.ERRORED]:p.EPlaybackState.ERROR},e._isLoadingPlayerModule=!1,yield e._createPlayerInstance()}})()}_createPlayerInstance(){var e=this;return s(function*(){var t,r,n,o,s,a,l,u,c;if(e._destroyPlayerInstance(),e._ristrettoModuleCache)if(null===e._isBroadcastSupportedByBrowser&&(e._isBroadcastSupportedByBrowser=yield e._ristrettoModuleCache.Broadcaster.checkSupport(),e._eventBusInstance.publish(h.EPlayersEvents.BROADCAST_SUPPORTED_CHANGE,{isSupported:e._isBroadcastSupportedByBrowser})),e._isBroadcastSupportedByBrowser){e._playerInstance=new e._ristrettoModuleCache.Broadcaster,e._playerInstance.setAppKey(e._appKey),e._lastKnownConfig&&e._playerInstance.setConfig(e._lastKnownConfig,!0);var d=null!==(t=e._lastKnownConfig)&&void 0!==t&&null!==(t=t.peerConnectionConfig)&&void 0!==t&&t.statsCollectionScheme?"string"==typeof(null===(r=e._lastKnownConfig)||void 0===r||null===(r=r.peerConnectionConfig)||void 0===r?void 0:r.statsCollectionScheme)?JSON.parse(null===(n=e._lastKnownConfig)||void 0===n||null===(n=n.peerConnectionConfig)||void 0===n?void 0:n.statsCollectionScheme):null===(o=e._lastKnownConfig)||void 0===o||null===(o=o.peerConnectionConfig)||void 0===o?void 0:o.statsCollectionScheme:{};null!==(s=e._playerInstance)&&void 0!==s&&s.setConfig({peerConnectionConfig:{statsCollectionScheme:i(i({},d),g),statsGatheringPeriod:null!==(a=e._lastKnownConfig)&&void 0!==a&&null!==(a=a.peerConnectionConfig)&&void 0!==a&&a.statsGatheringPeriod?Math.min(null===(l=e._lastKnownConfig)||void 0===l||null===(l=l.peerConnectionConfig)||void 0===l?void 0:l.statsGatheringPeriod,500):500}}),e._setStreamConfig(),e._videoElement&&e._playerInstance.setVideoElement(e._videoElement),e._attachEventListeners(),null!==(u=e._playerInstance)&&void 0!==u&&u.setLoggerLevels(e._logLevels),e._isStarted&&(null===(c=e._playerInstance)||void 0===c||c.start())}else e._eventBusInstance.publish(h.EPlayersEvents.ERROR,{error:new Error("Ristretto broadcast error: not supported by browser"),isFatal:!0,errorType:f.EPlayerErrorType.BROADCAST_NOT_SUPPORTED_BY_BROWSER,playerType:v.EPlayerType.BROADCAST});else yield e._loadRistrettoModule()})()}_setStreamConfig(){var e,t,r,n,i,o,s;null===(e=this._playerInstance)||void 0===e||e.setStreamConfig({customData:null===(t=this._lastKnownStreamConfig)||void 0===t?void 0:t.WebRTCPublishCustomData,mediaStream:null===(r=this._lastKnownStreamConfig)||void 0===r?void 0:r.MediaStream,streamId:null===(n=this._lastKnownStreamConfig)||void 0===n?void 0:n.WebRTCStreamId,streamToken:null===(i=this._lastKnownStreamConfig)||void 0===i?void 0:i.WebRTCACLToken,wsUrl:null===(o=this._lastKnownStreamConfig)||void 0===o?void 0:o.WebRTCSignallingUrl,probingCacheKey:null===(s=this._lastKnownStreamConfig)||void 0===s?void 0:s.ProbingCacheKey})}_onDebuggerConnected(e){var{detail:{debuggerUrl:t}}=e;this._eventBusInstance.publish(h.EPlayersEvents.DEBUGGER_CONNECTED,{debuggerUrl:t})}_onBroadcastStateChanged(e){var{detail:{prevState:t,nextState:r}}=e;this._ristrettoPlaybackStateToMMPStateMap&&this._eventBusInstance.publish(h.EPlayersEvents.PLAYBACK_STATE_CHANGED,{nextState:this._ristrettoPlaybackStateToMMPStateMap[r],prevState:this._ristrettoPlaybackStateToMMPStateMap[t]})}_onRistrettoError(e){var{detail:t}=e;this._eventBusInstance.publish(h.EPlayersEvents.ERROR,{error:new Error("Ristretto broadcast error: ".concat(t.info)),isFatal:t.isFatal,playerType:v.EPlayerType.BROADCAST})}_onLifecycleEventReported(e){var t,{detail:{eventType:r}}=e;null===(t=this._metricsCollector)||void 0===t||t.registerEvent(r)}_onLifecycleErrorReported(e){var t,{detail:{errorType:r,nativeError:n}}=e;null===(t=this._metricsCollector)||void 0===t||t.registerEvent(r,{errorMessage:(null==n?void 0:n.message)||""})}_onPeerMetricsAvailable(e){var t,{detail:{metrics:r}}=e,n=_.reduce((e,t)=>(Object.hasOwn(r,t)&&(e[t]=r[t]),e),{});null===(t=this._metricsCollector)||void 0===t||t.registerMetrics(n)}}t.RistrettoBroadcastWrapper=m,u([v.AsyncGuarderDecorator],m.prototype,"_loadRistrettoModule",null),u([v.AsyncGuarderDecorator],m.prototype,"_createPlayerInstance",null),u([p.bind],m.prototype,"_onDebuggerConnected",null),u([p.bind],m.prototype,"_onBroadcastStateChanged",null),u([p.bind],m.prototype,"_onRistrettoError",null),u([p.bind],m.prototype,"_onLifecycleEventReported",null),u([p.bind],m.prototype,"_onLifecycleErrorReported",null),u([p.bind],m.prototype,"_onPeerMetricsAvailable",null)},9959:(e,t,r)=>{r.d(t,{A:()=>n});var n=function(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}},9979:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||"undefined"!=typeof globalThis&&globalThis;function n(e){try{new e("")}catch(e){return!1}return!0}"function"==typeof r.Event&&n(r.Event)||(r.Event=function(e,t){this.bubbles=!!t&&!!t.bubbles,this.cancelable=!!t&&!!t.cancelable,this.composed=!!t&&!!t.composed,this.type=e}),void 0!==r.EventTarget&&n(r.EventTarget)||(r.EventTarget=function(){function e(){this.__listeners=new Map}return e.prototype=Object.create(Object.prototype),e.prototype.addEventListener=function(e,t,r){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only ".concat(arguments.length," present."));var n=this.__listeners,i=e.toString();n.has(i)||n.set(i,new Map);var o=n.get(i);o.has(t)||o.set(t,r)},e.prototype.removeEventListener=function(e,t,r){if(arguments.length<2)throw new TypeError("TypeError: Failed to execute 'addEventListener' on 'EventTarget': 2 arguments required, but only ".concat(arguments.length," present."));var n=this.__listeners,i=e.toString();if(n.has(i)){var o=n.get(i);o.has(t)&&o.delete(t)}},e.prototype.dispatchEvent=function(e){var t=this;if(!(e instanceof Event))throw new TypeError("Failed to execute 'dispatchEvent' on 'EventTarget': parameter 1 is not of type 'Event'.");var r=e.type,n=this.__listeners.get(r);if(n){var i=function(){try{"function"==typeof o?o.call(t,e):o&&"function"==typeof o.handleEvent&&o.handleEvent(e)}catch(e){setTimeout(()=>{throw e})}s&&s.once&&n.delete(o)};for(var[o,s]of n.entries())i()}return!0},e}())}},u={};function c(e){var t=u[e];if(void 0!==t)return t.exports;var r=u[e]={exports:{}};return l[e].call(r.exports,r,r.exports,c),r.exports}c.amdO={},c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var d={};(()=>{var e=d;Object.defineProperty(e,"__esModule",{value:!0}),e.validateConfig=e.MMP_VERSION=e.emulatePlayOnVideoElement=e.getVideoElement=e.EModuleLoadingState=e.EMouflonPlayerEvent=e.EPlayerErrorType=e.MouflonPlayer=e.EPlaybackStartType=e.EPlaybackState=e.EPlayerType=void 0,c(2502);var t=c(6805);Object.defineProperty(e,"EPlayerType",{enumerable:!0,get:function(){return t.EPlayerType}}),Object.defineProperty(e,"EPlaybackState",{enumerable:!0,get:function(){return t.EPlaybackState}}),Object.defineProperty(e,"EPlaybackStartType",{enumerable:!0,get:function(){return t.EPlaybackStartType}});var r=c(7033);Object.defineProperty(e,"MouflonPlayer",{enumerable:!0,get:function(){return r.MouflonPlayer}});var n=c(5307);Object.defineProperty(e,"EPlayerErrorType",{enumerable:!0,get:function(){return n.EPlayerErrorType}});var i=c(4354);Object.defineProperty(e,"EMouflonPlayerEvent",{enumerable:!0,get:function(){return i.EMouflonPlayerEvent}}),Object.defineProperty(e,"EModuleLoadingState",{enumerable:!0,get:function(){return i.EModuleLoadingState}});var o=c(2702);Object.defineProperty(e,"getVideoElement",{enumerable:!0,get:function(){return o.getVideoElement}}),Object.defineProperty(e,"emulatePlayOnVideoElement",{enumerable:!0,get:function(){return o.emulatePlayOnVideoElement}});var s=c(5810);Object.defineProperty(e,"MMP_VERSION",{enumerable:!0,get:function(){return s.MMP_VERSION}});var a=c(8810);Object.defineProperty(e,"validateConfig",{enumerable:!0,get:function(){return a.validateConfig}})})();var h=d.EMouflonPlayerEvent,f=d.EPlayerType,p=d.MouflonPlayer},4275:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".root--26nWL {\n  position: fixed;\n  border: 1px solid #555;\n  z-index: 2000000;\n}\n\n.topLeft--ww3NX {\n  top: 10px;\n  left: 10px;\n}\n\n.topRight--8HMsj {\n  top: 10px;\n  right: 10px;\n}\n\n.bottomLeft--OtTTA {\n  bottom: 10px;\n  left: 10px;\n}\n\n.bottomRight--h0VsQ {\n  bottom: 10px;\n  right: 10px;\n}\n\n.rootFullscreen--iSZiD {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  border: 1px solid #555;\n  z-index: 2000000;\n}\n\n.rootContent--OjJEv {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: horizontal;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: row;\n          flex-direction: row;\n  width: 100%;\n  height: 100%;\n}\n\n.modelWrapper--hcpk7 {\n  position: relative;\n  -webkit-box-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n\n.ctaButton--eeWNN {\n  z-index: 1;\n  bottom: 20px;\n  -ms-flex-item-align: center;\n      align-self: center;\n  position: absolute;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  padding: 5px 14px;\n  background: -webkit-gradient(linear, left bottom, left top, from(rgba(162, 36, 44, 0.2)), to(rgba(162, 36, 44, 0.2))), #ff0000;\n  background: linear-gradient(0deg, rgba(162, 36, 44, 0.2), rgba(162, 36, 44, 0.2)), #ff0000;\n  -webkit-box-shadow: 0 0 60px rgba(0, 0, 0, 0.08);\n          box-shadow: 0 0 60px rgba(0, 0, 0, 0.08);\n  border-radius: 16px;\n  position: absolute;\n  color: white;\n  text-transform: uppercase;\n  text-decoration: none;\n  font-size: 14px;\n  font-family: Source Sans Pro, sans-serif;\n  line-height: 1.3;\n}\n\n.ctaButtonSingle--tbSHp {\n  bottom: 6px;\n}\n\n.topRight--8HMsj.slideAnimation--2ih2G,\n.bottomRight--h0VsQ.slideAnimation--2ih2G {\n  -webkit-animation: slideInRight---Jyqq 0.3s ease-in;\n          animation: slideInRight---Jyqq 0.3s ease-in;\n}\n\n.topLeft--ww3NX.slideAnimation--2ih2G,\n.bottomLeft--OtTTA.slideAnimation--2ih2G {\n  -webkit-animation: slideInLeft--Sj1sR 0.3s ease-in;\n          animation: slideInLeft--Sj1sR 0.3s ease-in;\n}\n\n.close-button--a-8tK {\n  background: rgba(0, 0, 0, 0.7);\n  border: 1px solid #888888;\n  border-radius: 0;\n  outline: none;\n  color: white;\n  padding: 5px 8px;\n  top: 0;\n  right: 0;\n  position: absolute;\n  cursor: pointer;\n}\n\n@-webkit-keyframes slideInRight---Jyqq {\n  from {\n    -webkit-transform: translateX(100%);\n            transform: translateX(100%);\n  }\n  to {\n    -webkit-transform: translateX(0%);\n            transform: translateX(0%);\n  }\n}\n\n@keyframes slideInRight---Jyqq {\n  from {\n    -webkit-transform: translateX(100%);\n            transform: translateX(100%);\n  }\n  to {\n    -webkit-transform: translateX(0%);\n            transform: translateX(0%);\n  }\n}\n@-webkit-keyframes slideInLeft--Sj1sR {\n  from {\n    -webkit-transform: translateX(-100%);\n            transform: translateX(-100%);\n  }\n  to {\n    -webkit-transform: translateX(0%);\n            transform: translateX(0%);\n  }\n}\n@keyframes slideInLeft--Sj1sR {\n  from {\n    -webkit-transform: translateX(-100%);\n            transform: translateX(-100%);\n  }\n  to {\n    -webkit-transform: translateX(0%);\n            transform: translateX(0%);\n  }\n}",""]),i.locals={root:"root--26nWL",topLeft:"topLeft--ww3NX",topRight:"topRight--8HMsj",bottomLeft:"bottomLeft--OtTTA",bottomRight:"bottomRight--h0VsQ",rootFullscreen:"rootFullscreen--iSZiD",rootContent:"rootContent--OjJEv",modelWrapper:"modelWrapper--hcpk7",ctaButton:"ctaButton--eeWNN",ctaButtonSingle:"ctaButtonSingle--tbSHp",slideAnimation:"slideAnimation--2ih2G",slideInRight:"slideInRight---Jyqq",slideInLeft:"slideInLeft--Sj1sR","close-button":"close-button--a-8tK",closeButton:"close-button--a-8tK"},t.A=i},4343:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return T},generateProxyLink:function(){return d.ih},getProxyLinkProps:function(){return d.L9},getTrackingParameters:function(){return d.g8},impressionReadyEvent:function(){return c.P},trackingParametersLoaded:function(){return c.T}});var n=r(9266),i=r.n(n),o=r(3292),s=r(3246),a=r(6579),l=r(3614),u=r(5419),c=r(338),d=r(846),h=r(1981),f={acceptedParamsConfig:[{key:"referrer",title:"Referrer param from url",type:h.A.STRING,private:!0},{key:"trackOff",title:"trackOff",type:h.A.BOOL,default:!1}]},p=r(8062),v=r(9418),g=["m","mh"];var _=e=>{var{params:t,state:r,encrypted:n}=e,{m:i,mh:o}=t,s=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(t,g),a=(0,v.FB)(r,"impression");return n?i?(0,p.dF)(a,{e:btoa((0,p.x7)(s)),m:i,mh:o}):(0,p.dF)(a,{e:btoa((0,p.x7)(t))}):(0,p.dF)(a,t)};function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach(function(t){b(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function b(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var E=(e,t,r,n)=>{var i=c.P.effect(()=>n=>{var{trackOff:i,encrypted:o}=(0,a.zj)(n);if(!i){var s=r&&!1;if(!(0,u.A)(t)){var c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=JSON.stringify(t);return t&&t.length>0?y(y({},e),{},{m:r,mh:(0,l.A)(r)}):e}((0,d.Io)(n,t),s),h=new Image;h.style.cssText="position: fixed; top: -1px; left: -1px; width: 1px; height: 1px",h.src=_({params:c,state:n,encrypted:o}),e.appendChild(h)}}});return{reducer:(0,s.A)(y({impressionParameters:[],trackingParameters:[]},n)).on(c.T,e=>{var{impression:t=[],tracking:r=[]}=e;return{impressionParameters:t,trackingParameters:r}}),effects:[i,(0,a.I0)(f)]}},S=(0,o.A)((e,t,r)=>i()().catch(()=>0).then(Number).then(n=>{var{reducer:i,effects:o}=E(e,t,r,{isIncognito:n});return{reducer:i,effects:o}})).requires("body","location","performance"),T=S},5419:function(e,t,r){"use strict";var n=r(2929);t.A=e=>{var{hostname:t}=e;return(0,n.A)("gate.",t)}},5950:function(e,t,r){"use strict";r.d(t,{A:function(){return i}});var n=function(e,t){return{event:e,effect:t,options:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}}},i=e=>{var t=t=>({name:e,payload:t});return t.effect=e=>n(t,e),t.effectOnce=e=>n(t,e,{once:!0}),t.eventName=e,t}},5983:function(e,t){"use strict";t.A="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjZjFmMWYxIiB2aWV3Qm94PSIwIDAgMjE3IDQyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik02MS4zNTggMjMuNzU5aC00LjM1M2MtLjAxOSAxLjI2LjIxIDIuMzQ4LjY4OCAzLjI2NGE2LjQzNiA2LjQzNiAwIDAwMS45MzMgMi4yNjJjLjgxMS41OTIgMS43NDYgMS4wMjcgMi44MDYgMS4zMDMgMS4wNi4yNzcgMi4xNTMuNDE2IDMuMjc5LjQxNiAxLjM5NCAwIDIuNjItLjE2MyAzLjY4LS40ODcgMS4wNi0uMzI1IDEuOTQ3LS43NzggMi42NjMtMS4zNmE1LjY2MSA1LjY2MSAwIDAwMS42MTgtMi4wNzdjLjM2My0uODAxLjU0NC0xLjY3LjU0NC0yLjYwNSAwLTEuMTQ2LS4yNDMtMi4wODYtLjczLTIuODIxLS40ODctLjczNS0xLjA2NS0xLjMyMi0xLjczMy0xLjc2MWE3LjYxNiA3LjYxNiAwIDAwLTIuMDE5LS45NmMtLjY3Ny0uMi0xLjIwNy0uMzM4LTEuNTg5LS40MTUtMS4yOC0uMzI0LTIuMzE1LS41OTItMy4xMDctLjgwMi0uNzkyLS4yMS0xLjQxMy0uNDItMS44NjEtLjYzLS40NDktLjIxLS43NS0uNDM5LS45MDItLjY4Ny0uMTUzLS4yNDgtLjIzLS41NzMtLjIzLS45NzQgMC0uNDM5LjA5Ni0uODAxLjI4Ny0xLjA4OGEyLjQ4IDIuNDggMCAwMS43My0uNzE2IDIuOTEgMi45MSAwIDAxLjk4OC0uNCA1LjI3IDUuMjcgMCAwMTEuMDg4LS4xMTVjLjU1NCAwIDEuMDY0LjA0OCAxLjUzMi4xNDMuNDY4LjA5Ni44ODMuMjU4IDEuMjQ2LjQ4Ny4zNjMuMjI5LjY1NC41NDQuODczLjk0NS4yMi40LjM0OS45MDcuMzg3IDEuNTE4aDQuMzUzYzAtMS4xODQtLjIyNS0yLjE5MS0uNjczLTMuMDIyYTUuODY3IDUuODY3IDAgMDAtMS44MTktMi4wNDcgNy42NzggNy42NzggMCAwMC0yLjYyLTEuMTYgMTMuMDA4IDEzLjAwOCAwIDAwLTMuMDc4LS4zNThjLS45MTcgMC0xLjgzMy4xMjQtMi43NS4zNzNhNy42NzUgNy42NzUgMCAwMC0yLjQ2MiAxLjE0NSA2LjA5OCA2LjA5OCAwIDAwLTEuNzYxIDEuOTMzYy0uNDQ5Ljc3My0uNjczIDEuNjg1LS42NzMgMi43MzUgMCAuOTM1LjE3NiAxLjczMi41MyAyLjM5YTUuMDU3IDUuMDU3IDAgMDAxLjM4OCAxLjY0N2MuNTczLjQ0IDEuMjIyLjc5NyAxLjk0OCAxLjA3NC43MjUuMjc3IDEuNDcuNTExIDIuMjMzLjcwMi43NDUuMjEgMS40OC40IDIuMjA1LjU3My43MjYuMTcxIDEuMzc1LjM3MiAxLjk0OC42MDEuNTcyLjIzIDEuMDM1LjUxNSAxLjM4OC44Ni4zNTQuMzQzLjUzLjc5MS41MyAxLjM0NSAwIC41MTUtLjEzMy45NC0uNCAxLjI3NGEyLjgxMSAyLjgxMSAwIDAxLTEuMDAzLjc4OGMtLjQuMTktLjgzLjMyLTEuMjg5LjM4Ni0uNDU4LjA2Ny0uODg3LjEtMS4yODguMWE2LjgzNCA2LjgzNCAwIDAxLTEuNzE4LS4yMTQgNC4yNzcgNC4yNzcgMCAwMS0xLjQ0Ny0uNjU5IDMuMjUzIDMuMjUzIDAgMDEtLjk4OC0xLjE2Yy0uMjQ4LS40NzctLjM3Mi0xLjA2LS4zNzItMS43NDZ6bTIwLjA0Ni05Ljg4djE2LjY2Nkg4NS45VjEzLjg4aDYuMTI4VjEwLjFINzUuMjc1djMuNzhoNi4xMjl6bTE3LjQ2OCA1LjQ3di01Ljc1Nmg0LjkyNWMxLjAzMSAwIDEuODA0LjIyNCAyLjMyLjY3My41MTUuNDQ4Ljc3MyAxLjE2OS43NzMgMi4xNjIgMCAxLjAzLS4yNTggMS43NzUtLjc3MyAyLjIzMy0uNTE2LjQ1OS0xLjI4OS42ODgtMi4zMi42ODhoLTQuOTI1em0tNC40OTYtOS4yNXYyMC40NDZoNC40OTZ2LTcuOTloNC40OTZjMS4xMjYgMCAxLjkzNy4yNSAyLjQzNC43NDUuNDk2LjQ5Ny44MiAxLjI4Ljk3MyAyLjM0OS4xMTUuODIuMiAxLjY4LjI1OCAyLjU3Ny4wNTcuODk3LjIxIDEuNjcuNDU4IDIuMzJoNC40OTZhMy4wMSAzLjAxIDAgMDEtLjQ3Mi0xLjA0NiA5LjAyOSA5LjAyOSAwIDAxLS4yMy0xLjMwMyAyMi4zNzQgMjIuMzc0IDAgMDEtLjEtMS4zNDZjLS4wMTktLjQzOS0uMDM4LS44Mi0uMDU3LTEuMTQ1YTEyLjIyNSAxMi4yMjUgMCAwMC0uMjE1LTEuNTQ2IDUuMiA1LjIgMCAwMC0uNS0xLjQxOCAzLjg5IDMuODkgMCAwMC0uODg4LTEuMTE3Yy0uMzYzLS4zMTUtLjgyMS0uNTQ5LTEuMzc1LS43MDF2LS4wNThjMS4xNDUtLjQ1OCAxLjk3MS0xLjEyNiAyLjQ3Ny0yLjAwNC41MDYtLjg3OC43NTktMS45MTkuNzU5LTMuMTIyIDAtLjc4Mi0uMTM4LTEuNTEyLS40MTUtMi4xOWE1LjI4MyA1LjI4MyAwIDAwLTEuMjAzLTEuNzkgNS43MDEgNS43MDEgMCAwMC0xLjg5LTEuMjE3Yy0uNzM1LS4yOTYtMS41Ni0uNDQ0LTIuNDc3LS40NDRIOTQuMzc2em0yMC42NzUgMHYyMC40NDZoNC40OTZWMTAuMWgtNC40OTZ6bTEyLjk0NCA5LjYyMnYtNi4xMjhoMy40OTRhOS40NyA5LjQ3IDAgMDExLjQ4OS4xMTQgMy40OSAzLjQ5IDAgMDExLjI2LjQ0NGMuMzYyLjIyLjY1NC41My44NzMuOTMuMjIuNDAyLjMzLjkyNy4zMyAxLjU3NnMtLjExIDEuMTc0LS4zMyAxLjU3NWMtLjIyLjQtLjUxLjcxMS0uODczLjkzLS4zNjMuMjItLjc4My4zNjgtMS4yNi40NDRhOS40MTYgOS40MTYgMCAwMS0xLjQ5LjExNWgtMy40OTN6bS00LjQ5Ni05LjYyMnYyMC40NDZoNC40OTZ2LTcuMzNoNC43MjVjMS4yOCAwIDIuMzY3LS4xODcgMy4yNjUtLjU1OS44OTctLjM3MiAxLjYyNy0uODY0IDIuMTktMS40NzVhNS42NDYgNS42NDYgMCAwMDEuMjMyLTIuMTA0IDcuNzc2IDcuNzc2IDAgMDAuMzg2LTIuNDIgNy43NSA3Ljc1IDAgMDAtLjM4Ni0yLjQzNCA1LjY2NSA1LjY2NSAwIDAwLTEuMjMyLTIuMDljLS41NjMtLjYxMi0xLjI5My0xLjEwMy0yLjE5LTEuNDc1LS44OTgtLjM3My0xLjk4Ni0uNTU5LTMuMjY1LS41NTloLTkuMjJ6bTMzLjczNCA2LjE1N2gyLjcyYy0uMTUzLTEuMDg4LS40NzctMi4wNDgtLjk3My0yLjg3OGE3LjA4MSA3LjA4MSAwIDAwLTEuODYyLTIuMDc2IDguMTYgOC4xNiAwIDAwLTIuNTQ4LTEuMjYgMTAuNTEgMTAuNTEgMCAwMC0zLjAzNi0uNDNjLTEuNTY1IDAtMi45NTQuMjgyLTQuMTY2Ljg0NS0xLjIxMy41NjMtMi4yMjUgMS4zMzItMy4wMzYgMi4zMDUtLjgxMS45NzQtMS40MjcgMi4xMTUtMS44NDcgMy40MjItLjQyIDEuMzA4LS42MyAyLjcwNi0uNjMgNC4xOTYgMCAxLjQ4OS4xOTYgMi44ODIuNTg3IDQuMTguMzkxIDEuMjk5Ljk3OCAyLjQyNSAxLjc2MSAzLjM4Ljc4My45NTQgMS43NjYgMS43MDMgMi45NSAyLjI0NyAxLjE4My41NDUgMi41NjcuODE3IDQuMTUyLjgxNyAyLjYxNSAwIDQuNjc3LS43MTYgNi4xODUtMi4xNDggMS41MDktMS40MzIgMi4zOTYtMy40MzYgMi42NjQtNi4wMTRoLTIuNzJhNy44MDIgNy44MDIgMCAwMS0uNTE2IDIuMzQ4IDUuNjY3IDUuNjY3IDAgMDEtMS4xODkgMS44NzYgNS40MTMgNS40MTMgMCAwMS0xLjgwNCAxLjIzMmMtLjY5Ny4yOTUtMS40OTQuNDQzLTIuMzkuNDQzLTEuMjIzIDAtMi4yNzMtLjIyOS0zLjE1LS42ODdhNi4xNTIgNi4xNTIgMCAwMS0yLjE2My0xLjg0N2MtLjU2My0uNzczLS45NzgtMS42OC0xLjI0Ni0yLjcyYTEzLjI1IDEzLjI1IDAgMDEtLjQtMy4zMDhjMC0xLjA2OS4xMzMtMi4xLjQtMy4wOTNhNy45NzIgNy45NzIgMCAwMTEuMjQ2LTIuNjQ4IDYuMTg5IDYuMTg5IDAgMDEyLjE0OC0xLjg0OGMuODY4LS40NTggMS45MTQtLjY4NyAzLjEzNS0uNjg3IDEuNDMyIDAgMi42NjguMzYzIDMuNzA5IDEuMDg4IDEuMDQuNzI2IDEuNzEzIDEuODE0IDIuMDE5IDMuMjY1em02LjMtNi4xNTd2MjAuNDQ2aDIuNzJ2LTkuMzY0aDEwLjc2N3Y5LjM2NGgyLjcyVjEwLjFoLTIuNzJ2OC43OTFoLTEwLjc2N1YxMC4xaC0yLjcyem0yNC4xOTcgMTEuOTk5bDMuNDY1LTkuNTM2aC4wNThsMy40MDcgOS41MzZoLTYuOTN6bTIuMDM0LTExLjk5OWwtNy45NjEgMjAuNDQ2aDIuNzc3bDIuMjkxLTYuMTU2aDguNjQ5bDIuMjMzIDYuMTU2aDMuMDA3TDE5Mi43NyAxMC4xaC0zLjAwNnptMTcuNjQgMi4yOTF2MTguMTU1aDIuNzJWMTIuMzloNi44MTZWMTAuMWgtMTYuMzUydjIuMjloNi44MTZ6TTE3LjcgMzcuNzZzLS4yNzItLjA1LS4zMjEtLjA2NGMtLjc5NS0uMjEyLTEuNjE4LS4wMDMtMi4yMDguMjg1LS41NzQuMjgtLjMzLjE2My0uMzMuMTYzLS45NTguNDc1LTEuOTczLjkxMy0zLjAzOCAxLjMxNS0yLjg5NSAxLjA5MS02LjAyOCAxLjg3LTkuMTgyIDIuMzguMjgtLjQxNy41MzctLjgxNi43NzEtMS4xOTguNjMyLTEuMDMgMS40NDEtMi40OTkgMi4zODYtNC4yOTYgMCAwIC43OC0xLjM2IDEuMDktMi4wNzIuMzA4LS43MDYtLjA0OC0xLjM3Mi0uNDktMS44MDMtLjQ0NC0uNDMtMS4zNDQtMS4zOTgtMS4zNDQtMS4zOThDMS43NzcgMjcuNjgxIDAgMjMuNTA4IDAgMTkuMTMgMCA4LjczIDEwLjExNyAwIDIyLjkxIDAgMzUuNyAwIDQ1LjgxNyA4LjczIDQ1LjgxNyAxOS4xMjljMCA5LjgyOS05LjA0IDE4LjE2OC0yMC44MzUgMTkuMDUxLS4yNi4wMi0uNzgzLS4xODEtLjc4OS0uODE2LS4wMzUtMy44MTUtLjA3LTExLjQzMS0uMDctMTEuNDMxIDAtLjM1OC4yNDktLjc5NS41NTYtLjk3NWw4Ljc1OC05LjI0NmMuMjMtLjI0NC40MS0uNzEzLjQtMS4wNGwuMDE4LjU5YS44MTguODE4IDAgMDAtLjgxNy0uNzkybC0yMC43MDkuMDFjLS40MzggMC0uOC4zNTctLjgwOS43ODdsLjAxMi0uNjA0Yy0uMDA3LjMzMy4xOC44MDYuNDA1IDEuMDQ1bDguNzMyIDkuMjM3Yy4zMDMuMTg4LjU1LjYzLjU1Ljk4OCAwIDAtLjAxIDcuNjM4LjAxNCAxMS40NTguMDA0LjU4NC0uNTg0LjgwOC0uODcyLjc3OWEyOS4yMiAyOS4yMiAwIDAxLTIuNjYxLS40MXoiLz48L3N2Zz4="},6561:function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,s){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new i(n,o||e,s),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],a]:e._events[l].push(a):(e._events[l]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function a(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),a.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},a.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s},a.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},a.prototype.emit=function(e,t,n,i,o,s){var a=r?r+e:e;if(!this._events[a])return!1;var l,u,c=this._events[a],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,o),!0;case 6:return c.fn.call(c.context,t,n,i,o,s),!0}for(u=1,l=new Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,i);break;default:if(!l)for(h=1,l=new Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},a.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return s(this,o),this;var a=this._events[o];if(a.fn)a.fn!==t||i&&!a.once||n&&a.context!==n||s(this,o);else{for(var l=0,u=[],c=a.length;l<c;l++)(a[l].fn!==t||i&&!a[l].once||n&&a[l].context!==n)&&u.push(a[l]);u.length?this._events[o]=1===u.length?u[0]:u:s(this,o)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},6579:function(e,t,r){"use strict";r.d(t,{I0:function(){return D},Ay:function(){return B},zj:function(){return N},_M:function(){return R}});var n=r(6773),i=r(1981),o=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/\s/g,"")},s=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,a=/[^0-9-]/,l=(e,t,r)=>{var{min:o,max:s,disableNonNumeric:l}=t,u=String(e),c=parseInt(e,10),d=r===i.A.UNSIGNED_INT?Math.abs(c):c;switch(!0){case a.test(u)&&l:case Number.isNaN(d):case!(0,n.A)(o)&&d<o:case!(0,n.A)(s)&&d>s:return!1;default:return!0}},u=r(2929),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return""===e?[]:(e||"").split(",").map(e=>e.trim()).filter(e=>e||t)},d=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,h=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/\s/g,"")},f=(e,t,r,n)=>{var{allowEmpty:o}=n;switch(r){case i.A.UNSIGNED_INT:return Math.abs(parseInt(e,10));case i.A.INT:return parseInt(e,10);case i.A.INT_LIST:return(e||"").split(",").map(e=>parseInt(e,10)).filter(Boolean);case i.A.BOOL:return"boolean"==typeof e?e:1===parseInt(e,10);case i.A.STRING:case i.A.ENUM:return"".concat(e).trim();case i.A.STRING_LIST:return c(e,o);case i.A.HEX_COLOR:return h(e)&&(0,u.A)("#",e)?e:"#".concat(e);case i.A.HEX_LIST:return(e||"").split(",").map(h).filter(e=>d.test(e)).map(e=>(0,u.A)("#",e)?e:"#".concat(e));default:throw new Error("Unknown type ".concat(r))}},p=["key","default","type","convertValue","isAccepted"];function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach(function(t){_(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function _(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=(e,t)=>"function"==typeof e?e(t):e,y=(e,t)=>e.reduce((e,r)=>{var{key:a,default:u,type:c,convertValue:d=f,isAccepted:h}=r,v=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(r,p),_=!(a in t),y=(0,n.A)(u);if(_&&y)return e;var b=t[a],E=h?h(b,t):(e=>{var{value:t,type:r,options:n}=e;switch(r){case i.A.UNSIGNED_INT:case i.A.INT:return l(t,n,r);case i.A.INT_LIST:return(t||"").split(",").some(e=>l(e,n));case i.A.BOOL:return["1",1,"0",0].includes(t);case i.A.STRING:return"".concat(t).trim();case i.A.ENUM:return n.enum.includes(o(t));case i.A.STRING_LIST:return(t||"").split(",").some(e=>!!o(e));case i.A.HEX_COLOR:return s.test(t);case i.A.HEX_LIST:return(t||"").split(",").some(e=>s.test(o(e)));default:throw new Error("Unknown type ".concat(r))}})({value:b,type:c,options:v});return y&&!E?e:g(g({},e),{},{[a]:d(E&&b||m(u,t),t,c,v)})},{}),b=r(8062),E=r(6905),S=r(3292),T=r(3246),C=r(5950),A=(0,C.A)("App configuration"),P=(0,C.A)("Update config"),R=(0,C.A)("Update query");function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach(function(t){M(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function M(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var w=e=>t=>{var{config:r}=t;return{config:L(L({},r),e)}},I=(0,S.A)((e,t)=>{var{fixedQueryParams:r}=t,n={acceptedParamsConfig:[],initialConfig:{}},i=L(L({},(0,b.Vw)(e.href)),r),o=()=>w(L(L(L({},n.initialConfig),y(n.acceptedParamsConfig||[],i)),{},{acceptedQueryParamsConfig:n.acceptedParamsConfig,queryParams:i}));return{reducer:(0,T.A)({config:{queryParams:{}}}).on(E.z,()=>o()).on(R,e=>(Object.assign(i,e),o())).on(P,w),effects:[A.effect(e=>{var{acceptedParamsConfig:t=[],initialConfig:r={}}=e;n.acceptedParamsConfig=[...n.acceptedParamsConfig,...t],n.initialConfig=L(L({},n.initialConfig),r)})]}}).requires("location","globals"),D=e=>E.$.effect(()=>(t,r)=>r(A(e))),N=e=>{var{config:t={queryParams:{}}}=e;return t},B=I},6628:function(e,t){"use strict";function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}t.A=e=>Object.keys(e).reduce((t,r)=>{return n(n({},t),{},{[r]:"boolean"!=typeof e[r]?e[r]:(i=e[r],!0===i?1:0)});var i},{})},6773:function(e,t){"use strict";t.A=e=>null==e},6862:function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,l=(1<<a)-1,u=l>>1,c=-7,d=r?i-1:0,h=r?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+e[t+d],d+=h,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+e[t+d],d+=h,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=u}return(f?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,l,u=8*o-i-1,c=(1<<u)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=c):(s=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-s))<1&&(s--,l*=2),(t+=s+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(s++,l/=2),s+d>=c?(a=0,s=c):s+d>=1?(a=(t*l-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;e[r+f]=255&s,f+=p,s/=256,u-=8);e[r+f-p]|=128*v}},6904:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".root--Po7gy {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n\n.root--Po7gy small {\n  font-size: smaller;\n}\n\n.online--ZZr8m {\n  display: block;\n  width: 5px;\n  height: 5px;\n  background-color: #fff;\n  border-radius: 50%;\n  margin-right: 5px;\n}\n\n.big--slyR\\+ {\n  width: 13px;\n  height: 13px;\n}\n\n.dotLive--HtVTt {\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  display: block;\n}",""]),i.locals={root:"root--Po7gy",online:"online--ZZr8m",big:"big--slyR+",dotLive:"dotLive--HtVTt"},t.A=i},6905:function(e,t,r){"use strict";r.d(t,{$:function(){return i},z:function(){return o}});var n=r(5950),i=(0,n.A)("App bootstrap"),o=(0,n.A)("App initialization")},6926:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".root--esWti {\n  position: absolute;\n  left: 5px;\n  right: 5px;\n  z-index: 1;\n}\n\n.big--U1r6v {\n  left: 25px;\n  right: 25px;\n  top: 25px;\n}",""]),i.locals={root:"root--esWti",big:"big--U1r6v"},t.A=i},7727:function(e,t,r){"use strict";r.d(t,{v:function(){return n}});var n=function(e){return e.Count="count",e.Weight="weight",e}({})},7934:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,'.root--wuzSh {\n  color: inherit;\n  position: relative;\n  display: block;\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-position: center;\n  background-size: cover;\n  -webkit-transform: translate3d(0, 0, 0);\n          transform: translate3d(0, 0, 0);\n  font-family: Arimo, sans-serif;\n}\n\n.img--ooZce {\n  backdrop-filter: blur(5px);\n  height: 100%;\n  width: 100%;\n}\n\n.background--e1azP {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background-position: center;\n  background-size: cover;\n  -webkit-filter: blur(8px);\n          filter: blur(8px);\n}\n\n.with-shadow--oHSI7::after {\n  background: -webkit-gradient(linear, left top, left bottom, from(transparent), color-stop(transparent), color-stop(rgba(0, 0, 0, 0.2)), to(rgba(0, 0, 0, 0.9)));\n  background: linear-gradient(transparent, transparent, rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.9));\n  bottom: 0;\n  content: " ";\n  display: block;\n  left: 0;\n  pointer-events: none;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.header--fpjyA {\n  position: absolute;\n  z-index: 2;\n  top: 6px;\n  left: 0;\n  right: 0;\n  container-type: inline-size;\n}\n\n.footer--N0aK5 {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n}\n\n.footer--N0aK5 > * {\n  bottom: 0;\n}\n\n.play-button--A3-rp {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}',""]),i.locals={root:"root--wuzSh",img:"img--ooZce",background:"background--e1azP","with-shadow":"with-shadow--oHSI7",withShadow:"with-shadow--oHSI7",header:"header--fpjyA",footer:"footer--N0aK5","play-button":"play-button--A3-rp",playButton:"play-button--A3-rp"},t.A=i},8062:function(e,t,r){"use strict";function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){o(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}r.d(t,{$_:function(){return f},EW:function(){return v},Jr:function(){return p},Vw:function(){return h},dF:function(){return d},qy:function(){return c},x7:function(){return u}});var s=e=>t=>{try{return e(t)}catch(r){return t}},a=s(decodeURIComponent),l=s(encodeURIComponent);function u(e){return Object.keys(e).reduce((t,r)=>{var n=e[r];return[...t,[l(r),void 0===n?null:l(n&&"object"==typeof n&&!Array.isArray(n)?JSON.stringify(n):n)].filter(Boolean).join("=")]},[]).join("&")}function c(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("&").reduce((e,t)=>{var r=t.indexOf("="),n=-1===r,i=n?t:t.slice(0,r);return e[a(i)]=n?void 0:a(t.slice(r+1)),e},{})}function d(e,t){var[r,n=""]=e.split("?"),[o,s]=n.split("#"),a=u(i(i({},o?c(o):{}),t));return a?"".concat(r,"?").concat(a).concat(s?"#".concat(s):""):e}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.href,t=document.createElement("a");t.href=e;var r=t.search.substring(1);return r?c(r):{}}function f(e){return(e||"").replace(/(.*?\.[^?/]+)([?:/]{1}|$).*/,"$1")}var p=e=>e.split("//")[0],v=e=>f(e).split("//")[1]},8547:function(e,t,r){"use strict";var n,i=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},o=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(n){r=null}e[t]=r}return e[t]}}(),s=[];function a(e){for(var t=-1,r=0;r<s.length;r++)if(s[r].identifier===e){t=r;break}return t}function l(e,t){for(var r={},n=[],i=0;i<e.length;i++){var o=e[i],l=t.base?o[0]+t.base:o[0],u=r[l]||0,c="".concat(l," ").concat(u);r[l]=u+1;var d=a(c),h={css:o[1],media:o[2],sourceMap:o[3]};-1!==d?(s[d].references++,s[d].updater(h)):s.push({identifier:c,updater:g(h,t),references:1}),n.push(c)}return n}function u(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var i=r.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])}),"function"==typeof e.insert)e.insert(t);else{var s=o(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var c,d=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function h(e,t,r,n){var i=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=d(t,i);else{var o=document.createTextNode(i),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}function f(e,t,r){var n=r.css,i=r.media,o=r.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var p=null,v=0;function g(e,t){var r,n,i;if(t.singleton){var o=v++;r=p||(p=u(t)),n=h.bind(null,r,o,!1),i=h.bind(null,r,o,!0)}else r=u(t),n=f.bind(null,r,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var r=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<r.length;n++){var i=a(r[n]);s[i].references--}for(var o=l(e,t),u=0;u<r.length;u++){var c=a(r[u]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}r=o}}}},8767:function(e,t,r){"use strict";var n=r(1967),i=r.n(n)()(function(e){return e[1]});i.push([e.id,".root--2h\\+r1 {\n  height: 100%;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  overflow: hidden;\n}\n.root--2h\\+r1 video {\n  opacity: 1;\n  min-width: 100%;\n  min-height: 100%;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  font-size: 0;\n  display: block;\n}\n.root--2h\\+r1 video[metaloaded] {\n  -webkit-animation: videoFadeIn--Hs2wn 0.3s ease-in forwards;\n          animation: videoFadeIn--Hs2wn 0.3s ease-in forwards;\n}\n\n.inner--2g0Gr {\n  min-width: 100%;\n  min-height: 100%;\n  border-radius: 18px;\n  overflow: hidden;\n}\n\n.circle--\\+RsdM {\n  border-radius: 100%;\n  position: relative;\n}\n\n@-webkit-keyframes videoFadeIn--Hs2wn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes videoFadeIn--Hs2wn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}",""]),i.locals={root:"root--2h+r1",videoFadeIn:"videoFadeIn--Hs2wn",inner:"inner--2g0Gr",circle:"circle--+RsdM"},t.A=i},8960:function(e,t,r){"use strict";var n=r(3711),i=r(6862),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50;var s=2147483647;function a(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return d(e)}return u(e,t,r)}function u(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|v(e,t),n=a(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(V(e,Uint8Array)){var t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(V(e,ArrayBuffer)||e&&V(e.buffer,ArrayBuffer))return f(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(V(e,SharedArrayBuffer)||e&&V(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,r);var i=function(e){if(l.isBuffer(e)){var t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||W(e.length)?a(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return c(e),a(e<0?0:0|p(e))}function h(e){for(var t=e.length<0?0:0|p(e.length),r=a(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,l.prototype),n}function p(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function v(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||V(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return x(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return F(e).length;default:if(i)return n?-1:x(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,r);case"utf8":case"utf-8":return P(this,t,r);case"ascii":return O(this,t,r);case"latin1":case"binary":return L(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function _(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),W(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,i){var o,s=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,l/=2,r/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var c=-1;for(o=r;o<a;o++)if(u(e,o)===u(t,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===l)return c*s}else-1!==c&&(o-=o-c),c=-1}else for(r+l>a&&(r=a-l),o=r;o>=0;o--){for(var d=!0,h=0;h<l;h++)if(u(e,o+h)!==u(t,h)){d=!1;break}if(d)return o}return-1}function b(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(W(a))return s;e[r+s]=a}return s}function E(e,t,r,n){return U(x(t,e.length-r),e,r,n)}function S(e,t,r,n){return U(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function T(e,t,r,n){return U(F(t),e,r,n)}function C(e,t,r,n){return U(function(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function A(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function P(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o,s,a,l,u=e[i],c=null,d=u>239?4:u>223?3:u>191?2:1;if(i+d<=r)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(o=e[i+1]))&&(l=(31&u)<<6|63&o)>127&&(c=l);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(l=(15&u)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(c=l)}null===c?(c=65533,d=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),i+=d}return function(e){var t=e.length;if(t<=R)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=R));return r}(n)}t.kMaxLength=s,l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(r){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return u(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return function(e,t,r){return c(e),e<=0?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)}(e,t,r)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(V(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),V(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=l.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(V(o,Uint8Array))i+o.length>n.length?l.from(o).copy(n,i):Uint8Array.prototype.set.call(n,o,i);else{if(!l.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},l.byteLength=v,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?P(this,0,e):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,r,n,i){if(V(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(n,i),c=e.slice(t,r),d=0;d<a;++d)if(u[d]!==c[d]){o=u[d],s=c[d];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return b(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return S(this,e,t,r);case"base64":return T(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R=4096;function O(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function L(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function M(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=z[e[o]];return i}function w(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function I(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,r,n,i,o){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function N(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,n,o){return t=+t,r>>>=0,o||N(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function j(e,t,r,n,o){return t=+t,r>>>=0,o||N(e,0,r,8),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||I(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||I(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},l.prototype.readInt8=function(e,t){return e>>>=0,t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||I(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||I(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||I(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||I(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||I(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||I(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||D(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||D(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);D(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s|0)-a&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);D(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s|0)-a&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return j(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return j(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=l.isBuffer(e)?e:l.from(e,n),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%a]}return this};var k=/[^+/0-9A-Za-z-_]/g;function x(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function F(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(k,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function V(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function W(e){return e!=e}var z=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}()},9266:function(e){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";function n(){var e=window.navigator.userAgent;return e.indexOf("Android")>-1&&e.indexOf("Mozilla/5.0")>-1&&e.indexOf("AppleWebKit")>-1}r.r(t),r.d(t,"default",function(){return n})},function(e,t,r){"use strict";function n(){var e=window,t=e.chrome,r=e.navigator,n=e.opr,i=r.vendor,o=r.userAgent,s=void 0!==n,a=o.indexOf("Edge")>-1,l=o.match("CriOS"),u=o.match("Chromium");return l||null!==t&&"undefined"!==t&&"Google Inc."===i&&!1===s&&!1===a||u}r.r(t),r.d(t,"default",function(){return n})},function(e,t,r){"use strict";function n(){return window.navigator.userAgent.indexOf("Edge/")>0}r.r(t),r.d(t,"default",function(){return n})},function(e,t,r){"use strict";function n(){return window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1}r.r(t),r.d(t,"default",function(){return n})},function(e,t,r){"use strict";function n(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/");return t>0||r>0}r.r(t),r.d(t,"default",function(){return n})},function(e,t,r){"use strict";function n(){var e=window.opera||window.opr,t=window.navigator.userAgent.match(/Opera|OPR\//);return e&&t}r.r(t),r.d(t,"default",function(){return n})},function(e,t,r){"use strict";function n(){var e=window.navigator,t=e.vendor,r=e.userAgent,n=t&&t.indexOf("Apple")>-1,i=r&&-1==r.indexOf("CriOS")&&-1==r.indexOf("FxiOS");return n&&i}r.r(t),r.d(t,"default",function(){return n})},function(e,t,r){"use strict";function n(){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}r.r(t),r.d(t,"default",function(){return n})},function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"ANDROID",function(){return i}),r.d(n,"CHROME",function(){return o}),r.d(n,"EDGE",function(){return s}),r.d(n,"FIREFOX",function(){return a}),r.d(n,"IE",function(){return l}),r.d(n,"OPERA",function(){return u}),r.d(n,"SAFARI",function(){return c}),r.d(n,"UNKNOWN",function(){return d});var i="android",o="chrome",s="edge",a="firefox",l="ie",u="opera",c="safari",d="unknown",h=r(0),f=r(1),p=r(2),v=r(3),g=r(4),_=r(7),m=r(5),y=r(6);function b(){return Object(f.default)()?o:Object(y.default)()?c:Object(p.default)()?s:Object(v.default)()?a:Object(g.default)()?l:Object(h.default)()?i:Object(m.default)()?u:d}r.d(t,"detect",function(){return b}),r.d(t,"browsers",function(){return n}),r.d(t,"isAndroid",function(){return h.default}),r.d(t,"isChrome",function(){return f.default}),r.d(t,"isEdge",function(){return p.default}),r.d(t,"isFirefox",function(){return v.default}),r.d(t,"isIE",function(){return g.default}),r.d(t,"isMobile",function(){return _.default}),r.d(t,"isOpera",function(){return m.default}),r.d(t,"isSafari",function(){return y.default})}])},function(e,t,r){"use strict";r.r(t),r.d(t,"default",function(){return s});var n=r(0),i="cd1394e6-3fd1-4a2d-ae60-c9ae01f7ee89",o=new Error("Cannot identify whether incognito mode is active");function s(){var e=Object(n.detect)();return new Promise(function(t,r){var s=function(){return t(!0)},a=function(){return t(!1)},l=function(){return r(o)};if(e===n.browsers.CHROME||e===n.browsers.OPERA){var u=window.RequestFileSystem||window.webkitRequestFileSystem;return u?u(0,0,a,s):l()}if(e===n.browsers.FIREFOX){if(!window.indexedDB)return s();var c=window.indexedDB.open(i);c.onerror=s,c.onsuccess=a}if(e===n.browsers.IE||e===n.browsers.EDGE)return window.indexedDB||!window.PointerEvent&&!window.MSPointerEvent?a():s();if(e===n.browsers.SAFARI){try{localStorage[i]=i,localStorage.removeItem(i)}catch(e){return s()}try{window.openDatabase(null,null,null,null)}catch(e){return s()}return a()}return l()})}}])},9318:function(e,t){var r;!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var o=typeof r;if("string"===o||"number"===o)e.push(r);else if(Array.isArray(r)&&r.length){var s=i.apply(null,r);s&&e.push(s)}else if("object"===o)for(var a in r)n.call(r,a)&&r[a]&&e.push(a)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(r=function(){return i}.apply(t,[]))||(e.exports=r)}()},9322:function(e,t){"use strict";t.A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMQAAADEBAMAAAAyiJNYAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAnUExURUdwTJ4pL50oLp0oLp0oLp0oLp0pL50pL50oLqEsMqYyN54rMJwoLjw/TZYAAAAMdFJOUwBJ1J649YRn5R4NM2Y4jIcAAAVaSURBVHja7ZzPTxNBFMe3oMKuHmr8gRoONRoV0kMREw5yqL8gmh5E/BGkh+KPgKaHejEBOVRJMGgPaMR48FCNJh57MWrCQbvddgnzR8lvlnZn5r03MwdNv1eafjq7M++9+b4ZLKuppppq6r/Qm6e9ly+euXXrxcnLveNHtX+9/fRcge2Qf2l8XiPg04M0C5E3cEwT4MdZxtWJZxoAe+8xoU6VFAHOgQKTyO8pqhAiVxhAN6N0wvsCA8l/RCUcZGBdoC2FCYbQLGGR2A8ZSrfRDAdJWGEUTROwDAoByTjCSHoOJ7xjRF2FEtrSVISXAwa+OCOrDAqKTpYpqAp55W+ZkroAwTWthvDkYTfLFFU1Nl/BMzdSUEf44kc1zTSoJlx0TItyJt+19I23Mk1KcBH9uhAuj/CFadM1DiKlD+EafhP8t5HViagZXBOitXFIL2IoJNel9SK8xvz3jWnWK3PLjjtv25h21b/wBf2IkTpEXD+ivJOwhxlQZgei0wTij+nnVPek2pgRBefUVzOIuybXXcPq22uGEIxTuwwhWNLslN05beOmEGXTr2JFJRN1QXiV8NEcYsRE6RFa3ToFcwi/aDJABcNUi0lEzPTbZmxJ3+ZLXHimTCIqaxOKUwY+2Y8S51u81SkVAdUPUvGeRZQfPnQhVkNIO2fRIBG8aJ1f+dsieteJ2p0sC+ZsFYWYFmWlLKyYIw5i7ZemSFZGnTqFC6NAsjLAPtnKtHGgNalI3wXru8hbeVvLBuSJpoVf0obbdYbqpzhjtOJ2naF9iIK4QhCWH69BiA+SIkRYbPqQvocTlxSd4rQ6B0B8lqXWdnHFKB+GI0lpeQmCdUsRMqMsb+2WFL5FaqLY1HVrH9GCAxtlv2WjWM/vAkn3cNdl70KWmuSeQF6OcBUbBTFAuZlRc8BjgK1kVc3GT0J2qzklGx+EqBHyaXC6QGyiqErfKQMa6x9CPg085gjEaIji82lgX2xDPjaKz6eB8sCC/JTQDGuDtqE+1J2YQ+fTYIwDeVEhGdaBOSdV8FavC5tPg4sKtmFtSE2yfBos/tthH+0mNp7ycB+nUqQ1nhIIfyJJazytrlob+FmX1ItY2xSDbbsExWOvoOyoKqV7VsPZLBmCAb6Ec2lrhLZ4EvmTcngXfz0NOGmGfBvwQfhYU34jpiN83c0ftYi0XRG+7hLalY9hzcQk2tBGI6LoXjoWUcE3F7CI5S1EiynEdnSOmELM4/MLEuESmrhIxAgh/CMRGUIDFIcoU9q4OMQoJdvjEBlK9YhClCm7ERxilHS8AYXIkI4VxRDBv0I7aoIZRTdt44YYRZjn16kXsUx0AhCIHPEIFhxRpR4kgyMS1ONwYIRLPtQHRiRotjEC4VJ9YziC7yfacT0IV+HoNBCRIXcioIghclMIivBLxP4cHCE5Pi056gBBuDIjv18VIb9ZkAUgWhUeExAhGsVtemccOArA5QibKSG8x/JB7FFDQC6qLCghjkMajf1yF46PuAPqlqYVEMOga0mtjP6ggJfEZFaFYBSzwKtVKTLiJZAg3RxzEYPQIwQtRATiYuM0DTEMv54pPxeXDwkBXh/iDp28cA4ZBe6qrHwXE6sfxcwk7vxReK7wB590nE0HS7DNiecPYK9gh0ePytq7tA9fZNvHBFaXj39pDH+vNHTRuluP2u64P7X50nrHfpHuxoZFj+F5S6dS5NAGPoDUSDhd1EpojB7eeUuz6qNHeUo3oT56zJR0E+oDT4+lXwvE2EmbsooX9OVT1hssWUa0FWVnjlmGtBFlT0yaAqy3MPT9TwnO0r7RV7JMamLgqGVYRauppv4V/QUPoG/hUBLkNwAAAABJRU5ErkJggg=="},9418:function(e,t,r){"use strict";r.d(t,{Ay:function(){return D},IV:function(){return I.IV},FB:function(){return I.FB},JO:function(){return I.JO}});var n=r(6905),i=r(3292),o=r(3246),s=r(3698),a=r(338),l=r(3554),u=r(479),c=r(6579),d=r(7727);function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach(function(t){p(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function p(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=(e,t)=>new Array(e[t]).fill(null).map((r,n)=>f(f({},e),{},{name:t===d.v.Count?"".concat(e.name,"_").concat(n+1):e.name})),g=r(9322),_=r(889),m=r(5983),y=r(681),b="https:",E=e=>{var{href:t,hostname:r,protocol:n=b,search:i}=e;return"".concat((0,y.A)({hostname:r,protocol:n,search:i}),"/config?url=").concat(encodeURIComponent(t))},S=r(5950),T=(0,S.A)("App initialized"),C=(0,S.A)("Uniqueness params calculated");function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach(function(t){R(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function R(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var O,L={headerLogoUrlBlack:_.A,headerLogoUrl:m.A,siteName:(O=u.N5,O?O[0].toUpperCase()+O.slice(1).toLowerCase():""),domain:"".concat(u.N5,".com"),appIconUrl:g.A},M=(e,t)=>t.get(E(e)),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;return(0,i.A)((t,r,i)=>e(t,r).then(e=>{var{whiteLabel:r,urls:u,features:h,parameters:{modelsApi:f,impression:p,tracking:g}={},abTest:_}=e;if(_){var m="scab_".concat(_.name),y=!1!==_.sticky,b=y?i.get(m):null;if(_.variants=_.variants.reduce((e,t)=>(d.v.Weight in t?e.push(...v(t,d.v.Weight)):d.v.Count in t?e.push(...v(t,d.v.Count)):e.push(t),e),[]),b&&_.variants.some(e=>e.name===b))_.selectedVariant=b;else{var E=(0,l.A)(_.variants);y&&i.set(m,E.name),_.selectedVariant=E.name}}var S=n.z.effect(()=>(e,r)=>{if(e.abTest){var{params:n}=e.abTest.variants.find(t=>t.name===e.abTest.selectedVariant)||{};n&&r((0,c._M)(n));var o=Date.now(),s=["seenAbTest_".concat(e.abTest.name),"seenDomain_".concat(t.hostname),"seenLanding_".concat((0,c.zj)(e).landing)].reduce((e,t)=>{var r,[n]=t.split("_"),s=(e=>parseInt(i.get(e),10))(t),a=!(r=parseInt(String(s),10))||o-r>31968e7;return a&&i.set(t,o),P(P({},e),{},{[n]:Number(!a)})},{});r(C(s))}});return{effects:[n.$.effect(()=>(e,t)=>t((0,s.modelsApiParametersLoaded)(f),(0,a.T)({impression:p,tracking:g}))),n.z.effect(()=>(e,t)=>t(T())),S],reducer:(0,o.A)({appInitialized:!1,origin:t.origin,urls:u,features:h,abTest:_,whiteLabelData:r||P(P({},L),t.hostname.endsWith(".local")?{domain:t.hostname.split(".").slice(-2).join(".")}:{})}).on(C,e=>t=>({abTest:P(P({},t.abTest),{},{uniquenessParams:e})})).on(n.z,()=>({appInitialized:!0}))}})).requires("location","Api","LocalStorage")},I=r(3208),D=w},9773:function(e,t){"use strict";t.A=(e,t)=>function(){return e(...arguments)||t(...arguments)}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n](o,o.exports,r),o.loaded=!0,o.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="/static/9f1b11af/s/widgets/Spot/",r.nc=void 0,function(){"use strict";function e(e,t){for(var r=[],n=[],i=arguments.length;i-- >2;)r.push(arguments[i]);for(;r.length;){var o=r.pop();if(o&&o.pop)for(i=o.length;i--;)r.push(o[i]);else null!=o&&!0!==o&&!1!==o&&n.push(o)}return"function"==typeof e?e(t||{},n):{nodeName:e,attributes:t||{},children:n,key:t&&t.key}}function t(e,t,r,n){var i,o=[].map,s=n&&n.children[0]||null,a=s&&function e(t){return{nodeName:t.nodeName.toLowerCase(),attributes:{},children:o.call(t.childNodes,function(t){return 3===t.nodeType?t.nodeValue:e(t)})}}(s),l=[],u=!0,c=v(e),d=function e(t,r,n){for(var i in n)"function"==typeof n[i]?function(e,i){n[e]=function(e){var o=i(e);return"function"==typeof o&&(o=o(_(t,c),n)),o&&o!==(r=_(t,c))&&!o.then&&p(c=g(t,v(r,o),c)),o}}(i,n[i]):e(t.concat(i),r[i]=v(r[i]),n[i]=v(n[i]));return n}([],c,v(t));return p(),d;function h(e){return"function"==typeof e?h(e(c,d)):null!=e?e:""}function f(){i=!i;var e=h(r);for(n&&!i&&(s=C(n,s,a,a=e)),u=!1;l.length;)l.pop()()}function p(){i||(i=!0,setTimeout(f))}function v(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r}function g(e,t,r){var n={};return e.length?(n[e[0]]=e.length>1?g(e.slice(1),t,r[e[0]]):t,v(r,n)):t}function _(e,t){for(var r=0;r<e.length;)t=t[e[r++]];return t}function m(e){return e?e.key:null}function y(e){return e.currentTarget.events[e.type](e)}function b(e,t,r,n,i){if("key"===t);else if("style"===t)if("string"==typeof r)e.style.cssText=r;else for(var o in"string"==typeof n&&(n=e.style.cssText=""),v(n,r)){var s=null==r||null==r[o]?"":r[o];"-"===o[0]?e.style.setProperty(o,s):e.style[o]=s}else"o"===t[0]&&"n"===t[1]?(t=t.slice(2),e.events?n||(n=e.events[t]):e.events={},e.events[t]=r,r?n||e.addEventListener(t,y):e.removeEventListener(t,y)):t in e&&"list"!==t&&"type"!==t&&"draggable"!==t&&"spellcheck"!==t&&"translate"!==t&&!i?e[t]=null==r?"":r:null!=r&&!1!==r&&e.setAttribute(t,r),null!=r&&!1!==r||e.removeAttribute(t)}function E(e,t){var r="string"==typeof e||"number"==typeof e?document.createTextNode(e):(t=t||"svg"===e.nodeName)?document.createElementNS("http://www.w3.org/2000/svg",e.nodeName):document.createElement(e.nodeName),n=e.attributes;if(n){n.oncreate&&l.push(function(){n.oncreate(r)});for(var i=0;i<e.children.length;i++)r.appendChild(E(e.children[i]=h(e.children[i]),t));for(var o in n)b(r,o,n[o],null,t)}return r}function S(e,t){var r=t.attributes;if(r){for(var n=0;n<t.children.length;n++)S(e.childNodes[n],t.children[n]);r.ondestroy&&r.ondestroy(e)}return e}function T(e,t,r){function n(){e.removeChild(S(t,r))}var i=r.attributes&&r.attributes.onremove;i?i(t,n):n()}function C(e,t,r,n,i){if(n===r);else if(null==r||r.nodeName!==n.nodeName){var o=E(n,i);e.insertBefore(o,t),null!=r&&T(e,t,r),t=o}else if(null==r.nodeName)t.nodeValue=n;else{!function(e,t,r,n){for(var i in v(t,r))r[i]!==("value"===i||"checked"===i?e[i]:t[i])&&b(e,i,r[i],t[i],n);var o=u?r.oncreate:r.onupdate;o&&l.push(function(){o(e,t)})}(t,r.attributes,n.attributes,i=i||"svg"===n.nodeName);for(var s={},a={},c=[],d=r.children,f=n.children,p=0;p<d.length;p++){c[p]=t.childNodes[p],null!=(_=m(d[p]))&&(s[_]=[c[p],d[p]])}p=0;for(var g=0;g<f.length;){var _=m(d[p]),y=m(f[g]=h(f[g]));if(a[_])p++;else if(null==y||y!==m(d[p+1]))if(null==y||u)null==_&&(C(t,c[p],d[p],f[g],i),g++),p++;else{var S=s[y]||[];_===y?(C(t,S[0],S[1],f[g],i),p++):S[0]?C(t,t.insertBefore(S[0],c[p]),S[1],f[g],i):C(t,c[p],null,f[g],i),a[y]=f[g],g++}else null==_&&T(t,c[p],d[p]),p++}for(;p<d.length;)null==m(d[p])&&T(t,c[p],d[p]),p++;for(var p in s)a[p]||T(t,s[p][0],s[p][1])}return t}}var n=r(8062);function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=new class{constructor(){i(this,"subscribers",[])}get(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=(0,n.dF)(e,t);return window.fetch(i,r).then(t=>{if(!t.ok)throw new Error("".concat(t.status," - ").concat(t.statusText));this.onApiCall(e,"get",!0);var r=t.headers.get("Content-Type");return r&&r.includes("json")?t.json():t.text()}).catch(t=>{throw this.onApiCall(e,"get",!1),t})}post(e,t){return window.fetch(e,{method:"POST",body:JSON.stringify(t)}).then(t=>{if(!t.ok)throw t;this.onApiCall(e,"post",!0);var r=t.headers.get("Content-Type");return r&&r.includes("json")?t.json():t.text()}).catch(t=>{throw this.onApiCall(e,"post",!1),t})}subscribe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.subscribers.push({callback:e,conditionFunction:t,deleteAfterCall:r})}onApiCall(e,t,r){this.subscribers=this.subscribers.filter(n=>{var{callback:i,conditionFunction:o,deleteAfterCall:s}=n;return!(!o||o(e,t,r))||(i(e,t,r),!s)})}},s=o;class a{static getIsLocalStorageAvailable(){try{var e="___localStorageTest___";window.localStorage.setItem(e,"123");var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),"123"===t}catch(Di){return!1}}static get(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return a.getIsLocalStorageAvailable()?window.localStorage.getItem(e):t}static set(e,t){return!!a.getIsLocalStorageAvailable()&&window.localStorage.setItem(e,t)}static delete(e){a.getIsLocalStorageAvailable()&&window.localStorage.removeItem(e)}static has(e){return!!a.getIsLocalStorageAvailable()&&Object.prototype.hasOwnProperty.call(window.localStorage,e)}}var l=e=>e,u=!1,c=e=>{if(!u){u=!0;try{r.p="".concat((0,n.$_)(e)).concat(r.p)}catch(Jc){console.error("webpack path cannot be resolved",Jc)}}},d="stripchatWidgets_",h={HAS_USER_AUTHORIZED_EVER:"".concat(d,"_hasUserAuthorizedEver"),HAS_WIDGET_ISABELLA_SHOWN:"".concat(d,"_hasIsabellaWidgetShown"),HAS_WIDGET_JOIN_SHOW_SHOWN:"".concat(d,"_hasJoinHerShowWidgetShown"),HAS_WIDGET_STRIPBOT_SHOWN:"".concat(d,"_hasStripbotWidgetShown"),IS_EXIT_POP_SHOWN_IN_SESSION:"".concat(d,"_isExitPopShownInSession"),LAST_TEST_PARAMS:"".concat(d,"_lastTestParams"),LAST_VIEWED_TIME:"".concat(d,"_lastViewedTime"),WIDGET_CLOSED_BY_CLICK:"".concat(d,"_widgetClosedByClick")},f=Promise.resolve.bind(Promise),p=function(e,r,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l;return class{constructor(e){this.params=e||{},this.playerEnabled=!0}mount(l){var u,{body:d,referrer:p}=document;if(this.params.limitAfterClosure>0){var v=a.get(h.LAST_VIEWED_TIME);if(v)Date.now()-new Date(v).getTime()>6e4*this.params.limitAfterClosure?(a.delete(h.LAST_VIEWED_TIME),this.playerEnabled=!0):this.playerEnabled=!1}return this.playerEnabled?Promise.resolve(e).then((u=c,e=>{var t=u(e);return t&&t.then?t.then(()=>e):e})).then(e=>r.init(o({Api:s,referrer:p,location:{hostname:(0,n.EW)(e),href:(0,n.dF)(e,this.params),origin:"".concat((0,n.Jr)(e),"//").concat((0,n.EW)(e))},body:d,window:window,document:document,globals:{},performance:performance,LocalStorage:a})).mount(t,i,l)).then(e=>{var t=0,r={play:()=>(e.play(),t=1,Promise.resolve()),pause:()=>(e.pause(),t=0,Promise.resolve()),setParams:n=>{var i=!!t;return(i?r.pause():f()).then(()=>e.setParams(n).then(()=>i?r.play():f()))},destroy:()=>(e.terminate(),[...l.childNodes].reverse().forEach(e=>{l.removeChild(e)}),r.play=f,r.pause=f,r.destroy=f,Promise.resolve())};return r}):Promise.reject()}}},v=e=>{var t="script#".concat(e),r=document.querySelectorAll("script"),n=1===r.length?r[0]:document.querySelector(t);if(!n)throw new Error("Script #".concat(e," not found"));return n},g=r(9318),_=r.n(g),m=r(6579),y=(e,t)=>e&&t?{width:"".concat(e,"px"),height:"".concat(t,"px")}:e?{width:"".concat(e,"px"),height:"".concat(e*(185/330),"px")}:t?{width:"".concat(t*(330/185),"px"),height:"".concat(t,"px")}:{width:"".concat(330,"px"),height:"".concat(185,"px")},b={Cover:"cover",Contain:"contain"},E={Top:"top",Bottom:"bottom",Left:"left",Right:"right"},S="win_blur",T="win_focus",C="thumb_appear",A="thumb_disappear",P={TopRight:"topRight",TopLeft:"topLeft",BottomRight:"bottomRight",BottomLeft:"bottomLeft"},R=r(8547),O=r.n(R),L=r(4275),M={insert:"head",singleton:!1},w=(O()(L.A,M),L.A.locals||{}),I=r(846),D=r(889),N=r(5983),B=r(9322),j=r(479),k={small:{width:150,height:113},middle:{width:180,height:135},big:{width:240,height:180}},x={small:{width:150,height:146},middle:{width:180,height:175},big:{width:240,height:232}},F={ON_HOVER:"onHover",ALL:"all",NOT_AT_ALL:"notAtAll"},U={HLS:"hls",CANVAS:"canvas"},V=(D.A,N.A,"".concat(j.N5,".com"),B.A,{S_CHAT_BEST:"SChatBest",DEFAULT:"default",SNAPSHOT:"snapshot",PREVIEW:"preview",AVATAR:"avatar"}),W={best:V.DEFAULT,SCBest:V.S_CHAT_BEST},z={Direct:"direct",IfOnline:"ifOnline",IfOnlineNew:"ifOnlineNew"},G=[{models:[]}];function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach(function(t){Y(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Y(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Q=(e,t,r,n)=>{var i=(0,m.zj)(e),{path:o,query:s={}}=function(e){var{linkToModel:t,modelPromotion:r}=e,{username:n="",modelPromotionId:i,id:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=r?{modelPromotionId:i,modelId:o}:{};switch(t){case z.IfOnline:case z.IfOnlineNew:return{path:"/",query:q({onlineModels:n},s)};default:return{path:"/".concat(n),query:q({},s)}}}(i,t);return(0,I.ih)(e,o,q(q(q(q(q({},r),i.thumbType===V.DEFAULT?{thumbModelId:t.id,thumbUrl:t.thumbUrl}:{}),((e,t)=>{var{sortBy:r}=e,{hasSignupRate:n}=t;return"signupRateSort"===r?{fromSignupRate:n}:{}})(i,t)),s),{},{filtersMatch:t.strict,modelId:t.id}),n)},K=r(6773),X=r(1761),J=function(e){return e.Default="default",e.XH="xh",e.CB="cb",e}({}),Z=(0,X.A)(m.zj,e=>{var{thumbSizeKey:t,design:r}=e;return t?r===J.CB?x[t]:k[t]:{}}),$=r(3292),ee=e=>{var t=[];return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=>(t.find(t=>t.args.length===e.length&&t.args.every((t,r)=>t===e[r]))||{}).result)(n)||((e,r)=>(t.push({args:e,result:r}),r))(n,e(...n))}},te=r(6905),re=r(3246),ne=e=>!e.hidden;function ie(e){try{return e.self!==e.top}catch(Jc){return!0}}var oe=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];clearTimeout(t),t=setTimeout(()=>{t=null,e(...i)},r)}},se=r(5950),ae=(0,se.A)("Terminate"),le=(0,se.A)("Window blurred"),ue=(0,se.A)("Window focused"),ce=(0,se.A)("Window scrolled"),de=(0,se.A)("Window resized");function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function fe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach(function(t){pe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function pe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ve=e=>t=>{var{window:r}=t;return{window:fe(fe({},r),e)}},ge=(0,$.A)((e,t)=>{var r=ee(e=>()=>e(le())),n=ee(e=>()=>e(ue())),i=ee(t=>()=>t(ce(e.scrollY))),o=t=>t(de({height:e.innerHeight,width:e.innerWidth})),s=ee(e=>oe(()=>o(e),300)),a=te.z.effect(()=>(t,a)=>{e.addEventListener("blur",r(a)),e.addEventListener("focus",n(a)),e.addEventListener("scroll",i(a)),e.addEventListener("resize",s(a)),o(a)}),l=ae.effect(()=>(t,o)=>{e.removeEventListener("blur",r(o)),e.removeEventListener("focus",n(o)),e.removeEventListener("scroll",i(o)),e.removeEventListener("resize",s(o))});return{reducer:(0,re.A)({referrer:t,window:{iFramed:ie(e),hasFocus:ne(e.document),scrollTop:0,height:e.innerHeight,width:e.innerWidth}}).on(ce,e=>ve({scrollTop:e})).on(de,ve).on(le,()=>ve({hasFocus:!1})).on(ue,()=>ve({hasFocus:!0})),effects:[a,l],actions:{terminate:()=>(e,t)=>t(ae())}}}).requires("window","referrer"),_e=r(1981),me="appearance_and_behaviour",ye={acceptedParamsConfig:[{key:"nonNudeContent",title:"Non nude content",description:"Show only non nude content, if nonNudeContent=1, autoplay forced to notAtAll, backgroundImage Will be forsed to non nude",section:me,type:_e.A.BOOL,default:!1}]},be=((0,$.A)(()=>({effects:[(0,m.I0)(ye)]})),(0,X.A)(m.zj,e=>{var{nonNudeContent:t}=e;return!!t})),Ee=(0,X.A)(be,m.zj,(e,t)=>{var{autoplay:r,queryParams:n}=t;return e&&!n.autoplay||r===F.NOT_AT_ALL}),Se=((0,X.A)(m.zj,e=>{var{autoplayForce:t}=e;return t}),e=>!Ee(e)),Te=["ar-SA","zh-CN","hr-HR","cs-CZ","nl-NL","fi-FI","fr-FR","de-DE","el-GR","he-IL","hu-HU","it-IT","ja-JP","ko-KR","nb-NO","es-ES","pl-PL","pt-PT","pt-BR","ro-RO","ru-RU","sv-SE","th-TH","tr-TR","uk-UA","vi-VN"],Ce="en",Ae=()=>{};function Pe(){var e=window.MediaSource||window.WebKitMediaSource;if(!e)return!1;var t=window.SourceBuffer||window.WebKitSourceBuffer,r=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!r&&!!n}var Re=r(8767),Oe={insert:"head",singleton:!1},Le=(O()(Re.A,Oe),Re.A.locals||{}),Me=e=>{var{createVideo:t,stream:r,modelId:n}=e;return e=>{t({video:e,stream:r,modelId:n})}},we=t=>{var{modelId:r,stream:n,isCircleView:i,muted:o=!0}=t;return(t,s)=>{var{createVideo:a=Ae}=s,l=Pe(),u=n.url.includes(".mp4");return e("div",{className:Le.root},e("div",{className:_()(Le.inner,{[Le.circle]:i})},e("video",{key:r,id:r,oncreate:Me({createVideo:a,stream:n,modelId:r}),autoplay:l&&!u,playsinline:!0,preload:"none",muted:o,disableRemotePlayback:!0})))}},Ie=t=>{var{player:r,modelId:n,key:i,model:o,isCircleView:s,muted:a}=t;switch(!0){case o.stream.local:case r===U.HLS:return e(we,{stream:o.stream,key:i,modelId:n,isCircleView:s,muted:a});default:return null}},De=r(7934),Ne={insert:"head",singleton:!1},Be=(O()(De.A,Ne),De.A.locals||{});function je(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ke(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?je(Object(r),!0).forEach(function(t){xe(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):je(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function xe(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Fe=null,Ue=()=>{},Ve=(e,t)=>{var{play:r=Ue}=t;return()=>{r(e)}},We=(e,t)=>{var{pause:r=Ue}=t;return()=>{r(e)}},ze=(e,t)=>{var{pause:r=Ue,play:n=Ue}=t;return t=>{Array.from(document.querySelectorAll("button")).some(e=>e===t.target||e.contains(t.target))||(r(),Fe=setTimeout(()=>{n(e)},300))}},Ge=(e,t,r)=>{var{onItemCreate:n=Ue,observeIntersections:i=Ue}=r;return t=>{n({modelId:e}),i({key:"thumb",node:t,selector:()=>({modelId:e})})}},He=()=>{clearTimeout(Fe)},qe=t=>{var{key:r,model:n,linkToSection:i,isPlayOnHoverEnabled:o,isPlayingEnabled:s,showModelName:a,className:l,content:u=()=>null,blurredBackground:c=!1,blurredPrivate:d=!0,header:h=null,footer:f=null,additionalClickParams:p={},modelUrlName:v="click"}=t;return(t,g)=>{var{onExitLinkClick:y=Ue}=g,{player:E,playButton:S,thumbFit:T,thumbPlace:C}=(0,m.zj)(t),{id:A,stream:P}=n,R=o&&(!be(t)||P.local),O=(e=>{var{thumbWidth:t,thumbHeight:r}=e;return(0,K.A)(t)||(0,K.A)(r)?Z(e):{width:t,height:r}})(t),L=(null==n?void 0:n.prerollImageUrl)||(P.static?n.staticImageUrl:n.thumbUrl),M=ke(ke(ke({},"public"!==n.status&&d?{filter:"blur(25px)",transform:"scale(1.1)"}:{}),T===b.Contain?{backgroundImage:"url(".concat(L,")")}:{}),t.isThumbsSizeFixed?{width:"".concat(O.width,"px"),height:"".concat(O.height,"px")}:{}),w=((e,t)=>(e.playingState||{})[t])(t,A),D=i?(0,I.ih)(t):Q(t,n,p,v);return e("a",{class:_()(Be.root,l,{[Be.withShadow]:a}),href:D,id:"model-".concat(A),key:A,oncreate:Ge(A,0,g),onmouseenter:R?Ve(A,g):Ue,onmouseleave:R?We(A,g):Ue,ontouchcancel:R?He:Ue,ontouchend:R?He:Ue,ontouchstart:R||w?ze(A,g):Ue,style:M,onclick:y,target:"_blank",rel:"noopener"},e("img",{style:{objectFit:T,objectPosition:C||"center"},class:Be.img,src:L,alt:t.i18n&&t.i18n.locale===Ce?t.i18n.t("{$username} webcam, sex chat, nude photos, and sex videos").replace("{$username}",n.username):n.username}),c&&e("div",{className:Be.background,style:{backgroundImage:M.backgroundImage}}),e("div",{class:Be.header},h),s&&e(Ie,{player:E,modelId:A,key:r,model:n,actions:g}),!w&&S&&e("svg",{class:Be.playButton,width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e("rect",{width:"48",height:"48",rx:"24",fill:"black","fill-opacity":"0.4"}),e("path",{d:"M18.5 18.618C18.5 17.8747 19.2823 17.3912 19.9472 17.7236L30.7111 23.1056C31.4482 23.4741 31.4482 24.5259 30.7111 24.8944L19.9472 30.2764C19.2823 30.6088 18.5 30.1253 18.5 29.382V18.618Z",fill:"white",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round"})),e(u,null),e("div",{className:Be.footer},f))}},Ye=r(192),Qe={insert:"head",singleton:!1},Ke=(O()(Ye.A,Qe),Ye.A.locals,()=>e("svg",{style:{display:"none"}},e("defs",null,e("symbol",{id:"icon-female"},e("path",{d:"m27,24.1c14.3,0 26,11.6 26,25.9c0,13.2 -9.8,24 -22.5,25.7l0,5.7l5.5,0l0,5.5l-5.5,0l0,5.5l-6.8,0l0,-5.5l-5.5,0l0,-5.5l5.5,0l0,-5.7c-12.8,-1.7 -22.6,-12.5 -22.6,-25.7c0,-14.3 11.6,-25.9 25.9,-25.9zm0,6.8c-10.6,0 -19.1,8.5 -19.1,19.1s8.5,19.1 19.1,19.1c10.6,0 19.1,-8.5 19.1,-19.1s-8.5,-19.1 -19.1,-19.1z",fill:"#D63F9B"})),e("symbol",{id:"icon-females"},e("g",{fill:"#D63F9B"},e("path",{d:"M33.4 24.1c5.1 0 9.8 1.5 13.8 4 3.9 2.5 7.1 5.9 9.2 10 1.9 3.6 2.9 7.6 2.9 11.9 0 4.3-1 8.3-2.9 11.9-2.1-1.8-3.7-4.1-4.6-6.8.5-1.6.7-3.3.7-5.1 0-1.8-.2-3.5-.7-5.1-1.4-5-4.8-9.2-9.2-11.6-2.7-1.5-5.8-2.3-9.2-2.3-10.5 0-19.1 8.6-19.1 19.1s8.6 19.1 19.1 19.1c3.3 0 6.5-.9 9.2-2.3 1.3 1.9 2.9 3.7 4.6 5.2-3.1 1.9-6.6 3.3-10.4 3.8v5.7h5.5v5.5h-5.5v5.5H30v-5.5h-5.5v-5.5H30v-5.7C17.3 74.1 7.5 63.2 7.5 50c0-14.3 11.6-25.9 25.9-25.9z"}),e("path",{d:"M66.6 24.1c14.3 0 25.9 11.6 25.9 25.9 0 13.2-9.8 24-22.5 25.7v5.7h5.5v5.5H70v5.5h-6.8v-5.5h-5.5v-5.5h5.5v-5.7c-3.8-.5-7.3-1.8-10.4-3.8-3.9-2.5-7.1-5.9-9.2-10.1-1.8-3.6-2.9-7.6-2.9-11.9 0-4.3 1-8.3 2.9-11.9 2.1 1.8 3.7 4.2 4.6 6.9-.4 1.6-.7 3.3-.7 5 0 1.7.2 3.4.7 5 1.4 5.1 4.7 9.3 9.2 11.8 2.7 1.5 5.9 2.4 9.2 2.4 10.5 0 19.1-8.6 19.1-19.1s-8.6-19.1-19.1-19.1c-3.3 0-6.5.9-9.2 2.4-1.3-1.9-2.9-3.7-4.6-5.2 4-2.6 8.7-4 13.8-4z"}))),e("symbol",{id:"icon-femaleTranny"},e("g",null,e("path",{d:"M30.1 24.1c5.1 0 9.8 1.5 13.8 4 3.9 2.5 7.1 5.9 9.2 10C55 41.7 56 45.7 56 50c0 4.3-1 8.3-2.9 11.9-2.1-1.8-3.7-4.1-4.6-6.8.5-1.6.7-3.3.7-5.1 0-1.8-.2-3.5-.7-5.1-1.4-5-4.8-9.2-9.2-11.6-2.7-1.5-5.8-2.3-9.2-2.3C19.6 31 11 39.5 11 50.1s8.5 19.1 19.1 19.1c3.3 0 6.4-.8 9.2-2.3 1.3 1.9 2.9 3.7 4.6 5.2-3.1 1.9-6.6 3.3-10.4 3.8v5.7H39v5.5h-5.5v5.5h-6.8v-5.5h-5.5v-5.5h5.5v-5.7C14 74 4.2 63.2 4.2 50c0-14.3 11.6-25.9 25.9-25.9z",fill:"#D63F9B"}),e("path",{d:"M49.5 71.9c-3.9-2.5-7.1-5.9-9.2-10.1-1.8-3.6-2.9-7.6-2.9-11.9 0-4.3 1-8.3 2.9-11.9 2.1 1.8 3.7 4.2 4.6 6.9-.4 1.6-.7 3.3-.7 5 0 1.7.2 3.4.7 5 1.4 5.1 4.7 9.3 9.2 11.8 2.7 1.5 5.9 2.4 9.2 2.4 10.5 0 19.1-8.5 19.1-19.1s-8.5-19.1-19.1-19.1c-3.3 0-6.5.9-9.2 2.4-1.3-1.9-2.9-3.7-4.6-5.2 4-2.5 8.8-4 13.8-4 6 0 11.4 2 15.8 5.4l5.1-5.1-4.7-4.7 16.2-1.9L93.8 34l-4.7-4.7-5.1 5c3.3 4.4 5.3 9.8 5.3 15.7 0 13.2-9.8 24-22.5 25.7v5.7h5.5v5.5h-5.5v5.5H60v-5.5h-5.5v-5.5H60v-5.7c-3.9-.5-7.4-1.8-10.5-3.8zM31.3 20.7c4.2.2 8.1 1.3 11.7 3l4.1-4.1L31 17.7l.3 3z",fill:"#A862FF"}))),e("symbol",{id:"icon-male"},e("path",{d:"M82.4 17.7l-1.9 16.2-4.7-4.7-5.2 5.2c3.3 4.4 5.3 9.8 5.3 15.7C75.9 64.4 64.3 76 50 76c-14.3 0-25.9-11.6-25.9-25.9s11.6-26 25.9-26c6 0 11.4 2 15.8 5.4l5.1-5.2-4.7-4.7 16.2-1.9zM50 30.9c-10.5 0-19.1 8.6-19.1 19.1S39.5 69.1 50 69.1c10.5 0 19.1-8.6 19.1-19.1S60.6 30.9 50 30.9z",fill:"#61ACEC"})),e("symbol",{id:"icon-maleFemale"},e("g",null,e("path",{d:"M95.8 17.7l-1.9 16.2-4.7-4.7-5.2 5.1c3.3 4.4 5.3 9.8 5.3 15.7 0 14.3-11.6 25.9-25.9 25.9-5.1 0-9.8-1.5-13.9-4-3.9-2.5-7.1-5.9-9.2-10.1-1.8-3.6-2.9-7.6-2.9-11.9 0-4.3 1-8.3 2.9-11.9 2.1 1.8 3.7 4.2 4.6 6.9-.4 1.6-.7 3.3-.7 5 0 1.7.2 3.4.7 5 1.4 5.1 4.7 9.3 9.2 11.8 2.7 1.5 5.9 2.4 9.2 2.4 10.5 0 19.1-8.5 19.1-19.1 0-10.1-7.9-18.4-17.9-19.1h-1.2c-3.3 0-6.5.9-9.2 2.4-1.3-1.9-2.9-3.7-4.6-5.2 4-2.5 8.8-4 13.8-4 5.7 0 11.3 1.9 15.8 5.4l5.1-5.1-4.7-4.7 16.3-2z",fill:"#61ACEC"}),e("path",{d:"M30.1 24.1c5.1 0 9.8 1.5 13.8 4 3.9 2.5 7.1 5.9 9.2 10C55 41.7 56 45.7 56 50c0 4.3-1 8.3-2.9 11.9-2.1-1.8-3.7-4.1-4.6-6.8.5-1.6.7-3.3.7-5.1 0-1.8-.2-3.5-.7-5.1-1.4-5-4.8-9.2-9.2-11.6-2.7-1.5-5.8-2.3-9.2-2.3C19.6 31 11 39.5 11 50.1s8.5 19.1 19.1 19.1c3.3 0 6.4-.8 9.2-2.3 1.3 1.9 2.9 3.7 4.6 5.2-3.1 1.9-6.6 3.3-10.4 3.8v5.7H39v5.5h-5.5v5.5h-6.8v-5.5h-5.5v-5.5h5.5v-5.7C14 74 4.2 63.2 4.2 50c0-14.3 11.6-25.9 25.9-25.9z",fill:"#D63F9B"}))),e("symbol",{id:"icon-males"},e("g",{fill:"#61ACEC"},e("path",{d:"M62.6 17.7l-1.9 16.2-4.7-4.8-5.2 5.2c3.3 4.4 5.3 9.8 5.3 15.7 0 4.3-1 8.4-2.9 11.9-2.1-1.8-3.7-4.1-4.6-6.8 0 0 .7-3.4.7-5.2 0-10.6-8.6-19.1-19.1-19.1-10.6.1-19.2 8.7-19.2 19.3s8.6 19.1 19.1 19.1c3.3 0 6.4-.8 9.2-2.3 1.3 1.9 2.9 3.7 4.6 5.2h-.2C39.7 74.6 35 76 30 76 15.7 76 4 64.4 4 50s11.6-26 26-26c6 0 11.5 2 15.8 5.4l5.2-5.2-4.7-4.7 16.3-1.8z"}),e("path",{d:"M95.8 17.7l-1.9 16.2-4.7-4.7-5.2 5.1c3.3 4.4 5.3 9.8 5.3 15.7 0 14.3-11.6 26-26 26-5.1 0-9.9-1.5-13.9-4-3.9-2.5-7.1-6-9.2-10.1-1.8-3.6-2.9-7.6-2.9-11.9 0-4.3 1-8.3 2.9-11.9 2.1 1.8 3.7 4.2 4.6 6.9-.4 1.6-.7 3.3-.7 5 0 1.7.2 3.4.7 5 1.4 5.1 4.7 9.3 9.2 11.8 2.7 1.5 5.9 2.4 9.2 2.4 10.6 0 19.1-8.6 19.1-19.1 0-10.2-7.9-18.5-17.9-19.1l.8-6.8c5.2.4 9.9 2.3 13.8 5.3l5.2-5.2-4.7-4.7 16.3-1.9z"}))),e("symbol",{id:"icon-maleTranny"},e("g",null,e("path",{d:"M49.5 71.9c-3.9-2.5-7.1-5.9-9.2-10.1-1.8-3.6-2.9-7.6-2.9-11.9 0-4.3 1-8.3 2.9-11.9 2.1 1.8 3.7 4.2 4.6 6.9-.4 1.6-.7 3.3-.7 5 0 1.7.2 3.4.7 5 1.4 5.1 4.7 9.3 9.2 11.8 2.7 1.5 5.9 2.4 9.2 2.4 10.5 0 19.1-8.5 19.1-19.1 0-10.1-7.9-18.4-17.9-19.1l.8-6.8c5.2.4 9.9 2.3 13.8 5.3l5.1-5.1-4.7-4.7 16.2-1.9-1.9 16.2-4.7-4.7-5.1 5.1c3.3 4.4 5.3 9.8 5.3 15.7 0 13.2-9.8 24-22.5 25.7v5.7h5.5v5.5h-5.5v5.5H60v-5.5h-5.5v-5.5H60v-5.7c-3.9-.5-7.4-1.8-10.5-3.8zM31.3 20.7c4.2.2 8.1 1.3 11.7 3l1.4-1.4-3.4-3.4-10-1.2.3 3z",fill:"#A862FF"}),e("path",{d:"M62.6 17.7l-1.9 16.2-4.7-4.7-5.2 5.2c3.3 4.4 5.3 9.8 5.3 15.7 0 4.3-1 8.4-2.9 11.9-2.1-1.8-3.7-4.1-4.6-6.8 0 0 .7-3.4.7-5.2 0-10.5-8.5-19.1-19.1-19.1-10.5 0-19.1 8.5-19.1 19.1s8.5 19.1 19.1 19.1c3.3 0 6.4-.8 9.1-2.3 1.3 1.9 2.9 3.7 4.6 5.2h-.2c-4 2.5-8.6 3.9-13.7 3.9C15.8 75.9 4.2 64.3 4.2 50s11.6-25.9 25.9-25.9c6 0 11.4 2 15.8 5.4l5.1-5.1-4.7-4.7 16.3-2z",fill:"#61ACEC"}))),e("symbol",{id:"icon-tranny"},e("path",{d:"M50 24.1c6 0 11.4 2 15.8 5.4l5.1-5.1-4.7-4.7 16.2-1.9L80.5 34l-4.7-4.7-5.2 5.2c3.3 4.4 5.3 9.8 5.3 15.7 0 13.2-9.8 24-22.5 25.7v5.7h5.5v5.5h-5.5v5.5h-6.8v-5.5h-5.5v-5.5h5.5v-5.7C33.9 74 24.1 63.2 24.1 50c0-5.9 2-11.4 5.3-15.8l-5.1-5.1-4.7 4.7-1.9-16.2 16.2 1.9-4.7 4.7 5.1 5.1c4.3-3.2 9.8-5.2 15.7-5.2zm0 6.8c-10.5 0-19.1 8.5-19.1 19.1S39.5 69.1 50 69.1c10.5 0 19.1-8.5 19.1-19.1S60.6 30.9 50 30.9z",fill:"#A862FF"})),e("symbol",{id:"icon-trannies"},e("g",{fill:"#A862FF"},e("path",{d:"M33.4 24.1c5.7 0 11.3 1.9 15.8 5.4l5.1-5.1-4.7-4.7 16.2-1.9L63.9 34l-4.7-4.7-5.2 5c3.4 4.5 5.3 10 5.3 15.7 0 4.3-1 8.3-2.9 11.9-2.1-1.8-3.7-4.1-4.6-6.8.4-1.6.7-3.3.7-5.1 0-10.5-8.5-19.1-19.1-19.1-10.5 0-19.1 8.5-19.1 19.1s8.5 19.1 19.1 19.1c3.3 0 6.5-.9 9.2-2.3 1.3 1.9 2.9 3.7 4.6 5.2-3.1 1.9-6.6 3.3-10.4 3.8v5.7h5.5V87h-5.5v5.5H30V87h-5.5v-5.5H30v-5.7C17.2 74 7.4 63.2 7.4 50c0-5.9 2-11.4 5.3-15.8l-5.1-5.1-4.7 4.7L1 17.7l16.2 1.9-4.7 4.7 5.1 5.1c4.4-3.3 9.8-5.3 15.8-5.3z"}),e("path",{d:"M52.7 71.9c-3.9-2.5-7.1-5.9-9.2-10.1-1.8-3.6-2.9-7.6-2.9-11.9 0-4.3 1-8.3 2.9-11.9 2.1 1.8 3.7 4.2 4.6 6.9-.4 1.6-.7 3.3-.7 5 0 1.7.2 3.4.7 5 1.4 5.1 4.7 9.3 9.2 11.8 2.7 1.5 5.9 2.4 9.2 2.4 10.5 0 19.1-8.5 19.1-19.1 0-10.1-7.9-18.4-17.9-19.1l.8-6.8c5.2.4 9.9 2.3 13.8 5.3l5.1-5.1-4.7-4.7L99 17.7l-1.9 16.2-4.7-4.7-5.2 5.2c3.3 4.4 5.3 9.8 5.3 15.7 0 13.2-9.8 24-22.5 25.7v5.7h5.5V87H70v5.5h-6.8V87h-5.5v-5.5h5.5v-5.7c-3.8-.6-7.4-1.9-10.5-3.9zM34.6 20.7c4.2.2 8.1 1.3 11.7 3l1.4-1.4-3.4-3.4-10.1-1.2.4 3z"})))))),Xe=r(946),Je={insert:"head",singleton:!1},Ze=(O()(Xe.A,Je),Xe.A.locals||{}),$e=(t,r)=>{var{color:n,big:i}=t;return e("div",{class:_()(Ze.root,{[Ze.big]:i}),style:{backgroundColor:n}},r)},et=r(6904),tt={insert:"head",singleton:!1},rt=(O()(et.A,tt),et.A.locals||{}),nt=t=>{var{color:r,big:n,dotColor:i,capitalize:o,hideDot:s,onlyDot:a,className:l}=t,u=n?"small":"span",c=o?"Live":"LIVE";return a?e("div",{className:rt.dotLive,style:{backgroundColor:r}}):e($e,{color:r,big:n},e("div",{className:_()(rt.root,l)},!s&&e("span",{className:_()(rt.online,{[rt.big]:n}),style:{backgroundColor:i}}),e(u,null,c)))},it=t=>{var{big:r}=t;return e($e,{color:"#566fff",big:r},"VR")},ot=r(541),st={insert:"head",singleton:!1},at=(O()(ot.A,st),ot.A.locals||{}),lt=t=>{var{left:r,right:n}=t;return e("div",{class:at.root},r&&e("div",{class:at.left},r),n&&e("div",{class:at.right},n))},ut=r(6926),ct={insert:"head",singleton:!1},dt=(O()(ut.A,ct),ut.A.locals||{}),ht=t=>{var{liveBadge:r,showVRBadge:n,big:i}=t;return e("div",{class:_()(dt.root,{[dt.big]:i})},e(lt,{left:r,right:n?e(it,{big:i}):null}))},ft=e=>{var{broadcastGender:t,gender:r}=e;return"group"===t?r:t},pt=e=>{return e.broadcastVR||(t=e.tags,r="autoTagVr",t&&t.length&&-1!==t.indexOf(r));var t,r};function vt(){return vt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vt.apply(null,arguments)}var gt=(t,r)=>{var{href:n}=t,i="http://www.w3.org/1999/xlink",o=(e,t)=>{n?e.setAttributeNS(i,"href",n):t&&n===t.href||e.removeAttributeNS(i,"href")};return e("use",vt({},t,{oncreate:o,onupdate:o}),r)},_t=t=>{var{href:r,className:n,viewBox:i="0 0 100 100"}=t;return e("svg",{class:_()("icon",[n]),viewBox:i},e(gt,{href:r}))},mt=r(1512),yt={insert:"head",singleton:!1},bt=(O()(mt.A,yt),mt.A.locals||{}),Et=t=>{var{rightBadges:r,leftBadges:n,model:i,responsive:o,hideOnSmallSpots:s,hideModelName:a=!1,genderIcon:l=!0,big:u,modelName:c=""}=t;return e("div",{class:_()(bt.root,{[bt.big]:u,[bt.hideOnSmallSpots]:s})},e(lt,{left:i&&!a&&[e("div",{"qa-element":"model-name",className:_()(bt.modelName,{[bt.modelNameResponsive]:o})},c||i.screenName||i.username),...l?[e(_t,{href:"#icon-".concat(ft(i)),className:o?bt.iconResponsive:null})]:[],...n?[n]:[]],right:r}))},St=r(709),Tt={insert:"head",singleton:!1},Ct=(O()(St.A,Tt),St.A.locals||{}),At=r(9418),Pt=r(2698),Rt={insert:"head",singleton:!1},Ot=(O()(Pt.A,Rt),Pt.A.locals||{}),Lt=e=>!e,Mt=t=>{var{username:r,status:n}=t;return t=>{var{siteName:i,themePalette:{primary:o="#a2252d"}={}}=(0,At.JO)(t);return e("div",{className:Ot.root},e("div",null,e("h1",{className:Ot.head},r," is currently"," ",Lt(n)?"offline":"on private session"),Lt(n)?e("div",null,"Check out similar models on"," ",e("a",{target:"_blank",style:{color:o},href:(0,I.GN)("goToTheRoom",t)},i)):e("div",null,"Check out her room on"," ",e("a",{target:"_blank",style:{color:o},href:(0,I.ih)(t,"/".concat(r))},i))))}},wt={},It=t=>{var{fontSize:r="22px",lpomega:n=!1,model:i=null}=t;return t=>{var{hideModelName:o,hideLiveBadge:s,liveBadgeColor:a,modelName:l}=(0,m.zj)(t),u=i||t.modelsList[0]||wt,c="public"===u.status;return e("div",{className:Ct.layoutWrapper,style:{fontSize:r}},e(Ke,null),u===wt?e(Mt,{username:l}):[e(qe,{key:"player",model:u,header:e(ht,{showVRBadge:pt(u)&&!n,liveBadge:!n&&!s&&e(nt,{color:a})}),footer:!o&&!n&&e(Et,{model:u}),isPlayingEnabled:Se(t)&&c,blurredBackground:n}),c?null:e(Mt,{username:u.username,status:u.status})])}},Dt=r(3847);function Nt(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}var Bt=function(){var e=function(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){Nt(o,n,i,s,a,"next",e)}function a(e){Nt(o,n,i,s,a,"throw",e)}s(void 0)})}}(function*(e){for(var t of e)try{return yield t()}catch(r){}return null});return function(t){return e.apply(this,arguments)}}(),jt=Bt,kt=["ar","br","cz","de","en","es","fr","gr","hu","it","jp","nl","no","pl","pt","ro","ru","sw","tr","ja","sv","el","cs","zh","ko"];var xt=(e,t,r)=>{var i,o,{hostname:s,href:a}=e,l=function(e){var t=e.match(new RegExp("^(.*\\.|)(".concat(kt.join("|"),")\\..*$")));return t&&t[2]}(s)||(i=a,null!==(o=(0,n.Vw)(i).language)&&void 0!==o?o:null)||t.language,u={hit:[],partialHit:[]};return r.forEach(e=>{if(e!==l){if(2===l.length||"-"===l[2]){var t=l.slice(0,2);e.startsWith(t)&&u.partialHit.push(e)}}else u.hit.push(e)}),[...u.hit,...u.partialHit,Ce]};function Ft(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ft(Object(r),!0).forEach(function(t){zt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ft(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Vt(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function Wt(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){Vt(o,n,i,s,a,"next",e)}function a(e){Vt(o,n,i,s,a,"throw",e)}s(void 0)})}}function zt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Gt{constructor(e,t){zt(this,"i18nPaths",void 0),zt(this,"data",{}),zt(this,"locale",Ce),zt(this,"hostname",void 0),zt(this,"checkSameLocale",(e,t)=>e.every(e=>{var{locale:r}=e;return r===t})),this.hostname=t,this.i18nPaths=e}init(e){var t=this;return Wt(function*(){var r,n,i=yield Promise.all(t.i18nPaths.map(r=>t.loadTranslationFile(r,e))),o=i.reduce((e,t)=>{var{data:r}=t;return Ut(Ut({},e),r)},{}),s=null!==(r=null===(n=i[0])||void 0===n?void 0:n.locale)&&void 0!==r?r:Ce;return t.checkSameLocale(i,s)?t.locale=s:t.locale=Ce,t.data=o,t})()}loadTranslationFile(e,t){var n=this;return Wt(function*(){var i=e.startsWith("/")?"/static/9f1b11af/s":r.p||"",o=e.startsWith("http")?e:"https://".concat(n.hostname).concat(i).concat(e),a=t.map(e=>Wt(function*(){return{data:yield s.get("".concat(o,"/").concat(e,".json")),locale:e}})),l=yield jt(a);return null!=l?l:{data:{},locale:Ce}})()}t(e,t){var r="number"==typeof t,n=r?function(){var e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split("|");return r[((e,t)=>{switch(t){case"bo":case"dz":case"id":case"ja":case"jv":case"ka":case"km":case"kn":case"ko":case"ms":case"th":case"tr":case"vi":case"zh":default:return 0;case"af":case"az":case"bn":case"bg":case"ca":case"da":case"de":case"el":case"en":case"eo":case"es":case"et":case"eu":case"fa":case"fi":case"fo":case"fur":case"fy":case"gl":case"gu":case"ha":case"he":case"hu":case"is":case"it":case"ku":case"lb":case"ml":case"mn":case"mr":case"nah":case"nb":case"ne":case"nl":case"nn":case"no":case"om":case"or":case"pa":case"pap":case"ps":case"pt":case"so":case"sq":case"sv":case"sw":case"ta":case"te":case"tk":case"ur":case"zu":return 1===e?0:1;case"am":case"bh":case"fil":case"fr":case"gun":case"hi":case"hy":case"ln":case"mg":case"nso":case"xbr":case"ti":case"wa":return 0===e||1===e?0:1;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2;case"cs":case"sk":return 1===e?0:e>=2&&e<=4?1:2;case"ga":return 1===e?0:2===e?1:2;case"lt":return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2;case"sl":return e%100==1?0:e%100==2?1:e%100==3||e%100==4?2:3;case"mk":return e%10==1?0:1;case"mt":return 1===e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3;case"lv":return 0===e?0:e%10==1&&e%100!=11?1:2;case"pl":return 1===e?0:e%10>=2&&e%10<=4&&(e%100<12||e%100>14)?1:2;case"cy":return 1===e?0:2===e?1:8===e||11===e?2:3;case"ro":return 1===e?0:0===e||e%100>0&&e%100<20?1:2;case"ar":return 0===e?0:1===e?1:2===e?2:e>=3&&e<=10?3:e>=11&&e<=99?4:5}})(e,t.slice(0,2))]||r[0]||void 0}(this.data[e],t,this.locale):this.data[e];if(void 0===n)return e;try{return r?(0,Dt.sprintf)(n,t):n}catch(Di){return console.error(Di),n}}}var Ht=(t,r)=>{var{message:n,count:i,context:o}=t;return t=>e("span",null,t.i18n.t(n||r[0],i,o))};var qt,Yt,Qt,Kt=t=>{var{actions:r}=t;return t=>{var{spot:{closable:n},modelsList:i}=t,{hideButton:o,thumbsMargin:s}=(0,m.zj)(t),a=1===i.length;return e("div",{style:{gap:a?"0px":"".concat(s,"px")},className:w.rootContent},i.map(r=>e("div",{className:w.modelWrapper},!o&&e("a",{className:_()(w.ctaButton,{[w.ctaButtonSingle]:a}),target:"_blank",href:Q(t,r)},e(Ht,null,"Live sex")),e(It,{model:r,fontSize:"16px"}))),n&&e("button",{className:w.closeButton,onclick:r.handleClose,type:"button"},"Close ad "))}},Xt=r(3698),Jt=r(3208),Zt=r(6628),$t=r(3614),er=(qt=Array.isArray.bind(Array),Yt=e=>"[".concat(e.reduce((e,t)=>{var{key:r,value:n}=t;return(0,K.A)(n)?e:[...e,"".concat(r,"=").concat(n)]},[]).join("|"),"]"),Qt=l,function(){return qt(...arguments)?Yt(...arguments):Qt(...arguments)}),tr=["filterOptions"],rr=["models","defaultTags","total","prevailingGender"];function nr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ir(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(r),!0).forEach(function(t){or(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function or(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sr(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var ar=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{filterOptions:n}=r,i=sr(r,tr),o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4?arguments[4]:void 0;return e.get((0,Jt.FB)(t,s||"modelsApi"),(0,Zt.A)(ir(ir(ir({landing:(0,m.zj)(t).landing},i),n?{filterOptions:er(n)}:{}),i.stripcashR?{cb:Math.abs((0,$t.A)("".concat(Math.random()).concat(Date.now())))}:{})),o?{credentials:"include",mode:"cors"}:{}).then(e=>{var{models:t,defaultTags:r=[],total:n,prevailingGender:i}=e;return{prevailingGender:i,tags:r,meta:sr(e,rr),total:n,models:t}})},lr=e=>t=>t.reduce((t,r)=>t+(r[e]?1:0),0),ur=lr("inWatchHistory"),cr=lr("inFavorites");function dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function hr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(r),!0).forEach(function(t){fr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function fr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pr={acceptedParamsConfig:[{key:"forceClient",type:_e.A.BOOL,default:!0,private:!0},{key:"usePreroll",section:me,type:_e.A.BOOL},{key:"strict",type:_e.A.BOOL,private:!0},{key:"tag",type:_e.A.STRING,convertValue:e=>"couple"===e?"couples":e,private:!0},{key:"limit",title:"Limit of models to show",description:"Limit can not be greater than defined by creative",type:_e.A.INT,min:1,private:!0},{key:"stripcashR",title:"Retargeting",description:"Parameter to get in resposne necessary data and sorting for retargeting campaigns",section:me,type:_e.A.BOOL,default:!1},{key:"sortBy",private:!0,type:_e.A.ENUM,enum:["signupRateSort"]},{key:"linkToModel",title:"Link to model",description:"determines location of click by model, direct to models page or throw checking her online status",section:me,type:_e.A.ENUM,multiple:!1,enum:Object.values(z),default:z.IfOnlineNew,private:!0},{key:"modelPromotion",title:"Model promotion",description:"",section:me,type:_e.A.BOOL,default:!1}]},vr=r(2712),gr=r(3911);function _r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function mr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_r(Object(r),!0).forEach(function(t){yr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function yr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var br=(0,X.A)(m.zj,e=>{var{modelsLimit:t,limit:r=1/0}=e;return Math.min(r,t)}),Er=(0,X.A)(m.zj,e=>{var{lovescapeModelsLimit:t,limit:r=1/0}=e;return Math.min(r,t)}),Sr=["".concat(j.ky,"R"),"forceClient","usePreroll","modelPromotion"],Tr=(0,X.A)(m.zj,e=>{var{modelsApiParameters:t}=e;return t},(e,t)=>mr(mr({},(0,vr.A)((e,r)=>!(0,gr.A)(e)&&t.includes(r),e.queryParams)),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.reduce((e,r)=>(Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]),e),{})}(Sr,e))),Cr=(0,X.A)(Tr,Jt.xp,br,(e,t,r)=>mr(mr(mr({},e),t),{},{limit:r})),Ar=(0,X.A)(Tr,Er,(e,t)=>mr(mr({},e),{},{limit:t})),Pr=(0,X.A)(m.zj,e=>{var{quality:t}=e;return t});function Rr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Or(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rr(Object(r),!0).forEach(function(t){Lr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Lr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Mr=(e,t)=>Object.keys(e.stream.urls).reduce((e,r)=>Or(Or({},e),{},{[r]:t}),{});function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ir(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(Object(r),!0).forEach(function(t){Dr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Dr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Nr=(e,t)=>{var r;return 0===(null==t||null===(r=t.models)||void 0===r?void 0:r.length)?e:Ir(Ir({},e),{},{models:null==e?void 0:e.models.map((r,n)=>{if(n<e.meta.requestedLimit){var i=null==t?void 0:t.models[n];return i?Ir(Ir(Ir({},r),i),{},{stream:Ir(Ir(Ir({},r.stream),i.stream),{},{urls:Mr(r,i.stream.url)})}):r}return r})})};var Br=function(e){return new Promise((t,r)=>{var n=document.createElement("video");n.src=e,n.crossOrigin="anonymous",n.currentTime=1,n.onloadeddata=()=>{var e=document.createElement("canvas");e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d").drawImage(n,0,0,e.width,e.height),t(e.toDataURL("image/jpeg"))},n.onerror=e=>r(e)})},jr=()=>({models:[]}),kr=(e,t,r,i)=>{var o=(0,n.dF)((0,At.FB)(r,"prerollsUrl"),{videosList:i.join(",")});return e.get(o).then(e=>{var{videos:t=[]}=e;return Promise.all(t.map(e=>Br(e).then(e=>e).catch(()=>""))).then(e=>({models:e.map((e,r)=>{var n=t[r],i=(e=>{var t=e.split("/");return t[t.length-1].split(".").shift()})(n);return{screenName:i,prerollImageUrl:e,stream:{url:n,urls:{original:n}}}})})).catch(jr)}).catch(jr)};function xr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Fr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(r),!0).forEach(function(t){Ur(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ur(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Vr=e=>e.slice(0,2).reduce((e,t)=>Fr(Fr(Fr({},t),e),{},{models:[...e.models,...t.models]}),{models:[]}),{impressionReadyEvent:Wr}=r(4343),{modelsApiLoaded:zr}=r(3698),Gr=zr.effectOnce(()=>(e,t)=>{t(Wr())});function Hr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function qr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hr(Object(r),!0).forEach(function(t){Yr(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hr(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Yr(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Qr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"modelsApi",t=arguments.length>1?arguments[1]:void 0;return(0,$.A)((r,n)=>{var i=Xt.modelsLoadedEvent.effect(()=>(e,t)=>t((0,Xt.modelsReadyEvent)())),o=Xt.replaceModelByModel.effect(e=>{var{replaceBy:{id:t}}=e;return(e,r)=>r((0,Xt.modelsReadyEvent)({id:t}))}),s=Xt.startLoadingModels.effect(t=>(i,o)=>{o((0,Xt.modelsLoadingStarted)());var{videosList:s=[],landing:a="",queryParams:l}=(0,m.zj)(i),u=s.length>0&&"LPAkira"===a,c=qr(qr({},Cr(i)),t),d=[ar(r,i,c,"verticalModelsApi"!==e,e)];return"ls"===(null==l?void 0:l.lpversion)&&d.push(((e,t,r,n)=>new Promise(i=>ar(e,t,n,!0,r).then(e=>i(e)).catch(()=>i(G))))(r,i,"loveScapeModelsApi",qr(qr({},Ar(i)),t))),u&&d.push(kr(r,n,i,s)),Promise.all(d).then(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[G],r=t[0];return"ls"===(null==l?void 0:l.lpversion)&&(r=Vr(t)),u&&(r=Nr(r,t[t.length-1])),o((null===(e=r)||void 0===e||null===(e=e.models)||void 0===e?void 0:e.length)>0?(0,Xt.modelsLoadedEvent)(r):(0,Xt.modelsNotLoadedEvent)(qr(qr({},r),{},{requestParams:c})),(0,Xt.modelsApiLoaded)(r))})});return{reducer:(0,re.A)({prevailingGender:"female",isLoading:!1,modelsApiParameters:[],modelsList:[],isThumbsSizeFixed:!1,modelsMeta:{shownModelsCount:0,modelsInWatchHistoryCount:-1,modelsInFavoritesCount:-1}}).on(Xt.replaceModelByModel,e=>{var{modelId:t,replaceBy:r}=e;return e=>{var{modelsList:n}=e;return{modelsList:n.map(e=>e.id===t?r:e)}}}).on(Xt.modelsApiParametersLoaded,function(){return{modelsApiParameters:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}}).on(Xt.modelThumbRenderedEvent,()=>e=>{var{modelsMeta:t}=e;return{modelsMeta:hr(hr({},t),{},{shownModelsCount:t.shownModelsCount+1})}}).on(Xt.modelsLoadingStarted,()=>()=>({isLoading:!0})).on(Xt.modelsApiLoaded,e=>{var{tags:t,meta:r,prevailingGender:n}=e;return e=>({prevailingGender:n||e.prevailingGender,tags:t,isLoading:!1,modelsMeta:hr(hr(hr({},e.modelsMeta),r),{},{shownModelsCount:0})})}).on(Xt.modelsLoadedEvent,e=>{var{models:t}=e;return e=>({modelsList:t,modelsMeta:hr(hr({},e.modelsMeta),{},{modelsInWatchHistoryCount:(0,m.zj)(e).stripcashR?ur(t):-1,modelsInFavoritesCount:(0,m.zj)(e).stripcashR?cr(t):-1})})}),effects:[(0,m.I0)(pr),i,o,...void 0===t?[Gr]:[],s],actions:{onItemCreate:e=>{var{modelId:t}=e;return(e,r)=>r((0,Xt.modelThumbRenderedEvent)({modelId:t}))}}}}).requires("Api","location")},Kr=Qr,Xr=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>t.forEach(t=>t(e))},Jr=(e,t,r)=>function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ae,o=[],s=()=>Xr(...o)();t&&o.push(e(t,Xr(n,s),!0)),r&&o.push(e(r,Xr(i,s),!0))},Zr=(e,t)=>r=>(n,i,o)=>{var s=Cr(n);return i((0,m._M)(t(r))),JSON.stringify(s)===JSON.stringify(Cr(n))?Promise.resolve():(i(e()),new Promise(Jr(o,Xt.modelsLoadedEvent,Xt.modelsNotLoadedEvent)).catch(e=>{var{requestParams:t}=e,r=new Error("Models response is empty!");return r.requestParams=t,Promise.reject(r)}))},$r=r(6561),en=r.n($r),tn=()=>{var e=new(en()),t={emit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];r.forEach(t=>{var{name:r,payload:n}=t;return e.emit(r,n)})},on:(r,n)=>(r.once?e.once(r.eventName,n):e.on(r.eventName,n),t),off:(r,n)=>(e.off(r.eventName,n),t),once:(r,n)=>(e.once(r.eventName,n),t)};return t},rn=["$update","$effect"];function nn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function on(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(r),!0).forEach(function(t){sn(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nn(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function sn(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var an=e=>{var t,{modules:r}=e,n=[...r],i=tn(),o=i.emit,s=function(e,t){return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?i.once(e,t):i.on(e,t),()=>{i.off(e,t)}};return{addModules(e){return n.push(...e),this},init(e){return t=Promise.all(n.map(t=>t(on({},e)))).then(e=>e.reduce((e,t)=>({reducers:[...e.reducers,...t.reducer?[t.reducer]:[]],initialState:on(on({},e.initialState),(t.reducer||{}).initialState),effects:[...e.effects,...t.effects||[]],actions:Object.keys(t.actions||{}).reduce((e,r)=>{return on(on({},e),{},{[r]:(n=t.actions[r],e=>t=>{var r=n(e);return"function"==typeof r?r(t,o,s):r})});var n},e.actions)}),{initialState:{},reducers:[],effects:[],actions:{$effect:e=>t=>{"function"==typeof e&&e(t,o,s)},$update:e=>t=>"function"==typeof e?e(t):e}})),this},mount(e,r,n){return n&&n.firstChild&&n.insertBefore(document.createElement("div"),n.firstChild),t.then(t=>{var s,{initialState:a,actions:l,reducers:u,effects:c}=t,d=e(a,l,r,n),{$update:h,$effect:f}=d,p=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(d,rn);return u.forEach(e=>e.bind(i,h)),(s=c,s.reduce((e,t)=>e.concat(t),[])).forEach(e=>{var{event:t,effect:r,options:n}=e,o=e=>f(r(e));n.once?i.once(t,o):i.on(t,o)}),o((0,te.$)(),(0,te.z)()),p.dispatch=o,p})}}};function ln(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function un(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ln(Object(r),!0).forEach(function(t){cn(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ln(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function cn(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var dn=()=>{var e={},t={};return{waitFor(e){var r,n=this.get(e);if(n)return Promise.resolve(n);var i=new Promise(e=>{r=e});return t[e]=[...t[e]||[],r],i},create(r,n){e[r]=n,(t[r]||[]).forEach(e=>e(n))},update(t,r){e[t]=un(un({},e[t]||{}),r)},get(t){return e[t]},all(){return Object.values(e)},clearTimeouts(e){var t=this.get(e);t&&(clearTimeout(t.recoveryTimeout),delete t.recoveryTimeout)},clearPlayingInterval(e){var t=this.get(e);t&&clearInterval(t.playingInterval)}}},hn=e=>{var{video:t,onPlay:r,onError:n,onMetaLoaded:i}=e,o=()=>n({fatal:!1,type:"mp4"});t.addEventListener("loadedmetadata",i),t.addEventListener("error",o),t.addEventListener("abort",o),t.addEventListener("timeupdate",r)},fn={height:"auto",width:"100%",maxHeight:"unset"},pn={width:"auto",height:"100%",maxWidth:"unset"},vn={height:"100%",width:"100%"},gn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{thumbFit:r,thumbPlace:n}=arguments.length>2?arguments[2]:void 0,i={};if(!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])){if(r===b.Contain)i=vn;else{var o=e.parentElement,s=o.offsetHeight,a=o.offsetWidth,{height:l=e.videoHeight,width:u=e.videoWidth}=t;i=a/s-u/l>0?fn:pn}n&&Object.values(E).includes(n)&&(i.objectPosition=n)}Object.assign(e.style,i)};var _n=e=>{switch(e){case V.S_CHAT_BEST:return"popularSnapshotUrl";case V.PREVIEW:return"previewUrl";case V.AVATAR:return"avatarUrl";default:return"snapshotUrl"}},mn=(0,X.A)(m.zj,(e,t)=>t,(e,t)=>{var{thumbType:r,queryParams:n}=e;if(!n.thumbType&&t.staticImageUrl)return"staticImageUrl";var i=_n(r);return t[i]?i:_n()}),yn=(e,t)=>!!((e,t)=>{var{thumbsByModelId:r}=t;return r[e]||{}})(e,t).visible,bn=e=>{var t=be(e);return function(){var{stream:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t?e.local:!e.static}},En=(e,t,r)=>{if("vertical"===(0,m.zj)(e).landing)return!0;var{window:{hasFocus:n,iFramed:i},limitExceeded:o}=e;if(o||!e.modelsList[r]||!bn(e)(e.modelsList[r]))return!1;var s=yn(t,e);return(0,m.zj)(e).autoplay===F.ALL&&(s&&(i||n))},Sn=(e,t)=>{for(var r=0;r<t.length;){if(e(t[r]))return r;r+=1}return-1},Tn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return e.modelsList.map(e=>{var{id:t}=e;return t}).filter(e=>!t||e===t)},Cn=(0,se.A)("Model start playing"),An=(0,se.A)("Model(s) stop playing"),Pn=(0,se.A)("Model(s) is playing"),Rn=(0,se.A)("Player is gone"),On=(0,se.A)("Player data downloaded"),Ln=(0,se.A)("Player disabled"),Mn=(0,se.A)("Player enabled"),wn=(0,se.A)("Window blured or focused"),In=(0,se.A)("Send playback error"),Dn=(0,se.A)("Set failed to play count"),Nn=r(4080),Bn=[401,403,404],jn=e=>{var t,{video:r,stream:n,modelId:i,quality:o,onPlay:s,onError:a,onDownload:l,thumbFit:u,thumbPlace:c,isVertical:d}=e,{urls:h={},url:f}=n,p=!1,v=h[o]||f,g=e=>{var{detail:t}=e;l(t.netStats.sizeInKb),s()};return{pause:()=>(t&&p&&(t.stop(),p=!1),Promise.resolve()),play:()=>{if(t)return p||(s(),p=!0,t.setStreamConfig({HLSStreamUrl:v}),t.start()),Promise.resolve();gn(r,n,{thumbFit:u,thumbPlace:c},d),t=new Nn.yD,p=!0,s();var e=(e=>{var{modelId:t,onError:r,instance:n}=e;return e=>{var{detail:{httpStatusCode:i,resourceType:o,reason:s}}=e,a=(document.cookie.includes("sc-dev-hls"),"manifest"===o||i>500);(a||Bn.includes(i))&&(a&&n.destroy(),r({fatal:a,type:"hls",response:{text:s,code:i},modelId:t}))}})({modelId:i,onError:a,instance:t});return t.on(Nn.zQ.FRAG_LOADED,g),t.on(Nn.zQ.STREAM_LOAD_ERROR,e),t.setPlayerType(Nn.xG.HLS),t.setStreamConfig({HLSStreamUrl:v}),t.setVideoElement(r),t.start(),Promise.resolve()},destroy:()=>{t&&t.destroy()}}},kn=e=>{var{video:t,stream:r,quality:n,onPlay:i,onError:o,thumbFit:s,isUsePreroll:a}=e,{urls:l={},url:u}=r;t.src=a?u:l[n]||u,hn({video:t,onPlay:i,onError:o,onMetaLoaded:()=>{t.setAttribute("metaloaded","true"),gn(t,void 0,s)}})},xn=(e,t,r)=>{var{video:n,stream:i,modelId:o}=e,s=function(e){var{urls:t={}}=e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;if("optimal"===r){var i=Object.keys(t).reduce((e,t)=>{var r=parseFloat(t);return Number.isNaN(r)?e:[...e,r]},[]).sort().find(e=>e>=n);return i&&"".concat(i,"p")}return t[r]?r:void 0}(i,Pr(t),n.clientHeight),{usePreroll:a,thumbFit:l,thumbPlace:u,landing:c}=(0,m.zj)(t),d=i.url.includes(".mp4"),h={video:n,stream:i,modelId:o,thumbFit:l,thumbPlace:u,isVertical:"vertical"===c,quality:s,onPlay:()=>r(Pn({modelId:o})),onError:e=>r(Rn(e)),onDownload:e=>r(On(e)),isUsePreroll:a},{urls:f={},url:p}=i,v=f[s]||p,g={video:n,stream:i,modelId:o,quality:s,streamUrl:v};switch(!0){case i.local:case d:kn(h);break;case Pe():g.hls=jn(h);break;case!!n.canPlayType("application/vnd.apple.mpegurl"):kn(h)}return g},Fn=(0,se.A)("Model updated"),Un=(0,se.A)("Thumb appeared"),Vn=(0,se.A)("Thumb disappeared"),Wn=(0,se.A)("traffic limit exceeded"),zn=(0,se.A)("traffic consumed"),Gn=r(681),Hn="sCashGuestId",qn=e=>{if(e.has(Hn))return e.get(Hn);var t=[...Array(64)].map(()=>Math.floor(16*Math.random()).toString(16)).join("");return e.set(Hn,t,90),t},Yn=(e,t)=>{var r=[],n=[],i=null,o=0,s=()=>r[0]&&e(r[0]);return{get items(){return r},get size(){return o},setOrder:e=>{n=e},isHeadedWith:e=>r[0]===e,append(e){r.includes(e)||(r=[...r,e].sort((e,t)=>n.indexOf(e)-n.indexOf(t)),o+=1)},remove(e){var n=r.length;(r=r.filter(t=>t!==e)).length<n&&(o-=1),t(e)},replace(e,t){this.remove(e),this.append(t)},run:e=>{r=n.filter(t=>e.playingState[t]),i=setInterval(s,300)},stop:()=>{clearInterval(i)},enough:()=>{r=[],o=0,n.forEach(t)},destroy(){this.stop(),this.enough()},next(){r.shift(),s()}}},Qn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).some(r=>t[r]===e)},Kn={key:"autoplay",title:"Autoplay",description:"\n    Possible values:\n    \n    onHover - default, play/stop on thumb's mouse hover/leave\n    all - the first 3 thumbs are playing immediately if a page is in focus and thumbs are in viewport, other thumbs are playing on hover. Autoplay stops after 1 min, thumbs can be played on hover.\n    notAtAll - thumbs are not playing.\n    forced to notAtAll, if nonNudeContent=1\n    Available values : onHover, all, notAtAll\n  ",section:me,type:_e.A.ENUM,enum:Object.values(F),default:F.ON_HOVER,multiple:!1},Xn=()=>Pe()||Boolean(document.createElement("video").canPlayType("application/vnd.apple.mpegurl")),Jn=["fatal","type","modelId"];function Zn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function $n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zn(Object(r),!0).forEach(function(t){ei(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zn(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ei(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ti=6e4,ri=e=>t=>{var{modelId:r,force:n}=t;return t=>({playingState:$n($n({},t.playingState),{},{[r]:n||En(t,r,Sn(e=>{var{id:t}=e;return t===r},t.modelsList))===e&&e})})},ni=e=>e.modelsList.filter(bn(e)).map(e=>{var{id:t}=e;return t}),ii=(0,$.A)((e,t,r,n)=>{var i,{navigator:o}=e,s=dn(),a=(0,re.A)({playingState:{},playerEnabled:!0,isPlaybackErrorSent:!1,failedToPlayCount:0,viewEventTimes:{}}).on(Xt.modelsReadyEvent,()=>e=>({playingState:e.modelsList.reduce((t,r,n)=>{var{id:i}=r;return $n($n({},t),{},{[i]:En(e,i,n)})},{})})).on(Cn,ri(!0)).on(An,ri(!1)).on(Dn,e=>e).on(Ln,()=>({playerEnabled:!1})).on(Mn,()=>({playerEnabled:!0})).on(wn,e=>t=>({viewEventTimes:$n($n({},t.viewEventTimes),{},{[e]:Date.now()})})).on(In,()=>({isPlaybackErrorSent:!0})),l=Yn((e=>t=>{var{video:r,hls:n,playing:i=Promise.resolve(),isPlaying:o=!1}=e.get(t)||{};r&&!o&&e.update(t,{playing:i.then(()=>Promise.resolve(n?n.play():r.play()).catch(Ae)),isPlaying:!0})})(s),(e=>t=>{var{video:r,hls:n,playing:i=Promise.resolve(),isPlaying:o}=e.get(t)||{};r&&o&&(e.clearTimeouts(t),e.update(t,{playing:i.then(()=>Promise.resolve(n?n.pause():r.pause()).catch(Ae)),isPlaying:!1}))})(s)),u=On.effect(e=>(t,r)=>r(zn(e))),c=Wn.effect(()=>(e,t)=>{t(...Tn(e).map(e=>An({modelId:e}))),l.stop()}),d=te.z.effect(()=>(e,t)=>{e.config.nonStopPlaying||setTimeout(()=>{t(Ln())},6e4)}),h=Ln.effect(()=>l.enough()),f=Cn.effect(e=>{var{modelId:n,force:i}=e;return e=>{var{playingState:o,playerEnabled:a}=e;if(a&&o[n]&&l.size<3||i){l.append(n);var{landing:u,queryParams:{userId:c,smartpopId:d,masterSmartpopId:h,sourceId:f,creativeId:p,p1:v}}=(0,m.zj)(e);if((0,At.IV)("storePlay")(e).enabled){var g=s.get(n),_=null!=g&&g.hls?"hls":"video";null!=g&&g.playingInterval&&s.clearPlayingInterval(n),s.update(n,{playingInterval:setInterval(()=>{var e,i,o,a=s.get(n).playingTime||0;a%ti===0&&(e=a/ti,i=(0,Gn.A)(r),o={type:_,minute:e,landing:u,domain:r.hostname,userId:c,smartpopId:d,masterSmartpopId:h,sourceId:f,creativeId:p,p1:v},t.post("".concat(i,"/metric/store/play"),{message:o})),s.update(n,{playingTime:a+1e3})},1e3)})}}}}),p=An.effect(e=>{var{modelId:t}=e;return e=>{var{playingState:r}=e;r[t]||(l.remove(t),s.clearPlayingInterval(t))}}),v=Pn.effect(e=>{var{modelId:t}=e;l.isHeadedWith(t)&&l.next(),s.clearTimeouts(t)}),g=Xt.modelsReadyEvent.effectOnce(()=>e=>{l.setOrder(ni(e)),l.run(e)}),_=Xt.replaceModelByModel.effect(e=>{var{modelId:t,replaceBy:r}=e;return e=>s.waitFor(r.id).then(()=>{l.setOrder(ni(e)),l.replace(t,r.id)})}),y=Rn.effect(e=>{var{fatal:i,type:o,modelId:a}=e,l=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Jn);return(e,u)=>{var c=s.get(a),{landing:d,thumbFit:h,queryParams:{userId:f=""}}=(0,m.zj)(e),p=(0,At.IV)("storePlaybackError")(e);if(!i&&!e.isPlaybackErrorSent&&p.enabled){var v,g=(0,Gn.A)(r),_=(null==l||null===(v=l.response)||void 0===v?void 0:v.text)||"";t.post("".concat(g,"/metric/store/creative-playback-error"),{message:$n($n({type:o,error:!0,landing:d,guestId:qn(n)},f?{userId:f}:[]),_?{errorMessage:_}:[])}),u(In())}!i&&e.window.hasFocus&&c&&(c.hls?c.hls.play():e.failedToPlayCount<=10&&((e=>{for(var{stream:t,video:r,onPlay:n,onError:i,thumbFit:o}=e,s=r.parentElement,a=s.getElementsByTagName("video"),l=a.length-1;l<0;l--)a[l].id!==r.id&&s.removeChild(a[l]);var u=document.createElement("video");u.id=Math.random(),u.src=t.url,u.muted="muted",u.playsinline="playsinline",u.style.height=r.style.height,u.style.width="auto",r.parentElement.appendChild(u),u.load(),u.addEventListener("loadedmetadata",()=>{u.play()}),hn({video:u,onPlay:n,onError:i,onMetaLoaded:()=>{u.setAttribute("metaloaded","true"),gn(u,void 0,o)}})})({thumbFit:h,stream:c.stream,video:c.video,onPlay:()=>u(Pn({modelId:a})),onError:e=>u(Rn($n($n({},e),{},{modelId:a})))}),u(Dn(e.failedToPlayCount+1))),c.recoveryTimeout||s.update(a,{recoveryTimeout:setTimeout(()=>{u(Rn({modelId:a,fatal:!0})),c.hls&&c.hls.destroy()},3e3)}))}}),E=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return()=>(r,n)=>(n(wn(e)),n(...r.modelsList.map((e,n)=>{var{id:i}=e;return En(r,i,n)?Cn({modelId:i,force:t}):An({modelId:i,force:t})})))},P=le.effect(E(S)),R=ue.effect(E(T,!0)),O=Un.effect(E(C)),L=Vn.effect(E(A)),M=ae.effect(()=>{l.destroy(),clearInterval(null)});return{reducer:a,effects:[O,L,g,_,(0,m.I0)((i=/Chrome/.test(o.userAgent)&&/Google Inc/.test(o.vendor),{acceptedParamsConfig:[Kn,{key:"player",title:"Player engine",description:"",section:me,type:_e.A.ENUM,enum:Object.values(U),isAccepted:e=>!(!Qn(e,U)||e===U.HLS&&!Xn()),default:U.HLS,convertValue:e=>e===U.HLS&&100*Math.random()<=100&&Xn()?U.HLS:U.CANVAS,private:!0},{key:"thumbFit",section:me,type:_e.A.ENUM,default:b.Cover,enum:Object.values(b),title:"Thumb Fit",multiple:!1},{key:"hideLiveBadge",title:"Hide live badge",description:"",type:_e.A.BOOL,section:me,default:!1,convertValue:(e,t)=>{var{hideLiveBadge:r,showLiveBadge:n="1"}=t;return r?Boolean(Number(r)):!Number(n)}},{key:"hideModelName",title:"Hide model name",description:"",type:_e.A.BOOL,section:me,default:!1,convertValue:(e,t)=>{var{hideModelName:r,showModelName:n="1"}=t;return r?Boolean(Number(r)):!Number(n)}},{key:"autoplayForce",section:me,type:_e.A.BOOL,default:!i},{key:"playButton",title:"Show play button",section:me,type:_e.A.BOOL,default:!1},{key:"quality",title:"Video quality for models list",description:"It`s possible to choose quality for models videos",type:_e.A.ENUM,section:me,enum:["original","optimal","720p","480p","240p","160p"],default:"original",multiple:!1}],initialConfig:{randomAutoplayEnabled:!1}})),f,p,v,y,P,R,M,c,u,d,h],actions:{play:e=>(t,r)=>{(e?[e]:t.modelsList.map(e=>{var{id:t}=e;return t})).forEach(e=>{r(Cn({modelId:e,force:!0}))})},pause:e=>(t,r)=>r(...Tn(t,e).map(e=>An({modelId:e}))),createVideo:e=>{var{video:t,stream:r,modelId:n}=e;return(e,i)=>(0,m.zj)(e).player===U.HLS&&s.create(n,xn({video:t,stream:r,modelId:n},e,i))}}}}).requires("window","Api","location","LocalStorage"),oi=ii,si=r(9773),ai=e=>Qn(e,V),li=(0,si.A)(ai,e=>!!W[e]),ui=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.S_CHAT_BEST;return{acceptedParamsConfig:[{key:"thumbType",title:"Thumb type",description:"determines which property to use as thumb SChatBest: best icon of stripchat (popularSnapshotUrl) SCashBest: ab - testing of snapshots using stripcash api snapshot: latest snapshot (snapshotUrl) preview: icon setted by model as preview depreated thumb: alias of snapshot SCbest: alias of SChatBest",section:me,type:_e.A.ENUM,multiple:!1,enum:[V.S_CHAT_BEST,V.DEFAULT,V.AVATAR],isAccepted:(e,t)=>{var{thumbsSource:r,thumbs:n,xhThumbType:i}=t;return[e,r,n,i].some(li)},default:e,convertValue:(t,r)=>{var{thumbsSource:n,thumbs:i,xhThumbType:o}=r;return(e=>ai(e)?e:W[e])([n,i,o,t].find(li)||e)}}]}},ci=["id"];function di(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function hi(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?di(Object(r),!0).forEach(function(t){fi(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):di(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function fi(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pi=e=>t=>{var{modelId:r}=t;return t=>{var{thumbsByModelId:n}=t;return{thumbsByModelId:hi(hi({},n),{},{[r]:hi(hi({},n[r]),e)})}}},vi=function(){var e,{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t?e=>e.id===t:(e=!0,()=>e)},gi=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.S_CHAT_BEST;return(0,$.A)(()=>{var t=(0,re.A)({thumbsByModelId:{}}).on(Un,pi({visible:!0})).on(Vn,pi({visible:!1})).on(Xt.modelsReadyEvent,e=>t=>{var r=vi(e);return{modelsList:t.modelsList.map(e=>r(e)?hi(hi({},e),{},{thumbUrl:e[mn(t,e)]}):e)}}).on(Fn,e=>{var{id:t}=e,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,ci);return e=>{var{modelsList:n=[]}=e;return{modelsList:n.map(e=>e.id===t?hi(hi({},e),r):e)}}}),r=Xt.modelsReadyEvent.effect(e=>(t,r)=>{var{modelsList:n}=t;return n.filter(vi(e)).forEach(e=>{var t,{id:n,snapshotUrl:i,thumbUrl:o,broadcastMobile:s}=e;r(zn(s?15:25)),(t=o,new Promise((e,r)=>{var n=new Image;n.onerror=()=>r(),n.onload=()=>e(t),n.src=t})).catch(()=>r(Fn({id:n,thumbUrl:i})))})});return{reducer:t,effects:[(0,m.I0)(ui(e)),r]}}).requires("Api")},_i=gi,mi=r(4343),yi="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,bi="9.46.0",Ei=globalThis;function Si(){return Ti(Ei),Ei}function Ti(e){var t=e.__SENTRY__=e.__SENTRY__||{};return t.version=t.version||bi,t[bi]=t[bi]||{}}function Ci(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ei,n=r.__SENTRY__=r.__SENTRY__||{},i=n[bi]=n[bi]||{};return i[e]||(i[e]=t())}var Ai=["debug","info","warn","error","log","assert","trace"],Pi={};function Ri(e){if(!("console"in Ei))return e();var t=Ei.console,r={},n=Object.keys(Pi);n.forEach(e=>{var n=Pi[e];r[e]=t[e],t[e]=n});try{return e()}finally{n.forEach(e=>{t[e]=r[e]})}}function Oi(){Bi().enabled=!0}function Li(){Bi().enabled=!1}function Mi(){return Bi().enabled}function wi(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Ni("log",...t)}function Ii(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Ni("warn",...t)}function Di(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];Ni("error",...t)}function Ni(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];yi&&Mi()&&Ri(()=>{Ei.console[e]("".concat("Sentry Logger ","[").concat(e,"]:"),...r)})}function Bi(){return yi?Ci("loggerSettings",()=>({enabled:!1})):{enabled:!1}}var ji={enable:Oi,disable:Li,isEnabled:Mi,log:wi,warn:Ii,error:Di},ki=[];function xi(e){var t,r=e.defaultIntegrations||[],n=e.integrations;if(r.forEach(e=>{e.isDefaultInstance=!0}),Array.isArray(n))t=[...r,...n];else if("function"==typeof n){var i=n(r);t=Array.isArray(i)?i:[i]}else t=r;return function(e){var t={};return e.forEach(e=>{var{name:r}=e,n=t[r];n&&!n.isDefaultInstance&&e.isDefaultInstance||(t[r]=e)}),Object.values(t)}(t)}function Fi(e,t){for(var r of t)null!=r&&r.afterAllSetup&&r.afterAllSetup(e)}function Ui(e,t,r){if(r[t.name])yi&&ji.log("Integration skipped because it was already installed: ".concat(t.name));else{if(r[t.name]=t,-1===ki.indexOf(t.name)&&"function"==typeof t.setupOnce&&(t.setupOnce(),ki.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),"function"==typeof t.preprocessEvent){var n=t.preprocessEvent.bind(t);e.on("preprocessEvent",(t,r)=>n(t,r,e))}if("function"==typeof t.processEvent){var i=t.processEvent.bind(t),o=Object.assign((t,r)=>i(t,r,e),{id:t.name});e.addEventProcessor(o)}yi&&ji.log("Integration installed: ".concat(t.name))}}function Vi(e){var t=[];e.message&&t.push(e.message);try{var r=e.exception.values[e.exception.values.length-1];null!=r&&r.value&&(t.push(r.value),r.type&&t.push("".concat(r.type,": ").concat(r.value)))}catch(n){}return t}var Wi=Object.prototype.toString;function zi(e){switch(Wi.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return $i(e,Error)}}function Gi(e,t){return Wi.call(e)==="[object ".concat(t,"]")}function Hi(e){return Gi(e,"ErrorEvent")}function qi(e){return Gi(e,"DOMError")}function Yi(e){return Gi(e,"String")}function Qi(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function Ki(e){return null===e||Qi(e)||"object"!=typeof e&&"function"!=typeof e}function Xi(e){return Gi(e,"Object")}function Ji(e){return"undefined"!=typeof Event&&$i(e,Event)}function Zi(e){return Boolean((null==e?void 0:e.then)&&"function"==typeof e.then)}function $i(e,t){try{return e instanceof t}catch(r){return!1}}function eo(e){return!("object"!=typeof e||null===e||!e.__isVue&&!e._isVue)}var to=Ei;function ro(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"<unknown>";try{for(var r,n=e,i=[],o=0,s=0,a=Array.isArray(t)?t:t.keyAttrs,l=!Array.isArray(t)&&t.maxStringLength||80;n&&o++<5&&!("html"===(r=no(n,a))||o>1&&s+3*i.length+r.length>=l);)i.push(r),s+=r.length,n=n.parentNode;return i.reverse().join(" > ")}catch(u){return"<unknown>"}}function no(e,t){var r=e,n=[];if(null==r||!r.tagName)return"";if(to.HTMLElement&&r instanceof HTMLElement&&r.dataset){if(r.dataset.sentryComponent)return r.dataset.sentryComponent;if(r.dataset.sentryElement)return r.dataset.sentryElement}n.push(r.tagName.toLowerCase());var i=null!=t&&t.length?t.filter(e=>r.getAttribute(e)).map(e=>[e,r.getAttribute(e)]):null;if(null!=i&&i.length)i.forEach(e=>{n.push("[".concat(e[0],'="').concat(e[1],'"]'))});else{r.id&&n.push("#".concat(r.id));var o=r.className;if(o&&Yi(o)){var s=o.split(/\s+/);for(var a of s)n.push(".".concat(a))}}for(var l of["aria-label","type","name","title","alt"]){var u=r.getAttribute(l);u&&n.push("[".concat(l,'="').concat(u,'"]'))}return n.join("")}function io(){try{return to.document.location.href}catch(e){return""}}function oo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"string"!=typeof e||0===t||e.length<=t?e:"".concat(e.slice(0,t),"...")}function so(e,t){if(!Array.isArray(e))return"";for(var r=[],n=0;n<e.length;n++){var i=e[n];try{eo(i)?r.push("[VueViewModel]"):r.push(String(i))}catch(o){r.push("[value cannot be serialized]")}}return r.join(t)}function ao(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!!Yi(e)&&(Gi(t,"RegExp")?t.test(e):!!Yi(t)&&(r?e===t:e.includes(t)))}function lo(e){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).some(r=>ao(e,r,t))}function uo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function co(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?uo(Object(r),!0).forEach(function(t){ho(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ho(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fo(e,t,r){if(t in e){var n=e[t];if("function"==typeof n){var i=r(n);"function"==typeof i&&vo(i,n);try{e[t]=i}catch(o){yi&&ji.log('Failed to replace method "'.concat(t,'" in object'),e)}}}}function po(e,t,r){try{Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0})}catch(n){yi&&ji.log('Failed to add non-enumerable property "'.concat(t,'" to object'),e)}}function vo(e,t){try{var r=t.prototype||{};e.prototype=t.prototype=r,po(e,"__sentry_original__",t)}catch(n){}}function go(e){return e.__sentry_original__}function _o(e){if(zi(e))return co({message:e.message,name:e.name,stack:e.stack},yo(e));if(Ji(e)){var t=co({type:e.type,target:mo(e.target),currentTarget:mo(e.currentTarget)},yo(e));return"undefined"!=typeof CustomEvent&&$i(e,CustomEvent)&&(t.detail=e.detail),t}return e}function mo(e){try{return t=e,"undefined"!=typeof Element&&$i(t,Element)?ro(e):Object.prototype.toString.call(e)}catch(r){return"<unknown>"}var t}function yo(e){if("object"==typeof e&&null!==e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}return{}}function bo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Eo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?bo(Object(r),!0).forEach(function(t){So(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function So(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function To(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(e=Ei).crypto||e.msCrypto,r=()=>16*Math.random();try{if(null!=t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");null!=t&&t.getRandomValues&&(r=()=>{var e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(n){}return([1e7]+1e3+4e3+8e3+1e11).replace(/[018]/g,e=>(e^(15&r())>>e/4).toString(16))}function Co(e){var t;return null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t?void 0:t[0]}function Ao(e){var{message:t,event_id:r}=e;if(t)return t;var n=Co(e);return n?n.type&&n.value?"".concat(n.type,": ").concat(n.value):n.type||n.value||r||"<unknown>":r||"<unknown>"}function Po(e,t,r){var n=e.exception=e.exception||{},i=n.values=n.values||[],o=i[0]=i[0]||{};o.value||(o.value=t||""),o.type||(o.type=r||"Error")}function Ro(e,t){var r=Co(e);if(r){var n=r.mechanism;if(r.mechanism=Eo(Eo(Eo({},{type:"generic",handled:!0}),n),t),t&&"data"in t){var i=Eo(Eo({},null==n?void 0:n.data),t.data);r.mechanism.data=i}}}function Oo(e){if(function(e){try{return e.__sentry_captured__}catch(t){}}(e))return!0;try{po(e,"__sentry_captured__",!0)}catch(t){}return!1}function Lo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Mo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lo(Object(r),!0).forEach(function(t){wo(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function wo(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Io=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,/^Can't find variable: gmo$/,/^undefined is not an object \(evaluating 'a\.[A-Z]'\)$/,'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/,/^Java exception was raised during method invocation$/],Do=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{name:"EventFilters",setup(r){var n=r.getOptions();e=Bo(t,n)},processEvent(r,n,i){if(!e){var o=i.getOptions();e=Bo(t,o)}return function(e,t){if(e.type){if("transaction"===e.type&&function(e,t){if(null==t||!t.length)return!1;var r=e.transaction;return!!r&&lo(r,t)}(e,t.ignoreTransactions))return yi&&ji.warn("Event dropped due to being matched by `ignoreTransactions` option.\nEvent: ".concat(Ao(e))),!0}else{if(function(e,t){if(null==t||!t.length)return!1;return Vi(e).some(e=>lo(e,t))}(e,t.ignoreErrors))return yi&&ji.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: ".concat(Ao(e))),!0;if(function(e){var t;if(null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t||!t.length)return!1;return!e.message&&!e.exception.values.some(e=>e.stacktrace||e.type&&"Error"!==e.type||e.value)}(e))return yi&&ji.warn("Event dropped due to not having an error message, error type or stacktrace.\nEvent: ".concat(Ao(e))),!0;if(function(e,t){if(null==t||!t.length)return!1;var r=jo(e);return!!r&&lo(r,t)}(e,t.denyUrls))return yi&&ji.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: ".concat(Ao(e),".\nUrl: ").concat(jo(e))),!0;if(!function(e,t){if(null==t||!t.length)return!0;var r=jo(e);return!r||lo(r,t)}(e,t.allowUrls))return yi&&ji.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: ".concat(Ao(e),".\nUrl: ").concat(jo(e))),!0}return!1}(r,e)?null:r}}},No=function(){return Mo(Mo({},Do(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})),{},{name:"InboundFilters"})};function Bo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:Io],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[]]}}function jo(e){try{var t,r,n,i=[...null!==(t=null===(r=e.exception)||void 0===r?void 0:r.values)&&void 0!==t?t:[]].reverse().find(e=>{var t,r;return void 0===(null===(t=e.mechanism)||void 0===t?void 0:t.parent_id)&&(null===(r=e.stacktrace)||void 0===r||null===(r=r.frames)||void 0===r?void 0:r.length)}),o=null==i||null===(n=i.stacktrace)||void 0===n?void 0:n.frames;return o?function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.length-1;t>=0;t--){var r=e[t];if(r&&"<anonymous>"!==r.filename&&"[native code]"!==r.filename)return r.filename||null}return null}(o):null}catch(s){return yi&&ji.error("Cannot extract url for event ".concat(Ao(e))),null}}var ko;function xo(){return Date.now()/1e3}function Fo(){return(null!=ko?ko:ko=function(){var{performance:e}=Ei;if(null==e||!e.now||!e.timeOrigin)return xo;var t=e.timeOrigin;return()=>(t+e.now())/1e3}())()}function Uo(e){var t=Fo(),r={sid:To(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>function(e){return{sid:"".concat(e.sid),init:e.init,started:new Date(1e3*e.started).toISOString(),timestamp:new Date(1e3*e.timestamp).toISOString(),status:e.status,errors:e.errors,did:"number"==typeof e.did||"string"==typeof e.did?"".concat(e.did):void 0,duration:e.duration,abnormal_mechanism:e.abnormal_mechanism,attrs:{release:e.release,environment:e.environment,ip_address:e.ipAddress,user_agent:e.userAgent}}}(r)};return e&&Vo(r,e),r}function Vo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.user&&(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||Fo(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:To()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did="".concat(t.did)),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{var r=e.timestamp-e.started;e.duration=r>=0?r:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function Wo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function zo(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Go(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(!t||"object"!=typeof t||r<=0)return t;if(e&&0===Object.keys(t).length)return e;var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Wo(Object(r),!0).forEach(function(t){zo(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e);for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=Go(n[i],t[i],r-1));return n}function Ho(){return To()}function qo(){return To().substring(16)}var Yo="_sentrySpan";function Qo(e,t){t?po(e,Yo,t):delete e[Yo]}function Ko(e){return e[Yo]}function Xo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Jo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xo(Object(r),!0).forEach(function(t){Zo(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xo(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Zo(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $o;class es{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Ho(),sampleRand:Math.random()}}clone(){var e=new es;return e._breadcrumbs=[...this._breadcrumbs],e._tags=Jo({},this._tags),e._extra=Jo({},this._extra),e._contexts=Jo({},this._contexts),this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._attachments=[...this._attachments],e._sdkProcessingMetadata=Jo({},this._sdkProcessingMetadata),e._propagationContext=Jo({},this._propagationContext),e._client=this._client,e._lastEventId=this._lastEventId,Qo(e,Ko(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Vo(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}setTags(e){return this._tags=Jo(Jo({},this._tags),e),this._notifyScopeListeners(),this}setTag(e,t){return this._tags=Jo(Jo({},this._tags),{},{[e]:t}),this._notifyScopeListeners(),this}setExtras(e){return this._extra=Jo(Jo({},this._extra),e),this._notifyScopeListeners(),this}setExtra(e,t){return this._extra=Jo(Jo({},this._extra),{},{[e]:t}),this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;var t="function"==typeof e?e(this):e,r=t instanceof es?t.getScopeData():Xi(t)?e:void 0,{tags:n,extra:i,user:o,contexts:s,level:a,fingerprint:l=[],propagationContext:u}=r||{};return this._tags=Jo(Jo({},this._tags),n),this._extra=Jo(Jo({},this._extra),i),this._contexts=Jo(Jo({},this._contexts),s),o&&Object.keys(o).length&&(this._user=o),a&&(this._level=a),l.length&&(this._fingerprint=l),u&&(this._propagationContext=u),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._session=void 0,Qo(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Ho(),sampleRand:Math.random()}),this._notifyScopeListeners(),this}addBreadcrumb(e,t){var r="number"==typeof t?t:100;if(r<=0)return this;var n,i=Jo(Jo({timestamp:xo()},e),{},{message:e.message?oo(e.message,2048):e.message});(this._breadcrumbs.push(i),this._breadcrumbs.length>r)&&(this._breadcrumbs=this._breadcrumbs.slice(-r),null===(n=this._client)||void 0===n||n.recordDroppedEvent("buffer_overflow","log_item"));return this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:Ko(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=Go(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){var r=(null==t?void 0:t.event_id)||To();if(!this._client)return yi&&ji.warn("No client configured on scope - will not capture exception!"),r;var n=new Error("Sentry syntheticException");return this._client.captureException(e,Jo(Jo({originalException:e,syntheticException:n},t),{},{event_id:r}),this),r}captureMessage(e,t,r){var n=(null==r?void 0:r.event_id)||To();if(!this._client)return yi&&ji.warn("No client configured on scope - will not capture message!"),n;var i=new Error(e);return this._client.captureMessage(e,t,Jo(Jo({originalException:e,syntheticException:i},r),{},{event_id:n}),this),n}captureEvent(e,t){var r=(null==t?void 0:t.event_id)||To();return this._client?(this._client.captureEvent(e,Jo(Jo({},t),{},{event_id:r}),this),r):(yi&&ji.warn("No client configured on scope - will not capture event!"),r)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}class ts{constructor(e,t){var r,n;r=e||new es,n=t||new es,this._stack=[{scope:r}],this._isolationScope=n}withScope(e){var t,r=this._pushScope();try{t=e(r)}catch(Jc){throw this._popScope(),Jc}return Zi(t)?t.then(e=>(this._popScope(),e),e=>{throw this._popScope(),e}):(this._popScope(),t)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){var e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return!(this._stack.length<=1)&&!!this._stack.pop()}}function rs(){var e=Ti(Si());return e.stack=e.stack||new ts(Ci("defaultCurrentScope",()=>new es),Ci("defaultIsolationScope",()=>new es))}function ns(e){return rs().withScope(e)}function is(e,t){var r=rs();return r.withScope(()=>(r.getStackTop().scope=e,t(e)))}function os(e){return rs().withScope(()=>e(rs().getIsolationScope()))}function ss(e){var t=Ti(e);return t.acs?t.acs:{withIsolationScope:os,withScope:ns,withSetScope:is,withSetIsolationScope:(e,t)=>os(t),getCurrentScope:()=>rs().getScope(),getIsolationScope:()=>rs().getIsolationScope()}}function as(){return ss(Si()).getCurrentScope()}function ls(){return ss(Si()).getIsolationScope()}function us(){return as().getClient()}function cs(e){var t=e.getPropagationContext(),{traceId:r,parentSpanId:n,propagationSpanId:i}=t,o={trace_id:r,span_id:i||qo()};return n&&(o.parent_span_id=n),o}var ds=new WeakMap,hs=()=>({name:"FunctionToString",setupOnce(){$o=Function.prototype.toString;try{Function.prototype.toString=function(){for(var e=go(this),t=ds.has(us())&&void 0!==e?e:this,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return $o.apply(t,n)}}catch(e){}},setup(e){ds.set(e,!0)}});function fs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ps(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fs(Object(r),!0).forEach(function(t){vs(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fs(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function vs(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var gs="?",_s=/\(error: (.*)\)/,ms=/captureMessage|captureException/;function ys(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=[],o=e.split("\n"),s=t;s<o.length;s++){var a=o[s];if(!(a.length>1024)){var l=_s.test(a)?a.replace(_s,"$1"):a;if(!l.match(/\S*Error: /)){for(var u of n){var c=u(l);if(c){i.push(c);break}}if(i.length>=50+r)break}}}return function(e){if(!e.length)return[];var t=Array.from(e);/sentryWrapped/.test(bs(t).function||"")&&t.pop();t.reverse(),ms.test(bs(t).function||"")&&(t.pop(),ms.test(bs(t).function||"")&&t.pop());return t.slice(0,50).map(e=>ps(ps({},e),{},{filename:e.filename||bs(t).filename,function:e.function||gs}))}(i.slice(r))}}function bs(e){return e[e.length-1]||{}}var Es="<anonymous>";function Ss(e){try{return e&&"function"==typeof e&&e.name||Es}catch(t){return Es}}function Ts(e){var t=e.exception;if(t){var r=[];try{return t.values.forEach(e=>{e.stacktrace.frames&&r.push(...e.stacktrace.frames)}),r}catch(n){return}}}var Cs=()=>{var e;return{name:"Dedupe",processEvent(t){if(t.type)return t;try{if(function(e,t){if(!t)return!1;if(function(e,t){var r=e.message,n=t.message;if(!r&&!n)return!1;if(r&&!n||!r&&n)return!1;if(r!==n)return!1;if(!Ps(e,t))return!1;if(!As(e,t))return!1;return!0}(e,t))return!0;if(function(e,t){var r=Rs(t),n=Rs(e);if(!r||!n)return!1;if(r.type!==n.type||r.value!==n.value)return!1;if(!Ps(e,t))return!1;if(!As(e,t))return!1;return!0}(e,t))return!0;return!1}(t,e))return yi&&ji.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(r){}return e=t}}};function As(e,t){var r=Ts(e),n=Ts(t);if(!r&&!n)return!0;if(r&&!n||!r&&n)return!1;if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++){var o=n[i],s=r[i];if(o.filename!==s.filename||o.lineno!==s.lineno||o.colno!==s.colno||o.function!==s.function)return!1}return!0}function Ps(e,t){var r=e.fingerprint,n=t.fingerprint;if(!r&&!n)return!0;if(r&&!n||!r&&n)return!1;try{return!(r.join("")!==n.join(""))}catch(i){return!1}}function Rs(e){var t;return null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t?void 0:t[0]}function Os(e,t){!0===t.debug&&(yi?ji.enable():Ri(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),as().update(t.initialScope);var r=new e(t);return function(e){as().setClient(e)}(r),r.init(),r}function Ls(e){var t=e.protocol?"".concat(e.protocol,":"):"",r=e.port?":".concat(e.port):"";return"".concat(t,"//").concat(e.host).concat(r).concat(e.path?"/".concat(e.path):"","/api/")}function Ms(e,t,r){return t||"".concat(function(e){return"".concat(Ls(e)).concat(e.projectId,"/envelope/")}(e),"?").concat(function(e,t){var r={sentry_version:"7"};return e.publicKey&&(r.sentry_key=e.publicKey),t&&(r.sentry_client="".concat(t.name,"/").concat(t.version)),new URLSearchParams(r).toString()}(e,r))}var ws="production",Is=/^o(\d+)\./,Ds=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function Ns(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{host:r,path:n,pass:i,port:o,projectId:s,protocol:a,publicKey:l}=e;return"".concat(a,"://").concat(l).concat(t&&i?":".concat(i):"")+"@".concat(r).concat(o?":".concat(o):"","/").concat(n?"".concat(n,"/"):n).concat(s)}function Bs(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function js(e){var t="string"==typeof e?function(e){var t=Ds.exec(e);if(t){var[r,n,i="",o="",s="",a=""]=t.slice(1),l="",u=a,c=u.split("/");if(c.length>1&&(l=c.slice(0,-1).join("/"),u=c.pop()),u){var d=u.match(/^\d+/);d&&(u=d[0])}return Bs({host:o,pass:i,path:l,projectId:u,port:s,protocol:r,publicKey:n})}Ri(()=>{console.error("Invalid Sentry Dsn: ".concat(e))})}(e):Bs(e);if(t&&function(e){if(!yi)return!0;var{port:t,projectId:r,protocol:n}=e;return!(["protocol","publicKey","host","projectId"].find(t=>!e[t]&&(ji.error("Invalid Sentry Dsn: ".concat(t," missing")),!0))||(r.match(/^\d+$/)?function(e){return"http"===e||"https"===e}(n)?t&&isNaN(parseInt(t,10))&&(ji.error("Invalid Sentry Dsn: Invalid port ".concat(t)),1):(ji.error("Invalid Sentry Dsn: Invalid protocol ".concat(n)),1):(ji.error("Invalid Sentry Dsn: Invalid projectId ".concat(r)),1)))}(t))return t}function ks(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;try{return Fs("",e,t,r)}catch(n){return{ERROR:"**non-serializable** (".concat(n,")")}}}function xs(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:102400,i=ks(e,r);return t=i,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(t))>n?xs(e,r-1,n):i}function Fs(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){var e=new WeakSet;function t(t){return!!e.has(t)||(e.add(t),!1)}function r(t){e.delete(t)}return[t,r]}(),[o,s]=i;if(null==t||["boolean","string"].includes(typeof t)||"number"==typeof t&&Number.isFinite(t))return t;var a=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if(eo(t))return"[VueViewModel]";if(Xi(n=t)&&"nativeEvent"in n&&"preventDefault"in n&&"stopPropagation"in n)return"[SyntheticEvent]";if("number"==typeof t&&!Number.isFinite(t))return"[".concat(t,"]");if("function"==typeof t)return"[Function: ".concat(Ss(t),"]");if("symbol"==typeof t)return"[".concat(String(t),"]");if("bigint"==typeof t)return"[BigInt: ".concat(String(t),"]");var r=function(e){var t=Object.getPrototypeOf(e);return null!=t&&t.constructor?t.constructor.name:"null prototype"}(t);return/^HTML(\w*)Element$/.test(r)?"[HTMLElement: ".concat(r,"]"):"[object ".concat(r,"]")}catch(i){return"**non-serializable** (".concat(i,")")}var n}(e,t);if(!a.startsWith("[object "))return a;if(t.__sentry_skip_normalization__)return t;var l="number"==typeof t.__sentry_override_normalization_depth__?t.__sentry_override_normalization_depth__:r;if(0===l)return a.replace("object ","");if(o(t))return"[Circular ~]";var u=t;if(u&&"function"==typeof u.toJSON)try{return Fs("",u.toJSON(),l-1,n,i)}catch(v){}var c=Array.isArray(t)?[]:{},d=0,h=_o(t);for(var f in h)if(Object.prototype.hasOwnProperty.call(h,f)){if(d>=n){c[f]="[MaxProperties ~]";break}var p=h[f];c[f]=Fs(f,p,l-1,n,i),d++}return s(t),c}function Us(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Vs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Us(Object(r),!0).forEach(function(t){Ws(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Us(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ws(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zs(e){return[e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]]}function Gs(e,t){var[r,n]=e;return[r,[...n,t]]}function Hs(e,t){var r=e[1];for(var n of r){if(t(n,n[0].type))return!0}return!1}function qs(e){var t=Ti(Ei);return t.encodePolyfill?t.encodePolyfill(e):(new TextEncoder).encode(e)}function Ys(e){var[t,r]=e,n=JSON.stringify(t);function i(e){"string"==typeof n?n="string"==typeof e?n+e:[qs(n),e]:n.push("string"==typeof e?qs(e):e)}for(var o of r){var[s,a]=o;if(i("\n".concat(JSON.stringify(s),"\n")),"string"==typeof a||a instanceof Uint8Array)i(a);else{var l=void 0;try{l=JSON.stringify(a)}catch(u){l=JSON.stringify(ks(a))}i(l)}}return"string"==typeof n?n:function(e){var t=e.reduce((e,t)=>e+t.length,0),r=new Uint8Array(t),n=0;for(var i of e)r.set(i,n),n+=i.length;return r}(n)}function Qs(e){var t="string"==typeof e.data?qs(e.data):e.data;return[{type:"attachment",length:t.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType},t]}var Ks={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",raw_security:"security",log:"log_item"};function Xs(e){return Ks[e]}function Js(e){if(null!=e&&e.sdk){var{name:t,version:r}=e.sdk;return{name:t,version:r}}}function Zs(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function $s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zs(Object(r),!0).forEach(function(t){ea(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zs(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ea(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ta(e,t,r,n){var i=Js(r),o=e.type&&"replay_event"!==e.type?e.type:"event";!function(e,t){t&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=[...e.sdk.integrations||[],...t.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...t.packages||[]])}(e,null==r?void 0:r.sdk);var s=function(e,t,r,n){var i,o=null===(i=e.sdkProcessingMetadata)||void 0===i?void 0:i.dynamicSamplingContext;return Vs(Vs(Vs({event_id:e.event_id,sent_at:(new Date).toISOString()},t&&{sdk:t}),!!r&&n&&{dsn:Ns(n)}),o&&{trace:o})}(e,i,n,t);return delete e.sdkProcessingMetadata,zs(s,[[{type:o},e]])}var ra="sentry.profile_id",na="sentry.exclusive_time",ia=/^sentry-/;function oa(e){var t=function(e){if(!e||!Yi(e)&&!Array.isArray(e))return;if(Array.isArray(e))return e.reduce((e,t)=>{var r=sa(t);return Object.entries(r).forEach(t=>{var[r,n]=t;e[r]=n}),e},{});return sa(e)}(e);if(t){var r=Object.entries(t).reduce((e,t)=>{var[r,n]=t;r.match(ia)&&(e[r.slice(7)]=n);return e},{});return Object.keys(r).length>0?r:void 0}}function sa(e){return e.split(",").map(e=>e.split("=").map(e=>{try{return decodeURIComponent(e.trim())}catch(t){return}})).reduce((e,t)=>{var[r,n]=t;return r&&n&&(e[r]=n),e},{})}function aa(e){var t;if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;var r=e||(null===(t=us())||void 0===t?void 0:t.getOptions());return!(!r||null==r.tracesSampleRate&&!r.tracesSampler)}var la="_sentryScope",ua="_sentryIsolationScope";function ca(e){return{scope:e[la],isolationScope:e[ua]}}var da=["spanId","traceId","traceFlags"];function ha(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function fa(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pa=!1;function va(e){var{spanId:t,traceId:r,isRemote:n}=e.spanContext(),i=n?t:ya(e).parent_span_id,o=ca(e).scope;return{parent_span_id:i,span_id:n?(null==o?void 0:o.getPropagationContext().propagationSpanId)||qo():t,trace_id:r}}function ga(e){return e&&e.length>0?e.map(e=>{var{context:{spanId:t,traceId:r,traceFlags:n},attributes:i}=e,o=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e.context,da);return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ha(Object(r),!0).forEach(function(t){fa(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ha(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({span_id:t,trace_id:r,sampled:1===n,attributes:i},o)}):void 0}function _a(e){return"number"==typeof e?ma(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?ma(e.getTime()):Fo()}function ma(e){return e>9999999999?e/1e3:e}function ya(e){if(function(e){return"function"==typeof e.getSpanJSON}(e))return e.getSpanJSON();var{spanId:t,traceId:r}=e.spanContext();if(function(e){var t=e;return!!(t.attributes&&t.startTime&&t.name&&t.endTime&&t.status)}(e)){var n,{attributes:i,startTime:o,name:s,endTime:a,status:l,links:u}=e;return{span_id:t,trace_id:r,data:i,description:s,parent_span_id:"parentSpanId"in e?e.parentSpanId:"parentSpanContext"in e?null===(n=e.parentSpanContext)||void 0===n?void 0:n.spanId:void 0,start_timestamp:_a(o),timestamp:_a(a)||void 0,status:Ea(l),op:i["sentry.op"],origin:i["sentry.origin"],links:ga(u)}}return{span_id:t,trace_id:r,start_timestamp:0,data:{}}}function ba(e){var{traceFlags:t}=e.spanContext();return 1===t}function Ea(e){if(e&&0!==e.code)return 1===e.code?"ok":e.message||"unknown_error"}var Sa="_sentryRootSpan";function Ta(e){return e[Sa]||e}function Ca(){pa||(Ri(()=>{console.warn("[Sentry] Returning null from `beforeSendSpan` is disallowed. To drop certain spans, configure the respective integrations directly.")}),pa=!0)}var Aa="_frozenDsc";function Pa(e,t){var r,n=t.getOptions(),{publicKey:i,host:o}=t.getDsn()||{};n.orgId?r=String(n.orgId):o&&(r=function(e){var t=e.match(Is);return null==t?void 0:t[1]}(o));var s={environment:n.environment||ws,release:n.release,public_key:i,trace_id:e,org_id:r};return t.emit("createDsc",s),s}function Ra(e){var t,r,n=us();if(!n)return{};var i=Ta(e),o=ya(i),s=o.data,a=i.spanContext().traceState,l=null!==(t=null!==(r=null==a?void 0:a.get("sentry.sample_rate"))&&void 0!==r?r:s["sentry.sample_rate"])&&void 0!==t?t:s["sentry.previous_trace_sample_rate"];function u(e){return"number"!=typeof l&&"string"!=typeof l||(e.sample_rate="".concat(l)),e}var c=i[Aa];if(c)return u(c);var d=null==a?void 0:a.get("sentry.dsc"),h=d&&oa(d);if(h)return u(h);var f,p,v=Pa(e.spanContext().traceId,n),g=s["sentry.source"],_=o.description;("url"!==g&&_&&(v.transaction=_),aa())&&(v.sampled=String(ba(i)),v.sample_rand=null!==(f=null==a?void 0:a.get("sentry.sample_rand"))&&void 0!==f?f:null===(p=ca(i).scope)||void 0===p?void 0:p.getPropagationContext().sampleRand.toString());return u(v),n.emit("createDsc",v,i),v}var Oa,La,Ma;function wa(e){return new Da(t=>{t(e)})}function Ia(e){return new Da((t,r)=>{r(e)})}class Da{constructor(e){this._state=0,this._handlers=[],this._runExecutor(e)}then(e,t){return new Da((r,n)=>{this._handlers.push([!1,t=>{if(e)try{r(e(t))}catch(Jc){n(Jc)}else r(t)},e=>{if(t)try{r(t(e))}catch(Jc){n(Jc)}else n(e)}]),this._executeHandlers()})}catch(e){return this.then(e=>e,e)}finally(e){return new Da((t,r)=>{var n,i;return this.then(t=>{i=!1,n=t,e&&e()},t=>{i=!0,n=t,e&&e()}).then(()=>{i?r(n):t(n)})})}_executeHandlers(){if(0!==this._state){var e=this._handlers.slice();this._handlers=[],e.forEach(e=>{e[0]||(1===this._state&&e[1](this._value),2===this._state&&e[2](this._value),e[0]=!0)})}}_runExecutor(e){var t=(e,t)=>{0===this._state&&(Zi(t)?t.then(r,n):(this._state=e,this._value=t,this._executeHandlers()))},r=e=>{t(1,e)},n=e=>{t(2,e)};try{e(r,n)}catch(Jc){n(Jc)}}}function Na(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ba(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ja(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return new Da((i,o)=>{var s=e[n];if(null===t||"function"!=typeof s)i(t);else{var a=s(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Na(Object(r),!0).forEach(function(t){Ba(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Na(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},t),r);yi&&s.id&&null===a&&ji.log('Event processor "'.concat(s.id,'" dropped event')),Zi(a)?a.then(t=>ja(e,t,r,n+1).then(i)).then(null,o):ja(e,a,r,n+1).then(i).then(null,o)}})}function ka(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function xa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(r),!0).forEach(function(t){Fa(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ka(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Fa(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ua(e,t){var{fingerprint:r,span:n,breadcrumbs:i,sdkProcessingMetadata:o}=t;!function(e,t){var{extra:r,tags:n,user:i,contexts:o,level:s,transactionName:a}=t;Object.keys(r).length&&(e.extra=xa(xa({},r),e.extra));Object.keys(n).length&&(e.tags=xa(xa({},n),e.tags));Object.keys(i).length&&(e.user=xa(xa({},i),e.user));Object.keys(o).length&&(e.contexts=xa(xa({},o),e.contexts));s&&(e.level=s);a&&"transaction"!==e.type&&(e.transaction=a)}(e,t),n&&function(e,t){e.contexts=xa({trace:va(t)},e.contexts),e.sdkProcessingMetadata=xa({dynamicSamplingContext:Ra(t)},e.sdkProcessingMetadata);var r=Ta(t),n=ya(r).description;n&&!e.transaction&&"transaction"===e.type&&(e.transaction=n)}(e,n),function(e,t){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],t&&(e.fingerprint=e.fingerprint.concat(t));e.fingerprint.length||delete e.fingerprint}(e,r),function(e,t){var r=[...e.breadcrumbs||[],...t];e.breadcrumbs=r.length?r:void 0}(e,i),function(e,t){e.sdkProcessingMetadata=xa(xa({},e.sdkProcessingMetadata),t)}(e,o)}function Va(e,t){var{extra:r,tags:n,user:i,contexts:o,level:s,sdkProcessingMetadata:a,breadcrumbs:l,fingerprint:u,eventProcessors:c,attachments:d,propagationContext:h,transactionName:f,span:p}=t;Wa(e,"extra",r),Wa(e,"tags",n),Wa(e,"user",i),Wa(e,"contexts",o),e.sdkProcessingMetadata=Go(e.sdkProcessingMetadata,a,2),s&&(e.level=s),f&&(e.transactionName=f),p&&(e.span=p),l.length&&(e.breadcrumbs=[...e.breadcrumbs,...l]),u.length&&(e.fingerprint=[...e.fingerprint,...u]),c.length&&(e.eventProcessors=[...e.eventProcessors,...c]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext=xa(xa({},e.propagationContext),h)}function Wa(e,t,r){e[t]=Go(e[t],r,1)}function za(e){var t=Ei._sentryDebugIds;if(!t)return{};var r=Object.keys(t);return Ma&&r.length===La||(La=r.length,Ma=r.reduce((r,n)=>{Oa||(Oa={});var i=Oa[n];if(i)r[i[0]]=i[1];else for(var o=e(n),s=o.length-1;s>=0;s--){var a=o[s],l=null==a?void 0:a.filename,u=t[n];if(l&&u){r[l]=u,Oa[n]=[l,u];break}}return r},{})),Ma}function Ga(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ha(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ga(Object(r),!0).forEach(function(t){qa(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ga(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function qa(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ya(e,t,r,n,i,o){var{normalizeDepth:s=3,normalizeMaxBreadth:a=1e3}=e,l=Ha(Ha({},t),{},{event_id:t.event_id||r.event_id||To(),timestamp:t.timestamp||xo()}),u=r.integrations||e.integrations.map(e=>e.name);!function(e,t){var{environment:r,release:n,dist:i,maxValueLength:o=250}=t;e.environment=e.environment||r||ws,!e.release&&n&&(e.release=n);!e.dist&&i&&(e.dist=i);var s=e.request;null!=s&&s.url&&(s.url=oo(s.url,o))}(l,e),function(e,t){t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=[...e.sdk.integrations||[],...t])}(l,u),i&&i.emit("applyFrameMetadata",t),void 0===t.type&&function(e,t){var r,n=za(t);null===(r=e.exception)||void 0===r||null===(r=r.values)||void 0===r||r.forEach(e=>{var t;null===(t=e.stacktrace)||void 0===t||null===(t=t.frames)||void 0===t||t.forEach(e=>{e.filename&&(e.debug_id=n[e.filename])})})}(l,e.stackParser);var c=function(e,t){if(!t)return e;var r=e?e.clone():new es;return r.update(t),r}(n,r.captureContext);r.mechanism&&Ro(l,r.mechanism);var d=i?i.getEventProcessors():[],h=Ci("globalScope",()=>new es).getScopeData();o&&Va(h,o.getScopeData());c&&Va(h,c.getScopeData());var f=[...r.attachments||[],...h.attachments];return f.length&&(r.attachments=f),Ua(l,h),ja([...d,...h.eventProcessors],l,r).then(e=>(e&&function(e){var t,r={};if(null===(t=e.exception)||void 0===t||null===(t=t.values)||void 0===t||t.forEach(e=>{var t;null===(t=e.stacktrace)||void 0===t||null===(t=t.frames)||void 0===t||t.forEach(e=>{e.debug_id&&(e.abs_path?r[e.abs_path]=e.debug_id:e.filename&&(r[e.filename]=e.debug_id),delete e.debug_id)})}),0===Object.keys(r).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];var n=e.debug_meta.images;Object.entries(r).forEach(e=>{var[t,r]=e;n.push({type:"sourcemap",code_file:t,debug_id:r})})}(e),"number"==typeof s&&s>0?function(e,t,r){var n,i;if(!e)return null;var o=Ha(Ha(Ha(Ha(Ha({},e),e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(e=>Ha(Ha({},e),e.data&&{data:ks(e.data,t,r)}))}),e.user&&{user:ks(e.user,t,r)}),e.contexts&&{contexts:ks(e.contexts,t,r)}),e.extra&&{extra:ks(e.extra,t,r)});null!==(n=e.contexts)&&void 0!==n&&n.trace&&o.contexts&&(o.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(o.contexts.trace.data=ks(e.contexts.trace.data,t,r)));e.spans&&(o.spans=e.spans.map(e=>Ha(Ha({},e),e.data&&{data:ks(e.data,t,r)})));null!==(i=e.contexts)&&void 0!==i&&i.flags&&o.contexts&&(o.contexts.flags=ks(e.contexts.flags,3,r));return o}(e,s,a):e))}function Qa(e){if(e)return function(e){return e instanceof es||"function"==typeof e}(e)||function(e){return Object.keys(e).some(e=>Ka.includes(e))}(e)?{captureContext:e}:e}var Ka=["user","level","extra","contexts","tags","fingerprint","propagationContext"];function Xa(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ja(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xa(Object(r),!0).forEach(function(t){Za(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xa(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Za(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function el(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$a(Object(r),!0).forEach(function(t){tl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$a(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function tl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var rl="Not capturing exception because it's already been captured.",nl="Discarded session because of missing or non-string release",il=Symbol.for("SentryInternalError"),ol=Symbol.for("SentryDoNotSendEventError");function sl(e){return{message:e,[il]:!0}}function al(e){return{message:e,[ol]:!0}}function ll(e){return!!e&&"object"==typeof e&&il in e}function ul(e){return!!e&&"object"==typeof e&&ol in e}class cl{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=js(e.dsn):yi&&ji.warn("No DSN provided, client will not send events."),this._dsn){var t=Ms(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport(el(el({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this)},e.transportOptions),{},{url:t}))}}captureException(e,t,r){var n=To();if(Oo(e))return yi&&ji.log(rl),n;var i=el({event_id:n},t);return this._process(this.eventFromException(e,i).then(e=>this._captureEvent(e,i,r))),i.event_id}captureMessage(e,t,r,n){var i=el({event_id:To()},r),o=Qi(e)?e:String(e),s=Ki(e)?this.eventFromMessage(o,t,i):this.eventFromException(e,i);return this._process(s.then(e=>this._captureEvent(e,i,n))),i.event_id}captureEvent(e,t,r){var n=To();if(null!=t&&t.originalException&&Oo(t.originalException))return yi&&ji.log(rl),n;var i=el({event_id:n},t),o=e.sdkProcessingMetadata||{},s=o.capturedSpanScope,a=o.capturedSpanIsolationScope;return this._process(this._captureEvent(e,i,s||r,a)),i.event_id}captureSession(e){this.sendSession(e),Vo(e,{init:!1})}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){var t=this._transport;return t?(this.emit("flush"),this._isClientDoneProcessing(e).then(r=>t.flush(e).then(e=>r&&e))):wa(!0)}close(e){return this.flush(e).then(e=>(this.getOptions().enabled=!1,this.emit("close"),e))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(e=>{var{name:t}=e;return t.startsWith("Spotlight")}))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){var t=this._integrations[e.name];Ui(this,e,this._integrations),t||Fi(this,[e])}sendEvent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.emit("beforeSendEvent",e,t);var r=ta(e,this._dsn,this._options._metadata,this._options.tunnel);for(var n of t.attachments||[])r=Gs(r,Qs(n));var i=this.sendEnvelope(r);i&&i.then(t=>this.emit("afterSendEvent",e,t),null)}sendSession(e){var{release:t,environment:r=ws}=this._options;if("aggregates"in e){var n=e.attrs||{};if(!n.release&&!t)return void(yi&&ji.warn(nl));n.release=n.release||t,n.environment=n.environment||r,e.attrs=n}else{if(!e.release&&!t)return void(yi&&ji.warn(nl));e.release=e.release||t,e.environment=e.environment||r}this.emit("beforeSendSession",e);var i=function(e,t,r,n){var i=Js(r);return zs($s($s({sent_at:(new Date).toISOString()},i&&{sdk:i}),!!n&&t&&{dsn:Ns(t)}),["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(i)}recordDroppedEvent(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this._options.sendClientReports){var n="".concat(e,":").concat(t);yi&&ji.log('Recording outcome: "'.concat(n,'"').concat(r>1?" (".concat(r," times)"):"")),this._outcomes[n]=(this._outcomes[n]||0)+r}}on(e,t){var r=this._hooks[e]=this._hooks[e]||[];return r.push(t),()=>{var e=r.indexOf(t);e>-1&&r.splice(e,1)}}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=this._hooks[e];i&&i.forEach(e=>e(...r))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,e=>(yi&&ji.error("Error while sending envelope:",e),e)):(yi&&ji.error("Transport disabled"),wa({}))}_setupIntegrations(){var{integrations:e}=this._options;this._integrations=function(e,t){var r={};return t.forEach(t=>{t&&Ui(e,t,r)}),r}(this,e),Fi(this,e)}_updateSessionFromEvent(e,t){var r,n="fatal"===t.level,i=!1,o=null===(r=t.exception)||void 0===r?void 0:r.values;if(o)for(var s of(i=!0,o)){var a=s.mechanism;if(!1===(null==a?void 0:a.handled)){n=!0;break}}var l="ok"===e.status;(l&&0===e.errors||l&&n)&&(Vo(e,el(el({},n&&{status:"crashed"}),{},{errors:e.errors||Number(i||n)})),this.captureSession(e))}_isClientDoneProcessing(e){return new Da(t=>{var r=0,n=setInterval(()=>{0==this._numProcessing?(clearInterval(n),t(!0)):(r+=1,e&&r>=e&&(clearInterval(n),t(!1)))},1)})}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,r,n){var i=this.getOptions(),o=Object.keys(this._integrations);return!t.integrations&&null!=o&&o.length&&(t.integrations=o),this.emit("preprocessEvent",e,t),e.type||n.setLastEventId(e.event_id||t.event_id),Ya(i,e,t,r,this,n).then(e=>{if(null===e)return e;this.emit("postprocessEvent",e,t),e.contexts=el({trace:cs(r)},e.contexts);var n,i,o=(n=this,(i=r.getPropagationContext()).dsc||Pa(i.traceId,n));return e.sdkProcessingMetadata=el({dynamicSamplingContext:o},e.sdkProcessingMetadata),e})}_captureEvent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:as(),n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ls();return yi&&dl(e)&&ji.log("Captured error event `".concat(Vi(e)[0]||"<unknown>","`")),this._processEvent(e,t,r,n).then(e=>e.event_id,e=>{yi&&(ul(e)?ji.log(e.message):ll(e)?ji.warn(e.message):ji.warn(e))})}_processEvent(e,t,r,n){var i=this.getOptions(),{sampleRate:o}=i,s=hl(e),a=dl(e),l=e.type||"error",u="before send for type `".concat(l,"`"),c=void 0===o?void 0:function(e){if("boolean"==typeof e)return Number(e);var t="string"==typeof e?parseFloat(e):e;return"number"!=typeof t||isNaN(t)||t<0||t>1?void 0:t}(o);if(a&&"number"==typeof c&&Math.random()>c)return this.recordDroppedEvent("sample_rate","error"),Ia(al("Discarding event because it's not included in the random sample (sampling rate = ".concat(o,")")));var d="replay_event"===l?"replay":l;return this._prepareEvent(e,t,r,n).then(e=>{if(null===e)throw this.recordDroppedEvent("event_processor",d),al("An event processor returned `null`, will not send event.");if(t.data&&!0===t.data.__sentry__)return e;var r=function(e,t,r,n){var{beforeSend:i,beforeSendTransaction:o,beforeSendSpan:s}=t,a=r;if(dl(a)&&i)return i(a,n);if(hl(a)){if(s){var l=s(function(e){var t,r,n,{trace_id:i,parent_span_id:o,span_id:s,status:a,origin:l,data:u,op:c}=null!==(t=null===(r=e.contexts)||void 0===r?void 0:r.trace)&&void 0!==t?t:{};return{data:null!=u?u:{},description:e.transaction,op:c,parent_span_id:o,span_id:null!=s?s:"",start_timestamp:null!==(n=e.start_timestamp)&&void 0!==n?n:0,status:a,timestamp:e.timestamp,trace_id:null!=i?i:"",origin:l,profile_id:null==u?void 0:u[ra],exclusive_time:null==u?void 0:u[na],measurements:e.measurements,is_segment:!0}}(a));if(l?a=Go(r,function(e){return{type:"transaction",timestamp:e.timestamp,start_timestamp:e.start_timestamp,transaction:e.description,contexts:{trace:{trace_id:e.trace_id,span_id:e.span_id,parent_span_id:e.parent_span_id,op:e.op,status:e.status,origin:e.origin,data:Ja(Ja(Ja({},e.data),e.profile_id&&{[ra]:e.profile_id}),e.exclusive_time&&{[na]:e.exclusive_time})}},measurements:e.measurements}}(l)):Ca(),a.spans){var u=[];for(var c of a.spans){var d=s(c);d?u.push(d):(Ca(),u.push(c))}a.spans=u}}if(o){if(a.spans){var h=a.spans.length;a.sdkProcessingMetadata=el(el({},r.sdkProcessingMetadata),{},{spanCountBeforeProcessing:h})}return o(a,n)}}return a}(0,i,e,t);return function(e,t){var r="".concat(t," must return `null` or a valid event.");if(Zi(e))return e.then(e=>{if(!Xi(e)&&null!==e)throw sl(r);return e},e=>{throw sl("".concat(t," rejected with ").concat(e))});if(!Xi(e)&&null!==e)throw sl(r);return e}(r,u)}).then(i=>{if(null===i){if(this.recordDroppedEvent("before_send",d),s){var o=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",o)}throw al("".concat(u," returned `null`, will not send event."))}var l=r.getSession()||n.getSession();if(a&&l&&this._updateSessionFromEvent(l,i),s){var c,h=((null===(c=i.sdkProcessingMetadata)||void 0===c?void 0:c.spanCountBeforeProcessing)||0)-(i.spans?i.spans.length:0);h>0&&this.recordDroppedEvent("before_send","span",h)}var f=i.transaction_info;if(s&&f&&i.transaction!==e.transaction){i.transaction_info=el(el({},f),{},{source:"custom"})}return this.sendEvent(i,t),i}).then(null,e=>{if(ul(e)||ll(e))throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),sl("Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ".concat(e))})}_process(e){this._numProcessing++,e.then(e=>(this._numProcessing--,e),e=>(this._numProcessing--,e))}_clearOutcomes(){var e=this._outcomes;return this._outcomes={},Object.entries(e).map(e=>{var[t,r]=e,[n,i]=t.split(":");return{reason:n,category:i,quantity:r}})}_flushOutcomes(){yi&&ji.log("Flushing outcomes...");var e=this._clearOutcomes();if(0!==e.length)if(this._dsn){yi&&ji.log("Sending outcomes:",e);var t,r,n,i=(t=e,zs((r=this._options.tunnel&&Ns(this._dsn))?{dsn:r}:{},[[{type:"client_report"},{timestamp:n||xo(),discarded_events:t}]]));this.sendEnvelope(i)}else yi&&ji.log("No dsn provided, will not send outcomes");else yi&&ji.log("No outcomes to send")}}function dl(e){return void 0===e.type}function hl(e){return"transaction"===e.type}function fl(e,t){var r,n=null!==(r=null!=t?t:pl(e))&&void 0!==r?r:[];if(0!==n.length){var i,o,s,a,l,u,c=e.getOptions(),d=(i=n,o=c._metadata,s=c.tunnel,a=e.getDsn(),u={},null!=o&&o.sdk&&(u.sdk={name:o.sdk.name,version:o.sdk.version}),s&&a&&(u.dsn=Ns(a)),zs(u,[(l=i,[{type:"log",item_count:l.length,content_type:"application/vnd.sentry.items.log+json"},{items:l}])]));vl().set(e,[]),e.emit("flushLogs"),e.sendEnvelope(d)}}function pl(e){return vl().get(e)}function vl(){return Ci("clientToLogBufferMap",()=>new WeakMap)}function gl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function _l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gl(Object(r),!0).forEach(function(t){ml(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ml(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yl(e){var t;void 0===(null===(t=e.user)||void 0===t?void 0:t.ip_address)&&(e.user=_l(_l({},e.user),{},{ip_address:"{{auto}}"}))}function bl(e){var t;"aggregates"in e?void 0===(null===(t=e.attrs)||void 0===t?void 0:t.ip_address)&&(e.attrs=_l(_l({},e.attrs),{},{ip_address:"{{auto}}"})):void 0===e.ipAddress&&(e.ipAddress="{{auto}}")}function El(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Sl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?El(Object(r),!0).forEach(function(t){Tl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):El(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Tl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cl(e,t){var r=Rl(e,t),n={type:Ml(t),value:wl(t)};return r.length&&(n.stacktrace={frames:r}),void 0===n.type&&""===n.value&&(n.value="Unrecoverable error caught"),n}function Al(e,t,r,n){var i=us(),o=null==i?void 0:i.getOptions().normalizeDepth,s=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var r=e[t];if(r instanceof Error)return r}return}(t),a={__serialized__:xs(t,o)};if(s)return{exception:{values:[Cl(e,s)]},extra:a};var l={exception:{values:[{type:Ji(t)?t.constructor.name:n?"UnhandledRejection":"Error",value:Nl(t,{isUnhandledRejection:n})}]},extra:a};if(r){var u=Rl(e,r);u.length&&(l.exception.values[0].stacktrace={frames:u})}return l}function Pl(e,t){return{exception:{values:[Cl(e,t)]}}}function Rl(e,t){var r=t.stacktrace||t.stack||"",n=function(e){if(e&&Ol.test(e.message))return 1;return 0}(t),i=function(e){if("number"==typeof e.framesToPop)return e.framesToPop;return 0}(t);try{return e(r,n,i)}catch(o){}return[]}var Ol=/Minified React error #\d+;/i;function Ll(e){return"undefined"!=typeof WebAssembly&&void 0!==WebAssembly.Exception&&e instanceof WebAssembly.Exception}function Ml(e){var t=null==e?void 0:e.name;return!t&&Ll(e)?e.message&&Array.isArray(e.message)&&2==e.message.length?e.message[0]:"WebAssembly.Exception":t}function wl(e){var t=null==e?void 0:e.message;return Ll(e)?Array.isArray(e.message)&&2==e.message.length?e.message[1]:"wasm exception":t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function Il(e,t,r,n,i){var o;if(Hi(t)&&t.error)return Pl(e,t.error);if(qi(t)||Gi(t,"DOMException")){var s=t;if("stack"in t)o=Pl(e,t);else{var a=s.name||(qi(s)?"DOMError":"DOMException"),l=s.message?"".concat(a,": ").concat(s.message):a;Po(o=Dl(e,l,r,n),l)}return"code"in s&&(o.tags=Sl(Sl({},o.tags),{},{"DOMException.code":"".concat(s.code)})),o}return zi(t)?Pl(e,t):Xi(t)||Ji(t)?(Ro(o=Al(e,t,r,i),{synthetic:!0}),o):(Po(o=Dl(e,t,r,n),"".concat(t),void 0),Ro(o,{synthetic:!0}),o)}function Dl(e,t,r,n){var i={};if(n&&r){var o=Rl(e,r);o.length&&(i.exception={values:[{value:t,stacktrace:{frames:o}}]}),Ro(i,{synthetic:!0})}if(Qi(t)){var{__sentry_template_string__:s,__sentry_template_values__:a}=t;return i.logentry={message:s,params:a},i}return i.message=t,i}function Nl(e,t){var{isUnhandledRejection:r}=t,n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:40,r=Object.keys(_o(e));r.sort();var n=r[0];if(!n)return"[object has no keys]";if(n.length>=t)return oo(n,t);for(var i=r.length;i>0;i--){var o=r.slice(0,i).join(", ");if(!(o.length>t))return i===r.length?o:oo(o,t)}return""}(e),i=r?"promise rejection":"exception";if(Hi(e))return"Event `ErrorEvent` captured as ".concat(i," with message `").concat(e.message,"`");if(Ji(e)){var o=function(e){try{var t=Object.getPrototypeOf(e);return t?t.constructor.name:void 0}catch(r){}}(e);return"Event `".concat(o,"` (type=").concat(e.type,") captured as ").concat(i)}return"Object captured as ".concat(i," with keys: ").concat(n)}function Bl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function jl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bl(Object(r),!0).forEach(function(t){kl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function kl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xl(e,t){return as().captureEvent(e,t)}function Fl(e){var t=ls(),r=as(),{userAgent:n}=Ei.navigator||{},i=Uo(jl(jl({user:r.getUser()||t.getUser()},n&&{userAgent:n}),e)),o=t.getSession();return"ok"===(null==o?void 0:o.status)&&Vo(o,{status:"exited"}),Ul(),t.setSession(i),i}function Ul(){var e=ls(),t=as().getSession()||e.getSession();t&&function(e,t){var r={};t?r={status:t}:"ok"===e.status&&(r={status:"exited"}),Vo(e,r)}(t),Vl(),e.setSession()}function Vl(){var e=ls(),t=us(),r=e.getSession();r&&t&&t.captureSession(r)}function Wl(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?Ul():Vl()}function zl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Gl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zl(Object(r),!0).forEach(function(t){Hl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Hl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ql=Ei,Yl=0;function Ql(){return Yl>0}function Kl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!function(e){return"function"==typeof e}(e))return e;try{var r=e.__sentry_wrapped__;if(r)return"function"==typeof r?r:e;if(go(e))return e}catch(o){return e}var n=function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];try{var o=n.map(e=>Kl(e,t));return e.apply(this,o)}catch(s){throw Yl++,setTimeout(()=>{Yl--}),function(){for(var e=ss(Si()),t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(2===r.length){var[i,o]=r;return i?e.withSetScope(i,o):e.withScope(o)}e.withScope(r[0])}(e=>{var r,i;e.addEventProcessor(e=>(t.mechanism&&(Po(e,void 0,void 0),Ro(e,t.mechanism)),e.extra=Gl(Gl({},e.extra),{},{arguments:n}),e)),r=s,as().captureException(r,Qa(i))}),s}};try{for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}catch(s){}vo(n,e),po(e,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get(){return e.name}})}catch(a){}return n}function Xl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Jl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Zl extends cl{constructor(e){var t,r,n=(t=e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Xl(Object(r),!0).forEach(function(t){Jl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({release:"string"==typeof __SENTRY_RELEASE__?__SENTRY_RELEASE__:null===(r=ql.SENTRY_RELEASE)||void 0===r?void 0:r.id,sendClientReports:!0,parentSpanIsAlwaysRootSpan:!0},t));!function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[t],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"npm",i=e._metadata||{};i.sdk||(i.sdk={name:"sentry.javascript.".concat(t),packages:r.map(e=>({name:"".concat(n,":@sentry/").concat(e),version:bi})),version:bi}),e._metadata=i}(n,"browser",["browser"],ql.SENTRY_SDK_SOURCE||"npm"),super(n);var{sendDefaultPii:i,sendClientReports:o,enableLogs:s,_experiments:a}=this._options,l=null!=s?s:null==a?void 0:a.enableLogs;ql.document&&(o||l)&&ql.document.addEventListener("visibilitychange",()=>{"hidden"===ql.document.visibilityState&&(o&&this._flushOutcomes(),l&&fl(this))}),l&&(this.on("flush",()=>{fl(this)}),this.on("afterCaptureLog",()=>{this._logFlushIdleTimeout&&clearTimeout(this._logFlushIdleTimeout),this._logFlushIdleTimeout=setTimeout(()=>{fl(this)},5e3)})),i&&(this.on("postprocessEvent",yl),this.on("beforeSendSession",bl))}eventFromException(e,t){return function(e,t,r,n){var i=Il(e,t,(null==r?void 0:r.syntheticException)||void 0,n);return Ro(i),i.level="error",null!=r&&r.event_id&&(i.event_id=r.event_id),wa(i)}(this._options.stackParser,e,t,this._options.attachStacktrace)}eventFromMessage(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2?arguments[2]:void 0;return function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info",n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=Dl(e,t,(null==n?void 0:n.syntheticException)||void 0,i);return o.level=r,null!=n&&n.event_id&&(o.event_id=n.event_id),wa(o)}(this._options.stackParser,e,t,r,this._options.attachStacktrace)}_prepareEvent(e,t,r,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,t,r,n)}}var $l={},eu={};function tu(e,t){$l[e]=$l[e]||[],$l[e].push(t)}function ru(e,t){if(!eu[e]){eu[e]=!0;try{t()}catch(Jc){yi&&ji.error("Error while instrumenting ".concat(e),Jc)}}}function nu(e,t){var r=e&&$l[e];if(r)for(var n of r)try{n(t)}catch(Jc){yi&&ji.error("Error while triggering instrumentation handler.\nType: ".concat(e,"\nName: ").concat(Ss(n),"\nError:"),Jc)}}function iu(){"console"in Ei&&Ai.forEach(function(e){e in Ei.console&&fo(Ei.console,e,function(t){return Pi[e]=t,function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];nu("console",{args:r,level:e});var i=Pi[e];null==i||i.apply(Ei.console,r)}})})}var ou=Ei;function su(){if(!("fetch"in ou))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(e){return!1}}function au(e){return e&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function lu(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}function uu(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){lu(o,n,i,s,a,"next",e)}function a(e){lu(o,n,i,s,a,"throw",e)}s(void 0)})}}function cu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function du(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cu(Object(r),!0).forEach(function(t){hu(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function hu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fu(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&!function(){if("string"==typeof EdgeRuntime)return!0;if(!su())return!1;if(au(ou.fetch))return!0;var e=!1,t=ou.document;if(t&&"function"==typeof t.createElement)try{var r,n=t.createElement("iframe");n.hidden=!0,t.head.appendChild(n),null!==(r=n.contentWindow)&&void 0!==r&&r.fetch&&(e=au(n.contentWindow.fetch)),t.head.removeChild(n)}catch(i){yi&&ji.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",i)}return e}()||fo(Ei,"fetch",function(t){return function(){for(var r=new Error,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var{method:s,url:a}=function(e){if(0===e.length)return{method:"GET",url:""};if(2===e.length){var[t,r]=e;return{url:vu(t),method:pu(r,"method")?String(r.method).toUpperCase():"GET"}}var n=e[0];return{url:vu(n),method:pu(n,"method")?String(n.method).toUpperCase():"GET"}}(i),l={args:i,fetchData:{method:s,url:a},startTimestamp:1e3*Fo(),virtualError:r,headers:gu(i)};return e||nu("fetch",du({},l)),t.apply(Ei,i).then(function(){var t=uu(function*(t){return e?e(t):nu("fetch",du(du({},l),{},{endTimestamp:1e3*Fo(),response:t})),t});return function(e){return t.apply(this,arguments)}}(),e=>{if(nu("fetch",du(du({},l),{},{endTimestamp:1e3*Fo(),error:e})),zi(e)&&void 0===e.stack&&(e.stack=r.stack,po(e,"framesToPop",1)),e instanceof TypeError&&("Failed to fetch"===e.message||"Load failed"===e.message||"NetworkError when attempting to fetch resource."===e.message))try{var t=new URL(l.fetchData.url);e.message="".concat(e.message," (").concat(t.host,")")}catch(n){}throw e})}})}function pu(e,t){return!!e&&"object"==typeof e&&!!e[t]}function vu(e){return"string"==typeof e?e:e?pu(e,"url")?e.url:e.toString?e.toString():"":""}function gu(e){var t,[r,n]=e;try{if("object"==typeof n&&null!==n&&"headers"in n&&n.headers)return new Headers(n.headers);if(t=r,"undefined"!=typeof Request&&$i(t,Request))return new Headers(r.headers)}catch(i){}}function _u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function mu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var yu=100;function bu(e,t){var r=us(),n=ls();if(r){var{beforeBreadcrumb:i=null,maxBreadcrumbs:o=yu}=r.getOptions();if(!(o<=0)){var s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_u(Object(r),!0).forEach(function(t){mu(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({timestamp:xo()},e),a=i?Ri(()=>i(s,t)):s;null!==a&&(r.emit&&r.emit("beforeAddBreadcrumb",a,t),n.addBreadcrumb(a,o))}}}function Eu(e){return"warn"===e?"warning":["fatal","error","warning","log","info","debug"].includes(e)?e:"log"}function Su(e){return void 0===e?void 0:e>=400&&e<500?"warning":e>=500?"error":void 0}function Tu(e){if(!e)return{};var t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var r=t[6]||"",n=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:r,hash:n,relative:t[5]+r+n}}var Cu,Au,Pu,Ru=Ei;function Ou(){if(Ru.document){var e=nu.bind(null,"dom"),t=Lu(e,!0);Ru.document.addEventListener("click",t,!1),Ru.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach(t=>{var r,n,i=null===(r=Ru[t])||void 0===r?void 0:r.prototype;null!=i&&null!==(n=i.hasOwnProperty)&&void 0!==n&&n.call(i,"addEventListener")&&(fo(i,"addEventListener",function(t){return function(r,n,i){if("click"===r||"keypress"==r)try{var o=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},s=o[r]=o[r]||{refCount:0};if(!s.handler){var a=Lu(e);s.handler=a,t.call(this,r,a,i)}s.refCount++}catch(l){}return t.call(this,r,n,i)}}),fo(i,"removeEventListener",function(e){return function(t,r,n){if("click"===t||"keypress"==t)try{var i=this.__sentry_instrumentation_handlers__||{},o=i[t];o&&(o.refCount--,o.refCount<=0&&(e.call(this,t,o.handler,n),o.handler=void 0,delete i[t]),0===Object.keys(i).length&&delete this.__sentry_instrumentation_handlers__)}catch(s){}return e.call(this,t,r,n)}}))})}}function Lu(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return r=>{if(r&&!r._sentryCaptured){var n=function(e){try{return e.target}catch(t){return null}}(r);if(!function(e,t){return"keypress"===e&&(null==t||!t.tagName||"INPUT"!==t.tagName&&"TEXTAREA"!==t.tagName&&!t.isContentEditable)}(r.type,n)){po(r,"_sentryCaptured",!0),n&&!n._sentryId&&po(n,"_sentryId",To());var i="keypress"===r.type?"input":r.type;if(!function(e){if(e.type!==Au)return!1;try{if(!e.target||e.target._sentryId!==Pu)return!1}catch(t){}return!0}(r))e({event:r,name:i,global:t}),Au=r.type,Pu=n?n._sentryId:void 0;clearTimeout(Cu),Cu=Ru.setTimeout(()=>{Pu=void 0,Au=void 0},1e3)}}}}var Mu,wu="__sentry_xhr_v3__";function Iu(){if(Ru.XMLHttpRequest){var e=XMLHttpRequest.prototype;e.open=new Proxy(e.open,{apply(e,t,r){var n=new Error,i=1e3*Fo(),o=Yi(r[0])?r[0].toUpperCase():void 0,s=function(e){if(Yi(e))return e;try{return e.toString()}catch(t){}return}(r[1]);if(!o||!s)return e.apply(t,r);t[wu]={method:o,url:s,request_headers:{}},"POST"===o&&s.match(/sentry_key/)&&(t.__sentry_own_request__=!0);var a=()=>{var e=t[wu];if(e&&4===t.readyState){try{e.status_code=t.status}catch(r){}nu("xhr",{endTimestamp:1e3*Fo(),startTimestamp:i,xhr:t,virtualError:n})}};return"onreadystatechange"in t&&"function"==typeof t.onreadystatechange?t.onreadystatechange=new Proxy(t.onreadystatechange,{apply(e,t,r){return a(),e.apply(t,r)}}):t.addEventListener("readystatechange",a),t.setRequestHeader=new Proxy(t.setRequestHeader,{apply(e,t,r){var[n,i]=r,o=t[wu];return o&&Yi(n)&&Yi(i)&&(o.request_headers[n.toLowerCase()]=i),e.apply(t,r)}}),e.apply(t,r)}}),e.send=new Proxy(e.send,{apply(e,t,r){var n=t[wu];return n?(void 0!==r[0]&&(n.body=r[0]),nu("xhr",{startTimestamp:1e3*Fo(),xhr:t}),e.apply(t,r)):e.apply(t,r)}})}}function Du(e){var t="history";tu(t,e),ru(t,Nu)}function Nu(){function e(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.length>2?r[2]:void 0;if(i){var o=Mu,s=function(e){try{return new URL(e,Ru.location.origin).toString()}catch(t){return e}}(String(i));if(Mu=s,o===s)return e.apply(this,r);nu("history",{from:o,to:s})}return e.apply(this,r)}}Ru.addEventListener("popstate",()=>{var e=Ru.location.href,t=Mu;(Mu=e,t!==e)&&nu("history",{from:t,to:e})}),"history"in ou&&ou.history&&(fo(Ru.history,"pushState",e),fo(Ru.history,"replaceState",e))}var Bu="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;function ju(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ku(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ju(Object(r),!0).forEach(function(t){xu(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ju(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function xu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Fu=1024,Uu=function(){var e=ku({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{name:"Breadcrumbs",setup(t){var r,n;e.console&&(r=function(e){return function(t){if(us()===e){var r={category:"console",data:{arguments:t.args,logger:"console"},level:Eu(t.level),message:so(t.args," ")};if("assert"===t.level){if(!1!==t.args[0])return;r.message="Assertion failed: ".concat(so(t.args.slice(1)," ")||"console.assert"),r.data.arguments=t.args.slice(1)}bu(r,{input:t.args,level:t.level})}}}(t),tu(n="console",r),ru(n,iu)),e.dom&&function(e){tu("dom",e),ru("dom",Ou)}(function(e,t){return function(r){if(us()===e){var n,i,o="object"==typeof t?t.serializeAttribute:void 0,s="object"==typeof t&&"number"==typeof t.maxStringLength?t.maxStringLength:void 0;s&&s>Fu&&(Bu&&ji.warn("`dom.maxStringLength` cannot exceed ".concat(Fu,", but a value of ").concat(s," was configured. Sentry will use ").concat(Fu," instead.")),s=Fu),"string"==typeof o&&(o=[o]);try{var a=r.event,l=function(e){return!!e&&!!e.target}(a)?a.target:a;n=ro(l,{keyAttrs:o,maxStringLength:s}),i=function(e){if(!to.HTMLElement)return null;for(var t=e,r=0;r<5;r++){if(!t)return null;if(t instanceof HTMLElement){if(t.dataset.sentryComponent)return t.dataset.sentryComponent;if(t.dataset.sentryElement)return t.dataset.sentryElement}t=t.parentNode}return null}(l)}catch(c){n="<unknown>"}if(0!==n.length){var u={category:"ui.".concat(r.name),message:n};i&&(u.data={"ui.component_name":i}),bu(u,{event:r.event,name:r.name,global:r.global})}}}}(t,e.dom)),e.xhr&&function(e){tu("xhr",e),ru("xhr",Iu)}(function(e){return function(t){if(us()===e){var{startTimestamp:r,endTimestamp:n}=t,i=t.xhr[wu];if(r&&n&&i){var{method:o,url:s,status_code:a,body:l}=i,u={method:o,url:s,status_code:a},c={xhr:t.xhr,input:l,startTimestamp:r,endTimestamp:n},d={category:"xhr",data:u,type:"http",level:Su(a)};e.emit("beforeOutgoingRequestBreadcrumb",d,c),bu(d,c)}}}}(t)),e.fetch&&function(e,t){var r="fetch";tu(r,e),ru(r,()=>fu(void 0,t))}(function(e){return function(t){if(us()===e){var{startTimestamp:r,endTimestamp:n}=t;if(n&&(!t.fetchData.url.match(/sentry_key/)||"POST"!==t.fetchData.method))if(t.fetchData.method,t.fetchData.url,t.error){var i=t.fetchData,o={data:t.error,input:t.args,startTimestamp:r,endTimestamp:n},s={category:"fetch",data:i,level:"error",type:"http"};e.emit("beforeOutgoingRequestBreadcrumb",s,o),bu(s,o)}else{var a=t.response,l=ku(ku({},t.fetchData),{},{status_code:null==a?void 0:a.status});t.fetchData.request_body_size,t.fetchData.response_body_size,null==a||a.status;var u={input:t.args,response:a,startTimestamp:r,endTimestamp:n},c={category:"fetch",data:l,type:"http",level:Su(l.status_code)};e.emit("beforeOutgoingRequestBreadcrumb",c,u),bu(c,u)}}}}(t)),e.history&&Du(function(e){return function(t){var r;if(us()===e){var n=t.from,i=t.to,o=Tu(ql.location.href),s=n?Tu(n):void 0,a=Tu(i);null!==(r=s)&&void 0!==r&&r.path||(s=o),o.protocol===a.protocol&&o.host===a.host&&(i=a.relative),o.protocol===s.protocol&&o.host===s.host&&(n=s.relative),bu({category:"navigation",data:{from:n,to:i}})}}}(t)),e.sentry&&t.on("beforeSendEvent",function(e){return function(t){us()===e&&bu({category:"sentry.".concat("transaction"===t.type?"transaction":"event"),event_id:t.event_id,level:t.level,message:Ao(t)},{event:t})}}(t))}}};function Vu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Wu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var zu=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],Gu=function(){var e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vu(Object(r),!0).forEach(function(t){Wu(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,unregisterOriginalCallbacks:!1},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{name:"BrowserApiErrors",setupOnce(){e.setTimeout&&fo(ql,"setTimeout",Hu),e.setInterval&&fo(ql,"setInterval",Hu),e.requestAnimationFrame&&fo(ql,"requestAnimationFrame",qu),e.XMLHttpRequest&&"XMLHttpRequest"in ql&&fo(XMLHttpRequest.prototype,"send",Yu);var t=e.eventTarget;t&&(Array.isArray(t)?t:zu).forEach(t=>function(e,t){var r,n,i=null===(r=ql[e])||void 0===r?void 0:r.prototype;if(null==i||null===(n=i.hasOwnProperty)||void 0===n||!n.call(i,"addEventListener"))return;fo(i,"addEventListener",function(r){return function(n,i,o){try{"function"==typeof i.handleEvent&&(i.handleEvent=Kl(i.handleEvent,{mechanism:{data:{function:"handleEvent",handler:Ss(i),target:e},handled:!1,type:"instrument"}}))}catch(s){}return t.unregisterOriginalCallbacks&&function(e,t,r){e&&"object"==typeof e&&"removeEventListener"in e&&"function"==typeof e.removeEventListener&&e.removeEventListener(t,r)}(this,n,i),r.apply(this,[n,Kl(i,{mechanism:{data:{function:"addEventListener",handler:Ss(i),target:e},handled:!1,type:"instrument"}}),o])}}),fo(i,"removeEventListener",function(e){return function(t,r,n){try{var i=r.__sentry_wrapped__;i&&e.call(this,t,i,n)}catch(o){}return e.call(this,t,r,n)}})}(t,e))}}};function Hu(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r[0];return r[0]=Kl(i,{mechanism:{data:{function:Ss(e)},handled:!1,type:"instrument"}}),e.apply(this,r)}}function qu(e){return function(t){return e.apply(this,[Kl(t,{mechanism:{data:{function:"requestAnimationFrame",handler:Ss(e)},handled:!1,type:"instrument"}})])}}function Yu(e){return function(){var t=this;["onload","onerror","onprogress","onreadystatechange"].forEach(e=>{e in t&&"function"==typeof t[e]&&fo(t,e,function(t){var r={mechanism:{data:{function:e,handler:Ss(t)},handled:!1,type:"instrument"}},n=go(t);return n&&(r.mechanism.data.handler=Ss(n)),Kl(t,r)})});for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.apply(this,n)}}var Qu=()=>({name:"BrowserSession",setupOnce(){void 0!==ql.document?(Fl({ignoreDuration:!0}),Wl(),Du(e=>{var{from:t,to:r}=e;void 0!==t&&t!==r&&(Fl({ignoreDuration:!0}),Wl())})):Bu&&ji.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.")}}),Ku=null;function Xu(){Ku=Ei.onerror,Ei.onerror=function(e,t,r,n,i){return nu("error",{column:n,error:i,line:r,msg:e,url:t}),!!Ku&&Ku.apply(this,arguments)},Ei.onerror.__SENTRY_INSTRUMENTED__=!0}var Ju=null;function Zu(){Ju=Ei.onunhandledrejection,Ei.onunhandledrejection=function(e){return nu("unhandledrejection",e),!Ju||Ju.apply(this,arguments)},Ei.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function $u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function ec(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var tc=function(){var e=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?$u(Object(r),!0).forEach(function(t){ec(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$u(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({onerror:!0,onunhandledrejection:!0},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return{name:"GlobalHandlers",setupOnce(){Error.stackTraceLimit=50},setup(t){e.onerror&&(!function(e){t=t=>{var{stackParser:r,attachStacktrace:n}=nc();if(us()===e&&!Ql()){var{msg:i,url:o,line:s,column:a,error:l}=t,u=function(e,t,r,n){var i=e.exception=e.exception||{},o=i.values=i.values||[],s=o[0]=o[0]||{},a=s.stacktrace=s.stacktrace||{},l=a.frames=a.frames||[],u=n,c=r,d=Yi(t)&&t.length>0?t:io();return 0===l.length&&l.push({colno:u,filename:d,function:gs,in_app:!0,lineno:c}),e}(Il(r,l||i,void 0,n,!1),o,s,a);u.level="error",xl(u,{originalException:l,mechanism:{handled:!1,type:"onerror"}})}},r="error",tu(r,t),ru(r,Xu);var t,r}(t),rc("onerror")),e.onunhandledrejection&&(!function(e){t=t=>{var{stackParser:r,attachStacktrace:n}=nc();if(us()===e&&!Ql()){var i=function(e){if(Ki(e))return e;try{if("reason"in e)return e.reason;if("detail"in e&&"reason"in e.detail)return e.detail.reason}catch(t){}return e}(t),o=Ki(i)?{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: ".concat(String(i))}]}}:Il(r,i,void 0,n,!0);o.level="error",xl(o,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})}},r="unhandledrejection",tu(r,t),ru(r,Zu);var t,r}(t),rc("onunhandledrejection"))}}};function rc(e){Bu&&ji.log("Global Handler attached: ".concat(e))}function nc(){var e=us();return(null==e?void 0:e.getOptions())||{stackParser:()=>[],attachStacktrace:!1}}function ic(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function oc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ic(Object(r),!0).forEach(function(t){sc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ic(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function sc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ac=()=>({name:"HttpContext",preprocessEvent(e){var t;if(ql.navigator||ql.location||ql.document){var r=function(){var e=io(),{referrer:t}=ql.document||{},{userAgent:r}=ql.navigator||{};return{url:e,headers:Gl(Gl({},t&&{Referer:t}),r&&{"User-Agent":r})}}(),n=oc(oc({},r.headers),null===(t=e.request)||void 0===t?void 0:t.headers);e.request=oc(oc(oc({},r),e.request),{},{headers:n})}}});function lc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function uc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lc(Object(r),!0).forEach(function(t){cc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function cc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dc(e,t,r,n,i,o){var s;if(null!==(s=i.exception)&&void 0!==s&&s.values&&o&&$i(o.originalException,Error)){var a=i.exception.values.length>0?i.exception.values[i.exception.values.length-1]:void 0;a&&(i.exception.values=hc(e,t,n,o.originalException,r,i.exception.values,a,0))}}function hc(e,t,r,n,i,o,s,a){if(o.length>=r+1)return o;var l=[...o];if($i(n[i],Error)){fc(s,a);var u=e(t,n[i]),c=l.length;pc(u,i,c,a),l=hc(e,t,r,n[i],i,[u,...l],u,c)}return Array.isArray(n.errors)&&n.errors.forEach((n,o)=>{if($i(n,Error)){fc(s,a);var u=e(t,n),c=l.length;pc(u,"errors[".concat(o,"]"),c,a),l=hc(e,t,r,n,i,[u,...l],u,c)}}),l}function fc(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism=uc(uc(uc({},e.mechanism),"AggregateError"===e.type&&{is_exception_group:!0}),{},{exception_id:t})}function pc(e,t,r,n){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism=uc(uc({},e.mechanism),{},{type:"chained",source:t,exception_id:r,parent_id:n})}var vc=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.limit||5,r=e.key||"cause";return{name:"LinkedErrors",preprocessEvent(e,n,i){dc(Cl,i.getOptions().stackParser,r,t,e,n)}}};function gc(e,t,r,n){var i={filename:e,function:"<anonymous>"===t?gs:t,in_app:!0};return void 0!==r&&(i.lineno=r),void 0!==n&&(i.colno=n),i}var _c=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,mc=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,yc=/\((\S*)(?::(\d+))(?::(\d+))\)/,bc=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,Ec=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,Sc=ys(...[[30,e=>{var t=_c.exec(e);if(t){var[,r,n,i]=t;return gc(r,gs,+n,+i)}var o=mc.exec(e);if(o){if(o[2]&&0===o[2].indexOf("eval")){var s=yc.exec(o[2]);s&&(o[2]=s[1],o[3]=s[2],o[4]=s[3])}var[a,l]=Tc(o[1]||gs,o[2]);return gc(l,a,o[3]?+o[3]:void 0,o[4]?+o[4]:void 0)}}],[50,e=>{var t=bc.exec(e);if(t){if(t[3]&&t[3].indexOf(" > eval")>-1){var r=Ec.exec(t[3]);r&&(t[1]=t[1]||"eval",t[3]=r[1],t[4]=r[2],t[5]="")}var n=t[3],i=t[1]||gs;return[i,n]=Tc(i,n),gc(n,i,t[4]?+t[4]:void 0,t[5]?+t[5]:void 0)}}]]),Tc=(e,t)=>{var r=-1!==e.indexOf("safari-extension"),n=-1!==e.indexOf("safari-web-extension");return r||n?[-1!==e.indexOf("@")?e.split("@")[0]:gs,r?"safari-extension:".concat(t):"safari-web-extension:".concat(t)]:[e,t]},Cc=Symbol.for("SentryBufferFullError");function Ac(e){var t=[];function r(e){return t.splice(t.indexOf(e),1)[0]||Promise.resolve(void 0)}return{$:t,add:function(n){if(!(void 0===e||t.length<e))return Ia(Cc);var i=n();return-1===t.indexOf(i)&&t.push(i),i.then(()=>r(i)).then(null,()=>r(i).then(null,()=>{})),i},drain:function(e){return new Da((r,n)=>{var i=t.length;if(!i)return r(!0);var o=setTimeout(()=>{e&&e>0&&r(!1)},e);t.forEach(e=>{wa(e).then(()=>{--i||(clearTimeout(o),r(!0))},n)})})}}}function Pc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Rc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oc(e,t){var{statusCode:r,headers:n}=t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now(),o=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Pc(Object(r),!0).forEach(function(t){Rc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e),s=null==n?void 0:n["x-sentry-rate-limits"],a=null==n?void 0:n["retry-after"];if(s)for(var l of s.trim().split(",")){var[u,c,,,d]=l.split(":",5),h=parseInt(u,10),f=1e3*(isNaN(h)?60:h);if(c)for(var p of c.split(";"))"metric_bucket"===p&&d&&!d.split(";").includes("custom")||(o[p]=i+f);else o.all=i+f}else a?o.all=i+function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now(),r=parseInt("".concat(e),10);if(!isNaN(r))return 1e3*r;var n=Date.parse("".concat(e));return isNaN(n)?6e4:n-t}(a,i):429===r&&(o.all=i+6e4);return o}function Lc(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ac(e.bufferSize||64),n={};return{send:function(i){var o=[];if(Hs(i,(t,r)=>{var i=Xs(r);!function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();return function(e,t){return e[t]||e.all||0}(e,t)>r}(n,i)?o.push(t):e.recordDroppedEvent("ratelimit_backoff",i)}),0===o.length)return wa({});var s=zs(i[0],o),a=t=>{Hs(s,(r,n)=>{e.recordDroppedEvent(t,Xs(n))})};return r.add(()=>t({body:Ys(s)}).then(e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&yi&&ji.warn("Sentry responded with status code ".concat(e.statusCode," to sent event.")),n=Oc(n,e),e),e=>{throw a("network_error"),yi&&ji.error("Encountered error running transport request:",e),e})).then(e=>e,e=>{if(e===Cc)return yi&&ji.error("Skipped sending event because buffer is full."),a("queue_overflow"),wa({});throw e})},flush:e=>r.drain(e)}}var Mc="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__,wc={};function Ic(e){var t=wc[e];if(t)return t;var r=Ru[e];if(au(r))return wc[e]=r.bind(Ru);var n=Ru.document;if(n&&"function"==typeof n.createElement)try{var i=n.createElement("iframe");i.hidden=!0,n.head.appendChild(i);var o=i.contentWindow;null!=o&&o[e]&&(r=o[e]),n.head.removeChild(i)}catch(Jc){Mc&&ji.warn("Could not create sandbox iframe for ".concat(e," check, bailing to window.").concat(e,": "),Jc)}return r?wc[e]=r.bind(Ru):r}function Dc(e){wc[e]=void 0}function Nc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Bc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jc(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ic("fetch"),r=0,n=0;return Lc(e,function(i){var o=i.body.length;r+=o,n++;var s=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Nc(Object(r),!0).forEach(function(t){Bc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({body:i.body,method:"POST",referrerPolicy:"strict-origin",headers:e.headers,keepalive:r<=6e4&&n<15},e.fetchOptions);if(!t)return Dc("fetch"),Ia("No fetch implementation available");try{return t(e.url,s).then(e=>(r-=o,n--,{statusCode:e.status,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")}}))}catch(Jc){return Dc("fetch"),r-=o,n--,Ia(Jc)}})}function kc(){return!!function(){var e;if(void 0===ql.window)return!1;var t=ql;if(t.nw)return!1;var r=t.chrome||t.browser;if(null==r||null===(e=r.runtime)||void 0===e||!e.id)return!1;var n=io(),i=["chrome-extension","moz-extension","ms-browser-extension","safari-web-extension"];return!(ql===ql.top&&i.some(e=>n.startsWith("".concat(e,"://"))))}()&&(Bu&&Ri(()=>{console.error("[Sentry] You cannot use Sentry.init() in a browser extension, see: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")}),!0)}function xc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Fc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xc(Object(r),!0).forEach(function(t){Uc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Uc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vc(e){return[No(),hs(),Gu(),Uu(),tc(),vc(),Cs(),ac(),Qu()]}function Wc(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=!t.skipBrowserExtensionCheck&&kc(),n=Fc(Fc({},t),{},{enabled:!r&&t.enabled,stackParser:(e=t.stackParser||Sc,Array.isArray(e)?ys(...e):e),integrations:xi({integrations:t.integrations,defaultIntegrations:null==t.defaultIntegrations?Vc():t.defaultIntegrations}),transport:t.transport||jc});return Os(Zl,n)}function zc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Gc(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zc(Object(r),!0).forEach(function(t){Hc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Hc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var qc=e=>{var[t,r,n]=document.location.hostname.split(".").reverse(),i=/(creative|gate)\..*\.(com|local|dev)/,o="dev"===t,s={beforeSend:t=>{var r;return(null===(r=t.exception)||void 0===r||null===(r=r.values)||void 0===r?void 0:r.some(e=>{var t;return null===(t=e.stacktrace)||void 0===t||null===(t=t.frames)||void 0===t?void 0:t.some(e=>{if(!e.filename)return!1;try{var{hostname:t}=new URL(e.filename);return null!==(null==t?void 0:t.match(i))}catch(r){return!1}})}))?(t.tags=t.tags||{},t.tags.creative=e,o&&(t.tags.stage=n),t):null}},a=Gc(Gc({},s),{},{defaultIntegrations:!1,dsn:"https://3930fc5086c7463e8fa5bd6970c93880@sentry.".concat(j.jv,".com/2"),integrations:Vc().filter(e=>"InboundFilters"!==e.name)});o?Wc(Gc({environment:"stage"},a)):"com"===t&&Math.random()<.01&&Wc(Gc({environment:"production"},a))},Yc=(0,$.A)((e,t,r)=>{var n=!1,i=oe(i=>{var{urls:{domainCheckGet:o="",domainCheckResult:s=""}}=i,a=(0,Gn.A)(t),l=a.split("//").pop(),u=t=>e.post(s,t),c=e=>r.getEntriesByType("resource").find(t=>"fetch"===t.initiatorType&&e(t));e.post(o).then(e=>{var{checkUrl:t}=e;if(!n&&t){n=!0;var r="https://".concat(t.domain).concat(t.path);fetch(r,{headers:{"Accept-Language":Ce}}).then(e=>(e=>e.ok?e.text().then(e=>{try{return JSON.stringify(JSON.parse(e))}catch(Jc){return e}}):Promise.resolve(null))(e).then(n=>{var i=c(e=>{var{name:t}=e;return t.startsWith("".concat(a,"/config?"))}),o=c(e=>{var{name:t}=e;return t===r}),s=t.expectedContent===n&&200===e.status?"success":"error";u({checkId:t.id,result:s,currentDomain:l,requestSignature:t.requestSignature,configLoadTimeMs:i?parseInt(i.duration,10):void 0,checkPerformTimeMs:o?parseInt(o.duration,10):void 0,resultResponse:"".concat(n).slice(0,255),resultStatusCode:e.status})})).catch(e=>{var r=c(e=>{var{name:t}=e;return t.startsWith("".concat(a,"/config?"))});u({checkId:t.id,result:"fail",currentDomain:l,requestSignature:t.requestSignature,configLoadTimeMs:r?parseInt(r.duration,10):void 0,resultResponse:e.message})})}})},100);return{effects:[te.z.effect(()=>(e,t)=>i(e,t))]}}).requires("Api","location","performance"),Qc=Yc;function Kc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Xc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Jc=-1,Zc=e=>{addEventListener("pageshow",t=>{t.persisted&&(Jc=t.timeStamp,e(t))},!0)},$c=(e,t,r,n)=>{var i,o;return s=>{t.value>=0&&(s||n)&&(((o=t.value-(null!=i?i:0))||void 0===i)&&(i=t.value,t.delta=o,t.rating=((e,t)=>e>t[1]?"poor":e>t[0]?"needs-improvement":"good")(t.value,r),e(t)))}},ed=e=>{requestAnimationFrame(()=>requestAnimationFrame(()=>e()))},td=()=>{var e=performance.getEntriesByType("navigation")[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},rd=()=>{var e,t=td();return null!==(e=null==t?void 0:t.activationStart)&&void 0!==e?e:0},nd=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=td(),n="navigate";return Jc>=0?n="back-forward-cache":r&&(document.prerendering||rd()>0?n="prerender":document.wasDiscarded?n="restore":r.type&&(n=r.type.replace(/_/g,"-"))),{name:e,value:t,rating:"good",delta:0,entries:[],id:"v5-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:n}},id=new WeakMap;function od(e,t){return id.get(e)||id.set(e,new t),id.get(e)}class sd{constructor(){Xc(this,"t",void 0),Xc(this,"i",0),Xc(this,"o",[])}h(e){var t;if(!e.hadRecentInput){var r=this.o[0],n=this.o.at(-1);this.i&&r&&n&&e.startTime-n.startTime<1e3&&e.startTime-r.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),null===(t=this.t)||void 0===t||t.call(this,e)}}}var ad,ld=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(PerformanceObserver.supportedEntryTypes.includes(e)){var n=new PerformanceObserver(e=>{Promise.resolve().then(()=>{t(e.getEntries())})});return n.observe(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kc(Object(r),!0).forEach(function(t){Xc(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({type:e,buffered:!0},r)),n}}catch(i){}},ud=e=>{var t=!1;return()=>{t||(e(),t=!0)}},cd=-1,dd=new Set,hd=()=>"hidden"!==document.visibilityState||document.prerendering?1/0:0,fd=e=>{if("hidden"===document.visibilityState){if("visibilitychange"===e.type)for(var t of dd)t();isFinite(cd)||(cd="visibilitychange"===e.type?e.timeStamp:0,removeEventListener("prerenderingchange",fd,!0))}},pd=()=>{if(cd<0){var e,t=rd(),r=document.prerendering||null===(e=globalThis.performance.getEntriesByType("visibility-state").filter(e=>"hidden"===e.name&&e.startTime>t)[0])||void 0===e?void 0:e.startTime;cd=null!=r?r:hd(),addEventListener("visibilitychange",fd,!0),addEventListener("prerenderingchange",fd,!0),Zc(()=>{setTimeout(()=>{cd=hd()})})}return{get firstHiddenTime(){return cd},onHidden(e){dd.add(e)}}},vd=e=>{document.prerendering?addEventListener("prerenderingchange",()=>e(),!0):e()},gd=[1800,3e3],_d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vd(()=>{var r,n=pd(),i=nd("FCP"),o=ld("paint",e=>{for(var t of e)"first-contentful-paint"===t.name&&(o.disconnect(),t.startTime<n.firstHiddenTime&&(i.value=Math.max(t.startTime-rd(),0),i.entries.push(t),r(!0)))});o&&(r=$c(e,i,gd,t.reportAllChanges),Zc(n=>{i=nd("FCP"),r=$c(e,i,gd,t.reportAllChanges),ed(()=>{i.value=performance.now()-n.timeStamp,r(!0)})}))})},md=[.1,.25],yd=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=pd();_d(ud(()=>{var n,i=nd("CLS",0),o=od(t,sd),s=e=>{for(var t of e)o.h(t);o.i>i.value&&(i.value=o.i,i.entries=o.o,n())},a=ld("layout-shift",s);a&&(n=$c(e,i,md,t.reportAllChanges),r.onHidden(()=>{s(a.takeRecords()),n(!0)}),Zc(()=>{o.i=0,i=nd("CLS",0),n=$c(e,i,md,t.reportAllChanges),ed(()=>n())}),setTimeout(n))}))},bd=0,Ed=1/0,Sd=0,Td=e=>{for(var t of e)t.interactionId&&(Ed=Math.min(Ed,t.interactionId),Sd=Math.max(Sd,t.interactionId),bd=Sd?(Sd-Ed)/7+1:0)},Cd=()=>{var e;return ad?bd:null!==(e=performance.interactionCount)&&void 0!==e?e:0},Ad=0;class Pd{constructor(){Xc(this,"u",[]),Xc(this,"l",new Map),Xc(this,"m",void 0),Xc(this,"p",void 0)}v(){Ad=Cd(),this.u.length=0,this.l.clear()}L(){var e=Math.min(this.u.length-1,Math.floor((Cd()-Ad)/50));return this.u[e]}h(e){var t;if(null!==(t=this.m)&&void 0!==t&&t.call(this,e),e.interactionId||"first-input"===e.entryType){var r=this.u.at(-1),n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>r.P){var i;if(n?e.duration>n.P?(n.entries=[e],n.P=e.duration):e.duration===n.P&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],P:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort((e,t)=>t.P-e.P),this.u.length>10){var o=this.u.splice(10);for(var s of o)this.l.delete(s.id)}null===(i=this.p)||void 0===i||i.call(this,n)}}}}var Rd=e=>{var t=globalThis.requestIdleCallback||setTimeout;"hidden"===document.visibilityState?e():(e=ud(e),addEventListener("visibilitychange",e,{once:!0,capture:!0}),t(()=>{e(),removeEventListener("visibilitychange",e,{capture:!0})}))},Od=[200,500],Ld=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(globalThis.PerformanceEventTiming&&"interactionId"in PerformanceEventTiming.prototype){var r=pd();vd(()=>{var n;"interactionCount"in performance||ad||(ad=ld("event",Td,{type:"event",buffered:!0,durationThreshold:0}));var i,o=nd("INP"),s=od(t,Pd),a=e=>{Rd(()=>{for(var t of e)s.h(t);var r=s.L();r&&r.P!==o.value&&(o.value=r.P,o.entries=r.entries,i())})},l=ld("event",a,{durationThreshold:null!==(n=t.durationThreshold)&&void 0!==n?n:40});i=$c(e,o,Od,t.reportAllChanges),l&&(l.observe({type:"first-input",buffered:!0}),r.onHidden(()=>{a(l.takeRecords()),i(!0)}),Zc(()=>{s.v(),o=nd("INP"),i=$c(e,o,Od,t.reportAllChanges)}))})}};class Md{constructor(){Xc(this,"m",void 0)}h(e){var t;null===(t=this.m)||void 0===t||t.call(this,e)}}var wd=[2500,4e3],Id=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};vd(()=>{var r,n=pd(),i=nd("LCP"),o=od(t,Md),s=e=>{for(var s of(t.reportAllChanges||(e=e.slice(-1)),e))o.h(s),s.startTime<n.firstHiddenTime&&(i.value=Math.max(s.startTime-rd(),0),i.entries=[s],r())},a=ld("largest-contentful-paint",s);if(a){r=$c(e,i,wd,t.reportAllChanges);var l=ud(()=>{s(a.takeRecords()),a.disconnect(),r(!0)}),u=e=>{e.isTrusted&&(Rd(l),removeEventListener(e.type,u,{capture:!0}))};for(var c of["keydown","click","visibilitychange"])addEventListener(c,u,{capture:!0});Zc(n=>{i=nd("LCP"),r=$c(e,i,wd,t.reportAllChanges),ed(()=>{i.value=performance.now()-n.timeStamp,r(!0)})})}})},Dd=(r(7727),(0,$.A)(e=>({effects:[te.z.effect(()=>t=>{if(!(Math.random()>=.03)){var r=(0,At.FB)(t,"webVitalUrl"),{landing:n}=(0,m.zj)(t);r&&[yd,Ld,Id].forEach(t=>{t(t=>{var{name:i,navigationType:o,rating:s,value:a}=t,l=JSON.stringify({message:{name:i,navigationType:o,rating:s,value:a,creative:n}});navigator.sendBeacon?navigator.sendBeacon(r,l):e.post(r,l)})})}})]})).requires("Api")),Nd=Dd,Bd={initialConfig:{landing:"Player",modelsLimit:20},acceptedParamsConfig:[{key:"modelName",type:_e.A.STRING,default:"",section:me,title:"Model name"}]},jd=(0,se.A)("player started"),kd=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l;return(0,$.A)(()=>e({effects:[jd.effect(()=>(e,t,r)=>{Jr(r,Xt.modelsLoadedEvent)(e=>{var{models:r}=e;return r.forEach(e=>{var{id:r}=e;return t(Un({modelId:r}))})})}),(0,m.I0)(Bd)]}))},xd=["modelName"];function Fd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Ud(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fd(Object(r),!0).forEach(function(t){Vd(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Vd(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}qc("Player");var Wd=[m.Ay,(0,At.Ay)(),ge,_i(),Qc,oi,mi.default,Nd,kd(e=>{var{effects:t}=e;return{effects:[...t,jd.effect(()=>(e,t)=>{t((0,Xt.startLoadingModels)((e=>{var{modelName:t,strict:r}=(0,m.zj)(e);return t&&r?{status:["public","private","groupShow","p2p","virtualPrivate","p2pVoice"]}:void 0})(e)))}),te.z.effect(()=>function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(e,r)=>{var{modelName:n}=(0,m.zj)(e);n&&r((0,m._M)({modelsList:n})),t.forEach(e=>r(e()))}}(jd)),(0,m.I0)({acceptedParamsConfig:[{key:"nonStopPlaying",title:"Play one minute or non stop",default:!0,type:_e.A.BOOL,section:me},Ud(Ud({},Kn),{},{default:F.ALL,enum:Object.values(F).filter(e=>"onHover"!==e)})]})],actions:{setParams:Zr(jd,e=>{var{modelName:t}=e,r=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,xd);return Ud(Ud({},r),(0,K.A)(t)?{}:{modelsList:t})})}}})],zd=(an({modules:[...Wd,Kr()]}),{acceptedParamsConfig:[{key:"language",title:"Language",description:"",section:me,type:_e.A.ENUM,multiple:!1,enum:Te,default:Ce}]});function Gd(e,t,r,n,i,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(n,i)}var Hd=(0,$.A)(function(){var e=function(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var o=e.apply(t,r);function s(e){Gd(o,n,i,s,a,"next",e)}function a(e){Gd(o,n,i,s,a,"throw",e)}s(void 0)})}}(function*(e,t,r){return function(e,t,r){var n=Array.isArray(e)?e:[e];return new Gt(n,r.host||r.hostname).init(xt(r,t.navigator,Te))}(e,t,r).then(e=>({reducer:(0,re.A)({i18n:e}),effects:[(0,m.I0)(zd)]}))});return function(t,r,n){return e.apply(this,arguments)}}()).requires("i18nPaths","window","location"),qd=Hd,Yd=(e,t)=>{var r;return function(){var n=arguments;r||(e.apply(this,n),r=!0,setTimeout(function(){r=!1},t))}},Qd=r(3554);function Kd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Xd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Kd(Object(r),!0).forEach(function(t){Jd(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kd(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Jd(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Zd=(0,$.A)(e=>{var t=(0,re.A)({modelsApiCachedResponse:{tags:[],models:[],meta:{}}}).on(Xt.modelsApiCacheResponseSuccess,e=>{var{models:t,tags:r,meta:n}=e;return()=>({modelsApiCachedResponse:{tags:r,models:t,meta:n}})}),r=Yd((t,r)=>{var n=Cr(t);return ar(e,t,Xd(Xd({},n),{},{limit:2*n.limit})).then(e=>r((0,Xt.modelsApiCacheResponseSuccess)(e)))},3e3),n=Xt.updateModelsApiCache.effect(()=>r),i=Xt.replaceModelWithRandomModel.effect(e=>{var{modelId:t}=e;return(e,r,n)=>{var{modelsList:i,modelsApiCachedResponse:{models:o}}=e,s=((e,t)=>{var r=e.filter(e=>{var{id:r}=e;return!t.includes(r)});return r.length?(0,Qd.A)(r).id:null})(o,i.map(e=>{var{id:t}=e;return t}));if(!s)return n(Xt.modelsApiCacheResponseSuccess,()=>r((0,Xt.replaceModelWithRandomModel)({modelId:t})),!0),void r((0,Xt.updateModelsApiCache)());r((0,Xt.replaceModelByModel)({modelId:t,replaceBy:o.find(e=>{var{id:t}=e;return t===s})}))}});return{reducer:t,effects:[n,i,Rn.effect(e=>{var{modelId:t,fatal:r}=e;return(e,n)=>{if(!(0,m.zj)(e).queryParams.ignoreStreamErrors){var i=e.modelsList.find(e=>{var{id:r}=e;return r===t});(null==i?void 0:i.snapshotUrl.includes("lovescape"))||(n((0,Xt.updateModelsApiCache)()),r&&n((0,Xt.replaceModelWithRandomModel)({modelId:t})))}}})]}}).requires("Api"),$d=Zd,eh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(e.platform)||e.userAgent.includes("Mac")&&"ontouchend"in document},th=function(e){return e.SUCCESS="1",e.NOT_LOGGED_IN="0",e}({}),rh=function(e){return e.DEFAULT="default",e.SANDBOX="sandbox",e}({}),nh=e=>{th.SUCCESS},ih=(e,t,r)=>{var n=e.createElement("iframe");return n.src=t,n.style.display="none",r&&(n.sandbox="allow-forms allow-popups allow-modals allow-scripts allow-same-origin"),n},oh=(e,t)=>{var r;if("saretarget"===(null===(r=t.data)||void 0===r?void 0:r.target))if("uid"in(null==t?void 0:t.data)){var n=null!==t.data.uid?th.SUCCESS:th.NOT_LOGGED_IN;e((0,m._M)({scLoggedIn:n})),e((0,mi.impressionReadyEvent)())}else nh(th.NOT_LOGGED_IN)},sh=e=>{var{state:t,dispatch:r,window:n,document:i}=e,{queryParams:o}=(0,m.zj)(t),s=eh(n.navigator),a=null==o?void 0:o.pmr,l=null==o?void 0:o.scLoggedIn;return s&&l?(nh(l),r((0,mi.impressionReadyEvent)())):((e,t,r)=>!e&&t===rh.DEFAULT||t===rh.SANDBOX&&!(0,gr.A)(r))(s,a,i)?(e=>{var{state:t,dispatch:r,window:n,document:i,pmrMode:o}=e,s=(0,At.FB)(t,"pmrUrl"),a=o===rh.SANDBOX,l=ih(i,s,a);i.body.appendChild(l),n.addEventListener("message",e=>oh(r,e))})({state:t,dispatch:r,window:n,document:i,pmrMode:a}):r((0,mi.impressionReadyEvent)())},ah={initialConfig:{landing:"Spot"},acceptedParamsConfig:[{key:"hideButton",title:"Hide button",description:"",section:me,type:_e.A.BOOL,default:!1},{key:"delay",title:"Delay",description:"",section:me,type:_e.A.INT,default:1},{key:"closeButtonDelay",title:"Show close button delay",description:"",section:me,type:_e.A.INT,default:5},{key:"autoclose",title:"Auto close",description:"",section:me,type:_e.A.BOOL,default:!0},{key:"animate",title:"Open animation",description:"",section:me,type:_e.A.BOOL,default:!1},{key:"width",title:"Width",description:"",section:me,type:_e.A.INT,min:0,max:3840},{key:"height",title:"Height",description:"",section:me,type:_e.A.INT,min:0,max:2160},{key:"thumbsMargin",title:"Thumbs margin",type:_e.A.UNSIGNED_INT,disableNonNumeric:!0,section:me,default:2,min:0,max:25,placeholder:"0 - 25"},{key:"limit",title:"Limit of models to show",description:"Limit can not be greater than defined by creative",type:_e.A.INT,min:1,max:2,default:1},{key:"limitAfterClosure",title:"Limit after closure",description:"",section:me,type:_e.A.INT,default:void 0},{key:"placeCorner",title:"Video placement",description:"",section:me,type:_e.A.ENUM,default:P.BottomRight,enum:Object.values(P),multiple:!1}]};function lh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function uh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?lh(Object(r),!0).forEach(function(t){ch(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lh(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ch(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}qc("Spot");var dh=(0,se.A)("change spot closable"),hh=(0,se.A)("inject"),fh=an({modules:[...Wd,qd,$d,Kr("modelsApi",null),(0,$.A)((e,t)=>{var r,n,i=e=>{clearTimeout(r),r=setTimeout(()=>{e(ae())},2e4)};return{reducer:(0,re.A)({spot:{closable:!1},isWidgetUnInjected:!0}).on(dh,e=>t=>{var{spot:r}=t;return{spot:uh(uh({},r),{},{closable:e})}}).on(hh,e=>({isWidgetUnInjected:!e})),effects:[(0,m.I0)(ah),te.z.effect(()=>(r,o)=>{var{delay:s,autoclose:a,closeButtonDelay:l}=(0,m.zj)(r);sh({state:r,dispatch:o,window:e,document:t}),setTimeout(()=>{o(hh(!0)),n=setTimeout(()=>{o(dh(!0))},1e3*l),a&&i(o)},1e3*s)}),ae.effect(()=>(e,t)=>{t(hh(!1)),clearTimeout(n),clearTimeout(r)})],actions:{handleClose:()=>(e,t)=>{var{limitAfterClosure:r}=(0,m.zj)(e);r&&a.set(h.LAST_VIEWED_TIME,(new Date).toISOString()),t(ae())},handleTakeInterest:()=>clearTimeout(r),handleLostInterest:()=>(e,t)=>{var{autoclose:r}=(0,m.zj)(e);r&&i(t)}}}}).requires("window","document")]});function ph(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function vh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ph(Object(r),!0).forEach(function(t){gh(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ph(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function gh(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}window.StripchatSpot=p(v("SCSpotScript").src,fh,(t,r)=>{var{isWidgetUnInjected:n}=t,{width:i,height:o,animate:s,queryParams:{placeCorner:a=P.BottomRight}}=(0,m.zj)(t);return n?null:e("div",{className:_()(w.root,w[a],{[w.slideAnimation]:s}),style:y(i,o),onmouseenter:r.handleTakeInterest,onmouseleave:r.handleLostInterest},e(Kt,{actions:r}))},e=>vh(vh({},e),{},{i18nPaths:["/widgets/Spot/lang"]}))}()}();