/***********************************

> ScriptName        Sora去水印
> Author            @ddgksf2013
> Function          Sora AI生成发布[非草稿]的视频，下载时去除水印
> WechatID          墨鱼手记
> TgChannel         https://t.me/ddgksf2021
> Contribute        https://t.me/ddgksf2013_bot
> Feedback          📮 𝐝𝐝𝐠𝐤𝐬𝐟𝟐𝟎𝟏𝟑@𝟏𝟔𝟑.𝐜𝐨𝐦 📮
> UpdateTime        2025-10-16
> Attention         如需引用请注明出处，谢谢合作！
> ScriptURL         https://gist.githubusercontent.com/ddgksf2013/71fca841d34a7b440408276d03da3261/raw/SoraRemoveWatermark.js




[rewrite_local]

# > Sora去水印@ddgksf2013
^https?:\/\/videos\.openai\.com\/.*vg-assets\/assets.*mp4 url script-request-header https://gist.githubusercontent.com/ddgksf2013/71fca841d34a7b440408276d03da3261/raw/SoraRemoveWatermark.js

[mitm]

hostname = videos.openai.com

***********************************/

const $ = new Env("sora");
var hYIseR,k2LU2pz,SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;const pZcBsV=[0x0,0x1,0x8,0xff,"length","undefined",0x3f,0x6,"fromCodePoint",0x7,0xc,"push",0x5b,0x1fff,0x58,0xd,0xe,null,!0x1,0x7f,0x80];function Arbppb(hYIseR){var k2LU2pz="/dshFMcWbDeCpPZi`St=_uB[4>,vT:o+HJE8j.my9Y^3kn?|L2V~l*IG!$70A<w5#q({%x6}ONzrXg]KfQUR&@1a\";)",SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(SvWeUaM=""+(hYIseR||""),UsmLbu=SvWeUaM.length,N7QU5y1=[],N61i6Os=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<UsmLbu;NYUG6A++){var Arbppb=k2LU2pz.indexOf(SvWeUaM[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],N61i6Os|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(N7QU5y1.push(N61i6Os&pZcBsV[0x3]),N61i6Os>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){N7QU5y1.push((N61i6Os|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(N7QU5y1)}function CAqr1ja(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=Arbppb(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}uR2o5G7(hYIseR={},k2LU2pz=["dzZl9|_7Twsv/hT:RZ92rw{[z_4X>Fh>sHnW<O\"1/p<2&hDtG/","mD0gT@]?@PtE,MSE","cFoT1x(t<C\">|7m4+iboJI!7Xqn0vmq+","3}0gU]b?n!6dQO}>8$1Nk.|Y($dv,2`y&+aNPQjp+iyT}6Jjm$7:R]Rd","K64c3<G:c7s]vh4:$S/IaRPY#p8X_}`Er[A:J|NP0Se`v,r>O!s","HAJ~_x/","GZHNH0l7S(n4=,^+QEfIl~/^MIow,QP","@0{zrR}dXSerffZ","7,DIgGKW_#Af[mY>o:RMU]K:fA4~firy1~XME9v=M","9~]})N.5kb]2ym+or+x}:9aYwtV0QA{o","}S]X]my8EAV+;FRYGqwXcEjp#5r:d","b}PXm2WPd(oXOLO,_:D~6EMxj#`rz2o:)*d","5h#ceQls$wdrxO7^79zb0*]El$5!37ht&qkW2~>*sid%$LITq/","gZ8O..~|X!qdm>Om(w)M.@e1yP","S5+I<~]?ft`K<xW.Jh=g(?Oo9SVTE<e","5%%e%OF63SoZyZ<jxSc+Um@[Eieo},Dy","viY~76<:S(XA8mi,`.D]49U4?icUyZ[86+4Nn._s","m%/c@Vwpx=oWK6lEzZrgo<a$D7Co=Zi","#[sO0y*Pk0ItP`E[BIO~5zdYnZ_XJLp","e5~HIy5|)_","o..+cGm4wbEO*L~Y[%ve","ic0:Vr[*/5erWVZ,&q!c>}g:cP$FiZ}mF8<Gpx.8J(=+lh","5q!~Dj886=oXxFc>i$Me3!F#Q$#tdL*T","v%0g#y/bx=OgJ`~E;01N~?VoUpyKK,{tD5pW*y1lF","tc<z\"m8xlIr{_vhjOc#cm<.$W","ATnWj@35Q$q*?2,^HE\"D^N4lH(,e5U;[P.~*cKCYJinu`iv[","e%QI=Q|YbeEZAivT[}0:txvY@7yNF`b","jh0HY.@@sI6>q4v:{IRV&xiPa7vOhvJ4oA)HY%3|@I|+lR>TTzK2ng/","jDXVk~z?(i&{X0BY}IFMeXEoM","c}.G|6Ej.#=GfR}tK>L2v|DP/t",".hFg06wpQDmh@fO+C9%,@l_b%=q5&iD","/8%:3N`7M","YSZl*~ZbEDRg~hv:F2!~RV/4DS]j57ky4z^HxO<d","9~LI7*u:Q$C7%vY>j}bId*@xkZTWLij4R6dv(Q/","]EaNSR2r5*P75Z=veFOc,",")NLN)$r:MIxgW,V9g~8e}K$5(A`K%LS_a/","9~9v}VmoUpnwLRjm[~je","4Ar:`w|W,w$fHFQvB%Fe","dI$I>}#4zCSU]QXy6.Q~%E:={I%fP&Z9ppM+88G|.7SxF`xoQ6<G4","i,~*_VolJi@tx4tT>qw2J</","$qlGlg]cB##8HvM3Jh8O$A17kqaAs<5^V99cnge7u#tK>L+SI9JIo","Q6yIzzM>EAnN5vF4)ws","k[<z[$uW\"SYL5mmtj$BTk8/","FHZ+fRHjMIkX/","_cDIF1daM=YNP.c","]~V*+l#cRI2!6>[Yvd",")b&V|y}YHuA0B<Sv)*&*alW=ti,","fn6Df$/","49:Wfmt42D,x?s","<.neqL71n0}8jR!Ejpd~u@~YsI,~rZ0^0[4Dh?`bipAg/","~DmW;|3=$_ve7>S_4_:ev9/","5q(Mi}(?y_~Nvsd[v%X:.|/oKtqHe.sjX~!Iq*oz`pt41Qr,i}d",")nc+d*v=)qlt3,ooj%HvulZ4SpCo&8>YH%p:,0Q$rC%>&Rmms$0*4l[Wip","00yXm<vYK58O4}$YrnRg|~6oM7I6T|@T[[zH%w#%!72X/","P2`cv9jlgCdJ9vbmXw!D%wOt&=v7+ZivI~[cXxjt1=iEd","0q)H)]clJD","\"nsOj9,4+p8x1>|yh2s",".}wF(OcbQIkFhm$:o?DIKzTs","/pPWV?xW,0Y","H$7:|rW*winGV2X=aqqcgL85K5Xty6/t:_h",";TYvCR/bbG>x`L>T9L5F$53$dp@zO}C,Ow[IY<r~be9Ks<>TfEfcB",";!dokfTsXCWI@f[:cF=Ob1`l>q6fJFIT.3=ORng~\"_","4}MVY8,s($0f.<G8_},H|r4zwtjGJ`ITQ!.F**4l?br2c.9,fEs","..bJMADYF","9I5D$5+||!L0Qf7:t,ylc*e7Jir:V>UTyI1T40/","xD*zRx}Wr_OgJM\"^$IdvZz]E}#5>R,zmh(do.|/","_t/ofRws","P5#~k5S*gwr{ZV)B;Cl:T|r:Xb6>&iNmoz%eSRFbc","tI^HCmxPG_Lx!``v{Ls","#+DI`$F4:0RV3sk>(%^v1}>W&P*8M`Ivtd","YL=z*&aKVARzEZ?,ac!2EN5[o0>x+Ugy!}O~y<TlL(PU{Z\"^r/","@cq~~UW5c","nEl:l!y=d(K>iUbt6IuW07m4rqhOi,bm`d","R^z~1}F40SboQLOtJ:ErHI{5`t>L<Lw:R+keG*MYW",",[Fz^U(zpw}NKRrm!9v:SR/","[?`oBl9p;7}NjO9tx^hME%]7qp{!j}7Yu:?F","@+:+PRd>)qWoVP+[:9T:Gy#pip~w^P4:%~/r_R}$(A4hbRY+d5d","C$Rga]y8I=","*ERM6LnP~D;><O[:;/","f0xTK}5P?!QBfiT:N[wT7g(?w!h[,M","&_,OT8|Y!_)Hd","EAicKz857_4Xbhgme$#Do}V7`pp%vm@v","G%hg,0Xt<Z,PwP!Y]6Wc","n%/oo|mj8=f?d","=~+I@}#oewQd6>,Y&NcW^66o_=TGI>X,A,Me","p?je(Ac^+A3x^sGT5D^OU]_#`AGNP&5S?pBGbKI7iu~5t<q+5wL2T","2DwT]Xh*,Sdcbi;Yc[^rOKAoAw)duL@9UcQ~4X#cM",";N<GwE@P)0IZ=s","I,8Orm2PMeevG6>8Q_J~i$>YUpuKFh","_c1W]$4?l=/%(mkmtAxWpzr$|tFr~m0^o:0gP","1~X}rw>YOPcK<QfEAZF:Zz{x+i8uZ<Ot","v.fI\"}Hj9Pq(7.[Y%IX+Xm??lI/r=Ziv/AYOhzklYq!!&h","\"hg}VUN~OPXgCh<jdF;c^fKYMPPo$LuTEAZJo","ZpHDUJuP]0p%WmooKSGD%*]l8DI>@Lsj.~0HmUh=kCk(i,[TT:fIemWPh","1cnzE0,zLACLI2Yy>A6}[}!1q5!","%%<lF1|d8p5ZhmS_,%{:XG;:u7&bqF",";N&gxz/j=D&H(x8>Qq!I@@r$J5Ndw2ymZ2RV7E+:;w5!r6d.2n;c","R+,rwg77F$lxKvh>`IZlCxVt4_^Lk|/^u?Pz77\"?hp]F2Ld3P$2c~rRd","1nWo,0Sd","$w0btmt4a_ue[Z]9*q`r$&8=qtR5xFc=9%~g/Kos","X+aX3!1fAb@{jvoSk$,rNAWQNq!0W,x.W5Gl>","RR+3eD5bB#Gc?$uqjn","VR5DLC$b","BTQPP\"4","$d#:G@{jM#P=bsM","&~LD","tiBG3UQx(A\"?sM",":(UpJ>L,H:",":(N&mq[e","#/oQ4qxP=kshuOx.]?R+J","v!<f","Hv`rZ_sU]lFwQ`x.QQ1i$P1c[;)","qm!gp|ac,5CM%@8+:sx|]E{Y~y$ph<wl]ysiO>OiV&qR]LwI","`1a[kcOmB@","NM`r}F.\":<cK0.oJGtL_PFIm*<%u^","DPQL]56h","4[q!W5;X:|m?F3;dIMB_Z","X*UG<2[}6l)b=]Ez<3!cP","k*\"BbR1IXWb|})=\"CrBSBx)0",",(Sq#Hy","Zf:9pKsIVM4!.,","83bD","FFlg+}/","tiBG2%Es","!,o++]CPW#X?@F","29o+<&n8c","2nuFQJcpH$a6f}8mn$d","8.rig7$YH5B{8s,x~P","C1v#N","`2]siQT}","Ku>7L<IcM{Bv=]s?vgW:A<j)k6~S6f=?YYtVSwriirT","G2r/ESJ}",">a:j[sz?vp)","XTG,,iqV{#R@Nw","P|*j/YC0.#R@Im(q!:>Z&IpV#9","3~Mu","[W9/t{eR5DUho|Z_%?Z/?{+LLD;GOU7_#9iY","v3=H>","e^xR@.Ynl","eYodi,f]A\"GNQ:w^f^bH8:u","Ww/d2pg3Ric(naLnJn{&n/QR(|yg[|8","N2A,","{+N&*","_Uq=","D!6}iN<90^}yqmSH4$v#vZb[KghTutxCMB)i:)+P3yhT6G>jTxZ#O\"l","1!96}","x@9|z"]);function NOi3vZw(){var hYIseR=[function(){return globalThis},function(){return global},function(){return window},function(){return new Function("return this")()}],k2LU2pz,SvWeUaM,UsmLbu;uR2o5G7(k2LU2pz=void 0x0,SvWeUaM=[]);try{uR2o5G7(k2LU2pz=Object,SvWeUaM[pZcBsV[0xb]]("".__proto__.constructor.name))}catch(N7QU5y1){}xvBiwv:for(UsmLbu=pZcBsV[0x0];UsmLbu<hYIseR[pZcBsV[0x4]];UsmLbu++)try{var N61i6Os;k2LU2pz=hYIseR[UsmLbu]();for(N61i6Os=pZcBsV[0x0];N61i6Os<SvWeUaM[pZcBsV[0x4]];N61i6Os++)if(typeof k2LU2pz[SvWeUaM[N61i6Os]]===pZcBsV[0x5])continue xvBiwv;return k2LU2pz}catch(N7QU5y1){}return k2LU2pz||this}uR2o5G7(SvWeUaM=NOi3vZw()||{},UsmLbu=SvWeUaM.TextDecoder,N7QU5y1=SvWeUaM.Uint8Array,N61i6Os=SvWeUaM.Buffer,CaudqE=SvWeUaM.String||String,gq0u7jG=SvWeUaM.Array||Array,NYUG6A=function(){var hYIseR=new gq0u7jG(pZcBsV[0x14]),k2LU2pz,SvWeUaM;uR2o5G7(k2LU2pz=CaudqE[pZcBsV[0x8]]||CaudqE.fromCharCode,SvWeUaM=[]);return function(UsmLbu){var N7QU5y1,N61i6Os,gq0u7jG,NYUG6A;uR2o5G7(N61i6Os=void 0x0,gq0u7jG=UsmLbu[pZcBsV[0x4]],SvWeUaM[pZcBsV[0x4]]=pZcBsV[0x0]);for(NYUG6A=pZcBsV[0x0];NYUG6A<gq0u7jG;){uR2o5G7(N61i6Os=UsmLbu[NYUG6A++],N61i6Os<=pZcBsV[0x13]?N7QU5y1=N61i6Os:N61i6Os<=0xdf?N7QU5y1=(N61i6Os&0x1f)<<pZcBsV[0x7]|UsmLbu[NYUG6A++]&pZcBsV[0x6]:N61i6Os<=0xef?N7QU5y1=(N61i6Os&0xf)<<pZcBsV[0xa]|(UsmLbu[NYUG6A++]&pZcBsV[0x6])<<pZcBsV[0x7]|UsmLbu[NYUG6A++]&pZcBsV[0x6]:CaudqE[pZcBsV[0x8]]?N7QU5y1=(N61i6Os&pZcBsV[0x9])<<0x12|(UsmLbu[NYUG6A++]&pZcBsV[0x6])<<pZcBsV[0xa]|(UsmLbu[NYUG6A++]&pZcBsV[0x6])<<pZcBsV[0x7]|UsmLbu[NYUG6A++]&pZcBsV[0x6]:(N7QU5y1=pZcBsV[0x6],NYUG6A+=0x3),SvWeUaM[pZcBsV[0xb]](hYIseR[N7QU5y1]||(hYIseR[N7QU5y1]=k2LU2pz(N7QU5y1))))}return SvWeUaM.join("")}}());function vYMrz8y(hYIseR){return typeof UsmLbu!==pZcBsV[0x5]&&UsmLbu?new UsmLbu().decode(new N7QU5y1(hYIseR)):typeof N61i6Os!==pZcBsV[0x5]&&N61i6Os?N61i6Os.from(hYIseR).toString("utf-8"):NYUG6A(hYIseR)}function pHWnGb(SvWeUaM,UsmLbu=pZcBsV[0x1]){function N7QU5y1(SvWeUaM){var UsmLbu="4nbQTaNkEYBGMHXRm(wF5USV.>$vy!j3Px_I{p|%q[^d*]+r=Ahf81:Z/<,eos}Wz#`;cgt\"6O@0iDL9~C2JKlu?7&)",N7QU5y1,N61i6Os,hYIseR,k2LU2pz,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(N7QU5y1=""+(SvWeUaM||""),N61i6Os=N7QU5y1.length,hYIseR=[],k2LU2pz=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<N61i6Os;NYUG6A++){var Arbppb=UsmLbu.indexOf(N7QU5y1[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],k2LU2pz|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(hYIseR.push(k2LU2pz&pZcBsV[0x3]),k2LU2pz>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){hYIseR.push((k2LU2pz|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(hYIseR)}function N61i6Os(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=N7QU5y1(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}Object[N61i6Os(0x65)](SvWeUaM,N61i6Os(0x66),{[N61i6Os(0x67)]:UsmLbu,[N61i6Os(0x68)]:pZcBsV[0x12]});return SvWeUaM}const YeM4vl=$request[CAqr1ja(0x69)];function HekYpyZ(SvWeUaM,UsmLbu){if(!UsmLbu){UsmLbu=function(UsmLbu){if(typeof hYIseR[UsmLbu]===pZcBsV[0x5]){return hYIseR[UsmLbu]=SvWeUaM(k2LU2pz[UsmLbu])}return hYIseR[UsmLbu]}}if(!SvWeUaM){SvWeUaM=function(SvWeUaM){var UsmLbu="W3eSOKRPD1$cjs0(EF:9k}Nh,J=xAnltpH[d87^ib.6`T]BC4m\"w;/Q&V?v_zXfY~G)Uq*{%aorZ+y>!<uI@L|5g2M#",N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A,Arbppb,NOi3vZw;uR2o5G7(N7QU5y1=""+(SvWeUaM||""),N61i6Os=N7QU5y1.length,CaudqE=[],gq0u7jG=pZcBsV[0x0],NYUG6A=pZcBsV[0x0],Arbppb=-pZcBsV[0x1]);for(NOi3vZw=pZcBsV[0x0];NOi3vZw<N61i6Os;NOi3vZw++){var hYIseR=UsmLbu.indexOf(N7QU5y1[NOi3vZw]);if(hYIseR===-pZcBsV[0x1])continue;if(Arbppb<pZcBsV[0x0]){Arbppb=hYIseR}else{uR2o5G7(Arbppb+=hYIseR*pZcBsV[0xc],gq0u7jG|=Arbppb<<NYUG6A,NYUG6A+=(Arbppb&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(CaudqE.push(gq0u7jG&pZcBsV[0x3]),gq0u7jG>>=pZcBsV[0x2],NYUG6A-=pZcBsV[0x2])}while(NYUG6A>pZcBsV[0x9]);Arbppb=-pZcBsV[0x1]}}if(Arbppb>-pZcBsV[0x1]){CaudqE.push((gq0u7jG|Arbppb<<NYUG6A)&pZcBsV[0x3])}return vYMrz8y(CaudqE)}}const N7QU5y1=new Date,N61i6Os=N7QU5y1[CAqr1ja(0x6a)]()+"-"+(N7QU5y1[UsmLbu(0x6b)]()+pZcBsV[0x1]),CaudqE=$[UsmLbu(0x6c)](UsmLbu(0x6d));if(CaudqE===pZcBsV[0x11]||CaudqE!==N61i6Os){function gq0u7jG(SvWeUaM){var UsmLbu="^ehC30BX<frztmnPJ}%@|`Q?yZ:;EpDcGx6U$N(8&dT*AI19W],VR[!LwMgvo./lSK#~5u>{YqHO_b=2+Fi7a\"kj)s4",N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A,Arbppb,NOi3vZw;uR2o5G7(N7QU5y1=""+(SvWeUaM||""),N61i6Os=N7QU5y1.length,CaudqE=[],gq0u7jG=pZcBsV[0x0],NYUG6A=pZcBsV[0x0],Arbppb=-pZcBsV[0x1]);for(NOi3vZw=pZcBsV[0x0];NOi3vZw<N61i6Os;NOi3vZw++){var hYIseR=UsmLbu.indexOf(N7QU5y1[NOi3vZw]);if(hYIseR===-pZcBsV[0x1])continue;if(Arbppb<pZcBsV[0x0]){Arbppb=hYIseR}else{uR2o5G7(Arbppb+=hYIseR*pZcBsV[0xc],gq0u7jG|=Arbppb<<NYUG6A,NYUG6A+=(Arbppb&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(CaudqE.push(gq0u7jG&pZcBsV[0x3]),gq0u7jG>>=pZcBsV[0x2],NYUG6A-=pZcBsV[0x2])}while(NYUG6A>pZcBsV[0x9]);Arbppb=-pZcBsV[0x1]}}if(Arbppb>-pZcBsV[0x1]){CaudqE.push((gq0u7jG|Arbppb<<NYUG6A)&pZcBsV[0x3])}return vYMrz8y(CaudqE)}function NYUG6A(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=gq0u7jG(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}uR2o5G7($[NYUG6A(0x6e)](NYUG6A(0x6f),"",NYUG6A(0x70),{[NYUG6A(0x71)]:NYUG6A(0x72)}),$[NYUG6A(0x73)](N61i6Os,NYUG6A(0x74)),ACYmsGc(NYUG6A(0x75)+N61i6Os))}else{function Arbppb(SvWeUaM){var UsmLbu="0VJGLjikbTnsZhNQSI}Po(A7dl_=t!g%B:>\"xKOp5w9*8~Cy^H/M41DuvE<qf)cWeaF&|26[]3Y`+?{R;,XUz#.@$mr",N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A,Arbppb,NOi3vZw;uR2o5G7(N7QU5y1=""+(SvWeUaM||""),N61i6Os=N7QU5y1.length,CaudqE=[],gq0u7jG=pZcBsV[0x0],NYUG6A=pZcBsV[0x0],Arbppb=-pZcBsV[0x1]);for(NOi3vZw=pZcBsV[0x0];NOi3vZw<N61i6Os;NOi3vZw++){var hYIseR=UsmLbu.indexOf(N7QU5y1[NOi3vZw]);if(hYIseR===-pZcBsV[0x1])continue;if(Arbppb<pZcBsV[0x0]){Arbppb=hYIseR}else{uR2o5G7(Arbppb+=hYIseR*pZcBsV[0xc],gq0u7jG|=Arbppb<<NYUG6A,NYUG6A+=(Arbppb&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(CaudqE.push(gq0u7jG&pZcBsV[0x3]),gq0u7jG>>=pZcBsV[0x2],NYUG6A-=pZcBsV[0x2])}while(NYUG6A>pZcBsV[0x9]);Arbppb=-pZcBsV[0x1]}}if(Arbppb>-pZcBsV[0x1]){CaudqE.push((gq0u7jG|Arbppb<<NYUG6A)&pZcBsV[0x3])}return vYMrz8y(CaudqE)}function NOi3vZw(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=Arbppb(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}ACYmsGc(NOi3vZw(0x76)+N61i6Os)}}function ZjVIAR(SvWeUaM,UsmLbu,N7QU5y1){if(!N7QU5y1){N7QU5y1=function(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=UsmLbu(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}}if(!UsmLbu){UsmLbu=function(SvWeUaM){var UsmLbu="y,1;(hc?zvD3b$BfX&Z:6^>mC+=O4|_\"9/5u<#8{]!2`)7wWYEjQNlVTpagLkMrIARUGSFKdJHPoiqtex}.[0*@n~s%",N7QU5y1,N61i6Os,hYIseR,k2LU2pz,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(N7QU5y1=""+(SvWeUaM||""),N61i6Os=N7QU5y1.length,hYIseR=[],k2LU2pz=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<N61i6Os;NYUG6A++){var Arbppb=UsmLbu.indexOf(N7QU5y1[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],k2LU2pz|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(hYIseR.push(k2LU2pz&pZcBsV[0x3]),k2LU2pz>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){hYIseR.push((k2LU2pz|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(hYIseR)}}let N61i6Os=SvWeUaM[N7QU5y1(0x77)](new RegExp(N7QU5y1(0x78),""));return N61i6Os?N61i6Os[pZcBsV[0x0]]:pZcBsV[0x11]}const jUmxZ9=pZcBsV[0x12];function ACYmsGc(hYIseR){if(jUmxZ9){console[CAqr1ja(0x79)](hYIseR)}}let O3GuTMf=JSON[CAqr1ja(0x7a)]($[CAqr1ja(0x7b)](CAqr1ja(0x7c))||"{}");const HitjWm=0x14;if(YeM4vl[CAqr1ja(0x7d)](CAqr1ja(0x7e))!==-pZcBsV[0x1]){let YkoQr2l=ZjVIAR(YeM4vl);if(YkoQr2l){function gLGCx1(hYIseR){var k2LU2pz="JPY.U6MVawHB(&>1}vz!=jCk)^sZNA~2/QW_+K$?x4o[utIhflD9Rq*EbSc]r|`<L5F%{OGXyp@3ei#d0Tg7m:,8;n\"",SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(SvWeUaM=""+(hYIseR||""),UsmLbu=SvWeUaM.length,N7QU5y1=[],N61i6Os=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<UsmLbu;NYUG6A++){var Arbppb=k2LU2pz.indexOf(SvWeUaM[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],N61i6Os|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(N7QU5y1.push(N61i6Os&pZcBsV[0x3]),N61i6Os>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){N7QU5y1.push((N61i6Os|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(N7QU5y1)}function o2jQdw(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=gLGCx1(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}if(!O3GuTMf[o2jQdw(pZcBsV[0x13])](YkoQr2l)){function rwtznl(hYIseR){var k2LU2pz="uv}|w9^{HZBqnVA2to63]Kr`<xTkF7G,jgJ$(~mOd1lCLb@;>EU:?=./Xay[)\"5p#eP+SDYI%4h&Rsi0MQz*!NWcf_8",SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(SvWeUaM=""+(hYIseR||""),UsmLbu=SvWeUaM.length,N7QU5y1=[],N61i6Os=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<UsmLbu;NYUG6A++){var Arbppb=k2LU2pz.indexOf(SvWeUaM[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],N61i6Os|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(N7QU5y1.push(N61i6Os&pZcBsV[0x3]),N61i6Os>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){N7QU5y1.push((N61i6Os|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(N7QU5y1)}function WqfTOwI(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=rwtznl(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}let SXeM2M=Object[o2jQdw(pZcBsV[0x14])](O3GuTMf);if(SXeM2M[WqfTOwI(0x81)]>=HitjWm){function I6C9WJ0(hYIseR){var k2LU2pz="9])uNG%t7dr0s[/+TDj6{~o3i*4aRLnHApc\"ZgfP?lIQBeC,(kKSh@:OY;ME#UvbJ21>q|5<mW&wVFxX_}z`!.=^y$8",SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(SvWeUaM=""+(hYIseR||""),UsmLbu=SvWeUaM.length,N7QU5y1=[],N61i6Os=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<UsmLbu;NYUG6A++){var Arbppb=k2LU2pz.indexOf(SvWeUaM[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],N61i6Os|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(N7QU5y1.push(N61i6Os&pZcBsV[0x3]),N61i6Os>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){N7QU5y1.push((N61i6Os|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(N7QU5y1)}function wLIho4B(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=I6C9WJ0(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}let ap1L8kB=SXeM2M[pZcBsV[0x0]];uR2o5G7(delete O3GuTMf[ap1L8kB],ACYmsGc(wLIho4B(0x82)+ap1L8kB))}uR2o5G7(O3GuTMf[YkoQr2l]=YeM4vl,$[WqfTOwI(0x83)](JSON[WqfTOwI(0x84)](O3GuTMf),WqfTOwI(0x85)),ACYmsGc(WqfTOwI(0x86)+YkoQr2l+WqfTOwI(0x87)+YeM4vl))}else{ACYmsGc(o2jQdw(0x88)+YkoQr2l)}}uR2o5G7(HekYpyZ(),$[CAqr1ja(0x89)]({}))}else{function vmchTM(hYIseR){var k2LU2pz="u#v`d3lIkH9+<}~/qJjs=owAK2%p|>xRC,Fn:?z1^]Uf5Yy$Ge[!(Mb40LOWX@cE\"6D7;&NTrg{PQ_Vt8iBZ.h*)Sam",SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(SvWeUaM=""+(hYIseR||""),UsmLbu=SvWeUaM.length,N7QU5y1=[],N61i6Os=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<UsmLbu;NYUG6A++){var Arbppb=k2LU2pz.indexOf(SvWeUaM[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],N61i6Os|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(N7QU5y1.push(N61i6Os&pZcBsV[0x3]),N61i6Os>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){N7QU5y1.push((N61i6Os|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(N7QU5y1)}function AgnPED(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=vmchTM(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}if(YeM4vl[AgnPED(0x8a)](AgnPED(0x8b))!==-pZcBsV[0x1]){let YkoQr2l=ZjVIAR(YeM4vl),cKnYgk1=YkoQr2l?O3GuTMf[YkoQr2l]:pZcBsV[0x11];if(cKnYgk1){function abMaQrk(hYIseR){var k2LU2pz=",1[w8|vz?=F#;.<`DL\"NP]eM3*4{bG}x&fOCQ2VnXrY+>5a6q!iU9~IB%7j@Wy0(RlgJ/H^hspk$ZdSKAEoT_tcum:)",SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(SvWeUaM=""+(hYIseR||""),UsmLbu=SvWeUaM.length,N7QU5y1=[],N61i6Os=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<UsmLbu;NYUG6A++){var Arbppb=k2LU2pz.indexOf(SvWeUaM[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],N61i6Os|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(N7QU5y1.push(N61i6Os&pZcBsV[0x3]),N61i6Os>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){N7QU5y1.push((N61i6Os|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(N7QU5y1)}function WdXELI7(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=abMaQrk(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}uR2o5G7(ACYmsGc(WdXELI7(0x8c)+YkoQr2l+WdXELI7(0x8d)+cKnYgk1),$[WdXELI7(0x8e)]({[WdXELI7(0x8f)]:cKnYgk1}))}else{function HdvJzW(hYIseR){var k2LU2pz="l/PzmDQ@adIKB&%(GF?9g*\"uE}x1[,=:60;|s$H<jCM!7T+iAqXv>#Uh2nY~OVJ^rySoN85c4fwZbR){k]etpW_3`.L",SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(SvWeUaM=""+(hYIseR||""),UsmLbu=SvWeUaM.length,N7QU5y1=[],N61i6Os=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<UsmLbu;NYUG6A++){var Arbppb=k2LU2pz.indexOf(SvWeUaM[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],N61i6Os|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(N7QU5y1.push(N61i6Os&pZcBsV[0x3]),N61i6Os>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){N7QU5y1.push((N61i6Os|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(N7QU5y1)}function PNEpk_P(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=HdvJzW(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}uR2o5G7(ACYmsGc(PNEpk_P(0x90)+YkoQr2l),$[PNEpk_P(0x91)]({}))}}else{function GwhjzGX(hYIseR){var k2LU2pz="cy8*`F^aVGTI1i0w=~n9jDXf}z]xKhro|qH;PY&kN54@SdOU?bt,!m>_.CZ{W<sJv(+6\"L2BQ:u/eAM#glE3$[p%)R7",SvWeUaM,UsmLbu,N7QU5y1,N61i6Os,CaudqE,gq0u7jG,NYUG6A;uR2o5G7(SvWeUaM=""+(hYIseR||""),UsmLbu=SvWeUaM.length,N7QU5y1=[],N61i6Os=pZcBsV[0x0],CaudqE=pZcBsV[0x0],gq0u7jG=-pZcBsV[0x1]);for(NYUG6A=pZcBsV[0x0];NYUG6A<UsmLbu;NYUG6A++){var Arbppb=k2LU2pz.indexOf(SvWeUaM[NYUG6A]);if(Arbppb===-pZcBsV[0x1])continue;if(gq0u7jG<pZcBsV[0x0]){gq0u7jG=Arbppb}else{uR2o5G7(gq0u7jG+=Arbppb*pZcBsV[0xc],N61i6Os|=gq0u7jG<<CaudqE,CaudqE+=(gq0u7jG&pZcBsV[0xd])>pZcBsV[0xe]?pZcBsV[0xf]:pZcBsV[0x10]);do{uR2o5G7(N7QU5y1.push(N61i6Os&pZcBsV[0x3]),N61i6Os>>=pZcBsV[0x2],CaudqE-=pZcBsV[0x2])}while(CaudqE>pZcBsV[0x9]);gq0u7jG=-pZcBsV[0x1]}}if(gq0u7jG>-pZcBsV[0x1]){N7QU5y1.push((N61i6Os|gq0u7jG<<CaudqE)&pZcBsV[0x3])}return vYMrz8y(N7QU5y1)}function yv9_62s(SvWeUaM){if(typeof hYIseR[SvWeUaM]===pZcBsV[0x5]){return hYIseR[SvWeUaM]=GwhjzGX(k2LU2pz[SvWeUaM])}return hYIseR[SvWeUaM]}$[yv9_62s(0x92)]({})}}function uR2o5G7(){uR2o5G7=function(){}}
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e)} isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = [""]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }