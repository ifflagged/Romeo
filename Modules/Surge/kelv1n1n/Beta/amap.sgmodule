#!name=高德地图
#!desc=纯享丝滑导航
#!author=树先生, RuCu6
#!icon=https://github.com/luestr/IconResource/raw/refs/heads/main/App_icon/120px/Amap.png
#!category=Jacob

[Rule]
AND,((URL-REGEX,"^http:\/\/.+\/amdc\/mobileDispatch"),(USER-AGENT,"AMapiPhone*")),REJECT

[Body Rewrite]
http-response-jq ^https:\/\/m5\.amap\.com\/ws\/shield\/frogserver\/aocs\/updatable\/ '.data.aiNativeV16={"status":1,"version":"","value":""}|.data.aiNative1520={"status":1,"version":"","value":""}|.data.ai_agent_enter_style_cursor={"status":1,"version":"","value":""}|.data.ai_scenes={"status":1,"version":"","value":""}|.data.aiNativeRC06={"status":1,"version":"","value":""}|.data.plan_ai={"status":1,"version":"","value":""}|.data.ai_native_smart_island={"status":1,"version":"","value":""}|.data.llm={"status":2,"version":"","value":""}'

[Map Local]
# 此条可以屏蔽首次进入的天气动效图层  但是会导致足迹不显示地图数据
^https:\/\/mps\.amap\.com\/ws\/mps\/scene\? data-type=text data="{}" status-code=200 header="Content-Type:application/json"

# 线路导航火车tab推荐
^https:\/\/m5\.amap\.com\/ws\/boss\/transportation\/diversion\/car_train_all_car data-type=text data="{}" status-code=200 header="Content-Type:application/json"

# 订单页更多服务提示
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/order\/car\/feedback\/viptips data-type=text data="{}" status-code=200 header="Content-Type:application/json"

# 订单页打车服务评价
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/order\/car\/remark\/satisfactionConf data-type=text data="{}" status-code=200 header="Content-Type:application/json"

# 订单页随机提问服务反馈问题
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/order\/car\/feedback\/get_card_questions data-type=text data="{}" status-code=200 header="Content-Type:application/json"

# 订单页开始支付宝支付提示横幅
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/pay\/web\/paySuccess\/info\/request data-type=text data="{}" status-code=200 header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/faas\/amap-navigation\/card-service-(car-end|route-plan) data-type=text data="{}" status-code=200 header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/tips_adv\? data-type=text data="{}" status-code=200 header="Content-Type:application/json"

^https:\/\/oss\.amap\.com\/ws\/banner\/lists\/\? data-type=text data="{}" status-code=200 header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/aos\/main\/page\/product\/list\? data-type=text data="{}" status-code=200 header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/faas\/amap-navigation\/(main-page-assets|main-page-location|ridewalk-end-fc) data-type=text data="{}" status-code=200 header="Content-Type:application/json"

#  搜索框热词
^https:\/\/m5\.amap\.com\/ws\/(mapapi\/hint_text\/offline_data|message\/notice\/list|shield\/search\/new_hotword) data-type=text data="{}" status-code=200 header="Content-Type:application/json"

^https:\/\/m5\.amap\.com\/ws\/shield\/scene\/recommend\? data-type=text data="{}" status-code=200 header="Content-Type:application/json"

#  左下角天气
^https:\/\/m5\.amap\.com\/ws\/valueadded\/weather\/v2\? data-type=text data="{}" status-code=200 header="Content-Type:application/json"

^https:\/\/sns\.amap\.com\/ws\/msgbox\/pull_mp\? data-type=text data="{}" status-code=200 header="Content-Type:application/json"

^https:\/\/m5-zb\.amap\.com\/ws\/boss\/(order\/car\/king_toolbox_car_bubble|tips\/onscene_visual_optimization) data-type=text data="{}" status-code=200 header="Content-Type:application/json"

#  搜索结果地图左下角广告图标
^https:\/\/m5\.amap\.com\/ws\/shield\/search_business\/process\/marketingOperationStructured data-type=text data="{}" status-code=200 header="Content-Type:application/json"

#  订单页司机信息栏底部无忧行广告
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/order\/car\/rights_information data-type=text data="{}" status-code=200 header="Content-Type:application/json"

#  导航打车tab顺风车推荐
^https:\/\/m5-zb\.amap\.com\/ws\/boss\/transportation\/diversion\/resource\/driving data-type=text data="{}" status-code=200 header="Content-Type:application/json"

#  新的开屏广告
^https:\/\/amap-aos-info-nogw\.amap\.com\/ws\/aos\/alimama\/splash_screen_rt data-type=text data="{}" status-code=200 header="Content-Type:application/json"

[Script]
路线规划推广 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/aos\/perception\/publicTravel\/beforeNavi\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

路线规划和导航结束页推广 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/bus\/plan\/integrate\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

导航详情页底部酒店 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/c3frontend\/af-(hotel|launch)\/page\/main\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

路线规划推广 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/perception\/drive\/(routeInfo|routePlan), script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

搜索地点导航详情页推广 = type=http-response, pattern=^https:\/\/(?:info\.amap\.com|m5\.amap\.com)\/ws\/shield\/search\/(common\/coupon\/info|poi\/detail), script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

搜索框提示词 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_bff\/hotword\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

搜索详情页推广1 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/homepage, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

搜索详情页推广2 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/search\/sp, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

搜索详情页推广3 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/sug, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

搜索详情页推广4 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search_poi\/tips_operation_location, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

首页推广 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/faas\/amap-navigation\/(card-service-plan-home|main-page), script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

首页推广 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/frogserver\/aocs\/updatable\/1\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

我的页面推广 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/dsp\/profile\/index\/nodefaasv3\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

附近页推广 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/shield\/search\/nearbyrec_smart\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

附近页横幅广告、信息流广告 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/c3frontend\/af-nearby\/nearby, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

开屏广告 = type=http-response, pattern=^https:\/\/m5\.amap\.com\/ws\/valueadded\/alimama\/splash_screen\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

打车页 = type=http-response, pattern=^https:\/\/m5-zb\.amap\.com\/ws\/boss\/(car\/order\/content_info|order_web\/friendly_information), script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

打车页红点角标、天气图标 = type=http-response, pattern=^https:\/\/m5-zb\.amap\.com\/ws\/promotion-web\/resource(\/home)?\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

打车页提示 = type=http-response, pattern=^https:\/\/m5-zb\.amap\.com\/ws\/sharedtrip\/taxi\/order_detail_car_tips\?, script-path=https://klraw.pages.dev/kelv1n1n/script/refs/heads/main/js/amap.js?token=209863, requires-body=true

[MITM]
hostname = %APPEND% *.amap.com

